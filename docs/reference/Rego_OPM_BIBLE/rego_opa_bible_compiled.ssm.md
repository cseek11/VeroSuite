::: chapter-meta
id: CHMETA-d5fde7b099875c02
code: CH-01
number: 1
title: Introduction to OPA and Rego
level: [beginner]
prerequisites: []
sections: [1.1 Why Policy as Code?, 1.2 What is OPA?, 1.3 What is Rego?, 1.4 The OPA Ecosystem]
digest: f8e99bfdf56eccc50a33aca47d691d018fcfc324848522c4250f81d58f461dfa
symbol_refs: []
semantic_role: structure
embedding_hint_importance: high
embedding_hint_scope: chapter
embedding_hint_chunk: auto
role_notes_added: True
graph_prerequisites_direct: []
graph_prerequisites_all: []
graph_neighbors: [CHMETA-e13a48ceca0d1333]
graph_degree: 1
graph_two_hop: [CHMETA-715fae85c2aafc79]
graph_three_hop: [CHMETA-682833df3d4534db]
chapter: CH-01
:::
:::

::: chapter-meta
id: CHMETA-e13a48ceca0d1333
code: CH-02
number: 2
title: Language Specification
level: [beginner]
prerequisites: []
sections: [2.1 Syntax Overview, 2.2 Grammar (Complete EBNF), 2.3 Comments and Formatting, 2.4 Metadata Annotations]
digest: 9b859cc085e6166d39a8ec413fe66733815993124b0017cca0dfbcc8c4440b6d
symbol_refs: []
semantic_role: structure
embedding_hint_importance: high
embedding_hint_scope: chapter
embedding_hint_chunk: auto
role_notes_added: True
graph_prerequisites_direct: [CH-01]
graph_prerequisites_all: [CH-01]
graph_neighbors: [CHMETA-715fae85c2aafc79, CHMETA-d5fde7b099875c02]
graph_degree: 2
graph_two_hop: [CHMETA-682833df3d4534db]
graph_three_hop: [CHMETA-71ac1fc6225ce2b1]
chapter: CH-02
:::
:::

::: chapter-meta
id: CHMETA-715fae85c2aafc79
code: CH-03
number: 3
title: Core Concepts and Evaluation Model
level: [intermediate]
prerequisites: []
sections: [3.1 World Model, 3.2 Rules ‚Äî The Building Blocks, 3.3 Evaluation Semantics, 3.4 Undefined vs False, 3.5 Logical Conjunction and Disjunction, 3.6 Rule Conflicts and Resolution]
digest: e68c978763ace9e05e09ea022995bc1798926dca5b6114bbfb16b570718ed4f6
symbol_refs: []
semantic_role: structure
embedding_hint_importance: high
embedding_hint_scope: chapter
embedding_hint_chunk: auto
role_notes_added: True
graph_prerequisites_direct: [CH-02, CH-11]
graph_prerequisites_all: [CH-02, CH-11]
semantic_categories: [truth-values]
graph_neighbors: [CHMETA-e13a48ceca0d1333, CHMETA-682833df3d4534db]
graph_degree: 2
graph_two_hop: [CHMETA-71ac1fc6225ce2b1, CHMETA-d5fde7b099875c02]
graph_three_hop: []
chapter: CH-03
:::
:::

::: chapter-meta
id: CHMETA-682833df3d4534db
code: CH-04
number: 4
title: Variables, References, and Operators
level: [intermediate]
prerequisites: []
sections: [4.1 Variables and Unification, 4.2 References ‚Äî Traversing Documents, 4.3 The `some` Keyword, 4.4 Operators, Assignment and Equality, Comparison Operators, Arithmetic Operators, Bitwise Operators, Membership: The `in` Operator]
digest: cab24768109a9cc27953d2926e44568a0105dd4bb4e5b00347a227d8e342ead2
symbol_refs: []
semantic_role: structure
embedding_hint_importance: high
embedding_hint_scope: chapter
embedding_hint_chunk: auto
role_notes_added: True
graph_prerequisites_direct: [CH-03]
graph_prerequisites_all: [CH-03]
semantic_categories: [unification]
graph_neighbors: [CHMETA-715fae85c2aafc79, CHMETA-71ac1fc6225ce2b1]
graph_degree: 2
graph_two_hop: [CHMETA-e13a48ceca0d1333]
graph_three_hop: [CHMETA-d5fde7b099875c02]
chapter: CH-04
:::
:::

::: chapter-meta
id: CHMETA-71ac1fc6225ce2b1
code: CH-05
number: 5
title: Control Flow and Iteration
level: [intermediate]
prerequisites: []
sections: [5.1 Logical Conjunction (AND), 5.2 Logical Disjunction (OR), 5.3 Comprehensions, 5.4 Universal Quantification (FOR ALL), 1. Using `every` (Modern, Recommended), 2. Using Negation (Helper Pattern), 3. Using Comprehensions, 5.5 Negation]
digest: 624c1fce96be9507e4a0956a8bc146e7037848ad4b0949860f1a40b6ebbd690d
symbol_refs: []
semantic_role: structure
embedding_hint_importance: high
embedding_hint_scope: chapter
embedding_hint_chunk: auto
role_notes_added: True
graph_prerequisites_direct: [CH-04, CH-08, CH-09, CH-10, CH-11, CH-14, CH-15, CH-17]
graph_prerequisites_all: [CH-04, CH-08, CH-09, CH-10, CH-11, CH-14, CH-15, CH-17]
semantic_categories: [negation]
graph_neighbors: [CHMETA-682833df3d4534db]
graph_degree: 1
graph_two_hop: [CHMETA-715fae85c2aafc79]
graph_three_hop: [CHMETA-e13a48ceca0d1333]
chapter: CH-05
:::
:::

::: concept
id: BLK-1a1e9be7c0791aec
summary: ## üìò Preface ‚Äî Why This Book Exists.
digest: ecb28284ae0b815c6785c524b8e6037569f39e32a9e9b9279860f0a4b15a35bf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ## üìò Preface ‚Äî Why This Book Exists..
vector_summary: ## üìò Preface ‚Äî Why This Book Exists.
:::
## üìò Preface ‚Äî Why This Book Exists
:::

::: concept
id: BLK-aab2646fb63f3856
summary: Datalog (1980s) - Logic programming for databases - Prolog (1972) - Logic programming paradigm - Relational Calculus (1970s) - Theoretical foundati...
digest: ce955f1d0d00567c5ef447ab929f71323bab75c772b00359d4c8a01e0c3d6480
symbol_refs: [Datalog, Relational Calculus, Prolog, Modern Distributed Systems]
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Datalog (1980s) - Logic programming for databases - Prolog (1972) - Logic programming paradigm - Relational Calculus (1970s) - Theoretical foundati....
vector_summary: Datalog (1980s) - Logic programming for databases - Prolog (1972) - Logic programming paradigm - Relational Calculus (1970s) - Theoretical foundati...
graph_neighbors: [TERM-e46fa93c46b299f4]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
:::
- **Datalog** (1980s) - Logic programming for databases - **Prolog** (1972) - Logic programming paradigm - **Relational Calculus** (1970s) - Theoretical foundations - **Modern Distributed Systems** (2010s+) - Cloud-native architectures
:::

::: concept
id: BLK-188b3f5e12b5f024
summary: This Bible serves multiple audiences with unprecedented depth:
digest: a48effe84264cefdd85ad9ce91c5792ec4776070a0aa189dd460b195ccf08ed3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This Bible serves multiple audiences with unprecedented depth:.
vector_summary: This Bible serves multiple audiences with unprecedented depth:
:::
This Bible serves multiple audiences with unprecedented depth:
:::

::: concept
id: BLK-67bb749c0671c42b
summary: Beginners ‚Äî Practical, example-driven explanations with progressive learning 2.
digest: 792e24978734f9745f1580c7655fe8268104785517efcc98623f8c198a8e7b22
symbol_refs: [Beginners, Enterprise Engineers, Practitioners, Researchers & Architects]
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Beginners ‚Äî Practical, example-driven explanations with progressive learning 2..
semantic_categories: [testing, theory]
vector_summary: Beginners ‚Äî Practical, example-driven explanations with progressive learning 2.
graph_neighbors: [CODE-efd78ba9916ca447, CODE-031e381b7120fc25, CODE-8ac93f8eb365af28, CODE-141a39bba2be1ded, CODE-213aa0a6ee07643a]
graph_degree: 5
graph_two_hop: []
graph_three_hop: []
:::
1. **Beginners** ‚Äî Practical, example-driven explanations with progressive learning 2. **Practitioners** ‚Äî Design patterns, testing strategies, and deployment architectures 3. **Researchers & Architects** ‚Äî Formal semantics, fixpoint models, and enterprise policy theory 4. **Enterprise Engineers** ‚Äî Governance frameworks, multi-tenant patterns, and observability
:::

::: fact
id: BLK-24d056bb78be8a2d
summary: # The REGO & OPA Bible ‚Äî Ultimate Expanded Edition.
digest: 9a305ddf7f88d2b595ff883fd930b3b7f8604ff0d3696f2b74ef4f12ae66625c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # The REGO & OPA Bible ‚Äî Ultimate Expanded Edition..
vector_summary: # The REGO & OPA Bible ‚Äî Ultimate Expanded Edition.
:::
# The REGO & OPA Bible ‚Äî Ultimate Expanded Edition
:::

::: fact
id: BLK-bcf609f83239fab7
summary: Definitive Guide to the Rego Language and the Open Policy Agent (OPA) Ecosystem.
digest: c38e92bd8efb1cabc941cac3fbdf853cc68993506905fd8ea6bf18fb72176836
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Definitive Guide to the Rego Language and the Open Policy Agent (OPA) Ecosystem..
vector_summary: Definitive Guide to the Rego Language and the Open Policy Agent (OPA) Ecosystem.
:::
**Definitive Guide to the Rego Language and the Open Policy Agent (OPA) Ecosystem**
:::

::: fact
id: BLK-09dfc188b90c17d9
summary: Version: 2025-11-25 (Expanded) Author: Prof.
digest: 1edbef5985a36ee31b28b4f003fa78bc409178f9051d965cc1b1f16e5b945fe0
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Version: 2025-11-25 (Expanded) Author: Prof..
vector_summary: Version: 2025-11-25 (Expanded) Author: Prof.
:::
Version: 2025-11-25 (Expanded) Author: Prof. [Your Name], Ph.D. Discipline: Computer Engineering, Logic Programming, Declarative Policy Systems
:::

::: fact
id: BLK-f27503706039bad4
summary: Rego and Open Policy Agent (OPA) are not "just another policy framework." They represent the culmination of 40+ years of declarative programming re...
digest: b98969c83fd780b9ff17fc793911c0b2d8af3474c3047e6bcad66e4df6b1fd8e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego and Open Policy Agent (OPA) are not "just another policy framework." They represent the culmination of 40+ years of declarative programming re....
vector_summary: Rego and Open Policy Agent (OPA) are not "just another policy framework." They represent the culmination of 40+ years of declarative programming re...
:::
Rego and Open Policy Agent (OPA) are not "just another policy framework." They represent the culmination of 40+ years of declarative programming research, drawing from:
:::

::: constraint
id: CONSTR-4e81cb406c9e17d0
chapter: 
source_id: 
type: forbidden
digest: adae5d6130a9c78185a66001988d5cd7078ecd6b33bcf10d31b6dcbe1dd1ff6e
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-f46d4becd0a05581
chapter: 
source_id: 
type: forbidden
digest: 5f581d6f3a482ccf7a7c0152d871af2d2226cd49dfa2c91689e42966e5dde14f
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-a60918e29f7f8f50
chapter: 
source_id: 
type: forbidden
digest: e20f46cbbc10db9e647a4d7809c3c94e3cbfd38d9803aa01c560e9683732dcd2
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-ab8ee282d0235728
chapter: 
source_id: 
type: forbidden
digest: d3f2f6d105bbd9f266b363a730d3fad7691b9730b42dd46ec1b345f90d578503
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: qa
id: QA-3e08ff4a34cd1973
chapter: 
q: What is # The REGO & OPA Bible ‚Äî Ultimate Expanded Edition. in the context of Rego/OPA?
a: # The REGO & OPA Bible ‚Äî Ultimate Expanded Edition
reference: BLK-24d056bb78be8a2d
digest: 4440cfd6aa73d70c2cf94aad84c79752bc77dbd5faa51e9a797acb5e1ce9444b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-11f97ce0266d712d
chapter: 
q: What is Definitive Guide to the Rego Language and the Open Policy Agent (OPA) Ecosystem. in the context of Rego/OPA?
a: **Definitive Guide to the Rego Language and the Open Policy Agent (OPA) Ecosystem**
reference: BLK-bcf609f83239fab7
digest: f0491c2c55af98c6e555a424fb9286c6ca0352f20da28981bdf3e8f11e743a54
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-72f0efef97730665
chapter: 
q: What is Version in the context of Rego/OPA?
a: Version: 2025-11-25 (Expanded) Author: Prof. [Your Name], Ph.D. Discipline: Computer Engineering, Logic Programming, Declarative Policy Systems
reference: BLK-09dfc188b90c17d9
digest: bcfb09cd7cb83916b5dbbff21a51bc1162e840030febd879690e7c6e9541596b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-630dbdb59e73312f
chapter: 
q: What is ## üìò Preface ‚Äî Why This Book Exists. in the context of Rego/OPA?
a: ## üìò Preface ‚Äî Why This Book Exists
reference: BLK-1a1e9be7c0791aec
digest: 1b6b0ee8a37f974a1d7969ab300c7474854bcbf20b8f8c6737e79a7c646c27e9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5564d4040f031ff0
chapter: 
q: What is Rego and Open Policy Agent (OPA) are not "just another policy framework." They represent the culmination of 40+ years of declarative programming re... in the context of Rego/OPA?
a: Rego and Open Policy Agent (OPA) are not "just another policy framework." They represent the culmination of 40+ years of declarative programming research, drawing from:
reference: BLK-f27503706039bad4
digest: 44993e07798726860f2da8e409ccbfa457a9069ec0df78bb62b0b81715e9c35d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6849b0ee0c47d72d
chapter: 
q: What is Datalog (1980s) - Logic programming for databases - Prolog (1972) - Logic programming paradigm - Relational Calculus (1970s) - Theoretical foundati... in the context of Rego/OPA?
a: - **Datalog** (1980s) - Logic programming for databases - **Prolog** (1972) - Logic programming paradigm - **Relational Calculus** (1970s) - Theoretical foundations - **Modern Distributed Systems** (2010s+) - Cloud-native architectures
reference: BLK-aab2646fb63f3856
digest: e5477e6d6d90bf828f577419825d3a537eb3bc175de36a35b48dfd7650dd606f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1803389e70b532db
chapter: 
q: What is This Bible serves multiple audiences with unprecedented depth in the context of Rego/OPA?
a: This Bible serves multiple audiences with unprecedented depth:
reference: BLK-188b3f5e12b5f024
digest: 3e0760e5774eb7104110a8b1f61a246e2590bf282e80c0c66508fe6b90c73d40
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2e42bbff92eb135d
chapter: 
q: What is Beginners ‚Äî Practical, example-driven explanations with progressive learning 2. in the context of Rego/OPA?
a: 1. **Beginners** ‚Äî Practical, example-driven explanations with progressive learning 2. **Practitioners** ‚Äî Design patterns, testing strategies, and deployment architectures 3. **Researchers & Architects** ‚Äî Formal semantics, fixpoint models, and enterprise policy theory 4. **Enterprise Engineers** ‚Äî Governance frameworks, multi-tenant patterns, and observability
reference: BLK-67bb749c0671c42b
semantic_categories: [testing, theory]
digest: 54e167690235d786d4aa229254db35af05979c80fa99ae044f1fa1566bb2df46
symbol_refs: []
semantic_role: explanation
:::
:::

::: reasoning-chain
id: CHAIN-99e57f3ca4743edf
chapter: 
qa_id: QA-3e08ff4a34cd1973
reference: BLK-24d056bb78be8a2d
semantic_categories: [truth-values]
digest: cfb6a466445af5345e4d0c1f49e85da569ad758ffb20aa799be23304b3720ae2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2e520f532a93de14
chapter: 
qa_id: QA-11f97ce0266d712d
reference: BLK-bcf609f83239fab7
semantic_categories: [truth-values]
digest: 75241ba474034fd1cb7f32aea677d7269e703acfad74a61fe489af458615f8cf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-07ebbee74d2766dc
chapter: 
qa_id: QA-72f0efef97730665
reference: BLK-09dfc188b90c17d9
semantic_categories: [truth-values]
digest: 6f35f9fa23184ab4ba1eb6071631429908f93bbb683ce12be4aec655a51d4f7c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bb60cddf931d278e
chapter: 
qa_id: QA-630dbdb59e73312f
reference: BLK-1a1e9be7c0791aec
semantic_categories: [truth-values]
digest: f741d4c9fadb1f616f963b0a02119706fe710bbeb04210579c9b07da450f3602
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b7053a5e08607c68
chapter: 
qa_id: QA-5564d4040f031ff0
reference: BLK-f27503706039bad4
semantic_categories: [truth-values]
digest: 6bd42b92e9e8fa43e4186d03ccfa529bfcf31ded782cd826c013910d70159325
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7ece34e409af2667
chapter: 
qa_id: QA-6849b0ee0c47d72d
reference: BLK-aab2646fb63f3856
semantic_categories: [truth-values]
digest: 22d5700f0ec2f08ea36a1ece95a5b2ba5829419ea09ea9baede45705564be300
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-80ac1096c937db4f
chapter: 
qa_id: QA-1803389e70b532db
reference: BLK-188b3f5e12b5f024
semantic_categories: [truth-values]
digest: efd7956d390fd26a5d5003fc262b8c13bdf935e5213d725a7c48027c1c2689bb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b5f3fff4123eb4c3
chapter: 
qa_id: QA-2e42bbff92eb135d
reference: BLK-67bb749c0671c42b
semantic_categories: [truth-values]
digest: 4e684d346410675112e92df09a0b5aa9ac5f2e8ee3c32289e07ccba9fe6acecd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: inference
id: INFER-6e2862322abea38d
from: CH-03
to: CH-11
relation: reference
digest: 4e16609fb8448cab2390b2e5d2d1f26c757133c18168777a8d6e31cd12f978a8
symbol_refs: []
semantic_role: reference
:::
If CH-03 reference CH-11, understanding CH-03 usually helps understand CH-11.
:::

::: inference
id: INFER-e295177aaefd57db
from: community-tools
to: vscode-opa
relation: used_by
digest: 2ec9cd75e32ef1a35eba67c1d4b3ceec7e2111966003ec4994632000d20f021a
symbol_refs: []
semantic_role: content
:::
If community-tools used_by vscode-opa, understanding community-tools usually helps understand vscode-opa.
:::

::: inference
id: INFER-f8cf8376de0fd3b2
from: modern-syntax-opa-10
to: if
relation: used_by
digest: 2e9e20eec7dba5ce9161a1b8eeae255e8f4f76d80b6938079f16646c0beaefb9
symbol_refs: []
semantic_role: content
:::
If modern-syntax-opa-10 used_by if, understanding modern-syntax-opa-10 usually helps understand if.
:::

::: inference
id: INFER-d391cb22670cb5f5
from: CH-05
to: n
relation: contradicts
digest: 8db76a8884cafcb9021f80b14bdc683d0679e120991c082a218a2bfd7c215342
symbol_refs: []
semantic_role: content
:::
If CH-05 contradicts n, understanding CH-05 usually helps understand n.
:::

::: inference
id: INFER-b25e791b10117e8c
from: CH-05
to: CH-08
relation: used_by
digest: f3aa86fcb56056ecac1fbd6cafc3399393af070c6e971cdb00fc240edf879d02
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-08, understanding CH-05 usually helps understand CH-08.
:::

::: inference
id: INFER-30936191a8878aa0
from: CH-05
to: CH-09
relation: used_by
digest: 930781d33f705a8bd7b8be8f2a614dd30954decbb56e5b9dd1218456817dd56f
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-09, understanding CH-05 usually helps understand CH-09.
:::

::: inference
id: INFER-03f024a9d3fcdceb
from: CH-05
to: CH-09
relation: implements
digest: 3f8211e8f189582c63783c0c69acadfc14fda27fdef82a3bc02dcd7d1d1d19da
symbol_refs: []
semantic_role: content
:::
If CH-05 implements CH-09, understanding CH-05 usually helps understand CH-09.
:::

::: inference
id: INFER-391b5467528f93db
from: CH-05
to: CH-10
relation: used_by
digest: 3828fbfdfb489e14c1357342b5449124f834a8aa140f1610bbdefc9cdaea001b
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-10, understanding CH-05 usually helps understand CH-10.
:::

::: inference
id: INFER-460dc16d7b899eae
from: CH-05
to: CH-11
relation: used_by
digest: 2fc959da1300b1ca0d8167ae4b42d0b97ae91e0079a390c88c776962a50639c2
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-11, understanding CH-05 usually helps understand CH-11.
:::

::: inference
id: INFER-18172eec1625bedc
from: CH-05
to: CH-14
relation: used_by
digest: fb604433e39a54eddb72c7e908591314d56c0e895f34bccda1e2d77f27e2b949
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-14, understanding CH-05 usually helps understand CH-14.
:::

::: inference
id: INFER-81f2160e58430322
from: CH-05
to: CH-15
relation: requires
digest: 6549d28033b09f3ebd4e4058e55a929dedbe520c711279af267ea9aa6ee684ab
symbol_refs: []
semantic_role: content
:::
If CH-05 requires CH-15, understanding CH-05 usually helps understand CH-15.
:::

::: inference
id: INFER-36e695eabbfa9587
from: CH-05
to: CH-15
relation: used_by
digest: e3de0fe37da68089684a17f1a904cbda8ff8b74f6f21aac284c35b07df5e7d96
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-15, understanding CH-05 usually helps understand CH-15.
:::

::: inference
id: INFER-d02d124e5d2e3d25
from: CH-17
to: CH-18
relation: requires
digest: db7975a9a9897077d446e98bc4c35691c35a063f14da87e5d8a227ad7c927cbc
symbol_refs: []
semantic_role: content
:::
If CH-17 requires CH-18, understanding CH-17 usually helps understand CH-18.
:::

::: inference
id: INFER-c876533cdab041a4
from: CH-17
to: CH-18
relation: extends
digest: f92126003e3e98a859deda11d15cfeb2f1b62c9e0ef0689b77f41c06205ebbab
symbol_refs: []
semantic_role: content
:::
If CH-17 extends CH-18, understanding CH-17 usually helps understand CH-18.
:::

::: inference
id: INFER-60ed9008016025d7
from: CH-05
to: CH-17
relation: used_by
digest: 4591725f9e3737dc64339419a3ef6e5a04bc651393160ffaec2899f35e9ab837
symbol_refs: []
semantic_role: content
:::
If CH-05 used_by CH-17, understanding CH-05 usually helps understand CH-17.
:::

::: inference
id: INFER-ae73acbeb349173a
from: CH-17
to: CH-18
relation: used_by
digest: ac574ff30e6a759d5c22a53d01a99110194363c2da45acc422feb33239139045
symbol_refs: []
semantic_role: content
:::
If CH-17 used_by CH-18, understanding CH-17 usually helps understand CH-18.
:::

::: inference
id: INFER-3d488dd4800b1840
from: CH-17
to: CH-18
relation: part_of
digest: dcc11874dded0d978f478f86f4825a8bbf375448c4cfaec15e18dfa1e1349c3a
symbol_refs: []
semantic_role: content
:::
If CH-17 part_of CH-18, understanding CH-17 usually helps understand CH-18.
:::

::: inference
id: INFER-d210a7c7b095c924
from: important
to: CH-19
relation: requires
digest: 2c31b40229fe709137730cc07245372ff601514fbec6b7e064a9bc7c05325145
symbol_refs: []
semantic_role: content
:::
If important requires CH-19, understanding important usually helps understand CH-19.
:::

::: inference
id: INFER-4b4d89fcdd207f3a
from: important
to: CH-19
relation: used_by
digest: 1704bf7d9d95d914dbc9355915cc90f1540811166e66909997c6524e2b787bbf
symbol_refs: []
semantic_role: content
:::
If important used_by CH-19, understanding important usually helps understand CH-19.
:::

::: inference
id: INFER-772b833bf08a37d3
from: rationale
to: maintainability
relation: used_by
digest: f0c2b275792eb735b313c9a62ef2c6061c622de9ec84c8a91895a7710d3a159c
symbol_refs: []
semantic_role: content
:::
If rationale used_by maintainability, understanding rationale usually helps understand maintainability.
:::

::: inference
id: INFER-572b18d67d944eca
from: CH-02
to: CH-01
relation: extends
digest: 9c10943c27787d3040a6d07da053da4b1ac431d3f3a6e388d9dd9c64fd287b39
symbol_refs: []
semantic_role: content
:::
If CH-02 extends CH-01, understanding CH-02 usually helps understand CH-01.
:::

::: inference
id: INFER-cd5be72ea795c948
from: CH-03
to: CH-02
relation: extends
digest: d893ce81aae1999456834cc98bf54ce78f3c931c6c954a7577840364937bc198
symbol_refs: []
semantic_role: content
:::
If CH-03 extends CH-02, understanding CH-03 usually helps understand CH-02.
:::

::: inference
id: INFER-565c03aadbdcde0f
from: CH-04
to: CH-03
relation: extends
digest: 2fcc40f27028e24397ccdbc1ac90114b75735f367a984189aa4e99af9acf1c15
symbol_refs: []
semantic_role: content
:::
If CH-04 extends CH-03, understanding CH-04 usually helps understand CH-03.
:::

::: inference
id: INFER-690eb2eb3d1e98ff
from: CH-05
to: CH-04
relation: extends
digest: d827e9aff646f7ceb1809ec30a186b8a9ec019c21189fc3e94cdec3c6a3000b2
symbol_refs: []
semantic_role: content
:::
If CH-05 extends CH-04, understanding CH-05 usually helps understand CH-04.
:::

::: pathway
id: PATH-439a2977ba961c83
from: CH-03
to: CH-11
digest: 6e35f6061536f0bb1999a4874d204608f869fc0e82a6aa6afb159cb015276ee2
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-03 to CH-11 via chapter dependency graph.
:::

::: pathway
id: PATH-86aca65ba7691608
from: CH-03
to: CH-02
digest: a45cf063ab8b197cf4d78a78a699791755fa10838573a36368a02ca7c755dc9d
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-03 to CH-02 via chapter dependency graph.
:::

::: pathway
id: PATH-a2ccd3043ec6ad75
from: CH-05
to: CH-14
digest: 2c870ac2257cca0de67cea8e55914cac3277f2b367983a4a87caaeae25c4ba2a
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-14 via chapter dependency graph.
:::

::: pathway
id: PATH-ee2d908e7542712b
from: CH-05
to: CH-10
digest: c1596ad1ef12e80778db53654b786f4b3d1d3b2fec1848f08c349825fde419bb
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-10 via chapter dependency graph.
:::

::: pathway
id: PATH-2d078711e7000693
from: CH-05
to: CH-11
digest: 95ea2db3cd526532532632756337288df7b2313d424fcd55523f51993d0880ba
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-11 via chapter dependency graph.
:::

::: pathway
id: PATH-5b851d6370f9ce06
from: CH-05
to: CH-09
digest: 57f590389ecff69c9b5db736882be7c9af594ff3a680f2564bacdb8734a87cc9
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-09 via chapter dependency graph.
:::

::: pathway
id: PATH-2579e490d27dbbde
from: CH-05
to: CH-15
digest: d677c9df667b2a5337da34e15d7ab2ade31c5b588b0732143e1bbc1ff4e6b801
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-15 via chapter dependency graph.
:::

::: pathway
id: PATH-b2cbba2e28702283
from: CH-05
to: CH-08
digest: fff0cf9fa6f4af9cf98f77f038c00f399e815778ee5789386c57a4d8811a6c03
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-08 via chapter dependency graph.
:::

::: pathway
id: PATH-82f5f70f873fe619
from: CH-05
to: CH-17
digest: 984781943f11bc9f190e698dd8e6482d2cfd4a457673c2c6e31085cae2272e29
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-17 via chapter dependency graph.
:::

::: pathway
id: PATH-df6f187ec15f4e33
from: CH-05
to: CH-04
digest: 13fd4e40d5368b228b0937bafa2ec5bc401a721e3ee4bf58cf0c1fdf569ccb55
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-05 to CH-04 via chapter dependency graph.
:::

::: pathway
id: PATH-4570f8f2393829da
from: CH-17
to: CH-18
digest: 542005aa5dd0b85c1fc61ba4c64615fc6216d97f59abfa2c3cfa76d34f12b269
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-17 to CH-18 via chapter dependency graph.
:::

::: pathway
id: PATH-9130d2f8f96b3757
from: CH-02
to: CH-01
digest: 205b8a43e786429cfc198530e0f05fecc53338e9d51c36ae2d4ca91d1840a731
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-02 to CH-01 via chapter dependency graph.
:::

::: pathway
id: PATH-c4403a8dc6a15998
from: CH-04
to: CH-03
digest: a869319936de268dff6efb4b0d64c25d1e361562018717a26aafba6be4407674
symbol_refs: []
semantic_role: content
:::
Learning pathway from CH-04 to CH-03 via chapter dependency graph.
:::

::: uncertainty
id: UNCERT-8a699aa655d280ed
chapter: 
source_id: 
digest: 88db6534eacce9da6fcb81c10cd196b4635d5d77139f5ae3040a45e49521f841
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: relation
id: REL-6e2862322abea38d
from: CH-03
to: CH-11
type: reference
context: However, performance may differ (covered in Chapter 11).
confidence: 0.9
from_namespace: default
to_namespace: default
digest: 55224ec2bd414b73e5136ddb9e4b4924fe86903643b5a590b5d9008ab4b206a0
symbol_refs: []
semantic_role: connection
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
However, performance may differ (covered in Chapter 11).
:::

::: relation
id: REL-390697990b76b5e6
from: community-tools
to: vscode-opa
type: used_by
confidence: 0.8
evidence: support
context:  Rego linter
- **opa-idea-plugin**: IntelliJ IDEA support
- **vscode-opa**: VS Code extension
- **rego-play
from_namespace: default
to_namespace: default
source_id: community-tools
target_id: vscode-opa
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: eadee756ee14a4347e07c8288f5e062ec083e988572a9006f8459291fa6d4d76
symbol_refs: []
semantic_role: connection
:::
support
:::

::: relation
id: REL-df6ec3df654c57cd
from: modern-syntax-opa-10
to: if
type: used_by
confidence: 0.8
evidence: enables
context: **Modern Syntax (OPA 1.0+)**:
- `import rego.v1` enables modern keywords by default
- Keywords: `if`, `in`
from_namespace: default
to_namespace: default
source_id: modern-syntax-opa-10
target_id: if
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: ec20db07069f19aaaf5c8f53d34a8410227f608e69c0713a126ac53988c8db3a
symbol_refs: []
semantic_role: connection
:::
enables
:::

::: relation
id: REL-9114283e1eb99acb
from: CH-05
to: n
type: contradicts
confidence: 0.85
evidence: Unlike
context:  because they preserve actual newline characters. Unlike double-quoted strings where `\n` is a literal two
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: n
relation_type: contradicts
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 5cc7bb8d169d07c25136d33cdf30a5cc6449c15672aaeccdd7d54b274eab1b93
symbol_refs: []
semantic_role: connection
:::
Unlike
:::

::: relation
id: REL-fa6316168f36e7ce
from: CH-05
to: CH-08
type: used_by
confidence: 0.8
evidence: allow
context: hem.
	Look for panics, regressions, or surprising allow/deny.
	Mutation testing:
	Mutate policies (flip c
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-08
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
digest: 527320b0a028ee3dc0fc1f4554e8ceda73a64fb57cba0ab7603e0941d81ff939
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-600347e4207f87b9
from: CH-05
to: CH-09
type: used_by
confidence: 0.8
evidence: allow
context: allow if {
	    input.attributes.request.http.method ==
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-09
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: ed2a47527b9f11e24d266947520bb95cb9488327db46cbec97663bbdc46c984e
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-bf496641905faa53
from: CH-05
to: CH-09
type: implements
confidence: 0.9
evidence: Implement
context: t overlays ‚Äì per customer/tenant customizations.
	Implement via:
	Multiple bundles merged in OPA.
	Data-drive
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-09
relation_type: implements
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution]
digest: 47d1e48d14f90d6a543511280d0c35a19bb569f0f9f1eb27f09118db2606b3f7
symbol_refs: []
semantic_role: connection
:::
Implement
:::

::: relation
id: REL-a7d77ec3b5187723
from: CH-05
to: CH-10
type: used_by
confidence: 0.8
evidence: allow
context: allow if {
	    base_allow
	    not data.tenants[input.
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-10
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: a6df68d3721603720fa12b00b2aeb0e062b85167a5ecb6b1441c4169b6198b46
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-4b0519e7e11a24f7
from: CH-05
to: CH-11
type: used_by
confidence: 0.8
evidence: allow
context: go-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system.
_______________
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-11
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: bc81fb7a02ea9b9ff10af723dbbb86d034771d54af340aaf9f95d3dd56dbc184
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-d729c77a515edb39
from: CH-05
to: CH-14
type: used_by
confidence: 0.8
evidence: allow
context: allow if {
  base_allow
  not tenant_extra_deny[_]
}
Th
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-14
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 10a57db75451431f55af803314a3c5f8391e1e64dd01adf9fddba0f18bbb5e94
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-eceb61aa33ea549f
from: CH-05
to: CH-15
type: requires
confidence: 0.9
evidence: needs
context: ty & Auditability
A compliant audit story usually needs:
‚Ä¢	Given:
o	bundle_revision
o	policy_version
o	in
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-15
relation_type: requires
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution]
digest: 08da9320d90737699cee778cf6f2ca7525eb10d429801b4e1606665361451fcf
symbol_refs: []
semantic_role: connection
:::
needs
:::

::: relation
id: REL-d63e4df942687fa6
from: CH-05
to: CH-15
type: used_by
confidence: 0.8
evidence: allow
context: # decision doc
decision := {
  "allow": allow,
  "trace_id": trace_id,
}
______________
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-15
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 8e38df65021397865bfacb59002258d7c1423c0afeba5022bd759da918a64e51
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-55229de8ef0b3911
from: CH-17
to: CH-18
type: requires
confidence: 0.9
evidence: require
context: t be visible in logs‚Äù
o	‚ÄúAdmin role modifications require approval‚Äù
2.	LLM drafts:
o	Rego module.
o	Test su
from_namespace: default
to_namespace: default
source_id: CH-17
target_id: CH-18
relation_type: requires
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 9bbacdc9e1f4075dccd5c5683009ff64ee46665b65ce636c0ef75eb47d225b09
symbol_refs: []
semantic_role: connection
:::
require
:::

::: relation
id: REL-b5a39684b8607b02
from: CH-17
to: CH-18
type: extends
confidence: 0.9
evidence: Extends
context:  additional tests (edge cases, negative paths).
o	Extends _test.rego.
4.	Reviewer agent:
o	Summarizes behav
from_namespace: default
to_namespace: default
source_id: CH-17
target_id: CH-18
relation_type: extends
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 9580f658640bd01eaf435f39a00301a33858515c9eea43055f323e7a9dc28cb0
symbol_refs: []
semantic_role: connection
:::
Extends
:::

::: relation
id: REL-b0959e0edc414c52
from: CH-05
to: CH-17
type: used_by
confidence: 0.8
evidence: Allows
context: his pattern:
‚Ä¢	Keeps data access rules central.
‚Ä¢	Allows multiple services to enforce the same logic.
____
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-17
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 770ce18d6da970169cb608a31281d1f1cb80efcf5efdfad4ac79ea68844e98ab
symbol_refs: []
semantic_role: connection
:::
Allows
:::

::: relation
id: REL-8fa19dfee9129fd7
from: CH-17
to: CH-18
type: used_by
confidence: 0.8
evidence: allow
context: ike:
o	‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù
‚Ä¢	LL
from_namespace: default
to_namespace: default
source_id: CH-17
target_id: CH-18
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 0b4034297c277b5c7af8442ce8ff90e5a40f39027afde196f7886a6b42e49310
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-75ef71ffeff4a878
from: CH-17
to: CH-18
type: part_of
confidence: 0.7
evidence: inside
context: eport.
This turns Rego into a ground truth oracle inside an agentic system.
______________________________
from_namespace: default
to_namespace: default
source_id: CH-17
target_id: CH-18
relation_type: part_of
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 5535475de83f6abef8aaf519c0bc225c0b6588b344f696ee2ca64d87d7806bd1
symbol_refs: []
semantic_role: connection
:::
inside
:::

::: relation
id: REL-2e06bcbd06dd8ec2
from: important
to: CH-19
type: requires
confidence: 0.9
evidence: requires
context: n function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` dir
from_namespace: default
to_namespace: default
source_id: important
target_id: CH-19
relation_type: requires
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: a78e9cf175786224fbffa8077b217de8801020ba8ce52da9a440887ea10149b6
symbol_refs: []
semantic_role: connection
:::
requires
:::

::: relation
id: REL-b5754b7a338eab26
from: important
to: CH-19
type: used_by
confidence: 0.8
evidence: allow
context: a, or built-ins.
test_admin_can_read if {
  authz.allow with input as {"user": "alice", "role": "admin"}

from_namespace: default
to_namespace: default
source_id: important
target_id: CH-19
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 5477f260b962794ed7c131ad9f6b759368649d088906ad490ddf09db8dd420e4
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-fded1a44eea7827a
from: rationale
to: maintainability
type: used_by
confidence: 0.8
evidence: allow
context:  define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity.
2. **
from_namespace: default
to_namespace: default
source_id: rationale
target_id: maintainability
relation_type: used_by
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7875a006d153f345467382f96d898b08996e33c0ca6a354d1a42d2e8856b0935
symbol_refs: []
semantic_role: connection
:::
allow
:::

::: relation
id: REL-00e7405f1bdc4465
from: CH-02
to: CH-01
type: extends
confidence: 0.5
evidence: Sequential chapters
context: Introduction to OPA and Rego ‚Üí Language Specification
from_namespace: default
to_namespace: default
source_id: CH-02
target_id: CH-01
relation_type: extends
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 24b74094d67805d9eeef9ae661001c94e724bc63f7663dc20f447dfb2d9699b7
symbol_refs: []
semantic_role: connection
:::
Sequential chapters
:::

::: relation
id: REL-ef34b8e5c7e33ab4
from: CH-03
to: CH-02
type: extends
confidence: 0.5
evidence: Sequential chapters
context: Language Specification ‚Üí Core Concepts and Evaluation Model
from_namespace: default
to_namespace: default
source_id: CH-03
target_id: CH-02
relation_type: extends
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 123e6bf6e014e073e883fa9e21c86f61c0fccec9e02e12bde953e9134f521a45
symbol_refs: []
semantic_role: connection
:::
Sequential chapters
:::

::: relation
id: REL-73448a6975846f61
from: CH-04
to: CH-03
type: extends
confidence: 0.5
evidence: Sequential chapters
context: Core Concepts and Evaluation Model ‚Üí Variables, References, and Operators
from_namespace: default
to_namespace: default
source_id: CH-04
target_id: CH-03
relation_type: extends
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 29b9995f959ae73581a4e69f0c979817fefc83b80355888705e4489729ff3f08
symbol_refs: []
semantic_role: connection
:::
Sequential chapters
:::

::: relation
id: REL-13da5c9b356c97c9
from: CH-05
to: CH-04
type: extends
confidence: 0.5
evidence: Sequential chapters
context: Variables, References, and Operators ‚Üí Control Flow and Iteration
from_namespace: default
to_namespace: default
source_id: CH-05
target_id: CH-04
relation_type: extends
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 30ae8e0a03db7540717bb281c06d7168bb2e9438917445f6067e76b3e778979a
symbol_refs: []
semantic_role: connection
:::
Sequential chapters
:::

::: ssm-meta
id: SSMMETA-33d6c5928b456d51
compiler_version: 3.0.0
ssm_schema_version: 1.0.0
bible_version: 2025-11-26
namespace: default
digest: fcd7bf271256a414d5c79fd9853ecfbab41180ba657b2e386d6133baae290fe5
symbol_refs: []
semantic_role: content
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: part-meta
id: PARTMETA-854e19b238ba209f
part_number: I
title: FOUNDATIONS AND INTRODUCTION
chapters: [CH-01, CH-02]
digest: 89ce80152582592533747e741d5f5d0ca6650a32aba355488e328bf3e59351c0
symbol_refs: []
semantic_role: structure
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: part-meta
id: PARTMETA-9feb5612f45ac783
part_number: II
title: CORE LANGUAGE CONCEPTS
chapters: [CH-03, CH-04, CH-05]
digest: c5102c1e1eb38aac293495537654ce814181b660a0b48310c21f605b358bdd54
symbol_refs: []
semantic_role: structure
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: antipattern
id: antipattern-767-1327
problem: 2
solution: # ‚ùå Invalid reference starts
x := [1, 2, 3][0]
y := {"name": "Alice"}.name

# ‚úÖ Valid: Assign first
arr := [1, 2, 3]
x := arr[0]

obj := {"name": "Alice"}
y := obj.name
rationale: 
severity: low
chapter: CH-04
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 9848c99b89bd05a07d3cc6863f81ab4c1fff1b4f305cf0ce64b62b986500c5b9
symbol_refs: []
semantic_role: reference
:::
2

Solution: # ‚ùå Invalid reference starts
x := [1, 2, 3][0]
y := {"name": "Alice"}.name

# ‚úÖ Valid: Assign first
arr := [1, 2, 3]
x := arr[0]

obj := {"name": "Alice"}
y := obj.name
:::

::: antipattern
id: antipattern-811-1328
problem: # ‚ùå Invalid: literals are values, not reference roots
x := [1, 2, 3][0]
y := {"name": "Alice"}.name
z := {1, 2, 3}[0]
solution: 
rationale: 
severity: low
chapter: CH-04
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: f1cfe9915e1c862ce4be3150d9ab408876e84bda74f4d702c84ff5c2042158eb
symbol_refs: []
semantic_role: reference
:::
# ‚ùå Invalid: literals are values, not reference roots
x := [1, 2, 3][0]
y := {"name": "Alice"}.name
z := {1, 2, 3}[0]
:::

::: antipattern
id: antipattern-1205-1329
problem: **Common Pitfall ‚Äî Existential vs Universal**:
solution: # ‚ùå WRONG: "Is there any element != 'foo'?"
# This is true if ANY element is not "foo"
has_non_foo if {
    items[_] != "foo"  # Existential quantification
}

# ‚úÖ CORRECT: "Is 'foo' not in array?"
foo_not_present if {
    not "foo" in items
}

# ‚úÖ CORRECT: "Are all elements not foo?"
all_non_foo if not any_foo

any_foo if {
    some item in items
    item == "foo"
}
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: abda6aa332f509067a27de370a0ba8901175e6a5e1fa9005c0c3b83e1f8772cf
symbol_refs: []
semantic_role: antipattern
:::
**Common Pitfall ‚Äî Existential vs Universal**:

Solution: # ‚ùå WRONG: "Is there any element != 'foo'?"
# This is true if ANY element is not "foo"
has_non_foo if {
    items[_] != "foo"  # Existential quantification
}

# ‚úÖ CORRECT: "Is 'foo' not in array?"
foo_not_present if {
    not "foo" in items
}

# ‚úÖ CORRECT: "Are all elements not foo?"
all_non_foo if not any_foo

any_foo if {
    some item in items
    item == "foo"
}
:::

::: antipattern
id: antipattern-1487-1330
problem: Pitfall: contains is substring, not set membership (for that use in).
solution: in)
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 8a5e9d1107429193341b7a97246f3f7d892d7879c4d54d6b0f69eb3c4f966fed
symbol_refs: []
semantic_role: antipattern
:::
Pitfall: contains is substring, not set membership (for that use in).

Solution: in)
:::

::: antipattern
id: antipattern-2290-1331
problem: Harness: performs all file I/O and passes JSON into Rego as input or data
solution: capture these
rationale: ing (rule success/failure)
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 16382260403ac33fd41734fc338a284362030da1d187f11110368a3c5c89c060
symbol_refs: []
semantic_role: antipattern
:::
Harness: performs all file I/O and passes JSON into Rego as input or data

Solution: capture these
:::

::: antipattern
id: antipattern-2496-1332
problem: 7.9.1 The Case Sensitivity Trap
solution: # Policy checks for lowercase "temporary"
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")  # Lowercase required
}

# ‚ùå TEST FAILS: Test uses "Temporary" (capital T)
test_example if {
    mock_input := {"diff": "+ // FIXME: Temporary hack"}
    # Policy doesn't match "Temporary" (capital T)
    # Test expects warning but gets none
}

# ‚úÖ TEST PASSES: Test uses "temporary" (lowercase)
test_example if {
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # Policy matches "temporary" correctly
}
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: e4d65b779f3f717941cb593dd66896e8054146c53154aa1d13192f496a7fc83c
symbol_refs: []
semantic_role: warning
:::
7.9.1 The Case Sensitivity Trap

Solution: # Policy checks for lowercase "temporary"
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")  # Lowercase required
}

# ‚ùå TEST FAILS: Test uses "Temporary" (capital T)
test_example if {
    mock_input := {"diff": "+ // FIXME: Temporary hack"}
    # Policy doesn't match "Temporary" (capital T)
    # Test expects warning but gets none
}

# ‚úÖ TEST PASSES: Test uses "temporary" (lowercase)
test_example if {
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # Policy matches "temporary" correctly
}
:::

::: antipattern
id: antipattern-2623-1333
problem: use :latest tag"
	}
	Envoy / API Gateway
	Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP
solution: :latest tag"
	}
	Envoy / API Gateway
	Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [authz]
digest: ef49f05fc00e62623384a7fca7208f7f8c7684e68d7a90c5deb88f2547f29ee2
symbol_refs: []
semantic_role: antipattern
:::
use :latest tag"
	}
	Envoy / API Gateway
	Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP

Solution: :latest tag"
	}
	Envoy / API Gateway
	Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP
:::

::: antipattern
id: antipattern-3422-1334
problem: become a data breach
solution: :
o	Log hashed fields (hash(email))
o	Log ids / foreign keys
o	Redact sensitive values (e
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 65d7f9bc81c0998f4bb26d57f52767171dcb86e7c5f7cff9dfc9676414dbc097
symbol_refs: []
semantic_role: antipattern
:::
become a data breach

Solution: :
o	Log hashed fields (hash(email))
o	Log ids / foreign keys
o	Redact sensitive values (e
:::

::: antipattern
id: antipattern-3802-1335
problem: be visible in logs‚Äù
o	‚ÄúAdmin role modifications require approval‚Äù
2
solution: s_for(user) := {"active"} if {
  not "admin" in user
rationale: 
severity: high
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 762388c2995b36619003608ec003390d1cd05b1d8d5c467c29aadd503bf6b228
symbol_refs: []
semantic_role: antipattern
:::
be visible in logs‚Äù
o	‚ÄúAdmin role modifications require approval‚Äù
2

Solution: s_for(user) := {"active"} if {
  not "admin" in user
:::

::: antipattern
id: antipattern-4677-1336
problem: Pitfall 1: Accidental Variable Shadowing
solution: Inner blocks can rebind a variable name used in an outer block, changing meaning silently.
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: d208eff1f79510420f105643b52f894525de278584e2830520e9342628cdd740
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 1: Accidental Variable Shadowing

Solution: Inner blocks can rebind a variable name used in an outer block, changing meaning silently.
:::

::: antipattern
id: antipattern-4698-1337
problem: Pitfall 2: Unsafe Variables in Rules
solution: A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body.
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 9b82877042ecf242e4d684ec2617d85c7d227f397722e8a5cdbdf12101c83dfa
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 2: Unsafe Variables in Rules

Solution: A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body.
:::

::: antipattern
id: antipattern-4709-1338
problem: # ‚ùå Unsafe: r is not always bound
deny[r] if {
    input.violations[_] == v
    v.level == "HIGH"
    r := v.reason
} else {
    # no binding for r here
}
solution: Use opa check to detect this and refactor to ensure all head variables are always bound:
rationale: } else {
    # no binding for r here
}
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 4e6008fc8bc62d30bce8e77578116f0f84f39aef8d4855131843b4b7eb663224
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Unsafe: r is not always bound
deny[r] if {
    input.violations[_] == v
    v.level == "HIGH"
    r := v.reason
} else {
    # no binding for r here
}

Solution: Use opa check to detect this and refactor to ensure all head variables are always bound:
:::

::: antipattern
id: antipattern-4721-1339
problem: Pitfall 3: Misusing some in Comprehensions
solution: some x introduces a new variable local to the current expression. Using it incorrectly can over-constrain or under-constrain rules.
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 76352b60644c651586cae21c3319a17c7362ca85d154fbeba2d80ca863cd2875
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 3: Misusing some in Comprehensions

Solution: some x introduces a new variable local to the current expression. Using it incorrectly can over-constrain or under-constrain rules.
:::

::: antipattern
id: antipattern-4723-1340
problem: some x introduces a new variable local to the current expression
solution: Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names:
rationale: 
severity: medium
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 2d1cc441df3d97c01d6df13dd3d11b36999a3f4f99fa62cc2a2425f416c1c7a4
symbol_refs: []
semantic_role: antipattern
:::
some x introduces a new variable local to the current expression

Solution: Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names:
:::

::: antipattern
id: antipattern-4731-1341
problem: # ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices
bad if {
    some i
    arr[i] == "a"
    some i
    arr[i] == "b"
}
solution: Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: e682200891ea67421939995d7cc0a4ce407451bf0292bdf3d7d84b41ccbda2b6
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices
bad if {
    some i
    arr[i] == "a"
    some i
    arr[i] == "b"
}

Solution: Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names:
:::

::: antipattern
id: antipattern-4744-1342
problem: Pitfall 4: Assuming Global State in Rules
solution: 
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 9680d0d842d788fb41f80c7ff256fbe63bf36dc348277360f96749443b52feef
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 4: Assuming Global State in Rules
:::

::: antipattern
id: antipattern-4749-1343
problem: # ‚ùå Misleading mental model: this does not "increment" anything
counter := counter + 1 if { ..
solution: Instead, build sets or arrays with comprehensions, then aggregate:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 4e22195c8491845afa7ce95d6be465fc3c71d7d7c9b18854b81864283d332176
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Misleading mental model: this does not "increment" anything
counter := counter + 1 if { ..

Solution: Instead, build sets or arrays with comprehensions, then aggregate:
:::

::: antipattern
id: antipattern-4767-1344
problem: Pitfall 1: Accessing Missing Fields Directly
solution: # ‚ùå Panics if input.user is null or missing
email := input.user.email
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: e38eb33ba0c41f41c377c60dd19a47bb0b341b3d52fa2fd46234af4745199593
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 1: Accessing Missing Fields Directly

Solution: # ‚ùå Panics if input.user is null or missing
email := input.user.email
:::

::: antipattern
id: antipattern-4769-1345
problem: # ‚ùå Panics if input.user is null or missing
email := input.user.email
solution: r is null or missing
email := input
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7c31c28b586ec337979477d89ae6ed04d03a911980cdc3b942d100359072a101
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Panics if input.user is null or missing
email := input.user.email

Solution: r is null or missing
email := input
:::

::: antipattern
id: antipattern-4794-1346
problem: Pitfall 2: Null vs Missing vs Falsy
solution: Missing: input.user.email ‚Üí error if user missing or not object.
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 1299a2ba6ce2eda329423d8a4a30f32771a2aebe3ada2984e937bb50abeb489c
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 2: Null vs Missing vs Falsy

Solution: Missing: input.user.email ‚Üí error if user missing or not object.
:::

::: antipattern
id: antipattern-4811-1347
problem: Pitfall 3: Using array.concat on Non-Arrays
solution: Wrap in a safe helper or use guards:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 66eb79797aa51202e2cd7ce6162086b253c602669e1a96eb33677a94d21f16a6
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 3: Using array.concat on Non-Arrays

Solution: Wrap in a safe helper or use guards:
:::

::: antipattern
id: antipattern-4813-1348
problem: # ‚ùå Panics if path is null or not an array
full := concat(".", array.concat(path, [field]))
solution: Wrap in a safe helper or use guards:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 51e3fc5747c5586579200a007008a63b8fdb5158acf590ca6ae14121627ab86d
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Panics if path is null or not an array
full := concat(".", array.concat(path, [field]))

Solution: Wrap in a safe helper or use guards:
:::

::: antipattern
id: antipattern-4831-1349
problem: Pitfall 4: Equality Checks with Mixed Types
solution: # ‚ùå May silently fail if left/right have different types
allowed if input.user.id == data.allowed_ids[_]
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 76fe33e0cad6b480a14909cb497bdbd7a5fbf847ba1978f04bf7222e769c1c35
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 4: Equality Checks with Mixed Types

Solution: # ‚ùå May silently fail if left/right have different types
allowed if input.user.id == data.allowed_ids[_]
:::

::: antipattern
id: antipattern-4833-1350
problem: # ‚ùå May silently fail if left/right have different types
allowed if input.user.id == data.allowed_ids[_]
solution: r
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c3eedfcfa2a98b1d79fcef845c9149b09aa6800c0be565c0740956e5b124f8da
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå May silently fail if left/right have different types
allowed if input.user.id == data.allowed_ids[_]

Solution: r
:::

::: antipattern
id: antipattern-4843-1351
problem: Pitfall 5: Assuming in Works Like SQL for All Types
solution: 
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: fb52bfa97b9dc4db098e4ff48d8c1e440d4c9ce8e4194a578f5b3f3e0025997e
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 5: Assuming in Works Like SQL for All Types
:::

::: antipattern
id: antipattern-4866-1352
problem: Pitfall 1: Unbounded Linear Scans on Huge Collections
solution: Better approaches:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 8fc901f21ed6e24c53d99353768e697f1d95974f2d1db72c7215c615353cf6e2
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 1: Unbounded Linear Scans on Huge Collections

Solution: Better approaches:
:::

::: antipattern
id: antipattern-4871-1353
problem: # ‚ùå Potentially O(N) scan on large data set every request
deny if {
    some i
    data.events[i].ip == input.client_ip
}
solution: Better approaches:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7f778fb62751148d85b21ac5de5236a834b588f34bb7d3ebd16b1b47ba5a79b2
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Potentially O(N) scan on large data set every request
deny if {
    some i
    data.events[i].ip == input.client_ip
}

Solution: Better approaches:
:::

::: antipattern
id: antipattern-4886-1354
problem: Pitfall 2: Heavy Regex in Hot Paths
solution: # ‚ùå Expensive regex on every request
deny if re_match(".*(admin|root).*", input.user.name)
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 16be449800efeaedd93df55c75cf69adca25bc46cc124ec6cf784dc1fa2a4263
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 2: Heavy Regex in Hot Paths

Solution: # ‚ùå Expensive regex on every request
deny if re_match(".*(admin|root).*", input.user.name)
:::

::: antipattern
id: antipattern-4888-1355
problem: # ‚ùå Expensive regex on every request
deny if re_match(".*(admin|root).*", input.user.name)
solution: r
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 61c4131a356364f91ccb18c7c8c11329fa833e16787dd88f181e874b0677d903
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Expensive regex on every request
deny if re_match(".*(admin|root).*", input.user.name)

Solution: r
:::

::: antipattern
id: antipattern-4899-1356
problem: Pitfall 3: Recomputing the Same Expression Repeatedly
solution: # ‚ùå Recomputes parse for each use
deny if {
    re_match("admin", input.user.name)
    some p in data.profiles
    re_match("admin", input.user.name)  # repeated
}
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 0e74ea335757f3ae37ee9bbea1ca3b6723be4104a875ebe3753356c3979681d8
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 3: Recomputing the Same Expression Repeatedly

Solution: # ‚ùå Recomputes parse for each use
deny if {
    re_match("admin", input.user.name)
    some p in data.profiles
    re_match("admin", input.user.name)  # repeated
}
:::

::: antipattern
id: antipattern-4905-1357
problem: # ‚ùå Recomputes parse for each use
deny if {
    re_match("admin", input.user.name)
    some p in data.profiles
    re_match("admin", input.user.name)  # repeated
}
solution: deny if {
    re_match("admin", input
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: b805db5f653bb91d61414948ab1ebf53db1f6662c2aec3fe6169b2268a2b1664
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå Recomputes parse for each use
deny if {
    re_match("admin", input.user.name)
    some p in data.profiles
    re_match("admin", input.user.name)  # repeated
}

Solution: deny if {
    re_match("admin", input
:::

::: antipattern
id: antipattern-4920-1358
problem: Pitfall 4: Ignoring Partial Evaluation Opportunities
solution: 
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [performance]
digest: fa5c3a147ab2b8d8158f1ab638b86e126b290ddc268646478507df998fb71161
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 4: Ignoring Partial Evaluation Opportunities
:::

::: antipattern
id: antipattern-4925-1359
problem: # ‚ùå CLI call with huge static config in input
opa eval -d policies/ -i big_config.json 'data.authz.allow'
solution: If most config is static, bake it into data and use partial evaluation:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [performance]
digest: 546b8684cdc7d8fc0a7ee9c890064f3b74c3e3d3c1dca126851b803dd5c7bee2
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå CLI call with huge static config in input
opa eval -d policies/ -i big_config.json 'data.authz.allow'

Solution: If most config is static, bake it into data and use partial evaluation:
:::

::: antipattern
id: antipattern-4936-1360
problem: Pitfall 5: Overusing walk on Large Trees
solution: walk is powerful but traverses entire trees. Instead:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 3a0101f3e2fd82a20d6377c9257f9240f32f434dda4a97740acfa0fb262f8099
symbol_refs: []
semantic_role: antipattern
:::
Pitfall 5: Overusing walk on Large Trees

Solution: walk is powerful but traverses entire trees. Instead:
:::

::: antipattern
id: antipattern-4942-1361
problem: # ‚ùå walk(data) over a huge universe
deny if {
    some path, value
    walk(data, [path, value])
    value == "secret"
}
solution: walk is powerful but traverses entire trees. Instead:
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 234989e2dcfbc501f21e426198fcd6306cc272c4289df7d776e96a7cb78dbc70
symbol_refs: []
semantic_role: antipattern
:::
# ‚ùå walk(data) over a huge universe
deny if {
    some path, value
    walk(data, [path, value])
    value == "secret"
}

Solution: walk is powerful but traverses entire trees. Instead:
:::

::: antipattern
id: antipattern-5106-1362
problem: if [ -n "$unused" ]; then
  echo "‚ùå Unused imports detected:"
  echo "$unused"
  exit 1
fi
solution: d" ]; then
  echo "‚ùå Unused imports detected:"
  echo "$unused"
  exit 1
fi
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 0dba214bdf40c31c02c114372e8088f0f4ff2de8246eb9ff013c69fb47be3a46
symbol_refs: []
semantic_role: antipattern
:::
if [ -n "$unused" ]; then
  echo "‚ùå Unused imports detected:"
  echo "$unused"
  exit 1
fi

Solution: d" ]; then
  echo "‚ùå Unused imports detected:"
  echo "$unused"
  exit 1
fi
:::

::: antipattern
id: antipattern-5126-1363
problem: üß© Summary ‚Äî Best Way to Handle Rego Unused Imports
Method	Effectiveness	Recommended
opa fmt	‚ùå Does not remove unused imports	Useful, but not enough
opa check --strict	üî∂ Detects unused variables, not imports	Use always
rgl (Rego Lint)	‚úÖ Detects unused imports	Best open-source option
Styra DAS	üî• Enterprise-grade policy analyzer	Best paid option
CI + opa inspect + jq	üî• Fully reliable in CI	Recommended
Cursor/VSCode rules	üî∂ Helps devs during coding	Recommended
solution: d Imports
Method	Effectiveness	Recommended
opa fmt	‚ùå Does not remove unused imports	Useful, but not enough
opa check --strict	üî∂ Detects unused variables, not imports	Use always
rgl (Rego Lint)	‚úÖ Detects unused imports	Best open-source option
Styra DAS	üî• Enterprise-grade policy analyzer	Best paid option
CI + opa inspect + jq	üî• Fully reliable in CI	Recommended
Cursor/VSCode rules	üî∂ Helps devs during coding	Recommended
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 173d47c86810b534adedbbe740a73836894b829e5194555facb1c030cfa894c5
symbol_refs: []
semantic_role: antipattern
:::
üß© Summary ‚Äî Best Way to Handle Rego Unused Imports
Method	Effectiveness	Recommended
opa fmt	‚ùå Does not remove unused imports	Useful, but not enough
opa check --strict	üî∂ Detects unused variables, not imports	Use always
rgl (Rego Lint)	‚úÖ Detects unused imports	Best open-source option
Styra DAS	üî• Enterprise-grade policy analyzer	Best paid option
CI + opa inspect + jq	üî• Fully reliable in CI	Recommended
Cursor/VSCode rules	üî∂ Helps devs during coding	Recommended

Solution: d Imports
Method	Effectiveness	Recommended
opa fmt	‚ùå Does not remove unused imports	Useful, but not enough
opa check --strict	üî∂ Detects unused variables, not imports	Use always
rgl (Rego Lint)	‚úÖ Detects unused imports	Best open-source option
Styra DAS	üî• Enterprise-grade policy analyzer	Best paid option
CI + opa inspect + jq	üî• Fully reliable in CI	Recommended
Cursor/VSCode rules	üî∂ Helps devs during coding	Recommended
:::

::: antipattern
id: antipattern-5235-1364
problem: ‚ùå Bad
solution: ‚úîÔ∏è Correct
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: e72e5030e363240c425f4b8fc7e44f2589028280309c8cc8557590fd8826940f
symbol_refs: []
semantic_role: antipattern
:::
‚ùå Bad

Solution: ‚úîÔ∏è Correct
:::

::: antipattern
id: antipattern-5317-1365
problem: üß† The Better Fix (What I Would Do)
‚ùå Instead of removing the import
‚úîÔ∏è Fix the test to use the import explicitly
import data.compliance.tech_debt
solution: of removing the import
‚úîÔ∏è Fix the test to use the import explicitly
import data
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: e3fef71147465e54d3ae90e69f6cbabac93aaabd8cf686e5a43387a48a60e2d1
symbol_refs: []
semantic_role: antipattern
:::
üß† The Better Fix (What I Would Do)
‚ùå Instead of removing the import
‚úîÔ∏è Fix the test to use the import explicitly
import data.compliance.tech_debt

Solution: of removing the import
‚úîÔ∏è Fix the test to use the import explicitly
import data
:::

::: antipattern
id: antipattern-5364-1366
problem: **Anti-Pattern:**
solution: üõ†Ô∏è Recommended Final Fix for your file
Instead of removing the unused import:
Fix the test to reference it:
package compliance.tech_debt_r14_test
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c21e2f74e3ff69c4800554add96c1c1e9548c2cc763a975ae4359d1631968c19
symbol_refs: []
semantic_role: reference
:::
**Anti-Pattern:**

Solution: üõ†Ô∏è Recommended Final Fix for your file
Instead of removing the unused import:
Fix the test to reference it:
package compliance.tech_debt_r14_test
:::

::: antipattern
id: antipattern-5394-1367
problem: ‚ùå But in Rego test files, a string such as:
"diff": "+ // TODO:\n+ function getUsers() {"
solution: rs() {"
rationale: 
severity: low
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7200e46d40277ab2bcb96c3b24f46efd37c95d729d5089a9cb4bda13637b6bd3
symbol_refs: []
semantic_role: antipattern
:::
‚ùå But in Rego test files, a string such as:
"diff": "+ // TODO:\n+ function getUsers() {"

Solution: rs() {"
:::

::: rationale
id: rationale-12-1368
explanation: This Book Exists
related_to: 
chapter: 
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: cd8e853e1889c1b53cae0d5a0d0b56deccbac16614308c888b2bf39b66d3f881
symbol_refs: []
semantic_role: rationale
:::
This Book Exists
:::

::: rationale
id: rationale-44-1369
explanation: Traditional approaches fail because:
related_to: Microservices Architecture
chapter: CH-01
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: f686f921870c2d9f14b9759a2e90cdfbd3cf4bae2683bede5fc9da0ba4102d6c
symbol_refs: []
semantic_role: rationale
:::
Traditional approaches fail because:
:::

::: rationale
id: rationale-68-1370
explanation: OPA (Open Policy Agent) is a **general-purpose policy decision engine** that:
related_to: 
chapter: CH-01
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 884d2aac56cb49a6e8c48d28b2c550bed4ab6509c191a7068a181ffb7be0347d
symbol_refs: [general-purpose policy decision engine]
semantic_role: rationale
:::
OPA (Open Policy Agent) is a **general-purpose policy decision engine** that:
:::

::: rationale
id: rationale-375-1371
explanation: When you should use opa fmt
1. Every time you write or modify Rego
Just like go fmt or black for Python:
‚Ä¢	run opa fmt -w before committing
‚Ä¢	ensures consistent indentation, spacing, rule structure
Use it when:
‚Ä¢	adding new policies
‚Ä¢	editing existing rules
‚Ä¢	refactoring code
‚Ä¢	reviewing a pull request
________________________________________
2. Automatically in CI
Use it in CI to prevent unformatted code from merging.
Why?
‚Ä¢	Prevents style drift
‚Ä¢	Prevents person-to-person formatting debates
‚Ä¢	Keeps code reviews focused on logic, not style
CI check:
opa fmt --diff .
Use it when you want CI to enforce a formatting contract.
________________________________________
3. Before generating OPA bundles or deploying
Formatting helps avoid:
‚Ä¢	unnecessary diff churn
‚Ä¢	unreadable bundle changes
‚Ä¢	merge conflicts caused by spacing differences
Use it when preparing a release or bundle.
________________________________________
4. When onboarding new developers
New devs often write inconsistent Rego.
opa fmt makes their code instantly match the organization‚Äôs style without a learning curve.
Use it during:
‚Ä¢	onboarding
‚Ä¢	training
‚Ä¢	AI code generation reviews
________________________________________
5. After using AI tools (Cursor, ChatGPT, GitHub Copilot, etc.)
AI-generated Rego is usually:
‚Ä¢	valid
‚Ä¢	but not formatted to OPA conventions
You should run opa fmt immediately after AI/model generation.
This is especially true if:
‚Ä¢	you use Prompt Engineering to generate complex Rego
‚Ä¢	Cursor writes policy libraries
‚Ä¢	models generate example data
________________________________________
6. When converting JSON/YAML schemas into Rego
If you auto-generate code (e.g., from OPA schemas), format it afterward so it becomes readable.
________________________________________
7. Anytime code readability matters
Examples:
‚Ä¢	cross-team policy review
‚Ä¢	audits
‚Ä¢	security reviews
‚Ä¢	discussions with legal/compliance teams
‚Ä¢	contract policy negotiations
Formatted policies reduce friction with stakeholders.
________________________________________
üö´ When NOT to use it (rare cases)
1. When investigating a bug caused by whitespace or formatting
Almost never happens in Rego, but if you're comparing raw text output or diffing a policy artifact to reproduce an issue, you might avoid opa fmt temporarily.
2. If formatting breaks a handcrafted test snapshot
If you have an exact string match test involving policy source code, formatting will change the file.
But this is extremely rare in real OPA projects.
related_to: 
chapter: CH-02
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution]
digest: 81a5527dbf49f91f36fa3565902d580d9bf0e70e6a5c7a3fb86e259233a69181
symbol_refs: []
semantic_role: rationale
:::
When you should use opa fmt
1. Every time you write or modify Rego
Just like go fmt or black for Python:
‚Ä¢	run opa fmt -w before committing
‚Ä¢	ensures consistent indentation, spacing, rule structure
Use it when:
‚Ä¢	adding new policies
‚Ä¢	editing existing rules
‚Ä¢	refactoring code
‚Ä¢	reviewing a pull request
________________________________________
2. Automatically in CI
Use it in CI to prevent unformatted code from merging.
Why?
‚Ä¢	Prevents style drift
‚Ä¢	Prevents person-to-person formatting debates
‚Ä¢	Keeps code reviews focused on logic, not style
CI check:
opa fmt --diff .
Use it when you want CI to enforce a formatting contract.
________________________________________
3. Before generating OPA bundles or deploying
Formatting helps avoid:
‚Ä¢	unnecessary diff churn
‚Ä¢	unreadable bundle changes
‚Ä¢	merge conflicts caused by spacing differences
Use it when preparing a release or bundle.
________________________________________
4. When onboarding new developers
New devs often write inconsistent Rego.
opa fmt makes their code instantly match the organization‚Äôs style without a learning curve.
Use it during:
‚Ä¢	onboarding
‚Ä¢	training
‚Ä¢	AI code generation reviews
________________________________________
5. After using AI tools (Cursor, ChatGPT, GitHub Copilot, etc.)
AI-generated Rego is usually:
‚Ä¢	valid
‚Ä¢	but not formatted to OPA conventions
You should run opa fmt immediately after AI/model generation.
This is especially true if:
‚Ä¢	you use Prompt Engineering to generate complex Rego
‚Ä¢	Cursor writes policy libraries
‚Ä¢	models generate example data
________________________________________
6. When converting JSON/YAML schemas into Rego
If you auto-generate code (e.g., from OPA schemas), format it afterward so it becomes readable.
________________________________________
7. Anytime code readability matters
Examples:
‚Ä¢	cross-team policy review
‚Ä¢	audits
‚Ä¢	security reviews
‚Ä¢	discussions with legal/compliance teams
‚Ä¢	contract policy negotiations
Formatted policies reduce friction with stakeholders.
________________________________________
üö´ When NOT to use it (rare cases)
1. When investigating a bug caused by whitespace or formatting
Almost never happens in Rego, but if you're comparing raw text output or diffing a policy artifact to reproduce an issue, you might avoid opa fmt temporarily.
2. If formatting breaks a handcrafted test snapshot
If you have an exact string match test involving policy source code, formatting will change the file.
But this is extremely rare in real OPA projects.
:::

::: rationale
id: rationale-581-1372
explanation: It Matters**:
related_to: 
chapter: CH-03
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c30cfa96f3ef5d7bdff7f780eb8c33ad11008e21b01f53cf7d03183661b6725d
symbol_refs: []
semantic_role: rationale
:::
It Matters**:
:::

::: rationale
id: rationale-976-1373
explanation: **Dual Purpose**: Membership testing AND iteration
related_to: 
chapter: CH-04
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
digest: 39552790a4a23ecfc2cfbe5d582e83b66e6fa9b356f94ac6c3716cd5fd9180de
symbol_refs: [Dual Purpose]
semantic_role: rationale
:::
**Dual Purpose**: Membership testing AND iteration
:::

::: rationale
id: rationale-1278-1374
explanation: Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR).
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 549e0b36e2d6d184b0e88176a6787f99f6113ab9a5b3fe5fc145d9b1843fb985
symbol_refs: []
semantic_role: rationale
:::
Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR).
:::

::: rationale
id: rationale-1515-1375
explanation: they preserve actual newline characters
related_to: Exception: Multi-Line Test Data
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: ddff6efbfe29532d67e329016d26ed9a9420c28afc2561d1e4ac96d0ca18f8ad
symbol_refs: []
semantic_role: rationale
:::
they preserve actual newline characters
:::

::: rationale
id: rationale-2290-1376
explanation: Harness: performs all file I/O and passes JSON into Rego as input or data.
________________________________________
7.4 Debugging with print and opa eval
print is your printf.
	Signature: print(x1, x2, ...)
	Always returns true, so you can drop it directly inside rule bodies.
debug_threshold if {
    t := input.threshold
    print("Threshold is:", t)
    t > 10
}
Where output appears
	opa eval ‚Üí printed to stderr / logs.
	Embedded OPA ‚Üí appears in OPA logs; your host system should capture these.
Key points
	print doesn‚Äôt alter semantics (just like adding true).
	Good for:
	Inspecting variable bindings.
	Confirming which rule body is being hit.
	Bad for:
	Production policies with PII.
	Flooding logs; use sparingly or behind a debug flag.
________________________________________
7.5 opa eval Explain & Profile Modes
opa eval is both a REPL and microscope.
Explain modes
opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow'
opa eval --explain=full  ...
	notes = high-level reasoning (rule success/failure).
	full = full derivation tree; great for debugging, painful for huge queries.
Profile mode
opa eval --profile -d . -i input.json 'data.compliance'
You get:
	Per-rule evaluation counts and cumulative time.
	A ranking of ‚Äúhot‚Äù rules (the ones to optimize or refactor).
Typical workflow
	Problem: ‚ÄúPolicy is slow for large PRs / big cluster.‚Äù
	Run: opa eval --profile ...
	Identify rules with:
	Many evaluations (thousands or millions).
	High total time.
	Refactor:
	Use sets/objects instead of scanning arrays.
	Add guard conditions (cheap predicates before expensive ones).
	Use partial evaluation (¬ß11).
________________________________________
7.6 Common Errors and How to Diagnose Them
	rego_unsafe_var_error ‚Äì unsafe variables
	# ‚ùå Unsafe: user appears only under negation
	deny if {
	    not blacklisted[user]
	}
Fix: Bind user outside negation.
deny if {
    user := input.user
    not blacklisted[user]
}
	rego_type_error ‚Äì type mismatch
	Example: using to_number on an object, or sum over [1, "two"].
	Fix:
	Guard with is_* built-ins (is_number(x), is_array(x)).
	Normalize incoming data.
	Rule conflict errors
	Multiple complete rules with same name produce different values for same input.
	f(1) := 2
	f(1) := 3  # conflict
	For sets/partial objects this is okay (results are merged); for complete rules & functions it‚Äôs an error.
	Infinite or pathological recursion
	Patterns that refer back to themselves without a base case.
	OPA has guardrails, but logic errors can still create huge evaluation trees.
Mitigate with:
	Explicit depth counters.
	Clear base rules.
________________________________________
7.7 String Literal Handling in Tests: JSON vs Rego String Semantics
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation, performance]
digest: feeacac3b561ceae5195c7567fad2fe15f01a9e041e9ef454ff12dfd5136a343
symbol_refs: []
semantic_role: rationale
:::
Harness: performs all file I/O and passes JSON into Rego as input or data.
________________________________________
7.4 Debugging with print and opa eval
print is your printf.
	Signature: print(x1, x2, ...)
	Always returns true, so you can drop it directly inside rule bodies.
debug_threshold if {
    t := input.threshold
    print("Threshold is:", t)
    t > 10
}
Where output appears
	opa eval ‚Üí printed to stderr / logs.
	Embedded OPA ‚Üí appears in OPA logs; your host system should capture these.
Key points
	print doesn‚Äôt alter semantics (just like adding true).
	Good for:
	Inspecting variable bindings.
	Confirming which rule body is being hit.
	Bad for:
	Production policies with PII.
	Flooding logs; use sparingly or behind a debug flag.
________________________________________
7.5 opa eval Explain & Profile Modes
opa eval is both a REPL and microscope.
Explain modes
opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow'
opa eval --explain=full  ...
	notes = high-level reasoning (rule success/failure).
	full = full derivation tree; great for debugging, painful for huge queries.
Profile mode
opa eval --profile -d . -i input.json 'data.compliance'
You get:
	Per-rule evaluation counts and cumulative time.
	A ranking of ‚Äúhot‚Äù rules (the ones to optimize or refactor).
Typical workflow
	Problem: ‚ÄúPolicy is slow for large PRs / big cluster.‚Äù
	Run: opa eval --profile ...
	Identify rules with:
	Many evaluations (thousands or millions).
	High total time.
	Refactor:
	Use sets/objects instead of scanning arrays.
	Add guard conditions (cheap predicates before expensive ones).
	Use partial evaluation (¬ß11).
________________________________________
7.6 Common Errors and How to Diagnose Them
	rego_unsafe_var_error ‚Äì unsafe variables
	# ‚ùå Unsafe: user appears only under negation
	deny if {
	    not blacklisted[user]
	}
Fix: Bind user outside negation.
deny if {
    user := input.user
    not blacklisted[user]
}
	rego_type_error ‚Äì type mismatch
	Example: using to_number on an object, or sum over [1, "two"].
	Fix:
	Guard with is_* built-ins (is_number(x), is_array(x)).
	Normalize incoming data.
	Rule conflict errors
	Multiple complete rules with same name produce different values for same input.
	f(1) := 2
	f(1) := 3  # conflict
	For sets/partial objects this is okay (results are merged); for complete rules & functions it‚Äôs an error.
	Infinite or pathological recursion
	Patterns that refer back to themselves without a base case.
	OPA has guardrails, but logic errors can still create huge evaluation trees.
Mitigate with:
	Explicit depth counters.
	Clear base rules.
________________________________________
7.7 String Literal Handling in Tests: JSON vs Rego String Semantics
:::

::: rationale
id: rationale-2411-1377
explanation: Variable Binding is Preferred:**
- Explicit evaluation context: `with input as mock_input` applies to the rule evaluation, not the `count()` call
- Clearer semantics: The rule is evaluated with mocked input, then the result is counted
- More reliable: Avoids potential evaluation order issues in complex test expressions
- Better debugging: Can inspect `warnings` set before counting
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 73a442f09fe67d6c5a3b7b158f807fbea36379fbd9b1b6bcf023db7795f78088
symbol_refs: [with input as mock_input, warnings, count()]
semantic_role: warning
:::
Variable Binding is Preferred:**
- Explicit evaluation context: `with input as mock_input` applies to the rule evaluation, not the `count()` call
- Clearer semantics: The rule is evaluated with mocked input, then the result is counted
- More reliable: Avoids potential evaluation order issues in complex test expressions
- Better debugging: Can inspect `warnings` set before counting
:::

::: rationale
id: rationale-2997-1378
explanation: about correctness, or write academic work
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 51cb83b59ed8d6ba16dfa2a67f20bb477e4fcc1b9800f69ee52009ea28e752cb
symbol_refs: []
semantic_role: rationale
:::
about correctness, or write academic work
:::

::: rationale
id: rationale-3032-1379
explanation: Because:
	Herbrand base is finite for a given finite data and bounded terms.
	T_Pis monotonic for stratified, positive fragments.
‚Üí Fixpoint is reached in finite steps.
________________________________________
12.3 Unification & =, :=, ==
	Unification (=): find a most general unifier (MGU) that makes two terms equal.
	If both sides partially unbound, unify them structurally.
Example:
[x, "world"] = ["hello", y]
	MGU: {x‚Ü¶"hello",y‚Ü¶"world"}.
	Assignment (:=): one-way binding; fails if variable is already bound to a different value.
	Equality (==): no variable binding; pure comparison.
In implementation, OPA uses a mixture of:
	Unification-like semantics to explore bindings.
	Assignments and comparisons for clarity and performance in v1 syntax.
________________________________________
12.4 Negation-as-Failure & Stratification
Rego uses NAF (Negation-as-Failure):
not p(X)
means: ‚Äúit is not provable that p(X) holds‚Äù.
Formally:
"Eval"(P)‚ä®"not " p(t)" ‚Ää"‚ü∫" ‚ÄäEval"(P)‚ä®Ã∏p(t)
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation, theory, unification]
digest: bbb5233a99caf52e0831a1cc1a1b1a7dcb5b0cda79d7bd3bac8376281ee9ff39
symbol_refs: []
semantic_role: rationale
:::
Because:
	Herbrand base is finite for a given finite data and bounded terms.
	T_Pis monotonic for stratified, positive fragments.
‚Üí Fixpoint is reached in finite steps.
________________________________________
12.3 Unification & =, :=, ==
	Unification (=): find a most general unifier (MGU) that makes two terms equal.
	If both sides partially unbound, unify them structurally.
Example:
[x, "world"] = ["hello", y]
	MGU: {x‚Ü¶"hello",y‚Ü¶"world"}.
	Assignment (:=): one-way binding; fails if variable is already bound to a different value.
	Equality (==): no variable binding; pure comparison.
In implementation, OPA uses a mixture of:
	Unification-like semantics to explore bindings.
	Assignments and comparisons for clarity and performance in v1 syntax.
________________________________________
12.4 Negation-as-Failure & Stratification
Rego uses NAF (Negation-as-Failure):
not p(X)
means: ‚Äúit is not provable that p(X) holds‚Äù.
Formally:
"Eval"(P)‚ä®"not " p(t)" ‚Ää"‚ü∫" ‚ÄäEval"(P)‚ä®Ã∏p(t)
:::

::: rationale
id: rationale-3051-1380
explanation: variables in negated expressions must be grounded elsewhere; otherwise, the semantics become ill-defined
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7ec4a0e8b3234def16dabcb701f892360fddeec3c72f46825181f2c61df44d71
symbol_refs: []
semantic_role: rationale
:::
variables in negated expressions must be grounded elsewhere; otherwise, the semantics become ill-defined
:::

::: rationale
id: rationale-3564-1381
explanation: Rego is JSON-native
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: fe51e3294afd568026e6b32f7081916f1a70f9a8ba1aeb8ff62ba7aced06e402
symbol_refs: []
semantic_role: rationale
:::
Rego is JSON-native
:::

::: rationale
id: rationale-3959-1382
explanation: **Important:** `set()` is a type conversion function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` directly. Using `set()` without arguments will cause a runtime error.
________________________________________
18.4 Iteration
Implicit:
arr[_]               # all values
obj[k]               # binds k to each key
set[v]               # binds v to each member
Explicit with some ... in:
some x in arr        # values
some i, x in arr     # index, value
some k, v in obj     # key, value
some v in set        # members
________________________________________
18.5 Quantifiers
‚Ä¢	Existential: some x in xs { ... }
‚Ä¢	Universal:
o	Using every:
o	all_valid if {
o	  every x in xs {
o	    x.valid == true
o	  }
o	}
o	Or via negation:
o	all_valid if not any_invalid
o	any_invalid if {
o	  some x in xs
o	  not x.valid
o	}
________________________________________
18.6 Negation
not cond = ‚Äúcannot prove cond.‚Äù
Safety: variables in cond must be bound beforehand.
deny if {
  user := input.user
  not blacklisted[user]
}
________________________________________
18.7 Built-in Highlights
‚Ä¢	Aggregates: count, sum, max, min
‚Ä¢	Strings: concat, contains, startswith, endswith, split, replace
‚Ä¢	Regex: regex.match, regex.split
‚Ä¢	JSON: json.marshal, json.unmarshal
‚Ä¢	Time: time.now_ns, time.parse_rfc3339_ns, time.clock
‚Ä¢	Crypto: crypto.sha256, io.jwt.*
________________________________________
18.8 Testing
‚Ä¢	Tests: package ending in _test, rules starting with test_.
‚Ä¢	Use with to override input, data, or built-ins.
test_admin_can_read if {
  authz.allow with input as {"user": "alice", "role": "admin"}
}
Run:
opa test .
________________________________________
18.9 Best Practices (Ultra Condensed)
‚Ä¢	Always opa fmt and lint.
‚Ä¢	Use modern syntax (import rego.v1 or future.keywords).
‚Ä¢	Prefer sets/objects for membership tests.
‚Ä¢	Avoid inline comprehensions in complex allow/deny.
‚Ä¢	Use helper rules with clear names.
‚Ä¢	Always have tests for deny/allow semantics.
________________________________________
Chapter 19 ‚Äì Glossary (Rigorous)
Alphabetical list of core terms.
________________________________________
ABAC (Attribute-Based Access Control)
Access model where decisions are based on attributes of subject, resource, action, and environment, not just roles.
Allow / Deny (Effects)
Canonical authorization decision outcomes. Frequently modeled via Rego rules like allow and deny or decision documents with effects.
AST (Abstract Syntax Tree)
Tree representation of parsed input (e.g., GraphQL query), often passed to OPA as input for fine-grained policies.
Baseline Policy (Global Baseline)
Organization-wide invariant policy layer that lower layers cannot override or weaken (e.g., ‚ÄúNo public S3 buckets‚Äù).
Bundle
A versioned tarball containing Rego policies, data, and a .manifest file. Used by OPA to load and update policies in production.
Complete Rule
A Rego rule that defines a single final value (e.g., max_conns := 10 or allow := true). Multiple definitions that produce different values for the same input cause conflicts.
ConstraintTemplate (Gatekeeper)
Kubernetes CRD that defines reusable OPA policies for Gatekeeper. Users instantiate constraints based on templates.
Correlation ID
Identifier used to tie together logs and traces across systems, included in OPA decision logs for observability.
Data (in OPA)
Persistent, relatively static information (loaded from bundles or in-memory), accessed as data.*. May mirror configuration, schemas, user roles, etc.
Decision Document
The JSON result of an OPA query (e.g., data.authz.allow or a more complex document with allow, deny, effects, risk_score).
Decision Log
Structured record of each OPA evaluation: includes path, input (or hash), result, metrics, and bundle revision, used for audit and observability.
Datalog
A subset of Prolog used for declarative logic programming, without complex function symbols. Rego is inspired by Datalog and extends it with JSON-like structures.
Deny Rule
A partial rule (often deny[msg] or deny contains msg) that accumulates violation messages, typically used in compliance and validation policies.
Effect
The semantic outcome of a policy evaluation (e.g., "allow", "deny", "warn", "override"), often encoded in decision documents.
Fixpoint
A stable interpretation of a logic program where applying the immediate consequence operator (deriving new facts) produces no new facts. Rego‚Äôs semantics can be described via least fixpoints.
Future Keywords
The future.keywords import (Rego v0.x) that enables newer language constructs like if, in, contains, every. In OPA 1.0+ this is replaced by import rego.v1.
Global Baseline
See Baseline Policy: global layer of policies applied to all services/tenants, usually with highest precedence for security.
GraphQL Policy
Policy that operates on GraphQL queries represented as AST; can enforce field-level auth, query depth, or cost.
HTTP Sidecar
Deployment pattern where OPA runs as a sidecar container next to a service, receiving authorization queries over localhost.
Input (in OPA)
Per-request JSON document provided by the caller to OPA, containing details like user, action, resource, HTTP request, etc. Accessed as input.*.
LLM (Large Language Model)
Neural network model (like ChatGPT) used to generate or refactor Rego; OPA then validates and executes resulting policies.
NAF (Negation-as-Failure)
Logic programming semantics where not p(X) means ‚Äúp(X) cannot be proven.‚Äù Used in Rego for negation.
OPA (Open Policy Agent)
General-purpose policy decision engine that evaluates Rego policies against JSON inputs and data.
PDP (Policy Decision Point)
Component that computes policy decisions (e.g., OPA).
PEP (Policy Enforcement Point)
Component that enforces decisions (e.g., API gateway, Kubernetes admission controller).
Partial Evaluation (PE)
Technique where OPA specializes policies with respect to known input and data, producing an optimized, often smaller program or WASM artifact.
Partial Rule
A Rego rule that defines members of a virtual set or object incrementally (e.g., deny[msg] or roles[user] := role).
Rego
OPA‚Äôs declarative policy language, inspired by Datalog and designed for reasoning over JSON-like documents.
Regal
A dedicated linter for Rego, enforcing style and correctness rules beyond opa fmt.
Rule Conflict
Runtime error when multiple complete rules or function rules with the same name and arguments produce different values.
Schema (JSON Schema)
Formal type definition for JSON documents. OPA can use schemas to perform type checking on input or data.
Sidecar
Deployment pattern where OPA runs alongside an application in the same Pod/host, reducing network latency for policy queries.
Stateful Policy
Policy whose decision depends on past events or accumulated state. Implemented in OPA by passing state snapshots as data or input, not by mutability in Rego.
Stratification
Property of a logic program whereby cycles through negation are avoided, enabling well-defined semantics for negation-as-failure.
Temporal Policy
Policy that involves time (e.g., deadlines, windows, schedules), typically implemented with time.* built-ins and time-stamped state.
Tenant Overlay
Per-tenant policy or configuration that tightens (but does not weaken) global/domain rules, often stored under data.tenants[tenant_id].
Virtual Document
A Rego rule or package that behaves like a JSON document when queried (e.g., data.authz.allow), although it is computed on demand rather than stored.
WASM (WebAssembly)
Portable binary format that can run Rego policies compiled from OPA in multiple environments (browsers, proxies, services).
With (Keyword)
Rego keyword that allows overriding input, data, or built-ins for the scope of an expression; heavily used in testing and mocking.
Zero-Trust Architecture
Security model where no implicit trust is granted to assets or user accounts based solely on network location; OPA policies often implement zero-trust authorization logic.
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [authz, distribution, negation, observability, performance, testing, theory]
digest: 8a0ab874403825c7786d0bbae314eb0e57529afce9a665d27fc7692bd2b9ae88
symbol_refs: [{}, set([1,2,3]), Important:, set(), {1,2,3}]
semantic_role: architecture
:::
**Important:** `set()` is a type conversion function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` directly. Using `set()` without arguments will cause a runtime error.
________________________________________
18.4 Iteration
Implicit:
arr[_]               # all values
obj[k]               # binds k to each key
set[v]               # binds v to each member
Explicit with some ... in:
some x in arr        # values
some i, x in arr     # index, value
some k, v in obj     # key, value
some v in set        # members
________________________________________
18.5 Quantifiers
‚Ä¢	Existential: some x in xs { ... }
‚Ä¢	Universal:
o	Using every:
o	all_valid if {
o	  every x in xs {
o	    x.valid == true
o	  }
o	}
o	Or via negation:
o	all_valid if not any_invalid
o	any_invalid if {
o	  some x in xs
o	  not x.valid
o	}
________________________________________
18.6 Negation
not cond = ‚Äúcannot prove cond.‚Äù
Safety: variables in cond must be bound beforehand.
deny if {
  user := input.user
  not blacklisted[user]
}
________________________________________
18.7 Built-in Highlights
‚Ä¢	Aggregates: count, sum, max, min
‚Ä¢	Strings: concat, contains, startswith, endswith, split, replace
‚Ä¢	Regex: regex.match, regex.split
‚Ä¢	JSON: json.marshal, json.unmarshal
‚Ä¢	Time: time.now_ns, time.parse_rfc3339_ns, time.clock
‚Ä¢	Crypto: crypto.sha256, io.jwt.*
________________________________________
18.8 Testing
‚Ä¢	Tests: package ending in _test, rules starting with test_.
‚Ä¢	Use with to override input, data, or built-ins.
test_admin_can_read if {
  authz.allow with input as {"user": "alice", "role": "admin"}
}
Run:
opa test .
________________________________________
18.9 Best Practices (Ultra Condensed)
‚Ä¢	Always opa fmt and lint.
‚Ä¢	Use modern syntax (import rego.v1 or future.keywords).
‚Ä¢	Prefer sets/objects for membership tests.
‚Ä¢	Avoid inline comprehensions in complex allow/deny.
‚Ä¢	Use helper rules with clear names.
‚Ä¢	Always have tests for deny/allow semantics.
________________________________________
Chapter 19 ‚Äì Glossary (Rigorous)
Alphabetical list of core terms.
________________________________________
ABAC (Attribute-Based Access Control)
Access model where decisions are based on attributes of subject, resource, action, and environment, not just roles.
Allow / Deny (Effects)
Canonical authorization decision outcomes. Frequently modeled via Rego rules like allow and deny or decision documents with effects.
AST (Abstract Syntax Tree)
Tree representation of parsed input (e.g., GraphQL query), often passed to OPA as input for fine-grained policies.
Baseline Policy (Global Baseline)
Organization-wide invariant policy layer that lower layers cannot override or weaken (e.g., ‚ÄúNo public S3 buckets‚Äù).
Bundle
A versioned tarball containing Rego policies, data, and a .manifest file. Used by OPA to load and update policies in production.
Complete Rule
A Rego rule that defines a single final value (e.g., max_conns := 10 or allow := true). Multiple definitions that produce different values for the same input cause conflicts.
ConstraintTemplate (Gatekeeper)
Kubernetes CRD that defines reusable OPA policies for Gatekeeper. Users instantiate constraints based on templates.
Correlation ID
Identifier used to tie together logs and traces across systems, included in OPA decision logs for observability.
Data (in OPA)
Persistent, relatively static information (loaded from bundles or in-memory), accessed as data.*. May mirror configuration, schemas, user roles, etc.
Decision Document
The JSON result of an OPA query (e.g., data.authz.allow or a more complex document with allow, deny, effects, risk_score).
Decision Log
Structured record of each OPA evaluation: includes path, input (or hash), result, metrics, and bundle revision, used for audit and observability.
Datalog
A subset of Prolog used for declarative logic programming, without complex function symbols. Rego is inspired by Datalog and extends it with JSON-like structures.
Deny Rule
A partial rule (often deny[msg] or deny contains msg) that accumulates violation messages, typically used in compliance and validation policies.
Effect
The semantic outcome of a policy evaluation (e.g., "allow", "deny", "warn", "override"), often encoded in decision documents.
Fixpoint
A stable interpretation of a logic program where applying the immediate consequence operator (deriving new facts) produces no new facts. Rego‚Äôs semantics can be described via least fixpoints.
Future Keywords
The future.keywords import (Rego v0.x) that enables newer language constructs like if, in, contains, every. In OPA 1.0+ this is replaced by import rego.v1.
Global Baseline
See Baseline Policy: global layer of policies applied to all services/tenants, usually with highest precedence for security.
GraphQL Policy
Policy that operates on GraphQL queries represented as AST; can enforce field-level auth, query depth, or cost.
HTTP Sidecar
Deployment pattern where OPA runs as a sidecar container next to a service, receiving authorization queries over localhost.
Input (in OPA)
Per-request JSON document provided by the caller to OPA, containing details like user, action, resource, HTTP request, etc. Accessed as input.*.
LLM (Large Language Model)
Neural network model (like ChatGPT) used to generate or refactor Rego; OPA then validates and executes resulting policies.
NAF (Negation-as-Failure)
Logic programming semantics where not p(X) means ‚Äúp(X) cannot be proven.‚Äù Used in Rego for negation.
OPA (Open Policy Agent)
General-purpose policy decision engine that evaluates Rego policies against JSON inputs and data.
PDP (Policy Decision Point)
Component that computes policy decisions (e.g., OPA).
PEP (Policy Enforcement Point)
Component that enforces decisions (e.g., API gateway, Kubernetes admission controller).
Partial Evaluation (PE)
Technique where OPA specializes policies with respect to known input and data, producing an optimized, often smaller program or WASM artifact.
Partial Rule
A Rego rule that defines members of a virtual set or object incrementally (e.g., deny[msg] or roles[user] := role).
Rego
OPA‚Äôs declarative policy language, inspired by Datalog and designed for reasoning over JSON-like documents.
Regal
A dedicated linter for Rego, enforcing style and correctness rules beyond opa fmt.
Rule Conflict
Runtime error when multiple complete rules or function rules with the same name and arguments produce different values.
Schema (JSON Schema)
Formal type definition for JSON documents. OPA can use schemas to perform type checking on input or data.
Sidecar
Deployment pattern where OPA runs alongside an application in the same Pod/host, reducing network latency for policy queries.
Stateful Policy
Policy whose decision depends on past events or accumulated state. Implemented in OPA by passing state snapshots as data or input, not by mutability in Rego.
Stratification
Property of a logic program whereby cycles through negation are avoided, enabling well-defined semantics for negation-as-failure.
Temporal Policy
Policy that involves time (e.g., deadlines, windows, schedules), typically implemented with time.* built-ins and time-stamped state.
Tenant Overlay
Per-tenant policy or configuration that tightens (but does not weaken) global/domain rules, often stored under data.tenants[tenant_id].
Virtual Document
A Rego rule or package that behaves like a JSON document when queried (e.g., data.authz.allow), although it is computed on demand rather than stored.
WASM (WebAssembly)
Portable binary format that can run Rego policies compiled from OPA in multiple environments (browsers, proxies, services).
With (Keyword)
Rego keyword that allows overriding input, data, or built-ins for the scope of an expression; heavily used in testing and mocking.
Zero-Trust Architecture
Security model where no implicit trust is granted to assets or user accounts based solely on network location; OPA policies often implement zero-trust authorization logic.
:::

::: rationale
id: rationale-4107-1383
explanation: := "Global: public writes forbidden"
}
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 365a0835908eae1f07b53f3a1a5211f9c6a9180866eabf8a5ed0302af600c955
symbol_refs: []
semantic_role: rationale
:::
:= "Global: public writes forbidden"
}
:::

::: rationale
id: rationale-4114-1384
explanation: := "Domain(EU): consent required"
}
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7022c0fd3867c727743e18ab6cd5b422c4f7220532b94d997bf375d8056b8789
symbol_refs: []
semantic_role: rationale
:::
:= "Domain(EU): consent required"
}
:::

::: rationale
id: rationale-4121-1385
explanation: := "Team(Billing): admin role required"
}
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: cac0c7f6ae1401949392de4866c56bd606eb5acde0018e22a107401a7c752b4c
symbol_refs: []
semantic_role: rationale
:::
:= "Team(Billing): admin role required"
}
:::

::: rationale
id: rationale-4128-1386
explanation: := "Tenant override: feature-x beta allow"
}
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: b02c0077dfbcb95584b2120f52c1cbde82f15f182ae947d56d6d769b01770f7d
symbol_refs: []
semantic_role: rationale
:::
:= "Tenant override: feature-x beta allow"
}
:::

::: rationale
id: rationale-4139-1387
explanation: if {
    some r
    r := global_deny[r]  # global always first
} or {
    some r
    r := domain_deny[r]
} or {
    some r
    r := team_deny[r]
}
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c2f5d64edaeb8ffd98185999dbe6e9817ace82997dd7f4c607f20d81a4e5605e
symbol_refs: []
semantic_role: rationale
:::
if {
    some r
    r := global_deny[r]  # global always first
} or {
    some r
    r := domain_deny[r]
} or {
    some r
    r := team_deny[r]
}
:::

::: rationale
id: rationale-4182-1388
explanation: Audit trails (who allowed what, when, and why).
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c0f4d00fc28a20f1f353d3b9d34960c15686db4ad94a8cc4687716eef2ad87ac
symbol_refs: []
semantic_role: rationale
:::
Audit trails (who allowed what, when, and why).
:::

::: rationale
id: rationale-4303-1389
explanation: epoch)
    now := time
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: adab83084be69723576562ea8d103b345da033a0f2c52ca8c9d4117fe49ab145
symbol_refs: []
semantic_role: rationale
:::
epoch)
    now := time
:::

::: rationale
id: rationale-4709-1390
explanation: } else {
    # no binding for r here
}
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 4bf1aaa764b271f535a06c420615aec2f6d6cdc56114df709e18b4bbdd3a7ea2
symbol_refs: []
semantic_role: rationale
:::
} else {
    # no binding for r here
}
:::

::: rationale
id: rationale-4719-1391
explanation: some v in input
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 2f6c1913d2eaf27ba2bb79d24fb189c8c2aa18cb97a302487ceb785124cee42c
symbol_refs: []
semantic_role: rationale
:::
some v in input
:::

::: rationale
id: rationale-5078-1392
explanation: Why?
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 907e915190880a387ca440d53f6a8c7fd11e6a5c6339cb17add36093b6a74ff7
symbol_refs: []
semantic_role: rationale
:::
Why?
:::

::: rationale
id: rationale-5135-1393
explanation: Why?
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 907e915190880a387ca440d53f6a8c7fd11e6a5c6339cb17add36093b6a74ff7
symbol_refs: []
semantic_role: rationale
:::
Why?
:::

::: rationale
id: rationale-5137-1394
explanation: tests that depend on bare rule names (warn, deny, allow, audit, etc
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: fc439d95bd0bf7ab91033e32d3067eae6ea73e18ef1097b10eede0737eb476d1
symbol_refs: []
semantic_role: rationale
:::
tests that depend on bare rule names (warn, deny, allow, audit, etc
:::

::: rationale
id: rationale-5168-1395
explanation: the test never uses tech_debt
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: b4e347c5723a5c0b02f9067686fe0420b5f9126754c176a1ab68f4f453f5d1d7
symbol_refs: []
semantic_role: rationale
:::
the test never uses tech_debt
:::

::: rationale
id: rationale-5210-1396
explanation: OPA never needs the alias tech_debt to find the rule
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: f40ca5025f8cf03f248fab12b4f3f00f6ea2aec26b346ccb491bfa498bb7e93d
symbol_refs: []
semantic_role: rationale
:::
OPA never needs the alias tech_debt to find the rule
:::

::: rationale
id: rationale-5212-1397
explanation: this is risky
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 1e7404b384ce35c528cdabde525535b4ccf72793adad3bbc13035f6dc1d91c15
symbol_refs: []
semantic_role: rationale
:::
this is risky
:::

::: rationale
id: rationale-5258-1398
explanation: tests still work
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c09a747eebb6f898969a4459208f16787a336deca8a287aac00553571f30436b
symbol_refs: []
semantic_role: rationale
:::
tests still work
:::

::: rationale
id: rationale-5260-1399
explanation: Because:
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 19c395b37a01f25da9eebff04e17a1c273ef117747ccf3f5c6f4f2d29da25190
symbol_refs: []
semantic_role: rationale
:::
Because:
:::

::: rationale
id: rationale-5283-1400
explanation: Why?
1. Bare rule names (warn) are ambiguous
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 729a871bedef9ec017ba5106424a8a6fe559e6eefdb81bb2212723e8a61d04f9
symbol_refs: []
semantic_role: rationale
:::
Why?
1. Bare rule names (warn) are ambiguous
:::

::: rationale
id: rationale-5362-1401
explanation: **Rationale:**
1. **Ambiguity Prevention**: Multiple packages may define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity.
2. **Maintainability**: Tests remain stable when new policies are added that might introduce naming conflicts.
3. **Clarity**: Explicit references make test intent clear and reduce cognitive load during code review.
4. **Refactoring Safety**: Policy package reorganization doesn't break tests that use explicit references.
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 4b09f4a9be0c2ba1c21e3ead148b2457d5d6b17d0a0e9e45d5c368b007e8e0cd
symbol_refs: [warn, Refactoring Safety, allow, Rationale:, Maintainability, deny, Ambiguity Prevention, Clarity]
semantic_role: reference
:::
**Rationale:**
1. **Ambiguity Prevention**: Multiple packages may define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity.
2. **Maintainability**: Tests remain stable when new policies are added that might introduce naming conflicts.
3. **Clarity**: Explicit references make test intent clear and reduce cognitive load during code review.
4. **Refactoring Safety**: Policy package reorganization doesn't break tests that use explicit references.
:::

::: rationale
id: rationale-5391-1402
explanation: JSON escapes it as a newline character
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 8278c6ef986b978d6b6e43d5d5697b248b8a935a614c3fbb7dbea257a32bc38e
symbol_refs: []
semantic_role: rationale
:::
JSON escapes it as a newline character
:::

::: rationale
id: rationale-5428-1403
explanation: the three affected tests fail
1
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 89655c9233ad2980a7c71cc5ae74ca13e9eb234bd5cf1db1bddd7db9b856014b
symbol_refs: []
semantic_role: rationale
:::
the three affected tests fail
1
:::

::: rationale
id: rationale-5472-1404
explanation: does this fail?
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 67aadc221f74ccb6caa35bbb2fb40ab506c2648eb08b1bac85d2437a0de14444
symbol_refs: []
semantic_role: rationale
:::
does this fail?
:::

::: rationale
id: rationale-5474-1405
explanation: your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 378c311f8e71b311edd31f6d6d8ccb91eeadfdf64e20f87584f6a2b9c7f7ff31
symbol_refs: []
semantic_role: rationale
:::
your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e
:::

::: rationale
id: rationale-5499-1406
explanation: whitespace escaping does NOT behave like in JSON
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7aedf36a602e6357016107bd009f16d2f61c737da7c4a9df745d1f6b6cf0ff61
symbol_refs: []
semantic_role: rationale
:::
whitespace escaping does NOT behave like in JSON
:::

::: rationale
id: rationale-5501-1407
explanation: direct opa eval --input JSON works
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: c8423ffc3f2f56e1f102b4e9e5b75c9f96ec351bd4cfa4f04f754db0be62874f
symbol_refs: []
semantic_role: rationale
:::
direct opa eval --input JSON works
:::

::: rationale
id: rationale-5503-1408
explanation: JSON ‚Üí OPA decoding translates \n into real newlines
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 5dad0b7a8a3a29eedc6800c0808653964d696218ac5215222e806e1af0a5c3e7
symbol_refs: []
semantic_role: rationale
:::
JSON ‚Üí OPA decoding translates \n into real newlines
:::

::: rationale
id: rationale-5555-1409
explanation: you‚Äôre building an enterprise system:
related_to: 
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 40cbb5a3cb0e5f7b36c83acf01c22cea1ef5fe3ff6c9ef9834ea7fa1f8a92fde
symbol_refs: []
semantic_role: rationale
:::
you‚Äôre building an enterprise system:
:::

::: contrast
id: contrast-182-1410
concept_a: Community Tools**:
- **Regal**: Official Rego linter
- **opa-idea-plugin**: IntelliJ IDEA support
- **vscode-opa**:
concept_b: Code extension
- **rego-playground**: Web-based testing
differences: **Community Tools**:
- **Regal**: Official Rego linter
- **opa-idea-plugin**: IntelliJ IDEA support
- **vscode-opa**: VS Code extension
- **rego-playground**: Web-based testing
chapter: CH-01
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
digest: 9bdfd19778529841d306403bd137820afb3a4dafdb629d4026f12200d9d52d72
symbol_refs: []
semantic_role: comparison
:::
Community Tools**:
- **Regal**: Official Rego linter
- **opa-idea-plugin**: IntelliJ IDEA support
- **vscode-opa**: vs Code extension
- **rego-playground**: Web-based testing

**Community Tools**:
- **Regal**: Official Rego linter
- **opa-idea-plugin**: IntelliJ IDEA support
- **vscode-opa**: VS Code extension
- **rego-playground**: Web-based testing
:::

::: contrast
id: contrast-559-1411
concept_a: Undefined
concept_b: False
differences: 3.4 Undefined vs False
chapter: CH-03
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [truth-values]
digest: 3186c5f2d25982338fd54fdf8effbf28472ebb149e3dc9642b83bbf68e815d69
symbol_refs: []
semantic_role: comparison
:::
Undefined vs False

3.4 Undefined vs False
:::

::: contrast
id: contrast-802-1412
concept_a: What Cannot Start a Reference (Literals
concept_b: References)
differences: 4.2 What Cannot Start a Reference (Literals vs References)
chapter: CH-04
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 0cc799a7872c11c3f270ae1390984c9df4842a175d0a2cb22ba6c0eebfd0845a
symbol_refs: []
semantic_role: reference
:::
What Cannot Start a Reference (Literals vs References)

4.2 What Cannot Start a Reference (Literals vs References)
:::

::: contrast
id: contrast-1205-1413
concept_a: Common Pitfall ‚Äî Existential
concept_b: Universal**:
differences: **Common Pitfall ‚Äî Existential vs Universal**:
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 5125274577da9052fe3553f657c320367c51025a811d4d0cc60d0c4fdd1c2827
symbol_refs: []
semantic_role: comparison
:::
Common Pitfall ‚Äî Existential vs Universal**:

**Common Pitfall ‚Äî Existential vs Universal**:
:::

::: contrast
id: contrast-1272-1414
concept_a: Error Semantics: Strict
concept_b: non-strict behavior
differences: Error Semantics: Strict vs non-strict behavior
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 5a04177c408028794ff0be604ba8fe90d9ea7c0a81caddee3473271be7582ef8
symbol_refs: []
semantic_role: comparison
:::
Error Semantics: Strict vs non-strict behavior

Error Semantics: Strict vs non-strict behavior
:::

::: contrast
id: contrast-1346-1415
concept_a: Indexing
concept_b: slicing:
differences: Indexing vs slicing:
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: f32bfcad4349c2d7b060152e783747ed571591073a9fb2f4eccb169a697a8d1d
symbol_refs: []
semantic_role: comparison
:::
Indexing vs slicing:

Indexing vs slicing:
:::

::: contrast
id: contrast-1656-1416
concept_a: Parse JWT payload manually (not recommended
concept_b: io
differences: # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative)
parts := split(input.token, ".")
payload_b64 := parts[1]
payload_json := base64url.decode(payload_b64)
claims := json.unmarshal(payload_json)
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 8e6a5d1b4095d68d5f9c06fb26a92ef7a89d87b938775863cae7466c55f6a5dd
symbol_refs: []
semantic_role: comparison
:::
Parse JWT payload manually (not recommended vs io

# Parse JWT payload manually (not recommended vs io.jwt.* but illustrative)
parts := split(input.token, ".")
payload_b64 := parts[1]
payload_json := base64url.decode(payload_b64)
claims := json.unmarshal(payload_json)
:::

::: contrast
id: contrast-2177-1417
concept_a: Unit Tests
concept_b: Integration Tests vs ‚ÄúGolden‚Äù Tests
Testing & Tooling
differences: ________________________________________
7.3 Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests
Testing & Tooling
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
digest: 6c273f4deed7f267800ba259bcf1ce23654d5ee20df01ca7569a2caa0026be8e
symbol_refs: []
semantic_role: comparison
:::
Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests
Testing & Tooling

________________________________________
7.3 Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests
Testing & Tooling
:::

::: contrast
id: contrast-2290-1418
concept_a: String Literal Handling in Tests: JSON
concept_b: Rego String Semantics
differences: Rule conflict errors
	Multiple complete rules with same name produce different values for same input
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7e0b9de0ac5a7e02372ca3f4208ea56e532ae85d05260fbcd84f9d8790fa8a3c
symbol_refs: []
semantic_role: comparison
:::
String Literal Handling in Tests: JSON vs Rego String Semantics

Rule conflict errors
	Multiple complete rules with same name produce different values for same input
:::

::: contrast
id: contrast-2292-1419
concept_a: A critical distinction exists between how string literals are interpreted in JSON inputs
concept_b: Rego test files
differences: A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 29d38c714a0c8c09726051411d3eb4f9bebb829fb7273a370a65dfbdef104dfd
symbol_refs: []
semantic_role: comparison
:::
A critical distinction exists between how string literals are interpreted in JSON inputs vs Rego test files

A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files
:::

::: contrast
id: contrast-2355-1420
concept_a: When to Use Raw Strings
concept_b: Double-Quoted:**
- **Raw strings (backticks)**: Multi-line content
differences: **When to Use Raw Strings vs Double-Quoted:**
- **Raw strings (backticks)**: Multi-line content, actual newlines needed, regex patterns matching line breaks
- **Double-quoted**: Single-line content, escape sequences acceptable, JSON-like strings
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 7fdf8cd4c288d91ccf5f40cf69a12b8a61f99194cc109d55cbb5df29b6407d5a
symbol_refs: []
semantic_role: comparison
:::
When to Use Raw Strings vs Double-Quoted:**
- **Raw strings (backticks)**: Multi-line content

**When to Use Raw Strings vs Double-Quoted:**
- **Raw strings (backticks)**: Multi-line content, actual newlines needed, regex patterns matching line breaks
- **Double-quoted**: Single-line content, escape sequences acceptable, JSON-like strings
:::

::: contrast
id: contrast-2384-1421
concept_a: Direct Evaluation
concept_b: Variable Binding
differences: 7.8.1 Direct Evaluation vs Variable Binding
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: a84e580f502f68981123eb3ced6d3c4ec6ae1ba4922bc1c519ad222ff91b88a4
symbol_refs: []
semantic_role: comparison
:::
Direct Evaluation vs Variable Binding

7.8.1 Direct Evaluation vs Variable Binding
:::

::: contrast
id: contrast-2743-1422
concept_a: Compare decisions
concept_b: stable
differences: Compare decisions vs stable
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 80242025544f4ddeace43d1089dba464166b24b7c15fac3fe7f483e542394fbc
symbol_refs: []
semantic_role: comparison
:::
Compare decisions vs stable

Compare decisions vs stable
:::

::: contrast
id: contrast-3051-1423
concept_a: Partial
concept_b: Complete Rules: Semantic Interpretation
	Complete rule (one final value):
	max_memory := 4 if
differences: ________________________________________
12.5 Partial vs Complete Rules: Semantic Interpretation
	Complete rule (one final value):
	max_memory := 4 if ..
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 17efe4c46fa30060845afced13cb87a657411170416fa5ba339b9ff8c222a791
symbol_refs: []
semantic_role: comparison
:::
Partial vs Complete Rules: Semantic Interpretation
	Complete rule (one final value):
	max_memory := 4 if

________________________________________
12.5 Partial vs Complete Rules: Semantic Interpretation
	Complete rule (one final value):
	max_memory := 4 if ..
:::

::: contrast
id: contrast-4026-1424
concept_a: Chapter 8 ‚Äì Deployment Topologies (Sidecar
concept_b: Central vs Embedded)
8
differences: Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded)
8.X Topology Overview Diagram
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 2ac470a9829cde6f4fef8fc8240e9461aa0a532b223bcd4f6b96efeee399f4ae
symbol_refs: []
semantic_role: architecture
:::
Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded)
8

Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded)
8.X Topology Overview Diagram
:::

::: contrast
id: contrast-4091-1425
concept_a: EU
concept_b: US data rules)
differences: Domain: Variants per product/region (e.g., EU vs US data rules).
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 2d4137a09903fa5141400a2d53455794b98eea1ac117a8e8be95ce4740bafa5c
symbol_refs: []
semantic_role: comparison
:::
EU vs US data rules)

Domain: Variants per product/region (e.g., EU vs US data rules).
:::

::: contrast
id: contrast-4362-1426
concept_a: authz/
concept_b: pricing/)
differences: Using disjoint roots (e.g., authz/ vs pricing/).
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 6e326e1fcb31303d0b715b0af3eeed8d28ae10d5ad0a7f618a06755293c7c115
symbol_refs: []
semantic_role: comparison
:::
authz/ vs pricing/)

Using disjoint roots (e.g., authz/ vs pricing/).
:::

::: contrast
id: contrast-4794-1427
concept_a: Pitfall 2: Null
concept_b: Missing vs Falsy
differences: Pitfall 2: Null vs Missing vs Falsy
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 89d29c43d19d4c65969d6d481cd6a362bce5c59d9bc646e96b170fcad665a471
symbol_refs: []
semantic_role: comparison
:::
Pitfall 2: Null vs Missing vs Falsy

Pitfall 2: Null vs Missing vs Falsy
:::

::: contrast
id: contrast-5425-1428
concept_a: They are being accessed ‚Äî the content is just
concept_b: what your rules assume
differences: They are being accessed ‚Äî the content is just different from what your rules assume.
chapter: CH-05
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
digest: 8169fe35012214974d5d8dfc758ce5a9076de7e06cd405a7df913cdba291e807
symbol_refs: []
semantic_role: comparison
:::
They are being accessed ‚Äî the content is just vs what your rules assume

They are being accessed ‚Äî the content is just different from what your rules assume.
:::

::: term
id: TERM-7a1b28224d1efb01
name: OPA's Solution
definition: Externalize policy logic into a declarative language that: - Runs anywhere (Kubernetes, API gateways, applications, CI/CD) - Evaluates consistently - Supports auditing and testing - Enables policy-as-code workflows
aliases: []
chapter: CH-01
digest: 1ffbb67f8eb62dbd47fcb9b50b427fcc72741bed0c026910ee886468b4ae495c
symbol_refs: [OPA's Solution]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
vector_summary: Externalize policy logic into a declarative language that: - Runs anywhere (Kubernetes, API gateways, applications, CI/CD) - Evaluates consistently - Supports auditing and testing - Enables policy-as-code workflows
:::
:::

::: term
id: TERM-3f2e3cc325687e8a
name: Core Capabilities
definition: - Accepts JSON input and data - Evaluates Rego policies - Returns structured decision documents - Supports partial evaluation for optimization - Provides comprehensive built-in functions - Enables policy bundling and distribution
aliases: []
chapter: CH-01
digest: 25d099b31350b3722d95f1d6c3c60ef725b52ee3d03cd46bd2b1507567c203a4
symbol_refs: [Core Capabilities]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [performance]
vector_summary: - Accepts JSON input and data - Evaluates Rego policies - Returns structured decision documents - Supports partial evaluation for optimization - Provides comprehensive built-in functions - Enables policy bundling and distribution
:::
:::

::: term
id: TERM-8a388f9628663f96
name: Architecture Model
definition: ```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Application ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Query
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     OPA     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Policies ‚îÇ
‚îÇ   Engine    ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Decision
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Result    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```
aliases: []
chapter: CH-01
digest: 245b0c704f11a4a2c19fcd4f03cdcdb88245ae5b085472c6eab5799cde15bce4
symbol_refs: [Architecture Model]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ``` ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ Application ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ Query ‚ñº ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ OPA ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Policies ‚îÇ ‚îÇ Engine ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îÇ Decision ‚ñº ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îÇ Result ‚îÇ ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ```
:::
:::

::: term
id: TERM-1e66555c00c66273
name: Integration Points
definition: 1. **Kubernetes Admission Control** - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies 2. **API Gateways & Service Meshes** - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins 3. **CI/CD Pipelines** - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement 4. **Application Authorization** - Microservices decisions - GraphQL field authorization - Database query filtering 5. **Cloud Security** - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance
aliases: []
chapter: CH-01
digest: 213b71f7c4faed3f4d2cb7f8d73d0189c434077ff1068e5d86a25d71217b6faa
symbol_refs: [Integration Points]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
vector_summary: 1. **Kubernetes Admission Control** - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies 2. **API Gateways & Service Meshes** - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins 3. **CI/CD Pipelines** - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement 4. **Application Authorization** - Microservices decisions - GraphQL field authorization - Database query filtering 5. **Cloud Security** - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance
:::
:::

::: term
id: TERM-e46fa93c46b299f4
name: Theoretical Foundations
definition: - **Datalog**: Recursive query language for databases - **Horn Clauses**: Logical rules with no disjunction in head - **Closed World Assumption**: What cannot be proven true is false - **Stratified Negation**: Safe negation without paradoxes
aliases: []
chapter: CH-01
digest: 50b129c9d74d212690d701562d78815bc5efc9e5735e8352e98eb0c892ea7121
symbol_refs: [Theoretical Foundations]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [negation]
vector_summary: - **Datalog**: Recursive query language for databases - **Horn Clauses**: Logical rules with no disjunction in head - **Closed World Assumption**: What cannot be proven true is false - **Stratified Negation**: Safe negation without paradoxes
:::
:::

::: term
id: TERM-00a324bd0cc436ab
name: Design Philosophy
definition: ```
SQL:  Queries over relational tables
Rego: Queries over hierarchical JSON documents
```
aliases: []
chapter: CH-01
digest: eac39db2992220e250ec581f0debfce0b269a61d3ce344bc44a2f85b7a9254a8
symbol_refs: [Design Philosophy]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ``` SQL: Queries over relational tables Rego: Queries over hierarchical JSON documents ```
:::
:::

::: term
id: TERM-9ef47984a527fe5b
name: Key Differences from Procedural Languages
definition: 
aliases: []
chapter: CH-01
digest: d10bbc919c1a3cd1edc0cbdd8c0d81b9748e106a837541aee6f7659493587830
symbol_refs: [Key Differences from Procedural Languages]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-df19aa513d8045ea
name: Example Comparison
definition: ```python
# Python (Procedural)
def is_admin(user):
    if user is None:
        return False
    if 'roles' not in user:
        return False
    for role in user['roles']:
        if role == 'admin':
            return True
    return False
``` ```rego
# Rego (Declarative)
is_admin if "admin" in input.user.roles
```
aliases: []
chapter: CH-01
digest: 55f463630a604f95dd343d63c60eb843d85d825307ce65cdc61e277ebeb8733c
symbol_refs: [Example Comparison]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```python # Python (Procedural) def is_admin(user): if user is None: return False if 'roles' not in user: return False for role in user['roles']: if role == 'admin': return True return False ``` ```rego # Rego (Declarative) is_admin if "admin" in input.user.roles ```
:::
:::

::: term
id: TERM-d132887ebe1f05d0
name: Core Projects
definition: - **OPA**: Policy engine (Go, ~50MB binary) - **Gatekeeper**: Kubernetes-native OPA - **Conftest**: CLI for testing configs - **opa-docker-authz**: Docker authorization - **opa-envoy-plugin**: Envoy integration
aliases: []
chapter: CH-01
digest: bcd31cdc7afdcf0d16b3cf222d0c8e0ec72f04596796cada6aedce8535216370
symbol_refs: [Core Projects]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz, testing]
vector_summary: - **OPA**: Policy engine (Go, ~50MB binary) - **Gatekeeper**: Kubernetes-native OPA - **Conftest**: CLI for testing configs - **opa-docker-authz**: Docker authorization - **opa-envoy-plugin**: Envoy integration
:::
:::

::: term
id: TERM-78bd3257163736c3
name: Community Tools
definition: - **Regal**: Official Rego linter - **opa-idea-plugin**: IntelliJ IDEA support - **vscode-opa**: VS Code extension - **rego-playground**: Web-based testing
aliases: []
chapter: CH-01
digest: 559f8ff0c0a7790dde15db918626206cd1625454640a8c33ab232ae7e7dc15cb
symbol_refs: [Community Tools]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
vector_summary: - **Regal**: Official Rego linter - **opa-idea-plugin**: IntelliJ IDEA support - **vscode-opa**: VS Code extension - **rego-playground**: Web-based testing
:::
:::

::: term
id: TERM-62d76b07bff5db8a
name: Cloud Offerings
definition: - **Styra DAS**: Enterprise OPA platform - **Styra Run**: Free tier for developers ---
aliases: []
chapter: CH-01
digest: 2b64de894f493aa022399cfeaeeb44c6f67cefc1f80a7ce208f59b654d285333
symbol_refs: [Cloud Offerings]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: - **Styra DAS**: Enterprise OPA platform - **Styra Run**: Free tier for developers ---
:::
:::

::: concept
id: BLK-382d8e86d5d4bffc
summary: Modern distributed systems face unprecedented complexity:.
digest: 059323c73cac38c5036f5a2c75cf86a88c2f661ed64a5ef37d46c00a06304049
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Modern distributed systems face unprecedented complexity:..
vector_summary: Modern distributed systems face unprecedented complexity:.
chapter: CH-01
:::
Modern distributed systems face unprecedented complexity:
:::

::: concept
id: BLK-c7dcd752342ecff0
summary: Traditional approaches fail because:.
digest: 6c629d62745cb1c0fc17f5ab6e593273ca455867544ae0d7b965281490a890d4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Traditional approaches fail because:..
vector_summary: Traditional approaches fail because:.
chapter: CH-01
:::
Traditional approaches fail because:
:::

::: concept
id: BLK-efdaa64e667461dd
summary: RBAC Limitations: Role-based access control cannot express: - Context-dependent decisions - Attribute-based logic - Relationship-based access - Tim...
digest: 629e34fed86c769bf14c11edbdafe7f4bbd1d0a028d12caa92c776538187ad98
symbol_refs: [RBAC Limitations]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that RBAC Limitations: Role-based access control cannot express: - Context-dependent decisions - Attribute-based logic - Relationship-based access - Tim....
semantic_categories: [authz]
vector_summary: RBAC Limitations: Role-based access control cannot express: - Context-dependent decisions - Attribute-based logic - Relationship-based access - Tim...
chapter: CH-01
:::
2. **RBAC Limitations**: Role-based access control cannot express: - Context-dependent decisions - Attribute-based logic - Relationship-based access - Time-based constraints
:::

::: concept
id: BLK-363d990e2c667210
summary: Lack of Portability: Policies tied to specific languages/frameworks.
digest: fe63e6bb9aa704c4d64b2d2c5a18256633c847e3e2c390b8a33ebe0717c9e66d
symbol_refs: [Lack of Portability]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Lack of Portability: Policies tied to specific languages/frameworks..
vector_summary: Lack of Portability: Policies tied to specific languages/frameworks.
chapter: CH-01
:::
3. **Lack of Portability**: Policies tied to specific languages/frameworks
:::

::: concept
id: BLK-f280742f145feb92
summary: Kubernetes Admission Control - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies.
digest: d77292943d839fe2a41f0cbcab38d1bcdd7f1b7233d8d41f9cbbe2782ae72b4e
symbol_refs: [Kubernetes Admission Control]
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Kubernetes Admission Control - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies..
vector_summary: Kubernetes Admission Control - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies.
chapter: CH-01
:::
1. **Kubernetes Admission Control** - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies
:::

::: concept
id: BLK-f8b1ab79fa1735f0
summary: API Gateways & Service Meshes - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins.
digest: f512d928fb83f368d7ec14b5ac6b5e93896e42db874f9da51aeb2106ac41628c
symbol_refs: [API Gateways & Service Meshes]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that API Gateways & Service Meshes - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins..
semantic_categories: [authz]
vector_summary: API Gateways & Service Meshes - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins.
graph_neighbors: [CODE-f9165857ee2c0c68, CODE-4d2ad0d6df9f48c1, CODE-ae589d488d5196d2, CODE-e3021412b7e801e0, CODE-22a3c940e76c1893, CODE-1f681853ebf733fb, CODE-4b643428b4f2edd0, CODE-e8a2139bac84c4a0, CODE-3152b6a89a146d23, CODE-ff0c5e5c7e41a636, CODE-322fb8a04486fb51]
graph_degree: 11
graph_two_hop: []
graph_three_hop: []
chapter: CH-01
:::
2. **API Gateways & Service Meshes** - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins
:::

::: concept
id: BLK-b695e4fd74c356a4
summary: Application Authorization - Microservices decisions - GraphQL field authorization - Database query filtering.
digest: 5b0b3d51b8b68168788b454d7824419d939ecbd1e093026e98c63564efec24a9
symbol_refs: [Application Authorization]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Application Authorization - Microservices decisions - GraphQL field authorization - Database query filtering..
semantic_categories: [authz]
vector_summary: Application Authorization - Microservices decisions - GraphQL field authorization - Database query filtering.
graph_neighbors: [CODE-f9165857ee2c0c68, CODE-4d2ad0d6df9f48c1, CODE-ae589d488d5196d2, CODE-e3021412b7e801e0, CODE-22a3c940e76c1893, CODE-1f681853ebf733fb, CODE-4b643428b4f2edd0, CODE-e8a2139bac84c4a0, CODE-3152b6a89a146d23, CODE-ff0c5e5c7e41a636, CODE-322fb8a04486fb51]
graph_degree: 11
graph_two_hop: []
graph_three_hop: []
chapter: CH-01
:::
4. **Application Authorization** - Microservices decisions - GraphQL field authorization - Database query filtering
:::

::: fact
id: BLK-ea6c1037e9ae2b22
summary: Microservices Architecture: 10-1000+ services requiring consistent authorization - Zero-Trust Networks: Every request must be authenticated and aut...
digest: 2f2aadda6fcb4112a828ff9785678e610e8cdd58fc8816a5170fd7e10f7b5241
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Microservices Architecture: 10-1000+ services requiring consistent authorization - Zero-Trust Networks: Every request must be authenticated and aut....
semantic_categories: [authz]
vector_summary: Microservices Architecture: 10-1000+ services requiring consistent authorization - Zero-Trust Networks: Every request must be authenticated and aut...
chapter: CH-01
:::
- **Microservices Architecture**: 10-1000+ services requiring consistent authorization - **Zero-Trust Networks**: Every request must be authenticated and authorized - **Multi-Cloud Deployments**: Policies must work across AWS, Azure, GCP, on-prem - **Regulatory Compliance**: GDPR, HIPAA, SOC2, PCI-DSS requirements - **Dynamic Infrastructure**: Kubernetes, service meshes, serverless functions
:::

::: fact
id: BLK-deebb1848e375afc
summary: Hardcoded Logic: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow pol...
digest: 6803fe28effd712c6e13b24473396a856b9550d02628a84747ea1640599f19b7
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Hardcoded Logic: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow pol....
semantic_categories: [authz]
vector_summary: Hardcoded Logic: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow pol...
chapter: CH-01
:::
1. **Hardcoded Logic**: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow policy updates requiring redeployments - No centralized visibility
:::

::: fact
id: BLK-9b13ed19c42c1aac
summary: OPA (Open Policy Agent) is a general-purpose policy decision engine that:.
digest: 005d7fa37878b907841bf13f11463c8f336bbe5c9760cd9265ae22aa61283d61
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA (Open Policy Agent) is a general-purpose policy decision engine that:..
vector_summary: OPA (Open Policy Agent) is a general-purpose policy decision engine that:.
chapter: CH-01
:::
OPA (Open Policy Agent) is a **general-purpose policy decision engine** that:
:::

::: fact
id: BLK-a944c2c95e8b60cc
summary: CI/CD Pipelines - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement.
digest: d80c71e9e804d2021eb5677bd9dadd3353d23d656103615409865830e32e03d1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that CI/CD Pipelines - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement..
vector_summary: CI/CD Pipelines - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement.
chapter: CH-01
:::
3. **CI/CD Pipelines** - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement
:::

::: fact
id: BLK-c3fda219db4b4a9e
summary: Cloud Security - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance.
digest: be910ddf056d93d63fbb511fabcd7051ec86ed41a5a81f553f9e81d426295cc1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Cloud Security - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance..
vector_summary: Cloud Security - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance.
chapter: CH-01
:::
5. **Cloud Security** - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance
:::

::: fact
id: BLK-40e7559486f5e766
summary: Rego is a declarative logic language with unique characteristics:.
digest: b2efb8b4dfba782d40b0d63ac3cccffd2033946a3c94d6e7fcfed38ed6daf837
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego is a declarative logic language with unique characteristics:..
vector_summary: Rego is a declarative logic language with unique characteristics:.
chapter: CH-01
:::
Rego is a **declarative logic language** with unique characteristics:
:::

::: example
id: CODE-005dd023ebcc6940
language: rego
chapter: CH-01
source: term:Architecture Model
purpose: definition-example
digest: 9a4770709e0866673797877701ec3e7d1204e71ce8ed664da3b2562c62865445
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Application ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Query
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     OPA     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Policies ‚îÇ
‚îÇ   Engine    ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Decision
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Result    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
:::

::: example
id: CODE-ab5611427fe142db
language: rego
chapter: CH-01
source: term:Design Philosophy
purpose: definition-example
digest: eb6a57ab1f35d584bb5405d54b990d8abc0c8e6df3a8a33aa98b0ad6021525b4
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
SQL:  Queries over relational tables
Rego: Queries over hierarchical JSON documents
:::

::: example
id: CODE-86e2fac48990bc06
language: python
chapter: CH-01
source: term:Example Comparison
purpose: definition-example
digest: 37beac4af7da8138cbbe961cc86cb742154ac27cec68f92f25aac2eadb8551c9
symbol_refs: [is_admin, user, role]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Python (Procedural)
def is_admin(user):
    if user is None:
        return False
    if 'roles' not in user:
        return False
    for role in user['roles']:
        if role == 'admin':
            return True
    return False
:::

::: example
id: CODE-83a1975da93b48d8
language: rego
chapter: CH-01
source: term:Example Comparison
purpose: definition-example
digest: 58155527d6860f701c2eecfcf34d500f155501f2e966b5e5b2d718dc93c8fac4
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Rego (Declarative)
is_admin if "admin" in input.user.roles
:::

::: example
id: CODE-9efd8405f174dbee
chapter: CH-01
language: 
role: example
tags: []
digest: 604cb851d8303f532a61d0275de3205a1367afa1ac290ccc7999de8895787437
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Application ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Query
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     OPA     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Policies ‚îÇ
‚îÇ   Engine    ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Decision
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Result    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
:::

::: example
id: CODE-cfdbd349f684bfef
chapter: CH-01
language: 
role: example
tags: []
digest: c58ff658b1edaa951d0d10cfb6d3512f3321d0a0c2337fbbf39893eec00b9214
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
SQL:  Queries over relational tables
Rego: Queries over hierarchical JSON documents
:::

::: example
id: CODE-64edda5a1e638eac
chapter: CH-01
language: rego
role: example
tags: []
digest: ad46da7f024e1044a486bcae9b1a345ef7d25f300bf864fdbcc8f1447b2e15e7
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Rego (Declarative)
is_admin if "admin" in input.user.roles
:::

::: code-pattern
id: CODE-d4560f3ef9c1c8e2
chapter: CH-01
language: python
role: code-pattern:python-structure
tags: [python]
pattern_type: python-structure
digest: 1188db9fa071e6c08024bab1452532b0523f0dde048a529a06c7187f3dd1fd0b
symbol_refs: [is_admin, user, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Python (Procedural)
def is_admin(user):
    if user is None:
        return False
    if 'roles' not in user:
        return False
    for role in user['roles']:
        if role == 'admin':
            return True
    return False
:::

::: table
id: TABLE-9e656aa852fe3e8f
chapter: CH-01
headers: [Aspect, Procedural (Python/Java), Declarative (Rego)]
row_count: 5
caption: 
rows: [['Focus', 'How to compute', 'What should be true'], ['Execution', 'Sequential steps', 'Search-based evaluation'], ['Variables', 'Mutable state', 'Immutable bindings'], ['Control Flow', 'if/for/while', 'Logical conjunction/disjunction'], ['Side Effects', 'Common', 'Prohibited']]
digest: 127066b3e42a7eb3aa0f599d30dce70325c07f0d84eb49d46bb5f80e94d99760
symbol_refs: []
semantic_role: reference
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: table
id: TABLE-ca9fb1ed9ebf3089
chapter: CH-01
type: dos-donts
headers: [Do, Don't]
rows: [['Microservices Architecture: 10-1000+ services requiring consistent authorization - Zero-Trust Networks: Every request must be authenticated and aut...', ''], ['Hardcoded Logic: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow pol...', ''], ['OPA (Open Policy Agent) is a general-purpose policy decision engine that:.', ''], ['CI/CD Pipelines - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement.', ''], ['Cloud Security - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance.', ''], ['Rego is a declarative logic language with unique characteristics:.', '']]
semantic_categories: [authz]
digest: 700c3678f3b723370ab1c6df183ab8cb738c8d49cb9a7231884bee0cb61b652c
symbol_refs: []
semantic_role: architecture
:::
| Do | Don't |
| --- | --- |
| Microservices Architecture: 10-1000+ services requiring consistent authorization - Zero-Trust Networks: Every request must be authenticated and aut... |  |
| Hardcoded Logic: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow pol... |  |
| OPA (Open Policy Agent) is a general-purpose policy decision engine that:. |  |
| CI/CD Pipelines - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement. |  |
| Cloud Security - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance. |  |
| Rego is a declarative logic language with unique characteristics:. |  |
:::

::: qa
id: QA-7fd331f59b31937f
chapter: CH-01
q: What is OPA's Solution in the context of Rego/OPA?
a: Externalize policy logic into a declarative language that: - Runs anywhere (Kubernetes, API gateways, applications, CI/CD) - Evaluates consistently - Supports auditing and testing - Enables policy-as-code workflows
reference: TERM-7a1b28224d1efb01
semantic_categories: [testing]
digest: 47819494051e50821a92c7638fe61285da098f409afbecc7567bc88a004b9b88
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-45b037b8fba4543d
chapter: CH-01
q: What is Core Capabilities in the context of Rego/OPA?
a: - Accepts JSON input and data - Evaluates Rego policies - Returns structured decision documents - Supports partial evaluation for optimization - Provides comprehensive built-in functions - Enables policy bundling and distribution
reference: TERM-3f2e3cc325687e8a
semantic_categories: [performance]
digest: 5cfd2885298d65eac8813320cb770240f7d52459aa8cc01361325285a231154b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-16cbf99681281d92
chapter: CH-01
q: What is Architecture Model in the context of Rego/OPA?
a: ```
reference: TERM-8a388f9628663f96
digest: 83bc2cf1d8f012252c77a3e25f18ece0f5e30079b3a443f8928400adc8b434ce
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d911f57db8093f58
chapter: CH-01
q: What is Integration Points in the context of Rego/OPA?
a: 1. **Kubernetes Admission Control** - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies 2. **API Gateways & Service Meshes** - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins 3. **CI/CD Pipelines** - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement 4. **Application Authorization** - Microservices decisions - GraphQL field authorization - Database query filtering 5. **Cloud Security** - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance
reference: TERM-1e66555c00c66273
semantic_categories: [authz]
digest: 8704e07f756cdbc4bf30386a2dd0ce9c3538ec5b0171fa146aab1cea988e992c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-32902e6f4c3506fb
chapter: CH-01
q: What is Theoretical Foundations in the context of Rego/OPA?
a: - **Datalog**: Recursive query language for databases - **Horn Clauses**: Logical rules with no disjunction in head - **Closed World Assumption**: What cannot be proven true is false - **Stratified Negation**: Safe negation without paradoxes
reference: TERM-e46fa93c46b299f4
semantic_categories: [negation]
digest: ac2e12bbb57b31661dc0bb48bc780662603ba1d104bbe410283be0a2cbcb42ac
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-757e21cd75178f01
chapter: CH-01
q: What is Design Philosophy in the context of Rego/OPA?
a: ```
reference: TERM-00a324bd0cc436ab
digest: c7163f7a486118fec3b30ad54f0cf9449bf7b2e18b6fbd56b7f2c9a4bd5833a9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ac724f041b09fbc8
chapter: CH-01
q: What is Example Comparison in the context of Rego/OPA?
a: ```python
reference: TERM-df19aa513d8045ea
digest: 5110e0288ea159e5186210bfe2917cc8e1786107b7a7928d907fa81f37e8af99
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c38bd3f3f4c37fff
chapter: CH-01
q: What is Core Projects in the context of Rego/OPA?
a: - **OPA**: Policy engine (Go, ~50MB binary) - **Gatekeeper**: Kubernetes-native OPA - **Conftest**: CLI for testing configs - **opa-docker-authz**: Docker authorization - **opa-envoy-plugin**: Envoy integration
reference: TERM-d132887ebe1f05d0
semantic_categories: [authz, testing]
digest: 5ac5508e09b6bc090058b20b83b70713bdb6066810ded196fe58a552fbcf2ebc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0c06e313d60e5f56
chapter: CH-01
q: What is Community Tools in the context of Rego/OPA?
a: - **Regal**: Official Rego linter - **opa-idea-plugin**: IntelliJ IDEA support - **vscode-opa**: VS Code extension - **rego-playground**: Web-based testing
reference: TERM-78bd3257163736c3
semantic_categories: [testing]
digest: 25e5bf99c4f4f133e73189823ed5c9be1a1337a297751201947c98dcaac3bff4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d185b6e3a21a56b4
chapter: CH-01
q: What is Cloud Offerings in the context of Rego/OPA?
a: - **Styra DAS**: Enterprise OPA platform - **Styra Run**: Free tier for developers ---
reference: TERM-62d76b07bff5db8a
digest: e3ff572a08047f7ae5fa0d04dbd9517c33ef252937cd179bf156b8cb23b32b98
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3f340460853b3ead
chapter: CH-01
q: What is Modern distributed systems face unprecedented complexity in the context of Rego/OPA?
a: Modern distributed systems face unprecedented complexity:
reference: BLK-382d8e86d5d4bffc
digest: 8d2d54e2beffebdb19647621c81794ffbdc2450cca8f4a38b2a9193ae4c60259
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6ae22b36893af4aa
chapter: CH-01
q: What is Microservices Architecture in the context of Rego/OPA?
a: - **Microservices Architecture**: 10-1000+ services requiring consistent authorization - **Zero-Trust Networks**: Every request must be authenticated and authorized - **Multi-Cloud Deployments**: Policies must work across AWS, Azure, GCP, on-prem - **Regulatory Compliance**: GDPR, HIPAA, SOC2, PCI-DSS requirements - **Dynamic Infrastructure**: Kubernetes, service meshes, serverless functions
reference: BLK-ea6c1037e9ae2b22
semantic_categories: [authz]
digest: cc3e24d668787cd47aefde8d2ba9e0838c2832618d0fe4dee4f5f707e321f499
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b8518e7475e36bf7
chapter: CH-01
q: What is Traditional approaches fail because in the context of Rego/OPA?
a: Traditional approaches fail because:
reference: BLK-c7dcd752342ecff0
digest: 17114b3c330a39266b73abf9be76289e412d17c20ee460ae3463ce5429f0f98f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dd6b25b5f271968c
chapter: CH-01
q: What is Hardcoded Logic in the context of Rego/OPA?
a: 1. **Hardcoded Logic**: Authorization embedded in application code creates: - Inconsistency across services - Difficult auditing and compliance - Slow policy updates requiring redeployments - No centralized visibility
reference: BLK-deebb1848e375afc
semantic_categories: [authz]
digest: cf60f2b3e9df12462bb19e4d623825f6f913ec713bacf1c27c55dab8f5eb644e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-35d717173b3e8972
chapter: CH-01
q: What is RBAC Limitations in the context of Rego/OPA?
a: 2. **RBAC Limitations**: Role-based access control cannot express: - Context-dependent decisions - Attribute-based logic - Relationship-based access - Time-based constraints
reference: BLK-efdaa64e667461dd
semantic_categories: [authz]
digest: 32a46c281dd7b37d708b19d1f806fcbc3c9d8dbe855047caba1c74b613856824
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9ff6ce1825c440a9
chapter: CH-01
q: What is Lack of Portability in the context of Rego/OPA?
a: 3. **Lack of Portability**: Policies tied to specific languages/frameworks
reference: BLK-363d990e2c667210
digest: 3e8af2ec6295868da1926412f8734c50f67b2663aca6600b9123add40de19ad9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ebf35ab83c440c8e
chapter: CH-01
q: What is OPA (Open Policy Agent) is a general-purpose policy decision engine that in the context of Rego/OPA?
a: OPA (Open Policy Agent) is a **general-purpose policy decision engine** that:
reference: BLK-9b13ed19c42c1aac
digest: 808d83f7046bf5f6abcfeba7302688ab5467e3160ae2f137e4e615d41e571396
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-79e580a10409df3a
chapter: CH-01
q: What is Kubernetes Admission Control - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies. in the context of Rego/OPA?
a: 1. **Kubernetes Admission Control** - Gatekeeper validates/mutates resources - Prevents non-compliant deployments - Enforces security policies
reference: BLK-f280742f145feb92
digest: 587bf25ff02e7092efcc547c05f04592dbfd694152ce54dc71baefee16de0a82
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f09034242a2df735
chapter: CH-01
q: What is API Gateways & Service Meshes - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins. in the context of Rego/OPA?
a: 2. **API Gateways & Service Meshes** - Envoy External Authorization - Istio/Linkerd integration - Kong/Traefik plugins
reference: BLK-f8b1ab79fa1735f0
semantic_categories: [authz]
digest: 494017cc7ad4fec69ceed1b65a7f48433b1f4a437dd021682025fead83761b93
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7e6d841bb1bff52e
chapter: CH-01
q: What is CI/CD Pipelines - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement. in the context of Rego/OPA?
a: 3. **CI/CD Pipelines** - Infrastructure-as-Code validation - Terraform plan analysis - Docker image policy enforcement
reference: BLK-a944c2c95e8b60cc
digest: 8b2764123496a9f37e3f7ac890477f7bca00377e88092ea34ad346904ebd6463
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2997fb5823868b7d
chapter: CH-01
q: What is Application Authorization - Microservices decisions - GraphQL field authorization - Database query filtering. in the context of Rego/OPA?
a: 4. **Application Authorization** - Microservices decisions - GraphQL field authorization - Database query filtering
reference: BLK-b695e4fd74c356a4
semantic_categories: [authz]
digest: 4bb71575e648bd7d4be7c6ff425684884a96955da73e4dfd6fe80a288daaceaa
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6aa42fc4a04250d1
chapter: CH-01
q: What is Cloud Security - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance. in the context of Rego/OPA?
a: 5. **Cloud Security** - AWS IAM policy validation - Azure ARM template scanning - GCP resource compliance
reference: BLK-c3fda219db4b4a9e
digest: 0ee1b5ec9d799250cbfacf6533e949b4e3f5d9859f28f066aef4ce10e6e43f89
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5b3a2640b0d7bc9e
chapter: CH-01
q: What is Rego is a declarative logic language with unique characteristics in the context of Rego/OPA?
a: Rego is a **declarative logic language** with unique characteristics:
reference: BLK-40e7559486f5e766
digest: edec192c117ba507eb9d46fe3fbb0d893fecc75f3c12a89105777950db9f8c1c
symbol_refs: []
semantic_role: explanation
:::
:::

::: reasoning-chain
id: CHAIN-52053a86ff2fbfc2
chapter: CH-01
qa_id: QA-7fd331f59b31937f
reference: TERM-7a1b28224d1efb01
semantic_categories: [truth-values]
digest: f7816efe0eb32dbd755a99cdb6ac1b4c8868979c8f505d1a42d609b84e6e21ef
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d8551dad1432f75a
chapter: CH-01
qa_id: QA-45b037b8fba4543d
reference: TERM-3f2e3cc325687e8a
semantic_categories: [truth-values]
digest: dde840c16bfdd6f7399b1dc5093cd8acae49ac2df65246d4d2fb96c2f33682fe
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fb00418a6688ee53
chapter: CH-01
qa_id: QA-16cbf99681281d92
reference: TERM-8a388f9628663f96
semantic_categories: [truth-values]
digest: 015a0a335f9cca2dac370f93311e34ebe8297a1f66fec68eee6671f7790b5295
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a0ae39f0d649a8b5
chapter: CH-01
qa_id: QA-d911f57db8093f58
reference: TERM-1e66555c00c66273
semantic_categories: [truth-values]
digest: 474ceb047206907ebdd6776910c8711b5b27cd6d176ce41353b0989cf7cff8f1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-77fbbaf5e1c43897
chapter: CH-01
qa_id: QA-32902e6f4c3506fb
reference: TERM-e46fa93c46b299f4
semantic_categories: [truth-values]
digest: 9c67d0a8c9c0ee3b47b6fef81917ce03e395943211dbe98d286ce8205f6807b9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-432962c744c72e6e
chapter: CH-01
qa_id: QA-757e21cd75178f01
reference: TERM-00a324bd0cc436ab
semantic_categories: [truth-values]
digest: a9b8938b2a3fb686d961ff86c96af88b3671861c956794bcb1ec775592d17bff
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9bb94711cd177f46
chapter: CH-01
qa_id: QA-ac724f041b09fbc8
reference: TERM-df19aa513d8045ea
semantic_categories: [truth-values]
digest: decde2acd0b3145c25ab73a0dadf36fae769df9e388fb12db17066ece284e811
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b138b93cdfc33c05
chapter: CH-01
qa_id: QA-c38bd3f3f4c37fff
reference: TERM-d132887ebe1f05d0
semantic_categories: [truth-values]
digest: 06eccde4c3cb30f3235a5f4885373033434fa5880ce4236d90881b731a53fcfd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4d0f4475bf825bc
chapter: CH-01
qa_id: QA-0c06e313d60e5f56
reference: TERM-78bd3257163736c3
semantic_categories: [truth-values]
digest: 61e4ec594671c1325a409cfafdb1b92ff2d1d4bb4e0ec469bdbd3d7a4a7ae36c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5828dbc807195979
chapter: CH-01
qa_id: QA-d185b6e3a21a56b4
reference: TERM-62d76b07bff5db8a
semantic_categories: [truth-values]
digest: f95d1c574a2df07d1c6189bfb429ca17c772331080f40ca030bfd58f365c7427
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4d5a66b58a84b7d
chapter: CH-01
qa_id: QA-3f340460853b3ead
reference: BLK-382d8e86d5d4bffc
semantic_categories: [truth-values]
digest: bc3a5ebf315ff44415360124c3c053fa16de17e4b2f48d9d2ce40bdf75f3080e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8666fececf8d027a
chapter: CH-01
qa_id: QA-6ae22b36893af4aa
reference: BLK-ea6c1037e9ae2b22
semantic_categories: [truth-values]
digest: d99a70d952d8c6563a4e4c40453e9b3ca9ba0ae380e470cd3e924127ebacccb8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-83ed472bded1c8a6
chapter: CH-01
qa_id: QA-b8518e7475e36bf7
reference: BLK-c7dcd752342ecff0
semantic_categories: [truth-values]
digest: 5fa10c5dbc7ca08efeb394e2998f56bdaa6357ce5ea6c0778c91217a63abdbd0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8dcc39cf8a1e2798
chapter: CH-01
qa_id: QA-dd6b25b5f271968c
reference: BLK-deebb1848e375afc
semantic_categories: [truth-values]
digest: f5610a1f9fee8e3c1a77352de8a02459583846aa7aac82d14b2bbfef229e1dfa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-97abed7838e56ede
chapter: CH-01
qa_id: QA-35d717173b3e8972
reference: BLK-efdaa64e667461dd
semantic_categories: [truth-values]
digest: c31fe87b9fa22cec197c82f4801cc6802ea75d8f1ab3459cda39a91a3b13663e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-19446eb892867a5f
chapter: CH-01
qa_id: QA-9ff6ce1825c440a9
reference: BLK-363d990e2c667210
semantic_categories: [truth-values]
digest: 75e9b1cb4751582d11b967478bf3e31384e397edfc18636fad0918e868536d3f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e1ce41a861cba719
chapter: CH-01
qa_id: QA-ebf35ab83c440c8e
reference: BLK-9b13ed19c42c1aac
semantic_categories: [truth-values]
digest: 07673eb20b9964e9d844a2ade7051684d544e68429a7b65db4dd90e6142402fa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e400271a64b3ebb4
chapter: CH-01
qa_id: QA-79e580a10409df3a
reference: BLK-f280742f145feb92
semantic_categories: [truth-values]
digest: 7fe0f3d5bdc105e6978a34f905695443ed1a1c0bf95fceaf456ce0999e4d28bf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-841c7e6355ef6d9e
chapter: CH-01
qa_id: QA-f09034242a2df735
reference: BLK-f8b1ab79fa1735f0
semantic_categories: [truth-values]
digest: 62369e3f1ce36c9d196be18c53045014be6f2f6aaa64a4e0961fe1b68514c78b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4a6194eb0f3120b5
chapter: CH-01
qa_id: QA-7e6d841bb1bff52e
reference: BLK-a944c2c95e8b60cc
semantic_categories: [truth-values]
digest: 016a3110fdb2ea98032ffc32b998978d3c7a44fea52892cbfeef7ab5ff1676a0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b1e1786cb7623f3d
chapter: CH-01
qa_id: QA-2997fb5823868b7d
reference: BLK-b695e4fd74c356a4
semantic_categories: [truth-values]
digest: 6c4036803fa64eff13c76ab2b44770e6caff0148bc89526fddce0ac46d2230a2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5a7bbe46fc988d24
chapter: CH-01
qa_id: QA-6aa42fc4a04250d1
reference: BLK-c3fda219db4b4a9e
semantic_categories: [truth-values]
digest: 857938577567065038dd721380f1e164916d20fcc4794b208c453f07e3a98c0c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7043308c0c730b82
chapter: CH-01
qa_id: QA-5b3a2640b0d7bc9e
reference: BLK-40e7559486f5e766
semantic_categories: [truth-values]
digest: 6d0f4d3073a52e1ced53676b06491b19083a082e636d1768afc8a54f936856b1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: role-note
id: ROLE-b43048dfaa3c4437
chapter: CH-01
role: Policy Author
guidance: Focus on correctness & clarity of rules in this chapter.
digest: e8686f05c9ea64c69b7e6a5ac75effa1133223742bcefc5ff7b87c8ba831a744
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-d1723cdc74cf3721
chapter: CH-01
role: Security Reviewer
guidance: Look for unsafe patterns, missing deny cases, misuse of negation.
semantic_categories: [negation]
digest: e140eab9afea0a96300df53095790e716f6ea63149bcd9b8793212655adc30d3
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-867b134dc77da77f
chapter: CH-01
role: Performance Engineer
guidance: Identify heavy comprehensions and opportunities for partial evaluation.
semantic_categories: [performance]
digest: badb8d64f5bbdbc467fe7265d36c56240c4fcc8fb2d146a4b685dae1046aa28f
symbol_refs: []
semantic_role: content
:::
:::

::: diagram
id: DIAG-157573d5d7a6e5d9
chapter: CH-01
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: [{'id': 'node_0', 'label': 'Application'}, {'id': 'node_1', 'label': 'Query ‚ñº ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê OPA     ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ Policies'}, {'id': 'node_2', 'label': 'OPA     ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ Policies'}, {'id': 'node_3', 'label': 'Decision ‚ñº ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê Result'}, {'id': 'node_4', 'label': 'Result'}]
edges: []
normalized_content: [Application]
[Query ‚ñº ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê OPA     ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ Policies]
[OPA     ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂ Policies]
[Decision ‚ñº ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê Result]
[Result]
digest: 7297e939c78738599cb5ec1d32e37efd10f737b13cbc734281354817c1f2ea6b
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ Application ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Query
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ     OPA     ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ Policies ‚îÇ
‚îÇ   Engine    ‚îÇ     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ Decision
       ‚ñº
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Result    ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
:::

::: test-hint
id: TEST-b115a71ce58827de
chapter: CH-01
source_id: CODE-83a1975da93b48d8
digest: ae94a462661b2f1c5a425e0545f4c92f7a9244480a2888eb7582990265a2230c
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-f423b49a69d60e13
chapter: CH-01
source_id: CODE-64edda5a1e638eac
digest: 71cdcd8176ee0026596359ca46c849802b6ad8bafe59fe5cbda91b476764ee8d
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: section-meta
id: SECMETA-1238e5d26f0d67ba
title: 1.1 Why Policy as Code?
level: 3
chapter: CH-01
parent_section: None
line_no: 33
digest: b047f4b96f0f561271239b4161ec3f2861024a659c071fc9aeeb0bd9f6a62fa3
symbol_refs: []
semantic_role: structure
token_range: (33, 33)
char_offset: (2560, 2583)
source_ref: {'line': 33, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-797da4c9ba7471c4
title: 1.2 What is OPA?
level: 3
chapter: CH-01
parent_section: None
line_no: 65
digest: 2e1e750fcfa44496bd96ff1c5f198e4dd6a8e28fb06787482e97be758976686e
symbol_refs: []
semantic_role: structure
token_range: (65, 65)
char_offset: (5120, 5136)
source_ref: {'line': 65, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-c0c1d1abefaa244f
title: 1.3 What is Rego?
level: 3
chapter: CH-01
parent_section: None
line_no: 122
digest: 63229bf34ed6490c40cb6cdeb0b22580b543726a2e3784991cdd5ad63f8535bc
symbol_refs: []
semantic_role: structure
token_range: (122, 122)
char_offset: (9680, 9697)
source_ref: {'line': 122, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-d723c6e314c4b8fc
title: 1.4 The OPA Ecosystem
level: 3
chapter: CH-01
parent_section: None
line_no: 168
digest: 95b01a104e30add293650763162dc66c6376476403f8dd424af15a0f9802a24a
symbol_refs: []
semantic_role: structure
token_range: (168, 168)
char_offset: (13360, 13381)
source_ref: {'line': 168, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-52f0b79a221e0655
name: Modern Syntax (OPA 1.0+)
definition: - `import rego.v1` enables modern keywords by default - Keywords: `if`, `in`, `contains`, `every` - Legacy syntax still supported with `--v0-compatible`
aliases: []
chapter: CH-02
digest: 61d20b87109eaa493c16b9c6ce80f7415238b5f58662a8aa119a73fc478619f4
symbol_refs: [Modern Syntax (OPA 1.0+)]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: - `import rego.v1` enables modern keywords by default - Keywords: `if`, `in`, `contains`, `every` - Legacy syntax still supported with `--v0-compatible`
:::
:::

::: term
id: TERM-d115913513972cee
name: Reserved Keywords
definition: ```
as       default   else      every     false
if       import    in        input     not
null     package   some      true      with
data
```
aliases: []
chapter: CH-02
digest: 4c60d7407577f5f85b638695656d3d3aed09aabcea8cebec20dfb775d7583ce6
symbol_refs: [Reserved Keywords]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ``` as default else every false if import in input not null package some true with data ```
:::
:::

::: term
id: TERM-5bb4dc54be4c3c52
name: Comment Styles
definition: ```rego
# Single-line comment

# Multi-line documentation
# can span several lines
# with consistent indentation

allow if {
    input.user == "admin"  # Inline comment
}
```
aliases: []
chapter: CH-02
digest: 4fb8882be0432bcf0d67d3faeec1800f5ac325691926fc913a0afa8204a6791a
symbol_refs: [Comment Styles]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Single-line comment # Multi-line documentation # can span several lines # with consistent indentation allow if { input.user == "admin" # Inline comment } ```
:::
:::

::: term
id: TERM-c1f015240cf9e498
name: Formatting Tool
definition: ```bash
# Format all files in directory
opa fmt --write .

# Check formatting (CI)
opa fmt --fail .

# Use Rego v1 syntax
opa fmt --rego-v1 --write .
``` When you should use opa fmt 1. Every time you write or modify Rego Just like go fmt or black for Python: ‚Ä¢ run opa fmt -w before committing ‚Ä¢ ensures consistent indentation, spacing, rule structure Use it when: ‚Ä¢ adding new policies ‚Ä¢ editing existing rules ‚Ä¢ refactoring code ‚Ä¢ reviewing a pull request ________________________________________ 2. Automatically in CI Use it in CI to prevent unformatted code from merging. Why? ‚Ä¢ Prevents style drift ‚Ä¢ Prevents person-to-person formatting debates ‚Ä¢ Keeps code reviews focused on logic, not style CI check: opa fmt --diff . Use it when you want CI to enforce a formatting contract. ________________________________________ 3. Before generating OPA bundles or deploying Formatting helps avoid: ‚Ä¢ unnecessary diff churn ‚Ä¢ unreadable bundle changes ‚Ä¢ merge conflicts caused by spacing differences Use it when preparing a release or bundle. ________________________________________ 4. When onboarding new developers New devs often write inconsistent Rego. opa fmt makes their code instantly match the organization‚Äôs style without a learning curve. Use it during: ‚Ä¢ onboarding ‚Ä¢ training ‚Ä¢ AI code generation reviews ________________________________________ 5. After using AI tools (Cursor, ChatGPT, GitHub Copilot, etc.) AI-generated Rego is usually: ‚Ä¢ valid ‚Ä¢ but not formatted to OPA conventions You should run opa fmt immediately after AI/model generation. This is especially true if: ‚Ä¢ you use Prompt Engineering to generate complex Rego ‚Ä¢ Cursor writes policy libraries ‚Ä¢ models generate example data ________________________________________ 6. When converting JSON/YAML schemas into Rego If you auto-generate code (e.g., from OPA schemas), format it afterward so it becomes readable. ________________________________________ 7. Anytime code readability matters Examples: ‚Ä¢ cross-team policy review ‚Ä¢ audits ‚Ä¢ security reviews ‚Ä¢ discussions with legal/compliance teams ‚Ä¢ contract policy negotiations Formatted policies reduce friction with stakeholders. ________________________________________ üö´ When NOT to use it (rare cases) 1. When investigating a bug caused by whitespace or formatting Almost never happens in Rego, but if you're comparing raw text output or diffing a policy artifact to reproduce an issue, you might avoid opa fmt temporarily. 2. If formatting breaks a handcrafted test snapshot If you have an exact string match test involving policy source code, formatting will change the file. But this is extremely rare in real OPA projects.
aliases: []
chapter: CH-02
digest: c67f8805ba3049070d4ff53228a05775b0738e903fd4ab1b0dbbe319f0ed6bba
symbol_refs: [Formatting Tool]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [distribution]
vector_summary: ```bash # Format all files in directory opa fmt --write . # Check formatting (CI) opa fmt --fail . # Use Rego v1 syntax opa fmt --rego-v1 --write . ``` When you should use opa fmt 1. Every time you write or modify Rego Just like go fmt or black for Python: ‚Ä¢ run opa fmt -w before committing ‚Ä¢ ensures consistent indentation, spacing, rule structure Use it when: ‚Ä¢ adding new policies ‚Ä¢ editing existing rules ‚Ä¢ refactoring code ‚Ä¢ reviewing a pull request ________________________________________ 2. Automatically in CI Use it in CI to prevent unformatted code from merging. Why? ‚Ä¢ Prevents style drift ‚Ä¢ Prevents person-to-person formatting debates ‚Ä¢ Keeps code reviews focused on logic, not style CI check: opa fmt --diff . Use it when you want CI to enforce a formatting contract. ________________________________________ 3. Before generating OPA bundles or deploying Formatting helps avoid: ‚Ä¢ unnecessary diff churn ‚Ä¢ unreadable bundle changes ‚Ä¢ merge conflicts caused by spacing differences Use it when preparing a release or bundle. ________________________________________ 4. When onboarding new developers New devs often write inconsistent Rego. opa fmt makes their code instantly match the organization‚Äôs style without a learning curve. Use it during: ‚Ä¢ onboarding ‚Ä¢ training ‚Ä¢ AI code generation reviews ________________________________________ 5. After using AI tools (Cursor, ChatGPT, GitHub Copilot, etc.) AI-generated Rego is usually: ‚Ä¢ valid ‚Ä¢ but not formatted to OPA conventions You should run opa fmt immediately after AI/model generation. This is especially true if: ‚Ä¢ you use Prompt Engineering to generate complex Rego ‚Ä¢ Cursor writes policy libraries ‚Ä¢ models generate example data ________________________________________ 6. When converting JSON/YAML schemas into Rego If you auto-generate code (e.g., from OPA schemas), format it afterward so it becomes readable. ________________________________________ 7. Anytime code readability matters Examples: ‚Ä¢ cross-team policy review ‚Ä¢ audits ‚Ä¢ security reviews ‚Ä¢ discussions with legal/compliance teams ‚Ä¢ contract policy negotiations Formatted policies reduce friction with stakeholders. ________________________________________ üö´ When NOT to use it (rare cases) 1. When investigating a bug caused by whitespace or formatting Almost never happens in Rego, but if you're comparing raw text output or diffing a policy artifact to reproduce an issue, you might avoid opa fmt temporarily. 2. If formatting breaks a handcrafted test snapshot If you have an exact string match test involving policy source code, formatting will change the file. But this is extremely rare in real OPA projects.
:::
:::

::: term
id: TERM-4615466792d8d6d3
name: Canonical Style
definition: - Use tabs for indentation (OPA default) - 120 character line limit - Blank line between rules - Space after `if` keyword - Consistent spacing around operators
aliases: []
chapter: CH-02
digest: fd7efa03d99c64f6328537f039100142a275ce92722ca916c82e685bb65cedf2
symbol_refs: [Canonical Style]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: - Use tabs for indentation (OPA default) - 120 character line limit - Blank line between rules - Space after `if` keyword - Consistent spacing around operators
:::
:::

::: term
id: TERM-4bbf4058a9f58147
name: Queryable Metadata
definition: ```rego
rule_metadata := rego.metadata.rule()
chain_metadata := rego.metadata.chain()
``` ---
aliases: []
chapter: CH-02
digest: 352140420a373a0072be60f015ca0a8831ca25e7aca30bb65622fca60f55e32c
symbol_refs: [Queryable Metadata]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego rule_metadata := rego.metadata.rule() chain_metadata := rego.metadata.chain() ``` ---
:::
:::

::: concept
id: CODE-eb4e22abb4667ba3
chapter: CH-02
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
explanation: scope: document
confidence: 0.9
digest: c0e823856d36fc15b96f5fa8851319e4164ea0d5752994d2d6612486a04e53f7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
vector_summary: package authz.api
:::
package authz.api

:::

::: fact
id: BLK-f06f72fec6a23bfd
summary: A Rego module consists of three components:.
digest: cc1b435db0a02c2d18a2b17021d326b62e4daf8eb4c9d2f76048485dc3254f90
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A Rego module consists of three components:..
vector_summary: A Rego module consists of three components:.
chapter: CH-02
:::
A Rego module consists of three components:
:::

::: fact
id: BLK-b1486f7db7792024
summary: When you should use opa fmt 1.
digest: deba12ec75cc63dbe7a179e9659b155d9b55fed613efc15d6d339863f8b1a446
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When you should use opa fmt 1..
semantic_categories: [distribution]
vector_summary: When you should use opa fmt 1.
chapter: CH-02
:::
When you should use opa fmt 1. Every time you write or modify Rego Just like go fmt or black for Python: ‚Ä¢ run opa fmt -w before committing ‚Ä¢ ensures consistent indentation, spacing, rule structure Use it when: ‚Ä¢ adding new policies ‚Ä¢ editing existing rules ‚Ä¢ refactoring code ‚Ä¢ reviewing a pull request ________________________________________ 2. Automatically in CI Use it in CI to prevent unformatted code from merging. Why? ‚Ä¢ Prevents style drift ‚Ä¢ Prevents person-to-person formatting debates ‚Ä¢ Keeps code reviews focused on logic, not style CI check: opa fmt --diff . Use it when you want CI to enforce a formatting contract. ________________________________________ 3. Before generating OPA bundles or deploying Formatting helps avoid: ‚Ä¢ unnecessary diff churn ‚Ä¢ unreadable bundle changes ‚Ä¢ merge conflicts caused by spacing differences Use it when preparing a release or bundle. ________________________________________ 4. When onboarding new developers New devs often write inconsistent Rego. opa fmt makes their code instantly match the organization‚Äôs style without a learning curve. Use it during: ‚Ä¢ onboarding ‚Ä¢ training ‚Ä¢ AI code generation reviews ________________________________________ 5. After using AI tools (Cursor, ChatGPT, GitHub Copilot, etc.) AI-generated Rego is usually: ‚Ä¢ valid ‚Ä¢ but not formatted to OPA conventions You should run opa fmt immediately after AI/model generation. This is especially true if: ‚Ä¢ you use Prompt Engineering to generate complex Rego ‚Ä¢ Cursor writes policy libraries ‚Ä¢ models generate example data ________________________________________ 6. When converting JSON/YAML schemas into Rego If you auto-generate code (e.g., from OPA schemas), format it afterward so it becomes readable. ________________________________________ 7. Anytime code readability matters Examples: ‚Ä¢ cross-team policy review ‚Ä¢ audits ‚Ä¢ security reviews ‚Ä¢ discussions with legal/compliance teams ‚Ä¢ contract policy negotiations Formatted policies reduce friction with stakeholders. ________________________________________ üö´ When NOT to use it (rare cases) 1. When investigating a bug caused by whitespace or formatting Almost never happens in Rego, but if you're comparing raw text output or diffing a policy artifact to reproduce an issue, you might avoid opa fmt temporarily. 2. If formatting breaks a handcrafted test snapshot If you have an exact string match test involving policy source code, formatting will change the file. But this is extremely rare in real OPA projects.
:::

::: example
id: CODE-8d7b448579651102
language: rego
chapter: CH-02
source: term:Reserved Keywords
purpose: definition-example
digest: 5a543013049dc09bf10e4762c1fc768ef68d1cc168be6a25ddab15fd239eafb0
symbol_refs: [in, some]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
as       default   else      every     false
if       import    in        input     not
null     package   some      true      with
data
:::

::: example
id: CODE-feca7c6c91b820bb
language: bash
chapter: CH-02
source: term:Formatting Tool
purpose: definition-example
digest: c9699c071b95446312da163982b988f1eaa9840bc76abd55dfaf8c9ab4de776c
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Format all files in directory
opa fmt --write .

# Check formatting (CI)
opa fmt --fail .

# Use Rego v1 syntax
opa fmt --rego-v1 --write .
:::

::: example
id: CODE-b53a3bf42bfabaf9
language: rego
chapter: CH-02
source: term:Queryable Metadata
purpose: definition-example
digest: a7044033fe7286fee67a63c72c354bf192b47a6fc2ec33ff11e14db9ccaa03e9
symbol_refs: [rule_metadata, chain_metadata]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
rule_metadata := rego.metadata.rule()
chain_metadata := rego.metadata.chain()
:::

::: example
id: CODE-8c5d54970e116521
chapter: CH-02
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
explanation: Single-line comment
confidence: 0.9
digest: 366739371bda76faab5819415945276045352bebe7055ce27f5a27d74d3cac23
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
:::

::: example
id: CODE-0fae084775ed560e
chapter: CH-02
language: bash
role: example
tags: []
explanation: Format all files in directory
confidence: 0.9
digest: ab64e13bb26bf99d364256656fd0da4a00f21faab46796ec208611a8e5d037a8
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
opa fmt --write .

:::

::: example
id: CODE-22378fa3e5975cce
chapter: CH-02
language: bash
role: example
tags: []
explanation: Check formatting (CI)
confidence: 0.9
digest: a26003931e909f0e3b4d2c967b76c40f21c9b2a6698f66318bd914f82d692c3c
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
opa fmt --fail .

:::

::: example
id: CODE-be520f15f84e9ee8
chapter: CH-02
language: bash
role: example
tags: []
explanation: Use Rego v1 syntax
confidence: 0.9
digest: 5b4a11eacfe2754f3794e9433167e19fb1b92edef11f976549aeba432ee64417
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
opa fmt --rego-v1 --write .
:::

::: example
id: CODE-7c30e9d59af87e8a
chapter: CH-02
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
explanation: scope: rule
confidence: 0.9
digest: 2ef74637335b6a131c7c59bf825b44658706e2bac94d98b35fb53e36a2cc60d2
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
allow if {
    _is_admin
}
:::

::: code-pattern
id: CODE-9a303317da8e5b55
language: rego
chapter: CH-02
source: term:Comment Styles
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: c5ed7067064b1bbc9472eda7539e4533bea440a480c659a3879fe06d805e1e2e
symbol_refs: [user]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Single-line comment

# Multi-line documentation
# can span several lines
# with consistent indentation

allow if {
    input.user == "admin"  # Inline comment
}
:::

::: code-pattern
id: CODE-7aedf32081653252
chapter: CH-02
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule, rule_head, allow]
pattern_type: rule_head
pattern_subtype: allow
pattern_metadata: {'rule_type': 'allow'}
digest: c4bcb7d3d64287745d387bf10ca7f8213ab6b403d58400ba9c600105d1772903
symbol_refs: [method, allow, http.authz, Declaration, data.users, input.request, path, role, rego.v1]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
# 1. Package Declaration (required)
package http.authz

# 2. Imports (optional)
import rego.v1
import data.users
import input.request as req

# 3. Rules (policy logic)
default allow := false

allow if {
    input.user.role == "admin"
}

allow if {
    input.method == "GET"
    input.path == "/public"
}
:::

::: code-pattern
id: CODE-957fbe78b55be1dc
chapter: CH-02
language: ebnf
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: 97cf72a70e06fef5f459dc83e3d7132845eb6972843facc54ed28f5c37d77fff
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
module     ::= package { import } policy
package    ::= "package" ref
import     ::= "import" ref [ "as" var ]
policy     ::= { rule }

rule       ::= [ "default" ] rule-name [ rule-key ] [ rule-value ] [ "if" ] rule-body
rule-name  ::= var | ref
rule-key   ::= "[" term "]" | "contains" term
rule-value ::= "=" term | ":=" term
rule-body  ::= "{" query "}" | literal

query      ::= literal { ( ";" | LF ) literal }
literal    ::= ( some-decl | expr | "not" expr ) { with-modifier }
with-modifier ::= "with" term "as" term
some-decl  ::= "some" var { "," var } [ "in" expr ]

expr       ::= term
             | expr infix-operator expr
             | unary-operator expr
             | call-expr
             | "(" expr ")"
             | "every" var [ "," var ] "in" expr "{" query "}"

call-expr  ::= ref "(" [ term { "," term } ] ")"

term       ::= ref | var | scalar | array | object | set
             | array-compr | object-compr | set-compr

array-compr  ::= "[" term "|" query "]"
set-compr    ::= "{" term "|" query "}"
object-compr ::= "{" object-item "|" query "}"

infix-operator ::= ":=" | "=" | "==" | "!=" | "<" | ">" | ">=" | "<="
                 | "+" | "-" | "*" | "/" | "%" | "&" | "|" | "in"

unary-operator ::= "-"

ref      ::= ref-base { ref-arg }
ref-base ::= var | call-expr
ref-arg  ::= "." var | "[" ( scalar | var | array | object | set | "_" ) "]"

var      ::= ( ALPHA | "_" ) { ALPHA | DIGIT | "_" }
scalar   ::= string | NUMBER | TRUE | FALSE | NULL
string   ::= STRING | raw-string
raw-string ::= "`" { CHAR-"`" } "`"

array    ::= "[" [ term { "," term } ] "]"
object   ::= "{" [ object-item { "," object-item } ] "}"
object-item ::= ( scalar | var | ref ) ":" term
set      ::= "{" term { "," term } "}" | "set(" ")"
:::

::: code-pattern
id: CODE-64d3f0b391064236
chapter: CH-02
language: 
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: 5172c819069dbe629ddade89895f0d55cab1604190fdceb2d54d8c15a6df7918
symbol_refs: [in, some]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
as       default   else      every     false
if       import    in        input     not
null     package   some      true      with
data
:::

::: code-pattern
id: CODE-322fb8a04486fb51
chapter: CH-02
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
explanation: with consistent indentation
confidence: 0.9
pattern_type: authorization
pattern_subtype: allow-rule
digest: 594623381b1b2e4a5a48d4900f74a9c1849ef3a0006c18729999a55b79e51ac9
symbol_refs: [user]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::

allow if {
    input.user == "admin"  # Inline comment
}
:::

::: code-pattern
id: CODE-fa97df2a115ae029
chapter: CH-02
language: rego
role: code-pattern:introspection:metadata
tags: [introspection, metadata]
pattern_type: introspection
pattern_subtype: metadata
digest: 9b72800c6584758c493512178a650a8d971cd8b6d4b7254643a19e21c8ec4347
symbol_refs: [rule_metadata, chain_metadata]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
rule_metadata := rego.metadata.rule()
chain_metadata := rego.metadata.chain()
:::

::: code-pattern
id: CODEPAT-18de754d54a89727
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-02
metadata: {'rule_type': 'allow'}
digest: d25914bec9a498f6cf8709fd249cbb6e1d7f7da3baeb93c85e0a1a617c4b14f2
symbol_refs: [method, allow, http.authz, Declaration, data.users, input.request, path, role, rego.v1]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# 1. Package Declaration (required)
package http.authz

# 2. Imports (optional)
import rego.v1
import data.users
import input.request as req

# 3. Rules (policy logic)
default allow := false

allow if {
    input.user.role == "admin"
}

allow if {
    input.method == "GET"
    input.path == "/public"
}
:::

::: code-pattern
id: CODEPAT-0e4d8c6bea763dc2
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-02
metadata: {'rule_type': 'allow'}
digest: fb3fcada68709bde98c69578286b43d411970b931819a38ff69045a443956ec9
symbol_refs: [user]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Single-line comment

# Multi-line documentation
# can span several lines
# with consistent indentation

allow if {
    input.user == "admin"  # Inline comment
}
:::

::: code-pattern
id: CODEPAT-25e513db069ef052
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow, rule_head, allow]
chapter: CH-02
metadata: {'rule_type': 'allow'}
pattern_metadata: {'rule_type': 'allow'}
digest: 56e2eb1d7e125fe8535db0681cc903eb51ca445a92d0ca062e9ccbd7c0e4f7d4
symbol_refs: [organizations, allow, authz.api, title, description, scope, authors]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
# METADATA
# title: API Authorization Policy
# description: Controls access to API resources based on user roles
# authors:
# - Security Team <security@example.com>
# organizations:
# - Example Corp
# scope: document
package authz.api

# METADATA
# title: Admin Access Rule
# description: Grants full access to users with admin role
# scope: rule
allow if {
    _is_admin
}
:::

::: constraint
id: CONSTR-e5e31823e1332fbc
chapter: CH-02
source_id: TERM-c1f015240cf9e498
type: forbidden
digest: f51e736bd24d0cfb6b52873d1086f663b7c647156460b679aa0632978c06b86b
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-4ea7df8660066877
chapter: CH-02
source_id: BLK-b1486f7db7792024
type: forbidden
digest: 51fbd5adf694e56a42d74c178a397f9d12e29b58805f3b081c2a6947693f4dfa
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-ba584378b51cb500
chapter: CH-02
source_id: QA-d7ce616063104277
type: forbidden
digest: 972f619100d5ffc0e6e8d6cd14289657448c271abd522d66a4ae5ee441fd5253
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: table
id: TABLE-2bfcb4b007b1266d
chapter: CH-02
type: dos-donts
headers: [Do, Don't]
rows: [['A Rego module consists of three components:.', ''], ['When you should use opa fmt 1.', '']]
digest: e3bb545aa84789002f80542fc8beabe1cb991c0d52f43c269e500e5116e74513
symbol_refs: []
semantic_role: reference
:::
| Do | Don't |
| --- | --- |
| A Rego module consists of three components:. |  |
| When you should use opa fmt 1. |  |
:::

::: qa
id: QA-2c6d00b5a79e022f
chapter: CH-02
q: What is Modern Syntax (OPA 1.0+) in the context of Rego/OPA?
a: - `import rego.v1` enables modern keywords by default - Keywords: `if`, `in`, `contains`, `every` - Legacy syntax still supported with `--v0-compatible`
reference: TERM-52f0b79a221e0655
digest: 97d4c306f9578a36150159def58379833218240a4a96a1c931f06ec783463ca9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9764d1213daa5f20
chapter: CH-02
q: What is Reserved Keywords in the context of Rego/OPA?
a: ```
reference: TERM-d115913513972cee
digest: 0ce0039fc2dcdb7406ce9a771d9739678e49f9422376beb3a36e0f6646546d40
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-63f4195cf9cccb48
chapter: CH-02
q: What is Comment Styles in the context of Rego/OPA?
a: ```rego
reference: TERM-5bb4dc54be4c3c52
digest: af3739401bf08739449ef6edade9d3dd94436673a9e5b27addaf9cc81c50f906
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8d52f8a67fbb32c0
chapter: CH-02
q: What is Formatting Tool in the context of Rego/OPA?
a: ```bash
reference: TERM-c1f015240cf9e498
digest: 318d7dc152ece20ebf76d1c34b337623ee986dc7075b62c41097577963c3bbf0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5a3dedf83ae643b6
chapter: CH-02
q: What is Canonical Style in the context of Rego/OPA?
a: - Use tabs for indentation (OPA default) - 120 character line limit - Blank line between rules - Space after `if` keyword - Consistent spacing around operators
reference: TERM-4615466792d8d6d3
digest: 2dee64e3339b89837f758749f19179cff5bb8bbb24f2ae070a32f174c18487cb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-28212cff411dd060
chapter: CH-02
q: What is Queryable Metadata in the context of Rego/OPA?
a: ```rego
reference: TERM-4bbf4058a9f58147
digest: 56b513725ed8e45cdecd3331e8f65649933b1f1e0b3ef5828727a642254b6b6a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8bab5b1175ef4bdb
chapter: CH-02
q: What is A Rego module consists of three components in the context of Rego/OPA?
a: A Rego module consists of three components:
reference: BLK-f06f72fec6a23bfd
digest: 7894757a99eb0fcdb6deb96daba4427c5a2d250f28d39fd0daea3b8dd09c98d4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d7ce616063104277
chapter: CH-02
q: What is When you should use opa fmt 1. in the context of Rego/OPA?
a: When you should use opa fmt 1. Every time you write or modify Rego Just like go fmt or black for Python: ‚Ä¢ run opa fmt -w before committing ‚Ä¢ ensures consistent indentation, spacing, rule structure Use it when: ‚Ä¢ adding new policies ‚Ä¢ editing existing rules ‚Ä¢ refactoring code ‚Ä¢ reviewing a pull request ________________________________________ 2. Automatically in CI Use it in CI to prevent unformatted code from merging. Why? ‚Ä¢ Prevents style drift ‚Ä¢ Prevents person-to-person formatting debates ‚Ä¢ Keeps code reviews focused on logic, not style CI check: opa fmt --diff . Use it when you want CI to enforce a formatting contract. ________________________________________ 3. Before generating OPA bundles or deploying Formatting helps avoid: ‚Ä¢ unnecessary diff churn ‚Ä¢ unreadable bundle changes ‚Ä¢ merge conflicts caused by spacing differences Use it when preparing a release or bundle. ________________________________________ 4. When onboarding new developers New devs often write inconsistent Rego. opa fmt makes their code instantly match the organization‚Äôs style without a learning curve. Use it during: ‚Ä¢ onboarding ‚Ä¢ training ‚Ä¢ AI code generation reviews ________________________________________ 5. After using AI tools (Cursor, ChatGPT, GitHub Copilot, etc.) AI-generated Rego is usually: ‚Ä¢ valid ‚Ä¢ but not formatted to OPA conventions You should run opa fmt immediately after AI/model generation. This is especially true if: ‚Ä¢ you use Prompt Engineering to generate complex Rego ‚Ä¢ Cursor writes policy libraries ‚Ä¢ models generate example data ________________________________________ 6. When converting JSON/YAML schemas into Rego If you auto-generate code (e.g., from OPA schemas), format it afterward so it becomes readable. ________________________________________ 7. Anytime code readability matters Examples: ‚Ä¢ cross-team policy review ‚Ä¢ audits ‚Ä¢ security reviews ‚Ä¢ discussions with legal/compliance teams ‚Ä¢ contract policy negotiations Formatted policies reduce friction with stakeholders. ________________________________________ üö´ When NOT to use it (rare cases) 1. When investigating a bug caused by whitespace or formatting Almost never happens in Rego, but if you're comparing raw text output or diffing a policy artifact to reproduce an issue, you might avoid opa fmt temporarily. 2. If formatting breaks a handcrafted test snapshot If you have an exact string match test involving policy source code, formatting will change the file. But this is extremely rare in real OPA projects.
reference: BLK-b1486f7db7792024
semantic_categories: [distribution]
digest: fbe1308eb297091553150218fbac9b38f05c7783684c61819ad64220993c346f
symbol_refs: []
semantic_role: explanation
:::
:::

::: reasoning-chain
id: CHAIN-e120d521c9947f35
chapter: CH-02
qa_id: QA-2c6d00b5a79e022f
reference: TERM-52f0b79a221e0655
semantic_categories: [truth-values]
digest: 97892690bdcac413efce444d0048c34d358929f2bfed1e59fd2c4ca9ec927c94
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-14be037e22a486c1
chapter: CH-02
qa_id: QA-9764d1213daa5f20
reference: TERM-d115913513972cee
semantic_categories: [truth-values]
digest: 183d94c0e662d2d50bba0c99f48b17f70ab7eedb217125f24108868c25de814e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c2efe49ee1153bea
chapter: CH-02
qa_id: QA-63f4195cf9cccb48
reference: TERM-5bb4dc54be4c3c52
semantic_categories: [truth-values]
digest: a425b03516380f4df30226d435bf6dbc37aa3dffe7592b9da28498b0b75cf585
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e834b95ad09d6f16
chapter: CH-02
qa_id: QA-8d52f8a67fbb32c0
reference: TERM-c1f015240cf9e498
semantic_categories: [truth-values]
digest: 20201bddc30f5ab5cafa1c81dbcbbd31aff830097e70619f963af5c86ae667e4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c7de1374415cdbfc
chapter: CH-02
qa_id: QA-5a3dedf83ae643b6
reference: TERM-4615466792d8d6d3
semantic_categories: [truth-values]
digest: 51192655a0a72cf320077eeecc7cfc3bfa38ba98b6a28050adbefae8db62951e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4f2722074eb012a0
chapter: CH-02
qa_id: QA-28212cff411dd060
reference: TERM-4bbf4058a9f58147
semantic_categories: [truth-values]
digest: d21c96946b796e57a0bb3a0a41b3746c024d81bfbc68bdf3312eb20f2b77ce2d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-61f87bba2a79c3f3
chapter: CH-02
qa_id: QA-8bab5b1175ef4bdb
reference: BLK-f06f72fec6a23bfd
semantic_categories: [truth-values]
digest: df9ddb4c7a31ed8408e7ad1c3393d5d8c2d3e8546b1a82964e7ee3ae58c2c583
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cf6fa78e610e6520
chapter: CH-02
qa_id: QA-d7ce616063104277
reference: BLK-b1486f7db7792024
semantic_categories: [truth-values]
digest: bb661f2448bdbfdf74a0201aa9111108e3a8d972c333858746a708876d8a59d4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: role-note
id: ROLE-4e759a827b205998
chapter: CH-02
role: Policy Author
guidance: Focus on correctness & clarity of rules in this chapter.
digest: 5b011dac1809183412c69cef77c0c83125daee55cc9cd362cd0dac5724db2096
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-2941a84c8cd9b0a8
chapter: CH-02
role: Security Reviewer
guidance: Look for unsafe patterns, missing deny cases, misuse of negation.
semantic_categories: [negation]
digest: bd3a8efdc23d32d67e9e3b8c1ed3962f80a2278981746fcc08c2c9ce16eb72c8
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-b18755f4d1e4f78d
chapter: CH-02
role: Performance Engineer
guidance: Identify heavy comprehensions and opportunities for partial evaluation.
semantic_categories: [performance]
digest: 15acb264f72e09fb03017adaf59de1a5707f39d660c34fa3eca0e59d8265af4a
symbol_refs: []
semantic_role: content
:::
:::

::: diagram
id: DIAG-a41275c6925dc440
chapter: CH-02
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 331a708a14757f535937d1ebdcf3aa3236fe10b5d1bfb446634a39fb943e79f2
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
module     ::= package { import } policy
package    ::= "package" ref
import     ::= "import" ref [ "as" var ]
policy     ::= { rule }

rule       ::= [ "default" ] rule-name [ rule-key ] [ rule-value ] [ "if" ] rule-body
rule-name  ::= var | ref
rule-key   ::= "[" term "]" | "contains" term
rule-value ::= "=" term | ":=" term
rule-body  ::= "{" query "}" | literal

query      ::= literal { ( ";" | LF ) literal }
literal    ::= ( some-decl | expr | "not" expr ) { with-modifier }
with-modifier ::= "with" term "as" term
some-decl  ::= "some" var { "," var } [ "in" expr ]

expr       ::= term
             | expr infix-operator expr
             | unary-operator expr
             | call-expr
             | "(" expr ")"
             | "every" var [ "," var ] "in" expr "{" query "}"

call-expr  ::= ref "(" [ term { "," term } ] ")"

term       ::= ref | var | scalar | array | object | set
             | array-compr | object-compr | set-compr

array-compr  ::= "[" term "|" query "]"
set-compr    ::= "{" term "|" query "}"
object-compr ::= "{" object-item "|" query "}"

infix-operator ::= ":=" | "=" | "==" | "!=" | "<" | ">" | ">=" | "<="
                 | "+" | "-" | "*" | "/" | "%" | "&" | "|" | "in"

unary-operator ::= "-"

ref      ::= ref-base { ref-arg }
ref-base ::= var | call-expr
ref-arg  ::= "." var | "[" ( scalar | var | array | object | set | "_" ) "]"

var      ::= ( ALPHA | "_" ) { ALPHA | DIGIT | "_" }
scalar   ::= string | NUMBER | TRUE | FALSE | NULL
string   ::= STRING | raw-string
raw-string ::= "`" { CHAR-"`" } "`"

array    ::= "[" [ term { "," term } ] "]"
object   ::= "{" [ object-item { "," object-item } ] "}"
object-item ::= ( scalar | var | ref ) ":" term
set      ::= "{" term { "," term } "}" | "set(" ")"
:::

::: test-hint
id: TEST-73dc3062ddbcf796
chapter: CH-02
source_id: CODE-9a303317da8e5b55
digest: f7a54e697e111f4c8e5e5a5df05d4ce2e24dbfa429e62d0e79f4c8c62fcb3ac4
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-9e8d5e532600202c
chapter: CH-02
source_id: CODE-7aedf32081653252
digest: 5c8e330acfce6aef5b82ff88f375dbd72856e0f4ef0103c9e35f4e5ceb0ea820
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-ff6fdd5ea22c36d9
chapter: CH-02
source_id: CODE-322fb8a04486fb51
digest: fbbe0b9d62274e63418eb2b814e2d9c5754b4790743a33dddd66db3a6c72ac33
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-8d17a65983ed39b1
chapter: CH-02
source_id: CODE-7c30e9d59af87e8a
digest: 16ffbd708312de40bb062f72a87a05a827ac605efdbb0343a93f20aac35473a5
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-6165d1e7b876578c
chapter: CH-02
source_id: CODEPAT-18de754d54a89727
digest: 483d52a2781dc2c84ca571c4f10179ab459d01e9834c6fdcb7a1d1f7205837f1
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-924ddea327325469
chapter: CH-02
source_id: CODEPAT-0e4d8c6bea763dc2
digest: 4275487d536927d3730b284343613160cbcaf2060ac19e4d10a5dc9852848f20
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-bc045ef8de548e95
chapter: CH-02
source_id: CODEPAT-25e513db069ef052
digest: 95d1dcfbe13bf76421c739eeada72ca5bc66e9342427b0661670c44822d3add3
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: section-meta
id: SECMETA-751debbcfeceab1d
title: 2.1 Syntax Overview
level: 3
chapter: CH-02
parent_section: None
line_no: 191
digest: 2f6aad905a0ff70d5433a6f281754e481a6f6b86bb763319902b422e1d824e4a
symbol_refs: []
semantic_role: structure
token_range: (191, 191)
char_offset: (15200, 15219)
source_ref: {'line': 191, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-d2199576773ec710
title: 2.2 Grammar (Complete EBNF)
level: 3
chapter: CH-02
parent_section: None
line_no: 222
digest: 749345766e4d2641e2b6aa45e1a23847e01fc75393af906b8cd6c322b10246fe
symbol_refs: []
semantic_role: structure
token_range: (222, 222)
char_offset: (17680, 17707)
source_ref: {'line': 222, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-dcb5289fe5d75b7a
title: 2.3 Comments and Formatting
level: 3
chapter: CH-02
parent_section: None
line_no: 285
digest: 95d8b8597a2763cf5b7ea38c2adf3ea1f5efeab3b403606111684e11387a9139
symbol_refs: []
semantic_role: structure
token_range: (285, 285)
char_offset: (22720, 22747)
source_ref: {'line': 285, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-e64d7e236f43e79d
title: 2.4 Metadata Annotations
level: 3
chapter: CH-02
parent_section: None
line_no: 385
digest: 7c5ccb69352672f09e764d738feeb04a41a4752ea8c7c0dca737c68059e0859a
symbol_refs: []
semantic_role: structure
token_range: (385, 385)
char_offset: (30720, 30744)
source_ref: {'line': 385, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-7055bd73b15a8d51
name: Example Request
definition: ```json
{
  "input": {
    "user": {
      "id": "alice",
      "role": "developer",
      "department": "engineering"
    },
    "resource": {
      "type": "repository",
      "id": "backend-api",
      "owner": "engineering"
    },
    "action": "push"
  }
}
```
aliases: []
chapter: CH-03
digest: fe4ab9d8217bc44f6311541be5a5e28748279997e45bb163fd59bf7a51af0f50
symbol_refs: [Example Request]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```json { "input": { "user": { "id": "alice", "role": "developer", "department": "engineering" }, "resource": { "type": "repository", "id": "backend-api", "owner": "engineering" }, "action": "push" } } ```
:::
:::

::: term
id: TERM-551db8ac49dd585a
name: Rule Categories
definition: 1. **Complete Rules**: Define a single value ```rego
   max_memory := 32
   user_role := "admin"
   ``` 2. **Partial Rules**: Define sets or objects incrementally ```rego
   # Partial Set
   valid_users contains user.id if {
       some user in data.users
       user.active == true
   } # Partial Object
   user_roles[user.id] := user.role if {
       some user in data.users
   }
   ``` 3. **Boolean Rules**: Produce true/undefined ```rego
   allow if {
       input.user.role == "admin"
   }
   ``` 4. **Functions**: Take parameters, return values ```rego
   full_name(user) := concat(" ", [user.first, user.last])
   ```
aliases: []
chapter: CH-03
digest: 486b59ae16d52a667f7d6292e2780eab32f38850d879513e6975185e627912fe
symbol_refs: [Rule Categories]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: 1. **Complete Rules**: Define a single value ```rego max_memory := 32 user_role := "admin" ``` 2. **Partial Rules**: Define sets or objects incrementally ```rego # Partial Set valid_users contains user.id if { some user in data.users user.active == true } # Partial Object user_roles[user.id] := user.role if { some user in data.users } ``` 3. **Boolean Rules**: Produce true/undefined ```rego allow if { input.user.role == "admin" } ``` 4. **Functions**: Take parameters, return values ```rego full_name(user) := concat(" ", [user.first, user.last]) ```
:::
:::

::: term
id: TERM-1ff5b74d10590506
name: Key Principle
definition: Rego is **declarative, not procedural** ```
Procedural: Execute step-by-step
Declarative: Find all valid solutions
```
aliases: []
chapter: CH-03
digest: a48620911466797517f2a05adfe94c2debbc2627af30d8b75b421ad8bf1a39c0
symbol_refs: [Key Principle]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: Rego is **declarative, not procedural** ``` Procedural: Execute step-by-step Declarative: Find all valid solutions ```
:::
:::

::: term
id: TERM-e6fabf6d604d1fda
name: Evaluation Process
definition: 1. **Parse**: Convert Rego text to AST 2. **Compile**: Build evaluation plan 3. **Ground**: Bind variables systematically 4. **Unify**: Match patterns and values 5. **Search**: Explore all possibilities 6. **Collect**: Gather valid solutions
aliases: []
chapter: CH-03
digest: d547f664f7dd0b41dd1e3c2dc7cbcc54c9322eafb8e9dae0ec9bff2e20dfc8b4
symbol_refs: [Evaluation Process]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: 1. **Parse**: Convert Rego text to AST 2. **Compile**: Build evaluation plan 3. **Ground**: Bind variables systematically 4. **Unify**: Match patterns and values 5. **Search**: Explore all possibilities 6. **Collect**: Gather valid solutions
:::
:::

::: term
id: TERM-92a5159f8cfe0c6d
name: Example Evaluation
definition: ```rego
allow if {
    some role in input.user.roles
    role == "admin"
}
```
aliases: []
chapter: CH-03
digest: 389db54724bd7f6dbc2386399b35ee9f990a62b61739d1ead44df4a4386a2111
symbol_refs: [Example Evaluation]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego allow if { some role in input.user.roles role == "admin" } ```
:::
:::

::: term
id: TERM-088aaea9f3496bc5
name: Evaluation Steps
definition: 1. Access `input.user.roles` (e.g., `["developer", "admin"]`) 2. Iterate: bind `role` to `"developer"`, then `"admin"` 3. Check `role == "admin"` for each binding 4. Return `true` when binding succeeds
aliases: []
chapter: CH-03
digest: b581189374fdc3f7d826f5606b96040019e027b452d894e3cd42a3052fd68dd9
symbol_refs: [Evaluation Steps]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: 1. Access `input.user.roles` (e.g., `["developer", "admin"]`) 2. Iterate: bind `role` to `"developer"`, then `"admin"` 3. Check `role == "admin"` for each binding 4. Return `true` when binding succeeds
:::
:::

::: term
id: TERM-c1b4c571376282e8
name: Critical Insight
definition: Order of expressions is **semantically irrelevant**: ```rego
# These are equivalent
allow if {
    role == "admin"
    some role in input.user.roles
}

allow if {
    some role in input.user.roles
    role == "admin"
}
``` However, performance may differ (covered in Chapter 11).
aliases: []
chapter: CH-03
digest: 47cef96f73d0e28098c96145606213e9bdde81260810413981f06806748fa31c
symbol_refs: [Critical Insight]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: Order of expressions is **semantically irrelevant**: ```rego # These are equivalent allow if { role == "admin" some role in input.user.roles } allow if { some role in input.user.roles role == "admin" } ``` However, performance may differ (covered in Chapter 11).
:::
:::

::: term
id: TERM-f4ed7dd663f1c387
name: Critical Distinction
definition: ```rego
# Returns false explicitly
deny := false if input.user.role != "admin"

# Returns undefined (no rule matches)
deny if input.user.role == "admin"
# When user.role is "developer", deny is undefined, not false
```
aliases: []
chapter: CH-03
digest: cedd84bbace381738e46b137292d394193cfb98a10bd7ad34134dbb2885961ef
symbol_refs: [Critical Distinction]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Returns false explicitly deny := false if input.user.role != "admin" # Returns undefined (no rule matches) deny if input.user.role == "admin" # When user.role is "developer", deny is undefined, not false ```
:::
:::

::: term
id: TERM-525c8cc96d18b909
name: Truth Table
definition: 
aliases: []
chapter: CH-03
digest: a6191507d17df99549dc31543cab403c7d1475aa696c1ddfaded30e6874b2f37
symbol_refs: [Truth Table]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-2cad3572a9870d43
name: Why It Matters
definition: ```rego
# ‚ùå Common mistake
allow if not deny  # Broken if deny is undefined

# ‚úÖ Correct
default deny := false
allow if not deny
```
aliases: []
chapter: CH-03
digest: f34240626ac2e5319e3cc80af4e03389331b911f94c1e7907577f644361ebd05
symbol_refs: [Why It Matters]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # ‚ùå Common mistake allow if not deny # Broken if deny is undefined # ‚úÖ Correct default deny := false allow if not deny ```
:::
:::

::: term
id: TERM-567706b148bc012c
name: Conjunction (AND)
definition: Multiple expressions in one rule body ```rego
allow if {
    expr1  # AND
    expr2  # AND
    expr3  # All must be true
}
```
aliases: []
chapter: CH-03
digest: debf1be307050a063bc63fdd4f294db142d1bb84a5bf2976a004243f78d78ede
symbol_refs: [Conjunction (AND)]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: Multiple expressions in one rule body ```rego allow if { expr1 # AND expr2 # AND expr3 # All must be true } ```
:::
:::

::: term
id: TERM-5b83bf55911a3f71
name: Disjunction (OR)
definition: Multiple rule bodies with same name ```rego
allow if { expr1 }  # OR
allow if { expr2 }  # OR
allow if { expr3 }  # Any can be true
```
aliases: []
chapter: CH-03
digest: 53780931824567910063599e868163c294a0c2711aac07a48c27326bb6897e14
symbol_refs: [Disjunction (OR)]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: Multiple rule bodies with same name ```rego allow if { expr1 } # OR allow if { expr2 } # OR allow if { expr3 } # Any can be true ```
:::
:::

::: term
id: TERM-e76a7caae0bbdc8c
name: Complex Example
definition: ```rego
# (admin OR owner) AND active
allow if {
    input.user.role == "admin"
    input.user.active == true
}

allow if {
    input.resource.owner == input.user.id
    input.user.active == true
}
```
aliases: []
chapter: CH-03
digest: 9d1c7be9f8bae20e09aae39a609cb573d3847f76304937d907bfdfe79bff8638
symbol_refs: [Complex Example]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # (admin OR owner) AND active allow if { input.user.role == "admin" input.user.active == true } allow if { input.resource.owner == input.user.id input.user.active == true } ```
:::
:::

::: term
id: TERM-91c069f0733380d6
name: Complete Rule Conflicts
definition: ```rego
# ‚ùå ERROR: Conflict
max_value := 10 if condition1
max_value := 20 if condition2
# If both conditions true ‚Üí conflict error
```
aliases: []
chapter: CH-03
digest: f402483f7b05649c1e9f2cab6e16852d88081abfb4cb1a078b30bdfc1db73966
symbol_refs: [Complete Rule Conflicts]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # ‚ùå ERROR: Conflict max_value := 10 if condition1 max_value := 20 if condition2 # If both conditions true ‚Üí conflict error ```
:::
:::

::: term
id: TERM-3920245557315136
name: Resolution Strategy
definition: ```rego
# ‚úÖ Use default + conditional override
default max_value := 10
max_value := 20 if high_priority_user
```
aliases: []
chapter: CH-03
digest: 8a55b9747ade26d514ed05d752d9ca6aa90ea5726c998a1b61e9e2270630d750
symbol_refs: [Resolution Strategy]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # ‚úÖ Use default + conditional override default max_value := 10 max_value := 20 if high_priority_user ```
:::
:::

::: term
id: TERM-481545d3975a65fb
name: Partial Rules
definition: No conflicts, values merge ```rego
# ‚úÖ OK: Set accumulates values (union)
admins contains "alice" if alice_is_admin
admins contains "bob" if bob_is_admin
# Result: {"alice", "bob"} if both true
``` **Critical: Set Union Behavior in Partial Rules** Multiple rule bodies with the same partial rule name create a **union** for sets and objects, but this only works when each rule body adds distinct elements. For complete rules (single value), multiple bodies create conflicts. **For Sets (Union Works):** ```rego
# ‚úÖ CORRECT: Each body adds to the set
admins contains "alice" if alice_is_admin
admins contains "bob" if bob_is_admin
# Result: {"alice", "bob"} if both true (union)
``` **For Complete Rules with Sets (Use Comprehensions):** ```rego
# ‚úÖ CORRECT: Single rule with comprehension creates union
_missing_patterns_set(content) := missing_set if {
    missing_set := {
        name |
        some name in ["error_handling", "audit_logging", "structured_logging"]
        not pattern_present(name, content)
    }
}
# This creates a set containing ALL missing patterns

# ‚ùå WRONG: Multiple complete rules with different set values
_missing_patterns_set(content) := {"error_handling"} if { not error_handling }
_missing_patterns_set(content) := {"audit_logging"} if { not audit_logging }
# Problem: These are complete rules (:=), not partial (contains)
# If both conditions true, you get a conflict or non-deterministic selection
# Only ONE value will be chosen, not a union
``` **Key Insight:** - **Partial rules** (`contains`, `[key] := value`): Multiple bodies union automatically - **Complete rules** (`:= value`): Multiple bodies with different values create conflicts or non-deterministic selection - **Best Practice:** For building sets from multiple conditions, use a single rule with a comprehension that unions all possibilities ---
aliases: []
chapter: CH-03
digest: 9d98c61fb66044b5405dd432ebcd27d97926ac536e6f1677fcf952e54161e76b
symbol_refs: [Partial Rules]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: No conflicts, values merge ```rego # ‚úÖ OK: Set accumulates values (union) admins contains "alice" if alice_is_admin admins contains "bob" if bob_is_admin # Result: {"alice", "bob"} if both true ``` **Critical: Set Union Behavior in Partial Rules** Multiple rule bodies with the same partial rule name create a **union** for sets and objects, but this only works when each rule body adds distinct elements. For complete rules (single value), multiple bodies create conflicts. **For Sets (Union Works):** ```rego # ‚úÖ CORRECT: Each body adds to the set admins contains "alice" if alice_is_admin admins contains "bob" if bob_is_admin # Result: {"alice", "bob"} if both true (union) ``` **For Complete Rules with Sets (Use Comprehensions):** ```rego # ‚úÖ CORRECT: Single rule with comprehension creates union _missing_patterns_set(content) := missing_set if { missing_set := { name | some name in ["error_handling", "audit_logging", "structured_logging"] not pattern_present(name, content) } } # This creates a set containing ALL missing patterns # ‚ùå WRONG: Multiple complete rules with different set values _missing_patterns_set(content) := {"error_handling"} if { not error_handling } _missing_patterns_set(content) := {"audit_logging"} if { not audit_logging } # Problem: These are complete rules (:=), not partial (contains) # If both conditions true, you get a conflict or non-deterministic selection # Only ONE value will be chosen, not a union ``` **Key Insight:** - **Partial rules** (`contains`, `[key] := value`): Multiple bodies union automatically - **Complete rules** (`:= value`): Multiple bodies with different values create conflicts or non-deterministic selection - **Best Practice:** For building sets from multiple conditions, use a single rule with a comprehension that unions all possibilities ---
:::
:::

::: concept
id: BLK-480e6ac62d9bdadc
summary: Input Document (input): - Provided per query - Represents current request/context - Typically contains: - User identity and attributes - Resource b...
digest: 703b09414ea1fc15dcb281263f07dd27fb5417e85bdcbdc788c571bdc5c241c1
symbol_refs: [Input Document, input]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Input Document (input): - Provided per query - Represents current request/context - Typically contains: - User identity and attributes - Resource b....
vector_summary: Input Document (input): - Provided per query - Represents current request/context - Typically contains: - User identity and attributes - Resource b...
chapter: CH-03
:::
**Input Document** (`input`): - Provided per query - Represents current request/context - Typically contains: - User identity and attributes - Resource being accessed - Action/operation requested - Environmental context (time, location)
:::

::: concept
id: BLK-dc443db53fff92d3
summary: However, performance may differ (covered in Chapter 11).
digest: 2240d27cd4da24b262ab3a8f4f3e7f1415cb4b370222551c4535f2406690e55f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that However, performance may differ (covered in Chapter 11)..
vector_summary: However, performance may differ (covered in Chapter 11).
chapter: CH-03
:::
However, performance may differ (covered in Chapter 11).
:::

::: concept
id: BLK-8c7716e5431fa29f
summary: For Sets (Union Works):.
digest: 2f49cff68f304db5757de38a0199cc4fb2df77f4831e1d794eccdbc42e334883
symbol_refs: [For Sets (Union Works):]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For Sets (Union Works):..
vector_summary: For Sets (Union Works):.
chapter: CH-03
:::
**For Sets (Union Works):**
:::

::: fact
id: BLK-fca3fe13b2ec32f2
summary: OPA operates on a two-document model:.
digest: 3a2126b2745e673d37b8167bfa449a36da3dfb1324a9b24914eab0a86f3261f5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA operates on a two-document model:..
vector_summary: OPA operates on a two-document model:.
chapter: CH-03
:::
OPA operates on a **two-document model**:
:::

::: fact
id: BLK-0dd280f3e2ee752f
summary: Data Document (data): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configurati...
digest: 29b2a5f67db805f8d505bfc6e1318c3d18e9d4032bef4cf634f92af8e8817086
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Data Document (data): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configurati....
semantic_categories: [distribution]
vector_summary: Data Document (data): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configurati...
chapter: CH-03
:::
**Data Document** (`data`): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configuration - External data from APIs
:::

::: fact
id: BLK-69c0318ca03db573
summary: Rules are logical assertions about your world model.
digest: 683823ebe2502d7aa0f82444dce6dbc11eef5ed9afc71467f7bb2301d6be2079
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rules are logical assertions about your world model..
vector_summary: Rules are logical assertions about your world model.
chapter: CH-03
:::
Rules are **logical assertions** about your world model.
:::

::: fact
id: BLK-90b472c5727ce911
summary: Parse: Convert Rego text to AST 2.
digest: b696f9dc75e75fe7cd2b9810a7263635192ceded1ca4e579ece81c31ea993687
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Parse: Convert Rego text to AST 2..
vector_summary: Parse: Convert Rego text to AST 2.
chapter: CH-03
:::
1. **Parse**: Convert Rego text to AST 2. **Compile**: Build evaluation plan 3. **Ground**: Bind variables systematically 4. **Unify**: Match patterns and values 5. **Search**: Explore all possibilities 6. **Collect**: Gather valid solutions
:::

::: fact
id: BLK-b510316c3c4d2fdc
summary: Critical: Set Union Behavior in Partial Rules.
digest: 5928bfa1d68092a2fbd3c344a48f7dfb906b223332acead50cf474c9c9b36d5f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Critical: Set Union Behavior in Partial Rules..
vector_summary: Critical: Set Union Behavior in Partial Rules.
chapter: CH-03
:::
**Critical: Set Union Behavior in Partial Rules**
:::

::: fact
id: BLK-0d0f670ad5683689
summary: Multiple rule bodies with the same partial rule name create a union for sets and objects, but this only works when each rule body adds distinct ele...
digest: b02c0653a8cceaa76b8e9d085cb6324aa5303a1dadec3f112c8edcf92b33c7e6
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Multiple rule bodies with the same partial rule name create a union for sets and objects, but this only works when each rule body adds distinct ele....
vector_summary: Multiple rule bodies with the same partial rule name create a union for sets and objects, but this only works when each rule body adds distinct ele...
chapter: CH-03
:::
Multiple rule bodies with the same partial rule name create a **union** for sets and objects, but this only works when each rule body adds distinct elements. For complete rules (single value), multiple bodies create conflicts.
:::

::: fact
id: BLK-02fa19270211b5c5
summary: For Complete Rules with Sets (Use Comprehensions):.
digest: 3fe8d90bf27ae80dc3ebbabf66a32ed0ea5f354dd648696c3e8c87a83e8a8f03
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For Complete Rules with Sets (Use Comprehensions):..
vector_summary: For Complete Rules with Sets (Use Comprehensions):.
chapter: CH-03
:::
**For Complete Rules with Sets (Use Comprehensions):**
:::

::: fact
id: BLK-9e14dbd37949da40
summary: Key Insight: - Partial rules (contains, [key] := value): Multiple bodies union automatically - Complete rules (:= value): Multiple bodies with diff...
digest: c9230aba0bc570e27a06250f73cfac60c29c7de67dd8355b8fac75888d854669
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Key Insight: - Partial rules (contains, [key] := value): Multiple bodies union automatically - Complete rules (:= value): Multiple bodies with diff....
vector_summary: Key Insight: - Partial rules (contains, [key] := value): Multiple bodies union automatically - Complete rules (:= value): Multiple bodies with diff...
chapter: CH-03
:::
**Key Insight:** - **Partial rules** (`contains`, `[key] := value`): Multiple bodies union automatically - **Complete rules** (`:= value`): Multiple bodies with different values create conflicts or non-deterministic selection - **Best Practice:** For building sets from multiple conditions, use a single rule with a comprehension that unions all possibilities
:::

::: example
id: CODE-ea5f634c13657a5f
language: json
chapter: CH-03
source: term:Example Request
purpose: definition-example
digest: dee9dc69dc069e81a7ea1c18a40b694c1677096018f6420d03b0df09aaad6af6
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
{
  "input": {
    "user": {
      "id": "alice",
      "role": "developer",
      "department": "engineering"
    },
    "resource": {
      "type": "repository",
      "id": "backend-api",
      "owner": "engineering"
    },
    "action": "push"
  }
}
:::

::: example
id: CODE-8a90234eaba803d9
language: rego
chapter: CH-03
source: term:Rule Categories
purpose: definition-example
digest: 39785280a7c02a24c6f2503ffd8cecf0c788b6a5ae245856a3c387ac478d5fdf
symbol_refs: [user_role, max_memory]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
max_memory := 32
   user_role := "admin"
:::

::: example
id: CODE-49b75c96fe3eceba
language: rego
chapter: CH-03
source: term:Rule Categories
purpose: definition-example
digest: 430d56c5bbaa4e566482f29076d0924596ade70407b3ec0625af88ecd3d5b114
symbol_refs: [active]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Partial Set
   valid_users contains user.id if {
       some user in data.users
       user.active == true
   } # Partial Object
   user_roles[user.id] := user.role if {
       some user in data.users
   }
:::

::: example
id: CODE-754bc28c87fac504
language: rego
chapter: CH-03
source: term:Rule Categories
purpose: definition-example
digest: 70b2dce7ce741734a5bc98768d4058cb262a681368ead7a8659675576ab82d81
symbol_refs: [role]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
allow if {
       input.user.role == "admin"
   }
:::

::: example
id: CODE-e134fa925e8a413c
language: rego
chapter: CH-03
source: term:Rule Categories
purpose: definition-example
digest: 3420c07fbe4731a778746bf6d96f88aed81075a2b672828d12746866be841197
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
full_name(user) := concat(" ", [user.first, user.last])
:::

::: example
id: CODE-a80e1a4c63b47f1c
language: rego
chapter: CH-03
source: term:Key Principle
purpose: definition-example
digest: b43b48c016d309d6566825cf63e6ca02e78b8a2f1b09fe774c25836bd5c344e7
symbol_refs: []
semantic_role: walkthrough
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
Procedural: Execute step-by-step
Declarative: Find all valid solutions
:::

::: example
id: CODE-555d2aff842efec7
language: rego
chapter: CH-03
source: term:Complete Rule Conflicts
purpose: definition-example
digest: 201bc9cd65e07b52e4adaa2f2199be5d482ad9fb52aade083fd12a3716988530
symbol_refs: [max_value]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚ùå ERROR: Conflict
max_value := 10 if condition1
max_value := 20 if condition2
# If both conditions true ‚Üí conflict error
:::

::: example
id: CODE-f3be71b365fb49b3
language: rego
chapter: CH-03
source: term:Resolution Strategy
purpose: definition-example
digest: f641a7bedac796fecf337b4c01330cb1c45ec4b54e69de1cdae9cd1c7b314c5e
symbol_refs: [max_value]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ Use default + conditional override
default max_value := 10
max_value := 20 if high_priority_user
:::

::: example
id: CODE-8f24b7a18a0648d4
language: rego
chapter: CH-03
source: term:Partial Rules
purpose: definition-example
digest: e394f38eb5e62cd6e99fefd95cbebce060636bd7620a058f23ca7f9da36a0a0b
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ OK: Set accumulates values (union)
admins contains "alice" if alice_is_admin
admins contains "bob" if bob_is_admin
# Result: {"alice", "bob"} if both true
:::

::: example
id: CODE-ca436281c06aebde
language: rego
chapter: CH-03
source: term:Partial Rules
purpose: definition-example
digest: afdb6857dfeb0def08ca77e2ca3b18ee1630a393ea2c289db07b3ef59cd09df6
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Each body adds to the set
admins contains "alice" if alice_is_admin
admins contains "bob" if bob_is_admin
# Result: {"alice", "bob"} if both true (union)
:::

::: example
id: CODE-de62385ba8bec777
chapter: CH-03
language: 
role: example
tags: []
digest: f7c61fff1962eda8d05c704f858b9432008ebdb8aeb0a11be153b9de9523ca6e
symbol_refs: []
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         OPA Universe            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ     input       ‚îÇ     data      ‚îÇ
‚îÇ  (transient)    ‚îÇ  (persistent) ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚Ä¢ Request      ‚îÇ  ‚Ä¢ Policies   ‚îÇ
‚îÇ  ‚Ä¢ Context      ‚îÇ  ‚Ä¢ Config     ‚îÇ
‚îÇ  ‚Ä¢ User info    ‚îÇ  ‚Ä¢ Reference  ‚îÇ
‚îÇ  ‚Ä¢ Resource     ‚îÇ  ‚Ä¢ Lookup     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
:::

::: example
id: CODE-7df83483f10837f9
chapter: CH-03
language: json
role: example
tags: []
digest: f1aa2e3646eeefb01cbaadbfea227dcbc83aa7bb2c120fe30edaaa7c448313bd
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
{
  "input": {
    "user": {
      "id": "alice",
      "role": "developer",
      "department": "engineering"
    },
    "resource": {
      "type": "repository",
      "id": "backend-api",
      "owner": "engineering"
    },
    "action": "push"
  }
}
:::

::: example
id: CODE-251c3e9beb1ef640
chapter: CH-03
language: 
role: example
tags: []
digest: 183da9d5138e1581493a5cf629d1e25ce088d3a3997ec3247ff84a2de2235101
symbol_refs: []
semantic_role: walkthrough
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
Procedural: Execute step-by-step
Declarative: Find all valid solutions
:::

::: example
id: CODE-1564bb5ea54e5d98
chapter: CH-03
language: rego
role: example
tags: []
digest: 5d0d5bad12d0cbfc5eaa43d97447dae3915934224fbcafb49288d12b62da7ee7
symbol_refs: [max_value]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚ùå ERROR: Conflict
max_value := 10 if condition1
max_value := 20 if condition2
# If both conditions true ‚Üí conflict error
:::

::: example
id: CODE-df71a9ea4daa48d2
chapter: CH-03
language: rego
role: example
tags: []
digest: effb8711dc4d6c644b758524b5c5a80de97e1a3ac7a1a14774dc916240ab30bc
symbol_refs: [max_value]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ Use default + conditional override
default max_value := 10
max_value := 20 if high_priority_user
:::

::: example
id: CODE-41e80cd5b9c5b32a
chapter: CH-03
language: rego
role: example
tags: []
digest: 49af8f5f5b9e8e0c32a4ab2dffaa7ef7a28e7a2863bedaf54e2c10afe0fc5ff3
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ OK: Set accumulates values (union)
admins contains "alice" if alice_is_admin
admins contains "bob" if bob_is_admin
# Result: {"alice", "bob"} if both true
:::

::: example
id: CODE-3befa8ddbbb8e477
chapter: CH-03
language: rego
role: example
tags: []
digest: 3f043533d4fee8ecb937e50999d5d5c22b9491bc0eeb82ff6212fed436d2eb00
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Each body adds to the set
admins contains "alice" if alice_is_admin
admins contains "bob" if bob_is_admin
# Result: {"alice", "bob"} if both true (union)
:::

::: example
id: CODE-3d012ba6dae74718
chapter: CH-03
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚úÖ CORRECT: Single rule with comprehension creates union
confidence: 0.9
digest: 498a745e6484815ded63510212dc09f72ba4ee8e3a7efe843a459428b6a29ebf
symbol_refs: [missing_set]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
_missing_patterns_set(content) := missing_set if {
    missing_set := {
        name |
        some name in ["error_handling", "audit_logging", "structured_logging"]
        not pattern_present(name, content)
    }
}
:::

::: example
id: CODE-eda88bdf5c109417
chapter: CH-03
language: rego
role: code-pattern:generic
tags: [generic]
explanation: This creates a set containing ALL missing patterns
confidence: 0.9
digest: ca59f113b76a7cbca0e8fd8d92aa1954c1a6ca4c9095af5457f8eaa2cf189bf4
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: example
id: CODE-aee586e0808c2fa3
chapter: CH-03
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚ùå WRONG: Multiple complete rules with different set values
confidence: 0.9
digest: ae6106441920f821582310ab8895a5196e8dd144e1018dfc7b3bc20f50d81a64
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
_missing_patterns_set(content) := {"error_handling"} if { not error_handling }
_missing_patterns_set(content) := {"audit_logging"} if { not audit_logging }
:::

::: example
id: BLK-adf99062fbd06b04
summary: Complete Rules: Define a single value ``rego max_memory := 32 user_role := "admin" ``.
digest: e56e192e3a0cf03514fee696565eaad050999965dcb05b1088622c064699bea3
symbol_refs: [user_role, max_memory]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
chapter: CH-03
:::
1. **Complete Rules**: Define a single value ```rego max_memory := 32 user_role := "admin" ```
:::

::: example
id: BLK-c32cebb868f3736b
summary: Partial Rules: Define sets or objects incrementally ```rego # Partial Set valid_users contains user.id if { some user in data.users user.active == ...
digest: b6632214d54b6537620f2a00ebb87ab1aa9712f22d0d2a26f285315659689a8b
symbol_refs: [active]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
chapter: CH-03
:::
2. **Partial Rules**: Define sets or objects incrementally ```rego # Partial Set valid_users contains user.id if { some user in data.users user.active == true }
:::

::: example
id: BLK-277ca132ad70528a
summary: # Partial Object user_roles[user.id] := user.role if { some user in data.users } ```.
digest: 7eb23fa2f52b33e6e3562281422b6c1a6504db81f6c0d863f4667352e97114fc
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
chapter: CH-03
:::
# Partial Object user_roles[user.id] := user.role if { some user in data.users } ```
:::

::: example
id: BLK-916086bea807b611
summary: Boolean Rules: Produce true/undefined ``rego allow if { input.user.role == "admin" } ``.
digest: 2b93d79ce144aa53048317b645951aed3fc455eb208a86fb2649ddbd3cad2337
symbol_refs: [role]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
chapter: CH-03
:::
3. **Boolean Rules**: Produce true/undefined ```rego allow if { input.user.role == "admin" } ```
:::

::: example
id: BLK-ee318260cb042823
summary: Functions: Take parameters, return values ``rego full_name(user) := concat(" ", [user.first, user.last]) ``.
digest: 57942e9d97a60824882e259507302ad87dda4d803e503c4f2003e4dc21b59c5d
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
chapter: CH-03
:::
4. **Functions**: Take parameters, return values ```rego full_name(user) := concat(" ", [user.first, user.last]) ```
:::

::: code-pattern
id: CODE-5431f07c9453d310
language: rego
chapter: CH-03
source: term:Example Evaluation
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 27e40f91c364a6069697c50835cc93ef89ce412fee32b57d60c884d1d2e696d8
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODE-a67d7c106e51bb7b
language: rego
chapter: CH-03
source: term:Critical Insight
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 6a7759267444d7cb9c5c09e91d5bc6deb4a69f88fe20665dd9cd8c38b20c129c
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# These are equivalent
allow if {
    role == "admin"
    some role in input.user.roles
}

allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODE-1568ccce629f9455
language: rego
chapter: CH-03
source: term:Critical Distinction
purpose: definition-example
pattern_type: rule_head
pattern_subtype: deny
tags: [rule_head, deny]
pattern_metadata: {'rule_type': 'deny'}
digest: 03aaf050b05a0c9edb08147970fbe5bae9d0fafd31847262227ff6b27bb3867c
symbol_refs: [matches, deny, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Returns false explicitly
deny := false if input.user.role != "admin"

# Returns undefined (no rule matches)
deny if input.user.role == "admin"
# When user.role is "developer", deny is undefined, not false
:::

::: code-pattern
id: CODE-a5a15aa8ec17589f
language: rego
chapter: CH-03
source: term:Why It Matters
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: 882e6bbeea5be2783035b43d2c1079ad90a69f04620dc9b1478cebda93e08a4e
symbol_refs: [deny]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚ùå Common mistake
allow if not deny  # Broken if deny is undefined

# ‚úÖ Correct
default deny := false
allow if not deny
:::

::: code-pattern
id: CODE-33872740dcd72389
language: rego
chapter: CH-03
source: term:Conjunction (AND)
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: 79529349771dba04b38e1e877a865637871488f951e2c5487c1cc2a2728386ac
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    expr1  # AND
    expr2  # AND
    expr3  # All must be true
}
:::

::: code-pattern
id: CODE-929e95e5abeadac4
language: rego
chapter: CH-03
source: term:Disjunction (OR)
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: b0ad7bdae1fa2439eeb02b3818b631f11a9448aa714388c5c46ed6024d2bb6d8
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if { expr1 }  # OR
allow if { expr2 }  # OR
allow if { expr3 }  # Any can be true
:::

::: code-pattern
id: CODE-51338c0a334665a0
language: rego
chapter: CH-03
source: term:Complex Example
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: 545341917b589a649bcf0a40add789b82676159f59da6be755420b812c60a9c1
symbol_refs: [owner, active, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# (admin OR owner) AND active
allow if {
    input.user.role == "admin"
    input.user.active == true
}

allow if {
    input.resource.owner == input.user.id
    input.user.active == true
}
:::

::: code-pattern
id: CODE-48a55b2d311b7fb1
language: rego
chapter: CH-03
source: term:Partial Rules
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 11d42c82bcaf65ac71b1c01fcacb858c3884b3a2f8fe79ed205c266adaed3af9
symbol_refs: [with, missing_set]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚úÖ CORRECT: Single rule with comprehension creates union
_missing_patterns_set(content) := missing_set if {
    missing_set := {
        name |
        some name in ["error_handling", "audit_logging", "structured_logging"]
        not pattern_present(name, content)
    }
}
# This creates a set containing ALL missing patterns

# ‚ùå WRONG: Multiple complete rules with different set values
_missing_patterns_set(content) := {"error_handling"} if { not error_handling }
_missing_patterns_set(content) := {"audit_logging"} if { not audit_logging }
# Problem: These are complete rules (:=), not partial (contains)
# If both conditions true, you get a conflict or non-deterministic selection
# Only ONE value will be chosen, not a union
:::

::: code-pattern
id: CODE-f9165857ee2c0c68
chapter: CH-03
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: c37b1bd6c3f6a5a61783bbcd23327f13d4851d717834468eeb3b3248c4ea46dc
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODE-4b643428b4f2edd0
chapter: CH-03
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: 2071cb96a3b393da422b71411394c5846821d10c92678d70676948c392082c2f
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
# These are equivalent
allow if {
    role == "admin"
    some role in input.user.roles
}

allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODE-22a3c940e76c1893
chapter: CH-03
language: rego
role: code-pattern:authorization:deny-rule
tags: [authorization, deny-rule]
explanation: Returns false explicitly
confidence: 0.9
pattern_type: authorization
pattern_subtype: deny-rule
digest: d42bddc4aa9495b348e8f0d9043f4b5b5cd2ea5bd6c116f1cb21ca896e40db64
symbol_refs: [deny]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
deny := false if input.user.role != "admin"

:::

::: code-pattern
id: CODE-4d2ad0d6df9f48c1
chapter: CH-03
language: rego
role: code-pattern:authorization:deny-rule
tags: [authorization, deny-rule]
explanation: Returns undefined (no rule matches)
confidence: 0.9
pattern_type: authorization
pattern_subtype: deny-rule
digest: 514dade502e5e473f80cd64c58beaac3c63b2d650e31641d288d471bffe9a0f4
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
deny if input.user.role == "admin"
:::

::: code-pattern
id: CODE-e8a2139bac84c4a0
chapter: CH-03
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: e4b2c519793db610a12d47ef2b0e9b0a5f1d9ec342b96176fbfa05664f25b94f
symbol_refs: [deny]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
# ‚ùå Common mistake
allow if not deny  # Broken if deny is undefined

# ‚úÖ Correct
default deny := false
allow if not deny
:::

::: code-pattern
id: CODE-1f681853ebf733fb
chapter: CH-03
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: f74441b176305a8f8706564a39ff64df9f925285660306460adcb6928ff23612
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
allow if {
    expr1  # AND
    expr2  # AND
    expr3  # All must be true
}
:::

::: code-pattern
id: CODE-ae589d488d5196d2
chapter: CH-03
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: 7ac0736d5f517887d2564cd0f2eff1f0c8178ba6c6c46dd5800acb58345029bb
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
allow if { expr1 }  # OR
allow if { expr2 }  # OR
allow if { expr3 }  # Any can be true
:::

::: code-pattern
id: CODE-e3021412b7e801e0
chapter: CH-03
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: 73814a49aa781b3a9535e0c8547e22ea317a6eb48f1c387ac5c041724aec1b76
symbol_refs: [owner, active, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
# (admin OR owner) AND active
allow if {
    input.user.role == "admin"
    input.user.active == true
}

allow if {
    input.resource.owner == input.user.id
    input.user.active == true
}
:::

::: code-pattern
id: CODEPAT-4bc1f02cc355a6c6
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-03
metadata: {'quantifier': 'some'}
digest: e31eee8a59b476558785269f4a2f40961c78d4b28a8659717a8357871689d78c
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODEPAT-402d850e8096290b
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-03
metadata: {'rule_type': 'allow'}
digest: 57ce7f4946b081565b6db2ab3fe405e45246b62aff589e3d4c4681eb853c79ce
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODEPAT-aa75689c965cb127
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-03
metadata: {'quantifier': 'some'}
digest: 8fc1876ce313dd217b8cb8d49a662afb4cfe90b1e9f5031caa06e925bdcf6846
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# These are equivalent
allow if {
    role == "admin"
    some role in input.user.roles
}

allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODEPAT-58f0b093595148d9
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-03
metadata: {'rule_type': 'allow'}
digest: 90cb1ebe6d35887e762518ef9d771ccb2e066fe403217b0086ff55e62c65deae
symbol_refs: [role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# These are equivalent
allow if {
    role == "admin"
    some role in input.user.roles
}

allow if {
    some role in input.user.roles
    role == "admin"
}
:::

::: code-pattern
id: CODEPAT-3dd91e5defbcfaa3
language: rego
pattern_type: rule_head
pattern_subtype: deny
tags: [rule_head, deny]
chapter: CH-03
metadata: {'rule_type': 'deny'}
digest: 5f6a26b0fdf7e9defbc981f1a52cd3d9f3e85d82f7ef8fa72bc06465743c79d8
symbol_refs: [matches, deny, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Returns false explicitly
deny := false if input.user.role != "admin"

# Returns undefined (no rule matches)
deny if input.user.role == "admin"
# When user.role is "developer", deny is undefined, not false
:::

::: code-pattern
id: CODEPAT-c0e70cedb64e14dd
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-03
metadata: {'rule_type': 'allow'}
digest: 0805166034cd0f0f4a7d36bf979efeeab78a42ac3dcb3a1c2fc5a4148239121b
symbol_refs: [deny]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚ùå Common mistake
allow if not deny  # Broken if deny is undefined

# ‚úÖ Correct
default deny := false
allow if not deny
:::

::: code-pattern
id: CODEPAT-44a1238d48d7cf63
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-03
metadata: {'rule_type': 'allow'}
digest: b9d0787b5512e56a84f2a3e81520202c2fbf26b5ec3aafffe43fabbd91021e9b
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    expr1  # AND
    expr2  # AND
    expr3  # All must be true
}
:::

::: code-pattern
id: CODEPAT-6f3df6603b2c986c
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-03
metadata: {'rule_type': 'allow'}
digest: bc162c11c924019e810bab5582d924f7774c9136e883b17fcbf39761f0d5941a
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if { expr1 }  # OR
allow if { expr2 }  # OR
allow if { expr3 }  # Any can be true
:::

::: code-pattern
id: CODEPAT-0de88cc264571d62
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-03
metadata: {'rule_type': 'allow'}
digest: ddbe1df58ef590cdddb43df2138ddba4b1e0298a0efc75b406ef16fdf750840f
symbol_refs: [owner, active, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# (admin OR owner) AND active
allow if {
    input.user.role == "admin"
    input.user.active == true
}

allow if {
    input.resource.owner == input.user.id
    input.user.active == true
}
:::

::: code-pattern
id: CODEPAT-d8939cd112a01b95
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-03
metadata: {'quantifier': 'some'}
digest: a13303b78ba03a3254a1a208bb2de6fce616e4a0807e2b57a7a6893a28c3045c
symbol_refs: [with, missing_set]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚úÖ CORRECT: Single rule with comprehension creates union
_missing_patterns_set(content) := missing_set if {
    missing_set := {
        name |
        some name in ["error_handling", "audit_logging", "structured_logging"]
        not pattern_present(name, content)
    }
}
# This creates a set containing ALL missing patterns

# ‚ùå WRONG: Multiple complete rules with different set values
_missing_patterns_set(content) := {"error_handling"} if { not error_handling }
_missing_patterns_set(content) := {"audit_logging"} if { not audit_logging }
# Problem: These are complete rules (:=), not partial (contains)
# If both conditions true, you get a conflict or non-deterministic selection
# Only ONE value will be chosen, not a union
:::

::: table
id: TABLE-748d371f78160f37
chapter: CH-03
headers: [Rule Output, Meaning, Example]
row_count: 3
caption: 
rows: [['`true`', 'Explicitly true', '`allow := true`'], ['`false`', 'Explicitly false', '`allow := false`'], ['`undefined`', 'No rule produced value', 'No matching rule body']]
digest: 0b8410cfae78a4efbba82b4c904b0bdab859ebaef91ee8860371ccf418bb268e
symbol_refs: []
semantic_role: reference
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: table
id: TABLE-2564f122b06d6c6c
chapter: CH-03
type: dos-donts
headers: [Do, Don't]
rows: [['OPA operates on a two-document model:.', ''], ['Data Document (data): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configurati...', ''], ['Rules are logical assertions about your world model.', ''], ['Parse: Convert Rego text to AST 2.', ''], ['Critical: Set Union Behavior in Partial Rules.', ''], ['Multiple rule bodies with the same partial rule name create a union for sets and objects, but this only works when each rule body adds distinct ele...', ''], ['For Complete Rules with Sets (Use Comprehensions):.', ''], ['Key Insight: - Partial rules (contains, [key] := value): Multiple bodies union automatically - Complete rules (:= value): Multiple bodies with diff...', '']]
semantic_categories: [distribution]
digest: 53d68988d0e4076bea2bfa3eccd4f1fc5717a21feac7e2f77453c98e476db14b
symbol_refs: []
semantic_role: reference
:::
| Do | Don't |
| --- | --- |
| OPA operates on a two-document model:. |  |
| Data Document (data): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configurati... |  |
| Rules are logical assertions about your world model. |  |
| Parse: Convert Rego text to AST 2. |  |
| Critical: Set Union Behavior in Partial Rules. |  |
| Multiple rule bodies with the same partial rule name create a union for sets and objects, but this only works when each rule body adds distinct ele... |  |
| For Complete Rules with Sets (Use Comprehensions):. |  |
| Key Insight: - Partial rules (contains, [key] := value): Multiple bodies union automatically - Complete rules (:= value): Multiple bodies with diff... |  |
:::

::: qa
id: QA-596b5610eea33d51
chapter: CH-03
q: What is Example Request in the context of Rego/OPA?
a: ```json
reference: TERM-7055bd73b15a8d51
digest: 82db2986fb1fc4148b4a3509014f50b615cc64c2ff549e2544873b82789544cb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ada8385ec8690360
chapter: CH-03
q: What is Rule Categories in the context of Rego/OPA?
a: 1. **Complete Rules**: Define a single value ```rego
reference: TERM-551db8ac49dd585a
digest: b1a67976ab7962a2616149a82c082c4dfbeee1fa2ce81e309baff97af56c8ef4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ac9b11deb35f9eed
chapter: CH-03
q: What is Key Principle in the context of Rego/OPA?
a: Rego is **declarative, not procedural** ```
reference: TERM-1ff5b74d10590506
digest: 8124f27938b199616ef717fd82e24fbf4e433c01141dfe1d741b2a4bb19ac4c7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1a886991adae7e18
chapter: CH-03
q: What is Evaluation Process in the context of Rego/OPA?
a: 1. **Parse**: Convert Rego text to AST 2. **Compile**: Build evaluation plan 3. **Ground**: Bind variables systematically 4. **Unify**: Match patterns and values 5. **Search**: Explore all possibilities 6. **Collect**: Gather valid solutions
reference: TERM-e6fabf6d604d1fda
digest: 63891f311a8a8800c803848e6a7d49e0f63b72201bab7a0ba49f3350a7ae0643
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a9011234c887ce65
chapter: CH-03
q: What is Example Evaluation in the context of Rego/OPA?
a: ```rego
reference: TERM-92a5159f8cfe0c6d
digest: d4fa5028aa5eb6cf6ed08f4d50dcee8457b15334dab4540b127141ddba5dc6b7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bd552627cf74585b
chapter: CH-03
q: What is Evaluation Steps in the context of Rego/OPA?
a: 1. Access `input.user.roles` (e.g., `["developer", "admin"]`) 2. Iterate: bind `role` to `"developer"`, then `"admin"` 3. Check `role == "admin"` for each binding 4. Return `true` when binding succeeds
reference: TERM-088aaea9f3496bc5
digest: 791bce2ba88746a38fb8416344289dcb16cb8d57d5e47d61ec3c23a9388eaeab
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a83645f7c7ef0bbf
chapter: CH-03
q: What is Critical Insight in the context of Rego/OPA?
a: Order of expressions is **semantically irrelevant**: ```rego
reference: TERM-c1b4c571376282e8
digest: 484a13ad4e5ea8603978a273ee8f2e8957305811a94a24731fdb97543e30bde3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dd498b5f978c0ead
chapter: CH-03
q: What is Critical Distinction in the context of Rego/OPA?
a: ```rego
reference: TERM-f4ed7dd663f1c387
digest: fbffdbda0b485bdb012fba1b9ccae1c278eaff67884d30d4e354d9bd731a3b61
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-53a2318c4d9698fd
chapter: CH-03
q: What is Why It Matters in the context of Rego/OPA?
a: ```rego
reference: TERM-2cad3572a9870d43
digest: 30993f4de8ed7401b0197ea76bd8535111a655409c7a11ebbabf19fb1ee00b3b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f12f3ea28f769827
chapter: CH-03
q: What is Conjunction (AND) in the context of Rego/OPA?
a: Multiple expressions in one rule body ```rego
reference: TERM-567706b148bc012c
digest: 743d85f5ba1b9bbda2cf9b4e18e06750efae23bd1b89ed9eef7bf0b331c7bd56
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b70786fba9a97819
chapter: CH-03
q: What is Disjunction (OR) in the context of Rego/OPA?
a: Multiple rule bodies with same name ```rego
reference: TERM-5b83bf55911a3f71
digest: 14d713e21c2e379f23a7e2dc59c748370fa61259d42430f699db335d3970b491
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-abe8c55ccf5cd9ec
chapter: CH-03
q: What is Complex Example in the context of Rego/OPA?
a: ```rego
reference: TERM-e76a7caae0bbdc8c
digest: 80ce463867cecb043b5ce323ba459c29f7dedbd7ac682d301d6644b479d2995f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0b31b611147ff85b
chapter: CH-03
q: What is Complete Rule Conflicts in the context of Rego/OPA?
a: ```rego
reference: TERM-91c069f0733380d6
digest: 19321cf1d8c686a41469f85b42d437826f1c142dbeac4d0d84f6fcb8fd2a4fbf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3ca7a1e9d4792dac
chapter: CH-03
q: What is Resolution Strategy in the context of Rego/OPA?
a: ```rego
reference: TERM-3920245557315136
digest: abec5faea72e82570d7536ca32ca61409968906dd03e1b59414704457b3de0b1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-23b102e647502e9c
chapter: CH-03
q: What is Partial Rules in the context of Rego/OPA?
a: No conflicts, values merge ```rego
reference: TERM-481545d3975a65fb
digest: 5a7d7aa981473ff636efb4df9e24bfde72cceed90172654555a043a1e7af785a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-75291b96e8d48135
chapter: CH-03
q: What is OPA operates on a two-document model in the context of Rego/OPA?
a: OPA operates on a **two-document model**:
reference: BLK-fca3fe13b2ec32f2
digest: c13c94f0eb23fcbad43b808dc4d9139f483991459a9f5d86411705361eeb8f95
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a13062564548288d
chapter: CH-03
q: What is Input Document (input) in the context of Rego/OPA?
a: **Input Document** (`input`): - Provided per query - Represents current request/context - Typically contains: - User identity and attributes - Resource being accessed - Action/operation requested - Environmental context (time, location)
reference: BLK-480e6ac62d9bdadc
digest: 8321a50709435bbbccf96848fd384d9e5fb0d36f1aaf9bd19bbfa5b2cee2cd8b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-82971bbf35ccb074
chapter: CH-03
q: What is Data Document (data) in the context of Rego/OPA?
a: **Data Document** (`data`): - Loaded into OPA at startup or via bundles - Contains: - Policy rules (your Rego code) - Static reference data - Configuration - External data from APIs
reference: BLK-0dd280f3e2ee752f
semantic_categories: [distribution]
digest: e742896a14e4a6f606e762f1e550766d6e4bae40e90a0c9a89dda820841afd8c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-df547aa91e850240
chapter: CH-03
q: What is Rules are logical assertions about your world model. in the context of Rego/OPA?
a: Rules are **logical assertions** about your world model.
reference: BLK-69c0318ca03db573
digest: 6659707ba97b6e5a4ef11a95553bf4dfe8f09794bf791ba9f0817b6a5c323c0c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6c1ca5dab6e7185b
chapter: CH-03
q: What is Parse in the context of Rego/OPA?
a: 1. **Parse**: Convert Rego text to AST 2. **Compile**: Build evaluation plan 3. **Ground**: Bind variables systematically 4. **Unify**: Match patterns and values 5. **Search**: Explore all possibilities 6. **Collect**: Gather valid solutions
reference: BLK-90b472c5727ce911
digest: 87c0236b4769b4f6853aaf498cd78f50d4bdf05efff675aaff07b12977c663c6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-80888eeff4098aba
chapter: CH-03
q: What is However, performance may differ (covered in Chapter 11). in the context of Rego/OPA?
a: However, performance may differ (covered in Chapter 11).
reference: BLK-dc443db53fff92d3
digest: 0bb1367b40c8eb755d99705631c4ef6ab6cc767fdc490509c9841320e1639214
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ab78237ee2df91c0
chapter: CH-03
q: What is Critical in the context of Rego/OPA?
a: **Critical: Set Union Behavior in Partial Rules**
reference: BLK-b510316c3c4d2fdc
digest: b1c9e18612b6c0a010676a66dfebb0fd8f08628134f2b03db411d519cacce3ad
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0f7ecddc2813a172
chapter: CH-03
q: What is Multiple rule bodies with the same partial rule name create a union for sets and objects, but this only works when each rule body adds distinct ele... in the context of Rego/OPA?
a: Multiple rule bodies with the same partial rule name create a **union** for sets and objects, but this only works when each rule body adds distinct elements. For complete rules (single value), multiple bodies create conflicts.
reference: BLK-0d0f670ad5683689
digest: 6e783130ad338cd5303ca1264771ec002bbe023fc24c0d17b4313e99efce82b4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e8deaa4b0bde9a52
chapter: CH-03
q: What is For Sets (Union Works) in the context of Rego/OPA?
a: **For Sets (Union Works):**
reference: BLK-8c7716e5431fa29f
digest: 6e69593dac2c98746b9461c95bfdc13cfe9fbf986faa9e0918ae32b4859f3b5a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-94441f1ce6691817
chapter: CH-03
q: What is For Complete Rules with Sets (Use Comprehensions) in the context of Rego/OPA?
a: **For Complete Rules with Sets (Use Comprehensions):**
reference: BLK-02fa19270211b5c5
digest: fda17ba8e56b254a1f258545235ccc2f9109fe345234e4a95698841ce1164997
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-15d8801434007b32
chapter: CH-03
q: What is Key Insight in the context of Rego/OPA?
a: **Key Insight:** - **Partial rules** (`contains`, `[key] := value`): Multiple bodies union automatically - **Complete rules** (`:= value`): Multiple bodies with different values create conflicts or non-deterministic selection - **Best Practice:** For building sets from multiple conditions, use a single rule with a comprehension that unions all possibilities
reference: BLK-9e14dbd37949da40
digest: 66fffc6076cb3bd83a8e527cc880d9c32337b48f4523b0cd6648c8854487d8a4
symbol_refs: []
semantic_role: explanation
:::
:::

::: reasoning-chain
id: CHAIN-c483fd533041f0d9
chapter: CH-03
qa_id: QA-596b5610eea33d51
reference: TERM-7055bd73b15a8d51
semantic_categories: [truth-values]
digest: 98240dbfa25492ecd3f753a1ff211902f6472b08f2e5d0261270494154d33b6f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fe46ba2430427d85
chapter: CH-03
qa_id: QA-ada8385ec8690360
reference: TERM-551db8ac49dd585a
semantic_categories: [truth-values]
digest: 22add9aea4f85ddb08b4e272284947fe642047a02730e0963079f2533919da35
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3c4715ee83d2db8c
chapter: CH-03
qa_id: QA-ac9b11deb35f9eed
reference: TERM-1ff5b74d10590506
semantic_categories: [truth-values]
digest: 713934bc689436eba2d0062e595dbfb25429a0f8da64838f106d12a38f2d8301
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4ecc0c3c0599ae8c
chapter: CH-03
qa_id: QA-1a886991adae7e18
reference: TERM-e6fabf6d604d1fda
semantic_categories: [truth-values]
digest: d925050c6c280edc3bf598f89366dbbfd07b931202639d1f76326c6d4553da7c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-13bf2019c9944779
chapter: CH-03
qa_id: QA-a9011234c887ce65
reference: TERM-92a5159f8cfe0c6d
semantic_categories: [truth-values]
digest: 5b9cb7e11dcf41fe989354c48923a09e87d5b5a272bfbb3d682f173b0e957074
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-036ac01a5756abf6
chapter: CH-03
qa_id: QA-bd552627cf74585b
reference: TERM-088aaea9f3496bc5
semantic_categories: [truth-values]
digest: 5c7c33ada07b9c4574ed14e93eda2b8baa3bf842515101c6acd256313edf1111
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cd02f4e46515134e
chapter: CH-03
qa_id: QA-a83645f7c7ef0bbf
reference: TERM-c1b4c571376282e8
semantic_categories: [truth-values]
digest: dff80ccf073891b6ad97a59f4975771b9ac8b3d55e592ad73716901d40da21d0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e3f71e2714f5d025
chapter: CH-03
qa_id: QA-dd498b5f978c0ead
reference: TERM-f4ed7dd663f1c387
semantic_categories: [truth-values]
digest: e21047a1cd6f80890251a3c2bf7a0e75f5e51f9db2b38eae3c993927b043ccde
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2cdc5d277c5fb2b2
chapter: CH-03
qa_id: QA-53a2318c4d9698fd
reference: TERM-2cad3572a9870d43
semantic_categories: [truth-values]
digest: b79113c71e8fd94b1b1750e66058aebdddda201fef2f5c22e8c96d8c490c2e19
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6e2cf6ee5ad64d89
chapter: CH-03
qa_id: QA-f12f3ea28f769827
reference: TERM-567706b148bc012c
semantic_categories: [truth-values]
digest: 00fba0868bee3768565a50a6142c30bbd5c3c3355293a8b47c8773dfdf919359
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7e52119421de5a57
chapter: CH-03
qa_id: QA-b70786fba9a97819
reference: TERM-5b83bf55911a3f71
semantic_categories: [truth-values]
digest: a1985ca2b8e5a3b57b477d28d49d22fecbcde788b5932f3a86c529ebc797a3e9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ceb49c8ca43d2bad
chapter: CH-03
qa_id: QA-abe8c55ccf5cd9ec
reference: TERM-e76a7caae0bbdc8c
semantic_categories: [truth-values]
digest: 484fb5b7fec78500f881471e663df22e60d03a94926219b493abe10bec0079e9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-646f02d3678684e5
chapter: CH-03
qa_id: QA-0b31b611147ff85b
reference: TERM-91c069f0733380d6
semantic_categories: [truth-values]
digest: e3189544de865b8c4ddb0027848ce35ed158ca2b209aa245603c1a4f9cde384f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7da2a46103cf809c
chapter: CH-03
qa_id: QA-3ca7a1e9d4792dac
reference: TERM-3920245557315136
semantic_categories: [truth-values]
digest: d255661d223dff65d8cf090974f02b3335a40492930e9bfdbf8c3152997c7c92
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c6741d87900709ff
chapter: CH-03
qa_id: QA-23b102e647502e9c
reference: TERM-481545d3975a65fb
semantic_categories: [truth-values]
digest: 13662eabb64be6b3de5170a0a53e85e3a57f0e05dddf3ed2f2bcd41573219346
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a3e004e0bdf5625f
chapter: CH-03
qa_id: QA-75291b96e8d48135
reference: BLK-fca3fe13b2ec32f2
semantic_categories: [truth-values]
digest: 274c894b9f5aa92defe036312086b23f73e175092a7d0fb9eb0de988290dba0f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8a73383f19f29d9d
chapter: CH-03
qa_id: QA-a13062564548288d
reference: BLK-480e6ac62d9bdadc
semantic_categories: [truth-values]
digest: 5718f5192195f7da6493571dbb27a3c388a10382d3fd3059274a047dcc8ae9aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-69e44f2ea7efde6d
chapter: CH-03
qa_id: QA-82971bbf35ccb074
reference: BLK-0dd280f3e2ee752f
semantic_categories: [truth-values]
digest: 06362d810a94c5d3f41106d1c5b3816dda29d05412bc1265ef1053a42dcdbac3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-83aa7bb15793c94a
chapter: CH-03
qa_id: QA-df547aa91e850240
reference: BLK-69c0318ca03db573
semantic_categories: [truth-values]
digest: cfe13361276a8cf7440c1845c06bf5b5b43899322be7df62c89b1870d31cf4f3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eeb5671b131c1409
chapter: CH-03
qa_id: QA-6c1ca5dab6e7185b
reference: BLK-90b472c5727ce911
semantic_categories: [truth-values]
digest: 502349dbdcf83265053b69960ef590a9a0bca0ba7b82c24622c90c3ba2517b7d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5c167ad80b245608
chapter: CH-03
qa_id: QA-80888eeff4098aba
reference: BLK-dc443db53fff92d3
semantic_categories: [truth-values]
digest: 51ffbd2fa84a08f71cee79e991493127981ab880ebf5877200da6a6edc91eb41
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dd3d6647ff168d69
chapter: CH-03
qa_id: QA-ab78237ee2df91c0
reference: BLK-b510316c3c4d2fdc
semantic_categories: [truth-values]
digest: 9511cd3284bd0ed0bf33d01919e54010a889073824fa93b41dc48d4ad0fd97ac
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a3bacc5c46d161af
chapter: CH-03
qa_id: QA-0f7ecddc2813a172
reference: BLK-0d0f670ad5683689
semantic_categories: [truth-values]
digest: d0f536cae205315f87e60f6fa9cb649bc49e3cc11a38f5cd2156f65160c32b20
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-90d7624fad52290b
chapter: CH-03
qa_id: QA-e8deaa4b0bde9a52
reference: BLK-8c7716e5431fa29f
semantic_categories: [truth-values]
digest: f97b8ae2553fce313a5b73cd9ce2280ad6d0a5d30072b19b119d36db84d7785a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-41c624b61e11f8bf
chapter: CH-03
qa_id: QA-94441f1ce6691817
reference: BLK-02fa19270211b5c5
semantic_categories: [truth-values]
digest: b649d61569f46098156596e41fb7174c8c27509d9b9e88deca6f82bea2e23863
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7ff1518a27d1c04f
chapter: CH-03
qa_id: QA-15d8801434007b32
reference: BLK-9e14dbd37949da40
semantic_categories: [truth-values]
digest: fdcb084ea643b29c5d8c817323ac5f7d3ddf48cd258bd6cb2004455104d88c1a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: role-note
id: ROLE-6f2de71449bf6150
chapter: CH-03
role: Policy Author
guidance: Focus on correctness & clarity of rules in this chapter.
digest: 44adb4012b44e1b53d53e354a49bd3fdde1570bdf37e2adf2ee9f269efda80b0
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-3c006d76b441596a
chapter: CH-03
role: Security Reviewer
guidance: Look for unsafe patterns, missing deny cases, misuse of negation.
semantic_categories: [negation]
digest: 3ec3180ff5d1803a1be64b4bc8f99851f0d28fe8decaa010bb32fed5f0dac2f6
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-7b33cd163d91190c
chapter: CH-03
role: Performance Engineer
guidance: Identify heavy comprehensions and opportunities for partial evaluation.
semantic_categories: [performance]
digest: 0b802884ad9447a4ac080b2a5dadf658065d6e59489a92c72f71d2fdf3365123
symbol_refs: []
semantic_role: content
:::
:::

::: diagram
id: DIAG-6dd1fd866550db53
chapter: CH-03
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: [{'id': 'node_0', 'label': 'OPA Universe ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ input            data (transient)      (persistent) ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚Ä¢ Request        ‚Ä¢ Policies ‚Ä¢ Context        ‚Ä¢ Config ‚Ä¢ User info      ‚Ä¢ Reference ‚Ä¢ Resource       ‚Ä¢ Lookup'}, {'id': 'node_1', 'label': 'input            data (transient)      (persistent) ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚Ä¢ Request        ‚Ä¢ Policies ‚Ä¢ Context        ‚Ä¢ Config ‚Ä¢ User info      ‚Ä¢ Reference ‚Ä¢ Resource       ‚Ä¢ Lookup'}]
edges: []
normalized_content: [OPA Universe ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ input            data (transient)      (persistent) ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚Ä¢ Request        ‚Ä¢ Policies ‚Ä¢ Context        ‚Ä¢ Config ‚Ä¢ User info      ‚Ä¢ Reference ‚Ä¢ Resource       ‚Ä¢ Lookup]
[input            data (transient)      (persistent) ‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§ ‚Ä¢ Request        ‚Ä¢ Policies ‚Ä¢ Context        ‚Ä¢ Config ‚Ä¢ User info      ‚Ä¢ Reference ‚Ä¢ Resource       ‚Ä¢ Lookup]
digest: 2327531b749b4cc6f989ddad3062fc358663d162d2283c21496b392005cb627b
symbol_refs: []
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ         OPA Universe            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ     input       ‚îÇ     data      ‚îÇ
‚îÇ  (transient)    ‚îÇ  (persistent) ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  ‚Ä¢ Request      ‚îÇ  ‚Ä¢ Policies   ‚îÇ
‚îÇ  ‚Ä¢ Context      ‚îÇ  ‚Ä¢ Config     ‚îÇ
‚îÇ  ‚Ä¢ User info    ‚îÇ  ‚Ä¢ Reference  ‚îÇ
‚îÇ  ‚Ä¢ Resource     ‚îÇ  ‚Ä¢ Lookup     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
:::

::: diagram
id: DIAG-aa1bcb902547f29e
chapter: CH-03
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 20254c69f96458dbd17d0a432277ce11935e882e0aca0da85b722c97e1681b9a
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ Use default + conditional override
default max_value := 10
max_value := 20 if high_priority_user
:::

::: test-hint
id: TEST-0f6f8aa3279b3c76
chapter: CH-03
source_id: CODE-754bc28c87fac504
digest: ae8d819cb55b5d5f90dc284ae76698c8d61430f1e7425cdb9e2e80ccd3beed97
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-acc9ca230329dda4
chapter: CH-03
source_id: CODE-5431f07c9453d310
digest: f679b302b89f483048c08f0ee490f3f670d488d0dec3e514c5cdcb61630c5321
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-6afec691f271e54d
chapter: CH-03
source_id: CODE-a67d7c106e51bb7b
digest: 42ff29a34c7e0d82ff345db6cb0a2ae783771fd4cc2c4355c3bc6b1098d6a5b0
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-7a9bee0183bb37ff
chapter: CH-03
source_id: CODE-1568ccce629f9455
digest: ad18eee5c4967ea38fb8773d7cfb0e19f433401d2f86f288e9878f3a6969851b
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-6de33501def923bd
chapter: CH-03
source_id: CODE-a5a15aa8ec17589f
digest: 5ddbb1b8086b099fb2263d0d0f4297547179356a545805fb330727b35cfdb8f6
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-ec5f2e7051f3f0cf
chapter: CH-03
source_id: CODE-33872740dcd72389
digest: 18136cc174be0f172b07dc150529cb511679c16d3ef8e41c8569d30e5adfec6c
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-7388e4781932482f
chapter: CH-03
source_id: CODE-929e95e5abeadac4
digest: e6472e825d59ca3e60f16ee35a70361ed91be6493114f9b24981aa1144c77408
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-8642b3802bb7ad81
chapter: CH-03
source_id: CODE-51338c0a334665a0
digest: eb7a828c6596426ec3c92ca033d34d47f32e6b6e9ab9d03526dd4684598a1418
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-1d44dd7069fa2fb4
chapter: CH-03
source_id: CODE-f9165857ee2c0c68
digest: ddf086330bcb721a1d489c182953746dbc9c3f9429cc4fb3799719f2f26e0fbf
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b0575d78847a6519
chapter: CH-03
source_id: CODE-4b643428b4f2edd0
digest: 9b830952913ed41c5abcb1805ef048c5332f6115da34c2c18a1869ff44c5ceb2
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-9cb3ad784456d0f9
chapter: CH-03
source_id: CODE-22a3c940e76c1893
digest: 798f3445e05fff11ac933c4d849e10894b4e9692976490b3d39232284be47751
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-253a0136af51ca76
chapter: CH-03
source_id: CODE-4d2ad0d6df9f48c1
digest: 959eeb505c97410b35ecc783f647b7ccbd211c285fa34ba8b57d17a01870a1f5
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-8b115b0911c03417
chapter: CH-03
source_id: CODE-e8a2139bac84c4a0
digest: 02bacd0cafc71c42e29d115aa345e0541562ea3dfbbaae1314f39b6df6a82599
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-348b10a57c6b9e97
chapter: CH-03
source_id: CODE-1f681853ebf733fb
digest: dc17cb26d2b6be917309ca611d2fd9b3a3d280882e16cc559b9589bc9726fa39
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-0a38a6d8a34f10a7
chapter: CH-03
source_id: CODE-ae589d488d5196d2
digest: fca75746df75fc11a1526c6b48b3da3285eab696e3329ab2e7e4a8ef9a720646
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-f500da52bf26a3b7
chapter: CH-03
source_id: CODE-e3021412b7e801e0
digest: 7361b9e06d7ce541fac6bdfcdeb921590a56d7bb31c054d8d6ce0c5f9253bfb7
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-13a5e6f6485c7e89
chapter: CH-03
source_id: CODEPAT-4bc1f02cc355a6c6
digest: 3f039d4e4534327b56f7d7aa78a4382553eba7771f8c472eadb4a92aba7d9a96
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-a5b535d3850efc5d
chapter: CH-03
source_id: CODEPAT-402d850e8096290b
digest: 02fc72af344c5b9a8e874fdde881c5ea25c21b8cefdc9a7e7d74764af8de0993
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-3c5ac5e1609f3687
chapter: CH-03
source_id: CODEPAT-aa75689c965cb127
digest: 2d5905f7a3a1155e7fe8536acc83c6298c41a4654dae58d851c98d14c5a6652a
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-fa7ea1c77479e1bf
chapter: CH-03
source_id: CODEPAT-58f0b093595148d9
digest: 6bf5e1e20b0c0c395111a524ae5d6818e5bf7800f8205712039991d47265e715
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-061fef68326cf25c
chapter: CH-03
source_id: CODEPAT-3dd91e5defbcfaa3
digest: 8c9abfcbab25ed197b0393b7ef16b6d5696addd5f1f27e9db3ef965b033140ff
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b012e383f65087fb
chapter: CH-03
source_id: CODEPAT-c0e70cedb64e14dd
digest: 9ede9a7c30c4a39f8b150a66ff1f439ba53cc744f1e051589900e64dc48075d9
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-18d5d7538120daf4
chapter: CH-03
source_id: CODEPAT-44a1238d48d7cf63
digest: a49bcd54d0b653cb7b077b27191bf4ee72e9b2e443f1bf3be226e327445f5073
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-e18325c73358555b
chapter: CH-03
source_id: CODEPAT-6f3df6603b2c986c
digest: c8c9ec3c478bdc90eac4065a8f13befd871575be447fd9af5a830b794c0ed9e7
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-8e9061675b93e77e
chapter: CH-03
source_id: CODEPAT-0de88cc264571d62
digest: d46d22aa26856a3aac3a57524b74c9051029eb8f27818cdb8b22f30e7bcf9319
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-a288ef37d5c52b0f
chapter: CH-03
source_id: BLK-916086bea807b611
digest: 002798b2895932478205698d164ab1b6e6bc4425c24f115ee29099b1a2e59557
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: section-meta
id: SECMETA-f884251d72908ead
title: 3.1 World Model
level: 3
chapter: CH-03
parent_section: None
line_no: 419
digest: 663f4ce3ea3fff3604a7181e9a66f7007db33924ec235e24b388665f0b957305
symbol_refs: []
semantic_role: structure
token_range: (419, 419)
char_offset: (33440, 33455)
source_ref: {'line': 419, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-90189e486d21da95
title: 3.2 Rules ‚Äî The Building Blocks
level: 3
chapter: CH-03
parent_section: None
line_no: 473
digest: 4738ceea04d58424adf2941bc33b3b4fdaa380c2da9b9eddf5268880edc35553
symbol_refs: []
semantic_role: structure
token_range: (473, 473)
char_offset: (37760, 37791)
source_ref: {'line': 473, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-b53be783c40230ac
title: 3.3 Evaluation Semantics
level: 3
chapter: CH-03
parent_section: None
line_no: 511
digest: 7fd75f18b248ee6da394a0938b630afbaf15b9dccab1daab84043ab83828a3bd
symbol_refs: []
semantic_role: structure
token_range: (511, 511)
char_offset: (40800, 40824)
source_ref: {'line': 511, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-19d02b09e79ab31e
title: 3.4 Undefined vs False
level: 3
chapter: CH-03
parent_section: None
line_no: 559
digest: f782eb54c155a78d5d0764bf93f9826541ea30d8857a0c305e63f94a075283b2
symbol_refs: []
semantic_role: structure
token_range: (559, 559)
char_offset: (44640, 44662)
source_ref: {'line': 559, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [truth-values]
:::
:::

::: section-meta
id: SECMETA-78199f01c7151304
title: 3.5 Logical Conjunction and Disjunction
level: 3
chapter: CH-03
parent_section: None
line_no: 590
digest: 20fa39459d53f106301d05f834b9613cf8ff5728b0d69a9af3e408d09119e826
symbol_refs: []
semantic_role: structure
token_range: (590, 590)
char_offset: (47120, 47159)
source_ref: {'line': 590, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-18ea9ffc082d7249
title: 3.6 Rule Conflicts and Resolution
level: 3
chapter: CH-03
parent_section: None
line_no: 622
digest: 42b5d8fc1b79a3a8b3bb226c208241cbf946263adc57226e710b564219df06ee
symbol_refs: []
semantic_role: structure
token_range: (622, 622)
char_offset: (49680, 49713)
source_ref: {'line': 622, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-1a0cf4c1598ec141
name: Variable Declaration
definition: ```rego
# Assignment with :=
x := 42
name := input.user.name

# Variables are immutable within scope
x := 42
x := 43  # ‚ùå ERROR: Variable x referenced above
```
aliases: []
chapter: CH-04
digest: ad3efea4ee01a998d4b83bd1028830192cd609eb7edf469d11d3fb4d7ae09d9c
symbol_refs: [Variable Declaration]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Assignment with := x := 42 name := input.user.name # Variables are immutable within scope x := 42 x := 43 # ‚ùå ERROR: Variable x referenced above ```
:::
:::

::: term
id: TERM-ec28f90bca10efb5
name: Unification with =
definition: ```rego
# Pattern matching
[first, second] = [1, 2]
# first ‚Üí 1, second ‚Üí 2

# Symmetric unification
x = y  # Makes x and y equal

# Complex patterns
{"user": user, "role": role} = input.request
```
aliases: []
chapter: CH-04
digest: f7d35228e5369aec1b0ac8c5c114f9372e422d4baf8e0894d4fcb432f4532629
symbol_refs: [Unification with =]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [unification]
vector_summary: ```rego # Pattern matching [first, second] = [1, 2] # first ‚Üí 1, second ‚Üí 2 # Symmetric unification x = y # Makes x and y equal # Complex patterns {"user": user, "role": role} = input.request ```
:::
:::

::: term
id: TERM-da82327651a758ef
name: Safety Requirement
definition: Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using `==`) ```rego
# ‚ùå Unsafe
bad_rule if {
    not blacklisted[user]  # user never defined
}

# ‚úÖ Safe
good_rule if {
    user := input.user.id
    not blacklisted[user]
}
```
aliases: []
chapter: CH-04
digest: 8bce2faf2fcc8dfbae17df330ed9f5100b99c22b7a751026a5b7cd30db686afa
symbol_refs: [Safety Requirement]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using `==`) ```rego # ‚ùå Unsafe bad_rule if { not blacklisted[user] # user never defined } # ‚úÖ Safe good_rule if { user := input.user.id not blacklisted[user] } ```
:::
:::

::: term
id: TERM-a49e5704307f2b3c
name: Reference Syntax
definition: ```rego
# Dot notation (for simple keys)
input.user.name
data.roles.admin

# Bracket notation (for complex keys)
input["user"]["name"]
data["user-roles"]["admin-user"]

# Variable keys
users[user_id]
data.permissions[input.user.role]

# Array indices
items[0]
items[i]  # Iteration
items[_]  # All values (underscore = wildcard)
```
aliases: []
chapter: CH-04
digest: 6ba77a8d10990f555d6409af541e0c875c9f260968db270edb30c962b6a1e208
symbol_refs: [Reference Syntax]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Dot notation (for simple keys) input.user.name data.roles.admin # Bracket notation (for complex keys) input["user"]["name"] data["user-roles"]["admin-user"] # Variable keys users[user_id] data.permissions[input.user.role] # Array indices items[0] items[i] # Iteration items[_] # All values (underscore = wildcard) ```
:::
:::

::: term
id: TERM-91f24b484e572cbb
name: Reference Rules
definition: 1. Must start with: - Variable - `input` or `data` (implicitly imported) - Function call 2. Cannot start with: - Literal arrays: `[1,2,3][0]` ‚ùå - Literal objects: `{"a":1}.a` ‚ùå - Literal sets: `{1,2,3}[0]` ‚ùå ```rego
# ‚ùå Invalid reference starts
x := [1, 2, 3][0]
y := {"name": "Alice"}.name

# ‚úÖ Valid: Assign first
arr := [1, 2, 3]
x := arr[0]

obj := {"name": "Alice"}
y := obj.name
``` References & the Data Model Rego references let you navigate input, data, and local bindings. 4.1 Reference Roots Valid reference roots: input ‚Äì request-scoped data data ‚Äì bundle-scoped data (policies + static data) local variables (from rule heads or := in bodies) function calls (results assigned to a variable first) input.user.id data.config.defaults.timeout user := input.user user.profile.email 4.2 What Cannot Start a Reference (Literals vs References) Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value. You cannot start a reference with: # ‚ùå Invalid: literals are values, not reference roots x := [1, 2, 3][0] y := {"name": "Alice"}.name z := {1, 2, 3}[0] The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references. You can assign literals to variables and then reference them: # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0] obj := {"name": "Alice"} y := obj.name s := {1, 2, 3} contains_one if 1 in s Takeaways: Think of literals as values. Refs start from input, data, locals, or function results. Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù.
aliases: []
chapter: CH-04
digest: a844b7abd4468fcec5ee6a1ac9686d7fb7d5657ca56b8aa5b69accbdd7ceb532
symbol_refs: [Reference Rules]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [distribution]
vector_summary: 1. Must start with: - Variable - `input` or `data` (implicitly imported) - Function call 2. Cannot start with: - Literal arrays: `[1,2,3][0]` ‚ùå - Literal objects: `{"a":1}.a` ‚ùå - Literal sets: `{1,2,3}[0]` ‚ùå ```rego # ‚ùå Invalid reference starts x := [1, 2, 3][0] y := {"name": "Alice"}.name # ‚úÖ Valid: Assign first arr := [1, 2, 3] x := arr[0] obj := {"name": "Alice"} y := obj.name ``` References & the Data Model Rego references let you navigate input, data, and local bindings. 4.1 Reference Roots Valid reference roots: input ‚Äì request-scoped data data ‚Äì bundle-scoped data (policies + static data) local variables (from rule heads or := in bodies) function calls (results assigned to a variable first) input.user.id data.config.defaults.timeout user := input.user user.profile.email 4.2 What Cannot Start a Reference (Literals vs References) Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value. You cannot start a reference with: # ‚ùå Invalid: literals are values, not reference roots x := [1, 2, 3][0] y := {"name": "Alice"}.name z := {1, 2, 3}[0] The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references. You can assign literals to variables and then reference them: # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0] obj := {"name": "Alice"} y := obj.name s := {1, 2, 3} contains_one if 1 in s Takeaways: Think of literals as values. Refs start from input, data, locals, or function results. Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù.
:::
:::

::: term
id: TERM-5334ad887ed1e16d
name: Deep Traversal
definition: ```rego
# Multi-level access
sites[i].servers[j].hostname

# With wildcards
all_hostnames := sites[_].servers[_].hostname

# Safe access with default
hostname := input.server.hostname if input.server.hostname
default hostname := "unknown"
```
aliases: []
chapter: CH-04
digest: 67bcf390ec98e7fdd4b20f155860d713383844c60c69dcffd2152d63ed6d860a
symbol_refs: [Deep Traversal]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Multi-level access sites[i].servers[j].hostname # With wildcards all_hostnames := sites[_].servers[_].hostname # Safe access with default hostname := input.server.hostname if input.server.hostname default hostname := "unknown" ```
:::
:::

::: term
id: TERM-43534f97811a5b70
name: Explicit Variable Declaration
definition: ```rego
# Without 'some' (implicit)
result if {
    sites[i].region == "west"
}

# With 'some' (explicit - recommended)
result if {
    some i
    sites[i].region == "west"
}

# Modern style with 'in'
result if {
    some site in sites
    site.region == "west"
}
```
aliases: []
chapter: CH-04
digest: 770f7fa9c47ce751efd68cd5ffa22b0779214ae192bb5a2c01f03499a6cd4ea3
symbol_refs: [Explicit Variable Declaration]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Without 'some' (implicit) result if { sites[i].region == "west" } # With 'some' (explicit - recommended) result if { some i sites[i].region == "west" } # Modern style with 'in' result if { some site in sites site.region == "west" } ```
:::
:::

::: term
id: TERM-fa93cc1275da4b1d
name: Benefits
definition: - Makes intent explicit - Prevents variable capture from outer scope - Improves readability - Required for safety in some contexts
aliases: []
chapter: CH-04
digest: 3618fb3b20406b752d4c31d330d867d9eb5745785c8e491d56d318c06e76d54a
symbol_refs: [Benefits]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: - Makes intent explicit - Prevents variable capture from outer scope - Improves readability - Required for safety in some contexts
:::
:::

::: term
id: TERM-f78add9404966230
name: Multiple Variables
definition: ```rego
result if {
    some i, j
    sites[i].servers[j].name == "web-0"
    hostname := sites[i].servers[j].hostname
}

# Or with 'in'
result if {
    some site in sites
    some server in site.servers
    server.name == "web-0"
}
```
aliases: []
chapter: CH-04
digest: a1394fcfc7bd8bf23ed43055f841725b76368a0e0ac2b0c77aefe3f86180caa5
symbol_refs: [Multiple Variables]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego result if { some i, j sites[i].servers[j].name == "web-0" hostname := sites[i].servers[j].hostname } # Or with 'in' result if { some site in sites some server in site.servers server.name == "web-0" } ```
:::
:::

::: term
id: TERM-4176bf4a5b555c86
name: When to Use
definition: ```rego
# := for clear assignment (preferred)
count := array.length(items)

# = for pattern matching
[first, second] = [1, 2]

# == for comparison
result if count == 5
```
aliases: []
chapter: CH-04
digest: 216e9e04baf3c93f699476757a6ccef4e35a4d597832c629107bccbbe1fc40a1
symbol_refs: [When to Use]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # := for clear assignment (preferred) count := array.length(items) # = for pattern matching [first, second] = [1, 2] # == for comparison result if count == 5 ```
:::
:::

::: term
id: TERM-8929b33c2f4cdfab
name: Type Compatibility
definition: ```rego
# Same types
1 < 2                    # ‚úÖ true
"a" < "b"                # ‚úÖ true

# Different types
1 < "2"                  # ‚ùå undefined (not an error)
```
aliases: []
chapter: CH-04
digest: 6fd419d1056f2940bb64397c2dae69e146fbd3ead0074a47cded66f6a2c3ddda
symbol_refs: [Type Compatibility]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Same types 1 < 2 # ‚úÖ true "a" < "b" # ‚úÖ true # Different types 1 < "2" # ‚ùå undefined (not an error) ```
:::
:::

::: term
id: TERM-7189e73f44e918ef
name: Examples
definition: ```rego
sum := 10 + 5        # 15
diff := 10 - 5       # 5
product := 10 * 5    # 50
quotient := 10 / 5   # 2 (float)
remainder := 10 % 3  # 1
```
aliases: []
chapter: CH-04
digest: 86a95a9ad416b3e94fe643bbd9bd57db504480189879481cb52b3d58bca54b46
symbol_refs: [Examples]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego sum := 10 + 5 # 15 diff := 10 - 5 # 5 product := 10 * 5 # 50 quotient := 10 / 5 # 2 (float) remainder := 10 % 3 # 1 ```
:::
:::

::: term
id: TERM-c38851c763d3b0b9
name: Use Cases
definition: ```rego
# Permission bits
read_bit := 1
write_bit := 2
execute_bit := 4

has_write := (permissions & write_bit) != 0
```
aliases: []
chapter: CH-04
digest: b6bfd43fea83f3028597713da0627bfe3f48586e0c6af0a4097a264277ec4f5e
symbol_refs: [Use Cases]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Permission bits read_bit := 1 write_bit := 2 execute_bit := 4 has_write := (permissions & write_bit) != 0 ```
:::
:::

::: term
id: TERM-6b7ccdb5c322862a
name: Dual Purpose
definition: Membership testing AND iteration ```rego
# Membership testing (returns boolean)
"admin" in user.roles                 # true/false
3 in [1, 2, 3]                        # true
"key" in {"key": "value"}             # true (checks keys in objects)

# Iteration (with 'some')
some role in user.roles
some i, item in items                 # index and value
some key, value in object             # key and value

# Negation
not "admin" in user.roles
```
aliases: []
chapter: CH-04
digest: b865c1256801488cb22f077d1d153c3132c80aad723e9dcde1b96e87eaef2cc9
symbol_refs: [Dual Purpose]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [negation, testing]
vector_summary: Membership testing AND iteration ```rego # Membership testing (returns boolean) "admin" in user.roles # true/false 3 in [1, 2, 3] # true "key" in {"key": "value"} # true (checks keys in objects) # Iteration (with 'some') some role in user.roles some i, item in items # index and value some key, value in object # key and value # Negation not "admin" in user.roles ```
:::
:::

::: term
id: TERM-38529fcbca6dfab4
name: Array Iteration
definition: ```rego
# Values only
some item in [1, 2, 3]

# Index and value
some i, item in [1, 2, 3]
# Binds: i=0, item=1; then i=1, item=2; etc.
```
aliases: []
chapter: CH-04
digest: 4cb2988f02a64d311ed46e481948fadac1d4c5315056735ae413f0be1c5886cb
symbol_refs: [Array Iteration]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Values only some item in [1, 2, 3] # Index and value some i, item in [1, 2, 3] # Binds: i=0, item=1; then i=1, item=2; etc. ```
:::
:::

::: term
id: TERM-b493f9aa81a5c455
name: Object Iteration
definition: ```rego
# Values only
some val in {"a": 1, "b": 2}

# Key and value
some key, val in {"a": 1, "b": 2}
```
aliases: []
chapter: CH-04
digest: 424332d692597ca0e3a30bf256b102e77cde72d7a336c57462607807f68412b1
symbol_refs: [Object Iteration]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Values only some val in {"a": 1, "b": 2} # Key and value some key, val in {"a": 1, "b": 2} ```
:::
:::

::: term
id: TERM-228e619879f82d9d
name: Set Iteration
definition: ```rego
# Members
some member in {1, 2, 3}
``` ---
aliases: []
chapter: CH-04
digest: fd1d3fbb5201e4ee05aeef0f5af476b02c004c60dbd225f072d4d1323d1a90aa
symbol_refs: [Set Iteration]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Members some member in {1, 2, 3} ``` ---
:::
:::

::: concept
id: BLK-9810d9b02b25133e
summary: References & the Data Model.
digest: 37b472ddd822fd51ade2bb51acb8796d8a787d462f7527ad2228a3a5cdd9142d
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that References & the Data Model..
vector_summary: References & the Data Model.
chapter: CH-04
:::
References & the Data Model
:::

::: concept
id: BLK-95cc3b002d8754e2
summary: Valid reference roots:.
digest: df8955762c3451784aecf21718d20e7318a87d100f1013a13d1a7d9c9f43e7a6
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Valid reference roots:..
vector_summary: Valid reference roots:.
chapter: CH-04
:::
Valid reference roots:
:::

::: concept
id: BLK-78afb368bfa631d2
summary: Input ‚Äì request-scoped data.
digest: 61ee0767e0fd847d54e77f244f228f1a82c8432a4c3821fedcf9c882b29c7f1a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Input ‚Äì request-scoped data..
vector_summary: Input ‚Äì request-scoped data.
chapter: CH-04
:::
input ‚Äì request-scoped data
:::

::: concept
id: BLK-69421e4d60031cee
summary: Data ‚Äì bundle-scoped data (policies + static data).
digest: a6ae41ed4837b91c81d475c0275a27c6254b3cf41afffe43f590c00e8fa30476
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Data ‚Äì bundle-scoped data (policies + static data)..
semantic_categories: [distribution]
vector_summary: Data ‚Äì bundle-scoped data (policies + static data).
chapter: CH-04
:::
data ‚Äì bundle-scoped data (policies + static data)
:::

::: concept
id: BLK-9fa59c36fe5eb07e
summary: Function calls (results assigned to a variable first).
digest: b810ccda209ec52e45d930949a31c8c4fca3c4ef35ebb400c9b222fbf03dbef2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Function calls (results assigned to a variable first)..
vector_summary: Function calls (results assigned to a variable first).
chapter: CH-04
:::
function calls (results assigned to a variable first)
:::

::: concept
id: BLK-5a1c45e69659b266
summary: Input.user.id data.config.defaults.timeout user := input.user user.profile.email.
digest: 454b303e833a6dc5b88accaa66f6b3d24abcbc5d3795a25c01a238d17eb1bff9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Input.user.id data.config.defaults.timeout user := input.user user.profile.email..
vector_summary: Input.user.id data.config.defaults.timeout user := input.user user.profile.email.
chapter: CH-04
:::
input.user.id data.config.defaults.timeout user := input.user user.profile.email
:::

::: concept
id: BLK-a408b5cb37163856
summary: 4.2 What Cannot Start a Reference (Literals vs References).
digest: 270296d831db557c3d161106368830d180a9a21768171b951e359b0f5ec48823
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 4.2 What Cannot Start a Reference (Literals vs References)..
vector_summary: 4.2 What Cannot Start a Reference (Literals vs References).
chapter: CH-04
:::
4.2 What Cannot Start a Reference (Literals vs References)
:::

::: concept
id: BLK-967e2935894c77e0
summary: You cannot start a reference with:.
digest: 82c43dcb2a1f8192a20443360dc9a2f78ae0162dae079336b243ac07d7afb3de
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You cannot start a reference with:..
vector_summary: You cannot start a reference with:.
chapter: CH-04
:::
You cannot start a reference with:
:::

::: concept
id: BLK-243c144ec9ef9fec
summary: You can assign literals to variables and then reference them:.
digest: 35af2cd357d19bb85a4d5253913e99315d4efffd04861d41e48dd310d33afa76
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You can assign literals to variables and then reference them:..
vector_summary: You can assign literals to variables and then reference them:.
chapter: CH-04
:::
You can assign literals to variables and then reference them:
:::

::: concept
id: BLK-c7bb77c124e34850
summary: Obj := {"name": "Alice"} y := obj.name.
digest: b065d949ba271fdf738502129801ad3495e1652d0d04720adb10660d4b116945
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Obj := {"name": "Alice"} y := obj.name..
vector_summary: Obj := {"name": "Alice"} y := obj.name.
chapter: CH-04
:::
obj := {"name": "Alice"} y := obj.name
:::

::: concept
id: BLK-9b4015c66b260e6b
summary: S := {1, 2, 3} contains_one if 1 in s.
digest: 0b58203d72d2d2e8fe85bfe0df45bbe26cf25ab621ec3d2b7c2bcfe7a4a5a721
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that S := {1, 2, 3} contains_one if 1 in s..
vector_summary: S := {1, 2, 3} contains_one if 1 in s.
chapter: CH-04
:::
s := {1, 2, 3} contains_one if 1 in s
:::

::: concept
id: BLK-4b8e3328604ba9ff
summary: Think of literals as values.
digest: 78e8811c84fa5373e65454796696c8918e08545120429bfe8060cc56a5f0432f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Think of literals as values..
vector_summary: Think of literals as values.
chapter: CH-04
:::
Think of literals as values.
:::

::: concept
id: BLK-db27a696242d571c
summary: Refs start from input, data, locals, or function results.
digest: 73f28a712a6a7a1d43839dc27d9efa5df9a3e80c381f5a7abe8825041d8dab0c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Refs start from input, data, locals, or function results..
vector_summary: Refs start from input, data, locals, or function results.
chapter: CH-04
:::
Refs start from input, data, locals, or function results.
:::

::: concept
id: BLK-fc5db223276d9413
summary: Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù.
digest: 3f636a7d9034b3396d3a8459ac3766e08a2f08849d97b75440874f6f56a090ac
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù..
vector_summary: Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù.
chapter: CH-04
:::
Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù.
:::

::: fact
id: BLK-365e79b627669b85
summary: Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using ==).
digest: 80a71d583ef00e97cc7f8e67f4fbbfc32791063fbd500fbe6c5d365baee49990
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using ==)..
vector_summary: Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using ==).
chapter: CH-04
:::
Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using `==`)
:::

::: fact
id: BLK-374855f2833979c7
summary: Must start with: - Variable - input or data (implicitly imported) - Function call.
digest: 8d0b5493d8c2c7d51eef6d9a333df117451ff92d93f56f1c881537846ae122eb
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Must start with: - Variable - input or data (implicitly imported) - Function call..
vector_summary: Must start with: - Variable - input or data (implicitly imported) - Function call.
chapter: CH-04
:::
1. Must start with: - Variable - `input` or `data` (implicitly imported) - Function call
:::

::: fact
id: BLK-01542ca1939f1e90
summary: Rego references let you navigate input, data, and local bindings.
digest: 7e863df2a6acbcad7fc5de9830e2d4c29f8f7553c439de3c4d7e1c3beb09ece0
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego references let you navigate input, data, and local bindings..
vector_summary: Rego references let you navigate input, data, and local bindings.
chapter: CH-04
:::
Rego references let you navigate input, data, and local bindings.
:::

::: fact
id: BLK-ac51d7f44d5b9f6f
summary: Local variables (from rule heads or := in bodies).
digest: 1c53cbbeb9560d76a000094d79325c7877a077df9a434cd6077952a545d17f56
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Local variables (from rule heads or := in bodies)..
vector_summary: Local variables (from rule heads or := in bodies).
chapter: CH-04
:::
local variables (from rule heads or := in bodies)
:::

::: fact
id: BLK-6a91b47966fe0914
summary: Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value.
digest: 7522539a01ff1a2bcefc0b127e7f6ceada2a543fb64dbbbf9a09a4fc2d259ae9
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value..
vector_summary: Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value.
chapter: CH-04
:::
Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value.
:::

::: fact
id: BLK-0099fb0394aef55d
summary: The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references.
digest: 63e31c47062a20ed5f2a6e71924ba427e812093780fca31e31e3ca72b0f843c8
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references..
vector_summary: The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references.
chapter: CH-04
:::
The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references.
:::

::: fact
id: BLK-6764c41841ecebec
summary: # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0].
digest: 2f122d6ae08e526a5f47cff872eedde804c871a625012eb2630180c8fd6d3fd9
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0]..
vector_summary: # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0].
chapter: CH-04
:::
# ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0]
:::

::: example
id: CODE-43fdfdc8d23de345
language: rego
chapter: CH-04
source: term:Variable Declaration
purpose: definition-example
digest: ff4fd4fcb452b5bfcd78d8cffde7dce6bb12d5f35c26c3772139054619c57373
symbol_refs: [with, name, x]
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Assignment with :=
x := 42
name := input.user.name

# Variables are immutable within scope
x := 42
x := 43  # ‚ùå ERROR: Variable x referenced above
:::

::: example
id: CODE-a02a421a6fac4f98
language: rego
chapter: CH-04
source: term:Unification with =
purpose: definition-example
digest: b09de44d031d71621af668d926ab64be8948ca6398058cedb1fede5fca74552e
symbol_refs: [x]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [unification]
:::
# Pattern matching
[first, second] = [1, 2]
# first ‚Üí 1, second ‚Üí 2

# Symmetric unification
x = y  # Makes x and y equal

# Complex patterns
{"user": user, "role": role} = input.request
:::

::: example
id: CODE-b007cb357523f444
language: rego
chapter: CH-04
source: term:Safety Requirement
purpose: definition-example
digest: a9b453547a166e98ea7f18a408bf9020dcfa1aaef402e93a7e34e1594f7eb6e6
symbol_refs: [user]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
code_smell_probability: 1.0
:::
# ‚ùå Unsafe
bad_rule if {
    not blacklisted[user]  # user never defined
}

# ‚úÖ Safe
good_rule if {
    user := input.user.id
    not blacklisted[user]
}
:::

::: example
id: CODE-cd9f75f4f505f98f
language: rego
chapter: CH-04
source: term:Reference Syntax
purpose: definition-example
digest: 3de0fd12e42a512890f9b6064ef73d352bffa242806228944191552b844c3779
symbol_refs: [underscore]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Dot notation (for simple keys)
input.user.name
data.roles.admin

# Bracket notation (for complex keys)
input["user"]["name"]
data["user-roles"]["admin-user"]

# Variable keys
users[user_id]
data.permissions[input.user.role]

# Array indices
items[0]
items[i]  # Iteration
items[_]  # All values (underscore = wildcard)
:::

::: example
id: CODE-b95dcb5f7af9c909
language: rego
chapter: CH-04
source: term:Reference Rules
purpose: definition-example
digest: d79bc6bf5ee5844d7fa398598d3fa760440bd6e53feda2f20c0715e6720d35cb
symbol_refs: [y, obj, arr, x]
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚ùå Invalid reference starts
x := [1, 2, 3][0]
y := {"name": "Alice"}.name

# ‚úÖ Valid: Assign first
arr := [1, 2, 3]
x := arr[0]

obj := {"name": "Alice"}
y := obj.name
:::

::: example
id: CODE-9480eddfd36d6bd8
language: rego
chapter: CH-04
source: term:Deep Traversal
purpose: definition-example
digest: c1e2ed1223c141d1131867d2a4829713723c67896fa9625890ba0afb7d31a582
symbol_refs: [hostname, all_hostnames]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Multi-level access
sites[i].servers[j].hostname

# With wildcards
all_hostnames := sites[_].servers[_].hostname

# Safe access with default
hostname := input.server.hostname if input.server.hostname
default hostname := "unknown"
:::

::: example
id: CODE-4f7ad951c5e8fc13
language: rego
chapter: CH-04
source: term:When to Use
purpose: definition-example
digest: 4463173ca88315123eac7db4ef772036fc95303f49d2772888d9ce5f1c7a84ed
symbol_refs: [count]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# := for clear assignment (preferred)
count := array.length(items)

# = for pattern matching
[first, second] = [1, 2]

# == for comparison
result if count == 5
:::

::: example
id: CODE-4c3840c3d511c14f
language: rego
chapter: CH-04
source: term:Type Compatibility
purpose: definition-example
digest: 986e499b192f6c8cb1c89f1b66fcda18406f3754e3babc7c795eae7c1787fdb1
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Same types
1 < 2                    # ‚úÖ true
"a" < "b"                # ‚úÖ true

# Different types
1 < "2"                  # ‚ùå undefined (not an error)
:::

::: example
id: CODE-eb69c158485adda6
language: rego
chapter: CH-04
source: term:Examples
purpose: definition-example
digest: 3e9eec5f9aaa29242b2d6910727c028f4f371630c4ee6cbd6090414aa8133b82
symbol_refs: [remainder, diff, product, sum, quotient]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
sum := 10 + 5        # 15
diff := 10 - 5       # 5
product := 10 * 5    # 50
quotient := 10 / 5   # 2 (float)
remainder := 10 % 3  # 1
:::

::: example
id: CODE-52f9fdd779656e38
language: rego
chapter: CH-04
source: term:Use Cases
purpose: definition-example
digest: 1f1485ef1b35afb721b25e2e9f0f756d62522576bd16d50cf3608a01fba55213
symbol_refs: [write_bit, read_bit, has_write, execute_bit]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Permission bits
read_bit := 1
write_bit := 2
execute_bit := 4

has_write := (permissions & write_bit) != 0
:::

::: example
id: CODE-d32e8615902ca0d6
chapter: CH-04
language: rego
role: example
tags: []
explanation: Variables are immutable within scope
confidence: 0.9
digest: 3f0a90039b8a8726d5bf012f3e328f67176aa1f00fa4739853c07e294e8d12b9
symbol_refs: [x]
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
x := 42
x := 43  # ‚ùå ERROR: Variable x referenced above
:::

::: example
id: CODE-1e2dafd1a36095b9
chapter: CH-04
language: rego
role: example
tags: []
explanation: Pattern matching
confidence: 0.9
digest: 5bda2c6816772f627f8631d4ff7980c1bc55bb08cb768c9182eadd922b9be203
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
[first, second] = [1, 2]
:::

::: example
id: CODE-7583d41130ecfa94
chapter: CH-04
language: rego
role: example
tags: []
explanation: first ‚Üí 1, second ‚Üí 2
confidence: 0.9
digest: 7cdf397f18251e45b864cee4d5b5ac93b7cb9a522383896e8fe2f9f402c1ffd0
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: example
id: CODE-74e04ec1775f8da0
chapter: CH-04
language: rego
role: example
tags: []
explanation: Symmetric unification
confidence: 0.9
digest: 2b9741b5f9c85b17020bac0ed8f70d79909d93f17f98c407afb55efc324f2354
symbol_refs: [x]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [unification]
:::
x = y  # Makes x and y equal

:::

::: example
id: CODE-bceca388eebe308f
chapter: CH-04
language: rego
role: example
tags: []
explanation: Bracket notation (for complex keys)
confidence: 0.9
digest: acbb548f7eb7905195759bc212b7900c1b85d35e94f7c4017d6009494508ac3a
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
input["user"]["name"]
data["user-roles"]["admin-user"]

:::

::: example
id: CODE-d7b342344490c7a4
chapter: CH-04
language: rego
role: example
tags: []
explanation: Array indices
confidence: 0.9
digest: f5063435184952990a4fca1926070c472e7d195b929da0507cf633c487f4a9f0
symbol_refs: [underscore]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
items[0]
items[i]  # Iteration
items[_]  # All values (underscore = wildcard)
:::

::: example
id: CODE-2990fba9fd79f435
chapter: CH-04
language: rego
role: example
tags: []
digest: a48a93e76df83640c0fd8ddabd26aab728a70f6b69bb7cb60cfc1a1230607042
symbol_refs: [y, obj, arr, x]
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚ùå Invalid reference starts
x := [1, 2, 3][0]
y := {"name": "Alice"}.name

# ‚úÖ Valid: Assign first
arr := [1, 2, 3]
x := arr[0]

obj := {"name": "Alice"}
y := obj.name
:::

::: example
id: CODE-a62771a93b1461e1
chapter: CH-04
language: rego
role: example
tags: []
explanation: Multi-level access
confidence: 0.9
digest: c99970168ef1ddc1bdc4d2a4b95c7cd84eba22753e20e9d9a241d20fbe221242
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
sites[i].servers[j].hostname

:::

::: example
id: CODE-0408bf157b036da2
chapter: CH-04
language: rego
role: example
tags: []
explanation: With wildcards
confidence: 0.9
digest: 761f25ede9fb45dffb8abc958fab72fb8a8f8d4641c58bd11fd2d6983ec1a97e
symbol_refs: [all_hostnames]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
all_hostnames := sites[_].servers[_].hostname

:::

::: example
id: CODE-e8957c6cca7ec960
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Without 'some' (implicit)
confidence: 0.9
digest: af2e23abc769a60c44b010f4d5bee123d7c357345c550c56cbc670ca24f8e7a7
symbol_refs: [region]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
result if {
    sites[i].region == "west"
}

:::

::: example
id: CODE-6871411455d74e80
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: With 'some' (explicit - recommended)
confidence: 0.9
digest: 1529b0d79a8fa09c08e55835234cbb254d1164ba94a46c998495277ef75575b4
symbol_refs: [region]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
result if {
    some i
    sites[i].region == "west"
}

:::

::: example
id: CODE-cd41f44b1e3b1413
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Modern style with 'in'
confidence: 0.9
digest: bd994cc168dc0c1fce57b5dc0ab9a2ab8534d7dd6777d15450947562cf15e264
symbol_refs: [region]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
result if {
    some site in sites
    site.region == "west"
}
:::

::: example
id: CODE-2f8dc5657c8ff00a
chapter: CH-04
language: rego
role: example
tags: []
digest: 100655eb80bcdaddb29b4f93b7ea1a01a88e2672750049ddb7896284909bcf96
symbol_refs: [count]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# := for clear assignment (preferred)
count := array.length(items)

# = for pattern matching
[first, second] = [1, 2]

# == for comparison
result if count == 5
:::

::: example
id: CODE-bcbba9623c35b340
chapter: CH-04
language: rego
role: example
tags: []
digest: d2bdb987b6e75ffb116642759ec714efb508dcc32d7ea1a236d588cddfd58504
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
x + y    # Addition
x - y    # Subtraction
x * y    # Multiplication
x / y    # Division (float result)
x % y    # Modulo (remainder)
:::

::: example
id: CODE-da6034813f38ffd6
chapter: CH-04
language: rego
role: example
tags: []
digest: 8520a39d14d301b929e9d7cc429f867075585017b828170897963f9999b5dc27
symbol_refs: [remainder, diff, product, sum, quotient]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
sum := 10 + 5        # 15
diff := 10 - 5       # 5
product := 10 * 5    # 50
quotient := 10 / 5   # 2 (float)
remainder := 10 % 3  # 1
:::

::: example
id: CODE-9a2d4c6c1eb05ea6
chapter: CH-04
language: rego
role: example
tags: []
digest: 2d7bb45bacd6af26c6d7d366fbbc36cc4528225835ca9c89abff33faded1a6cc
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
x & y    # Bitwise AND
x | y    # Bitwise OR
:::

::: example
id: CODE-833d67ca5bf608a6
chapter: CH-04
language: rego
role: example
tags: []
digest: 9112a480358ed68cc1c012b7bbbd41b92d2cd3a92b99199be63a7d59225b5d70
symbol_refs: [write_bit, read_bit, has_write, execute_bit]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Permission bits
read_bit := 1
write_bit := 2
execute_bit := 4

has_write := (permissions & write_bit) != 0
:::

::: example
id: CODE-c85bb93a7ccfac64
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Membership testing (returns boolean)
confidence: 0.9
digest: 8a39334538e282aa1098005676551d2ddd2b491da65c405d1a17fdcc8fc117f3
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
"admin" in user.roles                 # true/false
3 in [1, 2, 3]                        # true
"key" in {"key": "value"}             # true (checks keys in objects)

:::

::: example
id: CODE-2f56e9162c110a40
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Iteration (with 'some')
confidence: 0.9
digest: d7bfab6026d9015d07f11924012099b80bc07ea9f92517283ca58a6d7d4476b2
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
some role in user.roles
some i, item in items                 # index and value
some key, value in object             # key and value

:::

::: example
id: CODE-a84c6328e44a8505
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Negation
confidence: 0.9
digest: fb3a1c783913fe3578af2b3142775cdcbef727e57a9d38b485c8f2413a21a818
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation]
:::
not "admin" in user.roles
:::

::: example
id: CODE-b624b208cd3b5ba3
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Values only
confidence: 0.9
digest: 95e54e88345cb60d1cf41d41d98e6b1af67388184efad285e87ad661f3cb5b8f
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
some item in [1, 2, 3]

:::

::: example
id: CODE-bf5174631e66f074
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Index and value
confidence: 0.9
digest: 01b8b8a4634540e150ba19cd25a2ec39add4978826a54bf05bff8cfc6d9b1d60
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
some i, item in [1, 2, 3]
:::

::: example
id: CODE-9410c91f9d9d046f
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Values only
confidence: 0.9
digest: 570680c6d8439d1b23ad345107f92a3558ec5ec98bd6947e82d23e63c375daf5
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
some val in {"a": 1, "b": 2}

:::

::: example
id: CODE-228f7ddbcb6151ad
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Key and value
confidence: 0.9
digest: 1fd932b25eff04956f00368945b2d69c2dbbb1d555c69bacacf47d211613df3e
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
some key, val in {"a": 1, "b": 2}
:::

::: code-pattern
id: CODE-33cc2f66fa073f3a
language: rego
chapter: CH-04
source: term:Explicit Variable Declaration
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: f33d1b1290fcc0dac0afc86eb801664ea382d2213eb22151c8dae6600ec03009
symbol_refs: [region]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Without 'some' (implicit)
result if {
    sites[i].region == "west"
}

# With 'some' (explicit - recommended)
result if {
    some i
    sites[i].region == "west"
}

# Modern style with 'in'
result if {
    some site in sites
    site.region == "west"
}
:::

::: code-pattern
id: CODE-3cb95b2fa63c007b
language: rego
chapter: CH-04
source: term:Multiple Variables
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: fc8db581a7c734242050d4c40a993dd5e8e59b16682dfd8f59d5afe6ce07e803
symbol_refs: [hostname, name]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
result if {
    some i, j
    sites[i].servers[j].name == "web-0"
    hostname := sites[i].servers[j].hostname
}

# Or with 'in'
result if {
    some site in sites
    some server in site.servers
    server.name == "web-0"
}
:::

::: code-pattern
id: CODE-ea38956bc4339e53
language: rego
chapter: CH-04
source: term:Dual Purpose
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: d4d9e120975a5baf850281efa9613b3749aaa2e4fdb738ac3a0a953775101e31
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [negation, testing]
:::
# Membership testing (returns boolean)
"admin" in user.roles                 # true/false
3 in [1, 2, 3]                        # true
"key" in {"key": "value"}             # true (checks keys in objects)

# Iteration (with 'some')
some role in user.roles
some i, item in items                 # index and value
some key, value in object             # key and value

# Negation
not "admin" in user.roles
:::

::: code-pattern
id: CODE-1b107ec7cb6ae135
language: rego
chapter: CH-04
source: term:Array Iteration
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 242d316b3c5a2ed07fd275d9f3249c354cf501d8369748c7904eaa258ea2bf02
symbol_refs: [i, item]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Values only
some item in [1, 2, 3]

# Index and value
some i, item in [1, 2, 3]
# Binds: i=0, item=1; then i=1, item=2; etc.
:::

::: code-pattern
id: CODE-46f9779c90ce8a98
language: rego
chapter: CH-04
source: term:Object Iteration
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: f089032b1880f993255a3dab5038be0752f67f8c38a8d982a4ba5f70ab4a051c
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Values only
some val in {"a": 1, "b": 2}

# Key and value
some key, val in {"a": 1, "b": 2}
:::

::: code-pattern
id: CODE-f0186ce6d764df50
language: rego
chapter: CH-04
source: term:Set Iteration
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: e0c9be9dce08e6ff6d1b4d4908fd3e4d6ce3b22fd492b693005036e04c4103fe
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Members
some member in {1, 2, 3}
:::

::: code-pattern
id: CODE-7d36c777bc54eff2
chapter: CH-04
language: rego
role: example
tags: []
explanation: Assignment with :=
confidence: 0.9
pattern_type: generic
digest: 1d70e506114a632d5bc9a3d0a92544d1ab67c51d67b8807fb0675f7608eb38f2
symbol_refs: [name, x]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
x := 42
name := input.user.name

:::

::: code-pattern
id: CODE-16006224b7fc05e6
chapter: CH-04
language: rego
role: example
tags: []
explanation: Complex patterns
confidence: 0.9
pattern_type: generic
digest: f3e38d6092a666a1d6bea50c27b31b29a6cdefc435cc529b2cce45b5891aaefc
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
{"user": user, "role": role} = input.request
:::

::: code-pattern
id: CODE-6657dc626f7f81a0
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: 4815782f2c4ed409f4e37d46a2ceb47a78efe694594f20edab89d6a659e5d003
symbol_refs: [user]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 1.0
:::
# ‚ùå Unsafe
bad_rule if {
    not blacklisted[user]  # user never defined
}

# ‚úÖ Safe
good_rule if {
    user := input.user.id
    not blacklisted[user]
}
:::

::: code-pattern
id: CODE-2f6d9a5bbe34c891
chapter: CH-04
language: rego
role: example
tags: []
explanation: Dot notation (for simple keys)
confidence: 0.9
pattern_type: generic
digest: 30cee5856e1d937aeef7464bff66b950deeee223bb09f96a5a5bb2978733f869
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
input.user.name
data.roles.admin

:::

::: code-pattern
id: CODE-917af16bdaf9c69e
chapter: CH-04
language: rego
role: example
tags: []
explanation: Variable keys
confidence: 0.9
pattern_type: generic
digest: b567b769075d0977204d613c1b59d4cfcdbc393f653bd0dd282ec673fb0fe796
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
users[user_id]
data.permissions[input.user.role]

:::

::: code-pattern
id: CODE-a177475f64f6ae17
chapter: CH-04
language: rego
role: example
tags: []
explanation: Safe access with default
confidence: 0.9
pattern_type: generic
digest: 3bd0e6564271caf008c6e99e9abe6fdd5585a024f4e4a137bd9b5f0c03d99abb
symbol_refs: [hostname]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
hostname := input.server.hostname if input.server.hostname
default hostname := "unknown"
:::

::: code-pattern
id: CODE-06020989fe05ea03
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: a9c41e83509376834799bf383690abf26ec27648247c1e97bf9d70388a5e3e01
symbol_refs: [hostname, name]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
result if {
    some i, j
    sites[i].servers[j].name == "web-0"
    hostname := sites[i].servers[j].hostname
}

# Or with 'in'
result if {
    some site in sites
    some server in site.servers
    server.name == "web-0"
}
:::

::: code-pattern
id: CODE-eb1bcfa56e45915a
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: 65c98312aea89cade27ca804a077bf06d864e935e6f2ad72911f01779a05a3ea
symbol_refs: [x]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
x == y   # Equal
x != y   # Not equal
x < y    # Less than
x <= y   # Less than or equal
x > y    # Greater than
x >= y   # Greater than or equal
:::

::: code-pattern
id: CODE-d89dfa73fd3f18f9
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: f92aef99ec73b60f017bf250094010f7671336f0fede72f594573a041e07d57a
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Same types
1 < 2                    # ‚úÖ true
"a" < "b"                # ‚úÖ true

# Different types
1 < "2"                  # ‚ùå undefined (not an error)
:::

::: code-pattern
id: CODE-a1a7ab680e3a11de
chapter: CH-04
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: 9b9675e57a1426fce7bfd50f4f7f4d0d5d5cdbfe5eaa4e57de38eb27e706f435
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Members
some member in {1, 2, 3}
:::

::: code-pattern
id: CODEPAT-74a112e70eb142c6
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-04
metadata: {'quantifier': 'some'}
digest: 2ffe57dbc5a6f8eccde7180f3bb79b53cbc4c885b6eb40529c1ea1aac8f3105e
symbol_refs: [region]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Without 'some' (implicit)
result if {
    sites[i].region == "west"
}

# With 'some' (explicit - recommended)
result if {
    some i
    sites[i].region == "west"
}

# Modern style with 'in'
result if {
    some site in sites
    site.region == "west"
}
:::

::: code-pattern
id: CODEPAT-15db5e11416df003
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-04
metadata: {'quantifier': 'some'}
digest: 3422235df773e39b5fc21c0f9d53dbcbc0834a449944f5403aa53929b218756c
symbol_refs: [hostname, name]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
result if {
    some i, j
    sites[i].servers[j].name == "web-0"
    hostname := sites[i].servers[j].hostname
}

# Or with 'in'
result if {
    some site in sites
    some server in site.servers
    server.name == "web-0"
}
:::

::: code-pattern
id: CODEPAT-640cec8bf45426a3
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-04
metadata: {'quantifier': 'some'}
digest: 555da8f4dc49640ef4378dc9bed1b64d49f5aa2f350f8223254ad8b0c8da3d4d
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [negation, testing]
:::
# Membership testing (returns boolean)
"admin" in user.roles                 # true/false
3 in [1, 2, 3]                        # true
"key" in {"key": "value"}             # true (checks keys in objects)

# Iteration (with 'some')
some role in user.roles
some i, item in items                 # index and value
some key, value in object             # key and value

# Negation
not "admin" in user.roles
:::

::: code-pattern
id: CODEPAT-10b19c1e8f7a7c78
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-04
metadata: {'quantifier': 'some'}
digest: bdf11dfb1665dce0cb1e9ac068b8798eb218e95ac8e02388545b9a58aef2202a
symbol_refs: [i, item]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Values only
some item in [1, 2, 3]

# Index and value
some i, item in [1, 2, 3]
# Binds: i=0, item=1; then i=1, item=2; etc.
:::

::: code-pattern
id: CODEPAT-8e9890b5393f8391
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-04
metadata: {'quantifier': 'some'}
digest: 49601585603d13e2c3a0d24c3efcbed8a2e11eb17fa734670c6d690e0580d42a
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Values only
some val in {"a": 1, "b": 2}

# Key and value
some key, val in {"a": 1, "b": 2}
:::

::: code-pattern
id: CODEPAT-39d782720bf449f1
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-04
metadata: {'quantifier': 'some'}
digest: 6d47642bce4ec81a25c7d28cb67f8547b1ce712f7790fd554ca37b145b803c2a
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Members
some member in {1, 2, 3}
:::

::: common-mistake
id: BLK-d7c09f7edc839a82
summary: Cannot start with: - Literal arrays: [1,2,3][0] ‚ùå - Literal objects: {"a":1}.a ‚ùå - Literal sets: {1,2,3}[0] ‚ùå.
digest: 7945843ab4b3590597b4e631956ac5122077459b24644290347dd60fa3cf21b4
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-04
:::
2. Cannot start with: - Literal arrays: `[1,2,3][0]` ‚ùå - Literal objects: `{"a":1}.a` ‚ùå - Literal sets: `{1,2,3}[0]` ‚ùå
:::

::: common-mistake
id: BLK-91f77ccc9a537a4b
summary: # ‚ùå Invalid: literals are values, not reference roots x := [1, 2, 3][0] y := {"name": "Alice"}.name z := {1, 2, 3}[0].
digest: 9ea6df714152c58dc74a655a59d990622c75b318d434682bc0986472265def8a
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-04
:::
# ‚ùå Invalid: literals are values, not reference roots x := [1, 2, 3][0] y := {"name": "Alice"}.name z := {1, 2, 3}[0]
:::

::: constraint
id: CONSTR-b960952c21854a8d
chapter: CH-04
source_id: TERM-da82327651a758ef
type: forbidden
digest: 2d0acf879fa226a685c954d80f3414d4549dc0839411f2bbe47dc4748e5087ba
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-247743bd0590722d
chapter: CH-04
source_id: CODE-b007cb357523f444
type: forbidden
digest: 2a5c3dee85cc0461cf8a12b2dc8da1a99972491f5d52caba9173e1695e408e08
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-b279867a18b15a50
chapter: CH-04
source_id: CODE-6657dc626f7f81a0
type: forbidden
digest: 3dacbeecad781a2837c49f36ce989b7de4eff2b71a6473aefda9cc989fc4d0f5
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: table
id: TABLE-40d7c73b90f30b23
chapter: CH-04
headers: [Operator, Name, Usage, Rebind Allowed?]
row_count: 3
caption: 
rows: [['`:=`', 'Assignment', '`x := 10`', 'No'], ['`=`', 'Unification', '`x = y`', 'Yes (pattern match)'], ['`==`', 'Equality', '`x == y`', 'Yes (comparison)']]
digest: 142788e5f519ae35c785c9e4f9f9d8eb251af3b227b88775f344ca8976686189
symbol_refs: []
semantic_role: reference
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [unification]
:::
:::

::: table
id: TABLE-9a6e7e95ed856ec4
chapter: CH-04
type: dos-donts
headers: [Do, Don't]
rows: [['Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using ==).', 'Cannot start with: - Literal arrays: [1,2,3][0] ‚ùå - Literal objects: {"a":1}.a ‚ùå - Literal sets: {1,2,3}[0] ‚ùå.'], ['Must start with: - Variable - input or data (implicitly imported) - Function call.', '# ‚ùå Invalid: literals are values, not reference roots x := [1, 2, 3][0] y := {"name": "Alice"}.name z := {1, 2, 3}[0].'], ['Rego references let you navigate input, data, and local bindings.', ''], ['Local variables (from rule heads or := in bodies).', ''], ['Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value.', ''], ['The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references.', ''], ['# ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0].', '']]
digest: 32bc877c9d626139521d86714851659294797924790fd5c7bb2f76908121d9dc
symbol_refs: []
semantic_role: reference
:::
| Do | Don't |
| --- | --- |
| Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using ==). | Cannot start with: - Literal arrays: [1,2,3][0] ‚ùå - Literal objects: {"a":1}.a ‚ùå - Literal sets: {1,2,3}[0] ‚ùå. |
| Must start with: - Variable - input or data (implicitly imported) - Function call. | # ‚ùå Invalid: literals are values, not reference roots x := [1, 2, 3][0] y := {"name": "Alice"}.name z := {1, 2, 3}[0]. |
| Rego references let you navigate input, data, and local bindings. |  |
| Local variables (from rule heads or := in bodies). |  |
| Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value. |  |
| The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references. |  |
| # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0]. |  |
:::

::: qa
id: QA-1367c92c537068f6
chapter: CH-04
q: What is Variable Declaration in the context of Rego/OPA?
a: ```rego
reference: TERM-1a0cf4c1598ec141
digest: 159535d5829cc6e385494e812663dc57f0c9c616e2f979a3279f4932086dac0c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2fcd7b06e77aa3c6
chapter: CH-04
q: What is Unification with = in the context of Rego/OPA?
a: ```rego
reference: TERM-ec28f90bca10efb5
semantic_categories: [unification]
digest: 3cb621239b79018833c9334f5927b8990322bb50088f19a20542ba8e8dcdcdaf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-02ed48fa644691c3
chapter: CH-04
q: What is Safety Requirement in the context of Rego/OPA?
a: Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using `==`) ```rego
reference: TERM-da82327651a758ef
digest: dca87287cc861852ac8afbb84c75038c9b07ab2a93c5245d211dbfe7230e2e1f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-96485c7e5c41dc2e
chapter: CH-04
q: What is Reference Syntax in the context of Rego/OPA?
a: ```rego
reference: TERM-a49e5704307f2b3c
digest: 652d80481c4fe11243326a5aaa6d5513d8fe47b0136eaf38cd0a1ed7f42b1847
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7dc0a0abf2b8a103
chapter: CH-04
q: What is Reference Rules in the context of Rego/OPA?
a: 1. Must start with: - Variable - `input` or `data` (implicitly imported) - Function call 2. Cannot start with: - Literal arrays: `[1,2,3][0]` ‚ùå - Literal objects: `{"a":1}.a` ‚ùå - Literal sets: `{1,2,3}[0]` ‚ùå ```rego
reference: TERM-91f24b484e572cbb
digest: 6340c65a1f878bba5b51103dbf0f6850c538f96bcacf300ab93534c6280e3146
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-87a0f3af8dd098f8
chapter: CH-04
q: What is Deep Traversal in the context of Rego/OPA?
a: ```rego
reference: TERM-5334ad887ed1e16d
digest: 7e5a4b3e062f357bbf6f16b62c3f389109884d9f54e2cae77b8202ac9814ca4b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3f27b5e1cb7dd3b5
chapter: CH-04
q: What is Explicit Variable Declaration in the context of Rego/OPA?
a: ```rego
reference: TERM-43534f97811a5b70
digest: fb72e88a30c6d397b8a650072723abec0b999a92fd94a14ca7c993488f1ebe92
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ffd71a29e0f14425
chapter: CH-04
q: What is Benefits in the context of Rego/OPA?
a: - Makes intent explicit - Prevents variable capture from outer scope - Improves readability - Required for safety in some contexts
reference: TERM-fa93cc1275da4b1d
digest: 1b9373f9ff5ac84ba1d0e42256342b08ca17dafe0b9287d4017571d30f3f65d9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6d0fffaf85403fb4
chapter: CH-04
q: What is Multiple Variables in the context of Rego/OPA?
a: ```rego
reference: TERM-f78add9404966230
digest: 46e3d9e75121d6137a5542bbc2117f8a4a87e6c0fcf47c7fe27811cbd01b4869
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-efb580b016c9b433
chapter: CH-04
q: What is When to Use in the context of Rego/OPA?
a: ```rego
reference: TERM-4176bf4a5b555c86
digest: 3d11daf83aa2e8529b24293ac468b9233b86cd26fffaa0c75894bd8033349558
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ed7b7e08c71a4a7b
chapter: CH-04
q: What is Type Compatibility in the context of Rego/OPA?
a: ```rego
reference: TERM-8929b33c2f4cdfab
digest: f067d8217ba770a2db931a340e701263818b34a6fe4c71f2c45f51a71c3fabf2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-263bd4601795a816
chapter: CH-04
q: What is Examples in the context of Rego/OPA?
a: ```rego
reference: TERM-7189e73f44e918ef
digest: 1f4e8885933b9e3e7539bc5e2d271a00af66aec725e6dcb41f64ac3186370443
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-af9f8e4a2c5b3c3c
chapter: CH-04
q: What is Use Cases in the context of Rego/OPA?
a: ```rego
reference: TERM-c38851c763d3b0b9
digest: 22b059739ec02778d35ae1ec5f73511bbbec93c7067dfc5cde45baf9e6cabdb1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2369598757bf56e2
chapter: CH-04
q: What is Dual Purpose in the context of Rego/OPA?
a: Membership testing AND iteration ```rego
reference: TERM-6b7ccdb5c322862a
semantic_categories: [testing]
digest: 10b7766996cc9326075b793424a93ae186aa77b82258aacaa2a59492c2dd6a6e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e1c798091080ced1
chapter: CH-04
q: What is Array Iteration in the context of Rego/OPA?
a: ```rego
reference: TERM-38529fcbca6dfab4
digest: 3e13312590816283661683f505710d73689c1c4fb241777d13b87cc74069062b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fb039b8ef8b47511
chapter: CH-04
q: What is Object Iteration in the context of Rego/OPA?
a: ```rego
reference: TERM-b493f9aa81a5c455
digest: a1630ebca04bb6bb8f4724628e2914a8b94e5a1e85434182f76440f5b6dd564a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-88bd30ff9a35f7bb
chapter: CH-04
q: What is Set Iteration in the context of Rego/OPA?
a: ```rego
reference: TERM-228e619879f82d9d
digest: a25b7f0f2bbc5e6e3a06302b360ee7b61dc041d2e3058612437178e8449da8a2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5e90eb0d494bfba1
chapter: CH-04
q: What is Variables must be "grounded" (defined) before use in in the context of Rego/OPA?
a: Variables must be "grounded" (defined) before use in: - Negated expressions - Certain built-in function arguments - Comparisons (when using `==`)
reference: BLK-365e79b627669b85
digest: 4c0251a02580fb620a1eee7ebbef3d11ffeb93663ec8d6c687bda653da45cc6b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6e39e8d9737e442a
chapter: CH-04
q: What is Must start with in the context of Rego/OPA?
a: 1. Must start with: - Variable - `input` or `data` (implicitly imported) - Function call
reference: BLK-374855f2833979c7
digest: a8b5fcb838c6ff1fb9c8e5a88b58e4cb9efb48767772ede49c46b9699c34d41c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1b87ace87df648fb
chapter: CH-04
q: What is References & the Data Model. in the context of Rego/OPA?
a: References & the Data Model
reference: BLK-9810d9b02b25133e
digest: 0a49caf44d3422940588772ff9cf5573f3edd0d3e59f50a94bf5938a1c9c3250
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c070ad37ca276251
chapter: CH-04
q: What is Rego references let you navigate input, data, and local bindings. in the context of Rego/OPA?
a: Rego references let you navigate input, data, and local bindings.
reference: BLK-01542ca1939f1e90
digest: 8812bbb85db2bbba4c196e284eaebc29f4913816a542cee70feb466bd42c0b49
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fbe01bebf44140c3
chapter: CH-04
q: What is Valid reference roots in the context of Rego/OPA?
a: Valid reference roots:
reference: BLK-95cc3b002d8754e2
digest: 8d71642bc5f97270159564f0d80bcfaaba9bf6e94bc5de2816c78ade22cd1bdb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ab32b7d71dd44de7
chapter: CH-04
q: What is Input ‚Äì request-scoped data. in the context of Rego/OPA?
a: input ‚Äì request-scoped data
reference: BLK-78afb368bfa631d2
digest: 44c0ea098a8979bf547b6d3058326a08aabd0b003dcf55b26fd5e8d67745fd19
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cf36aa970d0a1c17
chapter: CH-04
q: What is Data ‚Äì bundle-scoped data (policies + static data). in the context of Rego/OPA?
a: data ‚Äì bundle-scoped data (policies + static data)
reference: BLK-69421e4d60031cee
semantic_categories: [distribution]
digest: 6531c5d51d3c20322c9ed265517f521e3b8e57df54d65bee9222d98380421b17
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-802406596ba1d14a
chapter: CH-04
q: What is Local variables (from rule heads or  in the context of Rego/OPA?
a: local variables (from rule heads or := in bodies)
reference: BLK-ac51d7f44d5b9f6f
digest: 553e0b50495b47c5de8e8c00b226168bb21999e2ac98a93b2b006425fedd7a76
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-352496975679d082
chapter: CH-04
q: What is Function calls (results assigned to a variable first). in the context of Rego/OPA?
a: function calls (results assigned to a variable first)
reference: BLK-9fa59c36fe5eb07e
digest: 4ab5d6d36be7c367d4db12d6f90c8e99c930c94b6a3ae99763d5a17524f93e06
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d8a04f42ae5d3888
chapter: CH-04
q: What is Input.user.id data.config.defaults.timeout user  in the context of Rego/OPA?
a: input.user.id data.config.defaults.timeout user := input.user user.profile.email
reference: BLK-5a1c45e69659b266
digest: 439bf8c1fb2f019218d6bb1f66ba1505d4529ce2ecba817878cf3c3575af2803
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-75dd91684829ccfa
chapter: CH-04
q: What is 4.2 What Cannot Start a Reference (Literals vs References). in the context of Rego/OPA?
a: 4.2 What Cannot Start a Reference (Literals vs References)
reference: BLK-a408b5cb37163856
digest: a10f23b957af47d37681108d6a46f44e7775023535a92fc61a75822db3085545
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3631a5a40f29ab2e
chapter: CH-04
q: What is Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value. in the context of Rego/OPA?
a: Rego‚Äôs reference grammar requires that a reference start from a reference root, not a literal value.
reference: BLK-6a91b47966fe0914
digest: d43e86d76147c4eb5dc8273b1fd49ff8316c4c290492e11f0c4b6e1df0c88ea2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ea4c50b0b1242efc
chapter: CH-04
q: What is You cannot start a reference with in the context of Rego/OPA?
a: You cannot start a reference with:
reference: BLK-967e2935894c77e0
digest: bb8063255687d392fce1eb4a97ac2c6c6d9658104888257c6f489fb8b8538904
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2570e3a7e6b50b36
chapter: CH-04
q: What is The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references. in the context of Rego/OPA?
a: The problem is not that indexing literals is conceptually impossible; it‚Äôs that in Rego, literals are not references.
reference: BLK-0099fb0394aef55d
digest: 4097f1d2181a86d1b1942322361aeb014256c2737c51c852bfefb32d1bdb5651
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3b09574e286731d4
chapter: CH-04
q: What is You can assign literals to variables and then reference them in the context of Rego/OPA?
a: You can assign literals to variables and then reference them:
reference: BLK-243c144ec9ef9fec
digest: 931eb52c28d3db43202ecd2174f97c29bb83ab7e1b6798b419f0c06f7863e62c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8ba466ee3873ce3a
chapter: CH-04
q: What is # ‚úÖ Valid in the context of Rego/OPA?
a: # ‚úÖ Valid: assign literal to variable then index/select arr := [1, 2, 3] x := arr[0]
reference: BLK-6764c41841ecebec
digest: 9611be35db7da2e591db5a496c538f5d5ae33a8b78cff5952fcc43379225c6d5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-da4ed7eb2b5f1bec
chapter: CH-04
q: What is Obj  in the context of Rego/OPA?
a: obj := {"name": "Alice"} y := obj.name
reference: BLK-c7bb77c124e34850
digest: 13c49db1696648dd7a2ac362384fe1b52cfcd8c3f97b932f1253c25010612eac
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c00e5c7a999af8b8
chapter: CH-04
q: What is S  in the context of Rego/OPA?
a: s := {1, 2, 3} contains_one if 1 in s
reference: BLK-9b4015c66b260e6b
digest: 74275739039ef3f057b8e064da6ffe5f4b3054dc5e11e2ec397b562c8e430d23
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2e6aaecb1d2f0f44
chapter: CH-04
q: What is Think of literals as values. in the context of Rego/OPA?
a: Think of literals as values.
reference: BLK-4b8e3328604ba9ff
digest: 1e0c339431ebab740a0167da5cf2af0f94140d909cee2aa09a97b6d4eb8edbd3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d6f380bea3c79fdf
chapter: CH-04
q: What is Refs start from input, data, locals, or function results. in the context of Rego/OPA?
a: Refs start from input, data, locals, or function results.
reference: BLK-db27a696242d571c
digest: 69eaca176d18cd053d2313c563d92981a1838a40df5c1f0f628da58c38206d93
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2f6c7139817b87f2
chapter: CH-04
q: What is Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù. in the context of Rego/OPA?
a: Use a local binding when you want to operate on a literal in ‚Äúreference form‚Äù.
reference: BLK-fc5db223276d9413
digest: bf292fb65440bf1015505df670a0b8fa647611d44768674db819cb04da1c9a54
symbol_refs: []
semantic_role: explanation
:::
:::

::: reasoning-chain
id: CHAIN-1a588b6ed48183f3
chapter: CH-04
qa_id: QA-1367c92c537068f6
reference: TERM-1a0cf4c1598ec141
semantic_categories: [truth-values]
digest: 3a996ef04cc3c742225172abb69a2c15780bebca170863035fbe1e09d04ea8cd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c50b04ddb015d7fe
chapter: CH-04
qa_id: QA-2fcd7b06e77aa3c6
reference: TERM-ec28f90bca10efb5
semantic_categories: [truth-values]
digest: d8a2769a2732d13e339de5e4f15ea3ff3326d3dca473ddb2346b95101b3d66fa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0990842d81b17a9e
chapter: CH-04
qa_id: QA-02ed48fa644691c3
reference: TERM-da82327651a758ef
semantic_categories: [truth-values]
digest: e75fb6c26610bab912dcb14e521c785516049614b92d0c4649a2bdf62cc7bba3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-51c09add3e2060a2
chapter: CH-04
qa_id: QA-96485c7e5c41dc2e
reference: TERM-a49e5704307f2b3c
semantic_categories: [truth-values]
digest: a526c915048f26076c1de2262a68d120b89883e3ae4f722905d208b2a0886d28
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d3b5a69693c5118e
chapter: CH-04
qa_id: QA-7dc0a0abf2b8a103
reference: TERM-91f24b484e572cbb
semantic_categories: [truth-values]
digest: 963b39d45e71e3c447aa11edef009bb4d42b4d353f9bd9c0242e2cb51fa9b185
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3856d66c302cd8ab
chapter: CH-04
qa_id: QA-87a0f3af8dd098f8
reference: TERM-5334ad887ed1e16d
semantic_categories: [truth-values]
digest: f4adad0ec78aaf60584fcfb665d8c22f5ad7d54aa0ca281386bfb07341a0c7a6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dd6d0878f73df7c4
chapter: CH-04
qa_id: QA-3f27b5e1cb7dd3b5
reference: TERM-43534f97811a5b70
semantic_categories: [truth-values]
digest: ad45adbce10bd02a921fdac00ae7ae5636d60e65ab78742f2bb07ac4637a759b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-48c0c7bd82724edd
chapter: CH-04
qa_id: QA-ffd71a29e0f14425
reference: TERM-fa93cc1275da4b1d
semantic_categories: [truth-values]
digest: e039f60b87b6b237d62f7ea04a62c0b63bddfb980929062242f41f9fd81c5b31
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eb4034374ee9f441
chapter: CH-04
qa_id: QA-6d0fffaf85403fb4
reference: TERM-f78add9404966230
semantic_categories: [truth-values]
digest: 0ff3ce964e257322ad9cb9cd67859eb52bf3ee6cfef6fa62e34d9a2212a67fa9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0157749ed9a6bc50
chapter: CH-04
qa_id: QA-efb580b016c9b433
reference: TERM-4176bf4a5b555c86
semantic_categories: [truth-values]
digest: 483ce4fbc968593977cf5b200ae74023639e966ee018fc98b638176830073fae
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-44bb7172d3b1673f
chapter: CH-04
qa_id: QA-ed7b7e08c71a4a7b
reference: TERM-8929b33c2f4cdfab
semantic_categories: [truth-values]
digest: e580565ed7418dc5767252d0a423dfaa42a931f9e5f1ff11dce44c73115d4e06
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b8f05a1a6aa45bf7
chapter: CH-04
qa_id: QA-263bd4601795a816
reference: TERM-7189e73f44e918ef
semantic_categories: [truth-values]
digest: 76a372165e6ff70c98a69191a6e8ff6d9b17079604465219425d78020dd08c77
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3a04376f5a7d03c0
chapter: CH-04
qa_id: QA-af9f8e4a2c5b3c3c
reference: TERM-c38851c763d3b0b9
semantic_categories: [truth-values]
digest: 03750a42bf756c12d92a514f12ec95080256a3f90d86e2f835acadf90ed4595c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5905755fbbe10371
chapter: CH-04
qa_id: QA-2369598757bf56e2
reference: TERM-6b7ccdb5c322862a
semantic_categories: [truth-values]
digest: 73c4ecf1566da6614c681f0ab20b82b986ab377f6b0845a51085a7043f86d1b5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-10d515a2a0a237cb
chapter: CH-04
qa_id: QA-e1c798091080ced1
reference: TERM-38529fcbca6dfab4
semantic_categories: [truth-values]
digest: 52331066faf2dd6201b4fa5bed22a821d21ff96499020dfdc863d0bc8f215056
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-42985c8d47618b09
chapter: CH-04
qa_id: QA-fb039b8ef8b47511
reference: TERM-b493f9aa81a5c455
semantic_categories: [truth-values]
digest: 6de45c30acf990aa853c0d7cb382e0cb4f9cec1144d59b91747a86484d1b867d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-49e23c08b8214555
chapter: CH-04
qa_id: QA-88bd30ff9a35f7bb
reference: TERM-228e619879f82d9d
semantic_categories: [truth-values]
digest: 116ccef0db9f368bfc22beb343aede16ce9b0e4a50531cf8429ac2071f20015d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-16c14a7ab12f97bd
chapter: CH-04
qa_id: QA-5e90eb0d494bfba1
reference: BLK-365e79b627669b85
semantic_categories: [truth-values]
digest: 5e93a035078c9f9373a7a37c77c3336f1256be06796b8e469fdd60841bfcf350
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4e6a60ca4e64241c
chapter: CH-04
qa_id: QA-6e39e8d9737e442a
reference: BLK-374855f2833979c7
semantic_categories: [truth-values]
digest: 6973b4a9a495f79c310c88409763477d3be6690e1b965157d780601e2ca1ac3c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-431367855f024b3c
chapter: CH-04
qa_id: QA-1b87ace87df648fb
reference: BLK-9810d9b02b25133e
semantic_categories: [truth-values]
digest: d796da07cf85d04f4b8a81acf8186ab4b8f287595d53ac8f75af672e3b83267f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f5f353ad4d3a1a2c
chapter: CH-04
qa_id: QA-c070ad37ca276251
reference: BLK-01542ca1939f1e90
semantic_categories: [truth-values]
digest: 251ad95e50a50f0d65e1a49d497cca7890d46e026486b478487f109c07b49d1a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-285b8146903c36e5
chapter: CH-04
qa_id: QA-fbe01bebf44140c3
reference: BLK-95cc3b002d8754e2
semantic_categories: [truth-values]
digest: 09bb1c41e035b768e09171eeac775a97b3706f60529e56f83558d30cd395abf2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-65b8c40310b7244b
chapter: CH-04
qa_id: QA-ab32b7d71dd44de7
reference: BLK-78afb368bfa631d2
semantic_categories: [truth-values]
digest: 772f667fa622f5e7d6e3d3b9d415e3e2e1f2ebc1d00d9b5ecbab8a5be98a49fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8874e137a69eac89
chapter: CH-04
qa_id: QA-cf36aa970d0a1c17
reference: BLK-69421e4d60031cee
semantic_categories: [truth-values]
digest: d5eb7b3de8c3012c45876ab87e5835936329336bdbc2b54de5f6de386235e333
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c28a5b543f3b402
chapter: CH-04
qa_id: QA-802406596ba1d14a
reference: BLK-ac51d7f44d5b9f6f
semantic_categories: [truth-values]
digest: 12cfa2061b6e735e273896d499e7e703862dcecc25968939cf2db4fad1636c8d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-984dcf8af3a1f69d
chapter: CH-04
qa_id: QA-352496975679d082
reference: BLK-9fa59c36fe5eb07e
semantic_categories: [truth-values]
digest: 4f10459562883701fd9b8ab9b64f898479f3c0f7c3a8ba947b5671cbe12f349b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-74ee0e5a777c3b6c
chapter: CH-04
qa_id: QA-d8a04f42ae5d3888
reference: BLK-5a1c45e69659b266
semantic_categories: [truth-values]
digest: cff9e6dde66cb82f6be7838b7c7d21c0984bcc065194397ad1cc5f277b25ef3f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a6cda59992824386
chapter: CH-04
qa_id: QA-75dd91684829ccfa
reference: BLK-a408b5cb37163856
semantic_categories: [truth-values]
digest: 1db2dd63af6292720d4001381d616d887816286bd7569588502d29f81fc781d4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6c75ee09eb6847a2
chapter: CH-04
qa_id: QA-3631a5a40f29ab2e
reference: BLK-6a91b47966fe0914
semantic_categories: [truth-values]
digest: ffdbc7543e6c4b494f2a19e6c548310cbc2213dc9525052a9a8c225ee15f3db2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fa33e51deebac683
chapter: CH-04
qa_id: QA-ea4c50b0b1242efc
reference: BLK-967e2935894c77e0
semantic_categories: [truth-values]
digest: c51e6aa905937d257e8b3406894f54f216903018a6ca65d468055f758bfd0ff9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cd6baa40ae5180a9
chapter: CH-04
qa_id: QA-2570e3a7e6b50b36
reference: BLK-0099fb0394aef55d
semantic_categories: [truth-values]
digest: 686561b5c7a76f284503cfc17bde4d51c63a599b47214b4ea270c90a5037e1e9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7752c8d41b12271e
chapter: CH-04
qa_id: QA-3b09574e286731d4
reference: BLK-243c144ec9ef9fec
semantic_categories: [truth-values]
digest: 860d79e514b250484909fef14a29f66e3d4478ba6187a4c92b27679bab8aaadb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-23451dc46f2c0412
chapter: CH-04
qa_id: QA-8ba466ee3873ce3a
reference: BLK-6764c41841ecebec
semantic_categories: [truth-values]
digest: 8522a6c25635a56698cc0f43af78670eb7948a2d9edc5e578ff2029b4553fbb6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8ff3b88cc0d657b6
chapter: CH-04
qa_id: QA-da4ed7eb2b5f1bec
reference: BLK-c7bb77c124e34850
semantic_categories: [truth-values]
digest: 9c0bf689c756b32bfef3c11651633437cd1385e1f6380698db682552f9b7b125
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-468b9725de764fa7
chapter: CH-04
qa_id: QA-c00e5c7a999af8b8
reference: BLK-9b4015c66b260e6b
semantic_categories: [truth-values]
digest: 90de9a7b213f9211920bfb563c8071851f9c265c6881fc6f34908af85bbc3696
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8de4315bc5d77e7f
chapter: CH-04
qa_id: QA-2e6aaecb1d2f0f44
reference: BLK-4b8e3328604ba9ff
semantic_categories: [truth-values]
digest: ae4f5b6f877d98b808d683d7f68b6187ebbf85059ad35cb6ae0a4c435d9953eb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-478b02ef90cf8380
chapter: CH-04
qa_id: QA-d6f380bea3c79fdf
reference: BLK-db27a696242d571c
semantic_categories: [truth-values]
digest: 7b0d4c32c919de846c568a22304da7b4558109175dc1158b33e044a7b2bf85b8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c17dbce28afa995e
chapter: CH-04
qa_id: QA-2f6c7139817b87f2
reference: BLK-fc5db223276d9413
semantic_categories: [truth-values]
digest: 1ad6b715ef595ae0af42f78d763b72bfe41990db836d01f788e7deb34869bca7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: role-note
id: ROLE-e847e3a1070d248e
chapter: CH-04
role: Policy Author
guidance: Focus on correctness & clarity of rules in this chapter.
digest: 2e81f22a709d2e14f36a2f7388f1f8ded0bd41a3dd0f85c28fc6abedbe4eb367
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-e6465b59d555b13e
chapter: CH-04
role: Security Reviewer
guidance: Look for unsafe patterns, missing deny cases, misuse of negation.
semantic_categories: [negation]
digest: 4ef1ce860d5514cd30bbdc55d9f838e042a0ac7c4fd519b0f22dfa2203a0eafc
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-3e69e963173d71f7
chapter: CH-04
role: Performance Engineer
guidance: Identify heavy comprehensions and opportunities for partial evaluation.
semantic_categories: [performance]
digest: 462a8b1e197cd9e584afe0e794ad3979c9f5cab1609e85f787c860422e7ae2db
symbol_refs: []
semantic_role: content
:::
:::

::: diagram
id: DIAG-b21d3dfa30d02e7e
chapter: CH-04
language: ascii
diagram_type: decision
summary: decision diagram
nodes: [{'id': 'node_0', 'label': 'first, second'}, {'id': 'node_1', 'label': '1, 2'}, {'id': 'node_2', 'label': '"user": user, "role": role'}]
edges: [{'source': 'node_0', 'target': 'node_1', 'type': 'directed'}, {'source': 'node_1', 'target': 'node_2', 'type': 'directed'}]
normalized_content: [first, second]
[1, 2]
["user": user, "role": role]
node_0 -> node_1
node_1 -> node_2
digest: 01603ea8a42d2ebe5ed01a6ce19bfaef54228b5f2e847288c35e3bf1966820ff
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [unification]
:::
# Pattern matching
[first, second] = [1, 2]
# first ‚Üí 1, second ‚Üí 2

# Symmetric unification
x = y  # Makes x and y equal

# Complex patterns
{"user": user, "role": role} = input.request
:::

::: diagram
id: DIAG-d95104493c915f24
chapter: CH-04
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 85ed2cf408494b309484303f2c41696f243604c7579f051b686c6e813609edbc
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
x + y    # Addition
x - y    # Subtraction
x * y    # Multiplication
x / y    # Division (float result)
x % y    # Modulo (remainder)
:::

::: diagram
id: DIAG-1d2989eaca3d9c18
chapter: CH-04
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: bc534f5121682462b86643469714fc6c5451970c0169404fbad0e1fc8fea7d96
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
sum := 10 + 5        # 15
diff := 10 - 5       # 5
product := 10 * 5    # 50
quotient := 10 / 5   # 2 (float)
remainder := 10 % 3  # 1
:::

::: test-hint
id: TEST-9806c513344f1306
chapter: CH-04
source_id: CODE-43fdfdc8d23de345
digest: fb711cbb731cc406f7a4ba86a32477d14e5179bae25f4d795b584704d712f0c3
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-8d21902da5350dbe
chapter: CH-04
source_id: CODE-a02a421a6fac4f98
digest: b64390ca54ad85348ae27769c49c06eecde3b8d04c6d63e31475cc71eb4a1f2b
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-247743bd0590722d
chapter: CH-04
source_id: CODE-b007cb357523f444
digest: 82b3d608bf57be5021d1786978493e8542b9fafbf8c11a109167c5549e2c184f
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-6bc0472e334d24c3
chapter: CH-04
source_id: CODE-cd9f75f4f505f98f
digest: f6b7f64a50e9ede7cbfd6a3d4dbbad07b00e7262103c633d2ecd67b8541f52d0
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-904aab6eed8325c5
chapter: CH-04
source_id: CODE-9480eddfd36d6bd8
digest: b13b95b32e59dcb29cfac264ee989f1a8182071b43461e83604cd86b219195b2
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-ed0240b170b25007
chapter: CH-04
source_id: CODE-7d36c777bc54eff2
digest: 4c577695dd74d21df0fb08f69a05356d24a093371c1ae78ca21793de1ae4882c
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-d243f166066e10fc
chapter: CH-04
source_id: CODE-16006224b7fc05e6
digest: c0b0d370cb3ae723fa055e82d29a102ea15415022091b498ed31ee1bee00d1a4
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b279867a18b15a50
chapter: CH-04
source_id: CODE-6657dc626f7f81a0
digest: f454f84e002960d959b75ecf3cd20f7d3ed311237c83bb52d3fa94b6f0654205
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-52a298a91607d2a3
chapter: CH-04
source_id: CODE-2f6d9a5bbe34c891
digest: 9990de7700fb7da1993fcd9912da54fa381ab9c57b43bbf39db36506bef8fd9f
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b85bea539c957cd5
chapter: CH-04
source_id: CODE-bceca388eebe308f
digest: 57bbb5fb27026c995aba6a5c83b2d2d566da7ae96a1c836fc3b76a7e43f917fa
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-87b16faa329e5a9d
chapter: CH-04
source_id: CODE-917af16bdaf9c69e
digest: aad6a24fe953b3fd1aa2495aba3bc3a1a6d398054905eb7089ad44cfa7db89ee
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-87e841d4e9e4309d
chapter: CH-04
source_id: CODE-a177475f64f6ae17
digest: 5989a286d8f368048761142c84efff94e5a0e4c53aa19ec9b9fe7e431bf555d2
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: section-meta
id: SECMETA-ecdd76c8aec57949
title: 4.1 Variables and Unification
level: 3
chapter: CH-04
parent_section: None
line_no: 688
digest: d0a0d9e119a661c1f9ca52387be1055c98b34eb86962c751440a56458f1f5520
symbol_refs: []
semantic_role: structure
token_range: (688, 688)
char_offset: (54960, 54989)
source_ref: {'line': 688, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [unification]
:::
:::

::: section-meta
id: SECMETA-58ef365f6631b3cc
title: 4.2 References ‚Äî Traversing Documents
level: 3
chapter: CH-04
parent_section: None
line_no: 734
digest: 8cf9877b9cfca2880975390b7c563f6169261a7a8d76b3b7acc18ae43e51c361
symbol_refs: []
semantic_role: structure
token_range: (734, 734)
char_offset: (58640, 58677)
source_ref: {'line': 734, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-c048505b0a61a762
title: 4.3 The `some` Keyword
level: 3
chapter: CH-04
parent_section: None
line_no: 849
digest: e2e8a0847927db31e5bd188912115375fd9bb13bcca84bfc2a92ba24faf1bf5e
symbol_refs: []
semantic_role: structure
token_range: (849, 849)
char_offset: (67840, 67862)
source_ref: {'line': 849, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-eaa76c1951df236c
title: 4.4 Operators
level: 3
chapter: CH-04
parent_section: None
line_no: 894
digest: d83be0074297686d364fd92e31259a58e38ad0d2c0d6a037125e6c9ea3f63fa0
symbol_refs: []
semantic_role: structure
token_range: (894, 894)
char_offset: (71440, 71453)
source_ref: {'line': 894, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-c3094badffba934b
title: Assignment and Equality
level: 4
chapter: CH-04
parent_section: SECMETA-eaa76c1951df236c
line_no: 896
digest: af0e82b8471dcd623b8dfc91ac543a3dd9de92b171128eeff3a34ab3d60ce1c4
symbol_refs: []
semantic_role: structure
token_range: (896, 896)
char_offset: (71600, 71623)
source_ref: {'line': 896, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-d87ca40d5c0570c0
title: Comparison Operators
level: 4
chapter: CH-04
parent_section: SECMETA-eaa76c1951df236c
line_no: 916
digest: 3406274f583201b344cc7537fdcd27fdaf4a18a0d2e9e110a92639e2211e3a54
symbol_refs: []
semantic_role: structure
token_range: (916, 916)
char_offset: (73200, 73220)
source_ref: {'line': 916, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-796bff90bfcdfb83
title: Arithmetic Operators
level: 4
chapter: CH-04
parent_section: SECMETA-eaa76c1951df236c
line_no: 937
digest: bb0dfe3bed928ea83a1c3df9ae56b09eaa83b13e29d68b00d25999dbd8a9a3e3
symbol_refs: []
semantic_role: structure
token_range: (937, 937)
char_offset: (74880, 74900)
source_ref: {'line': 937, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-36fd1aa9b7411fab
title: Bitwise Operators
level: 4
chapter: CH-04
parent_section: SECMETA-eaa76c1951df236c
line_no: 956
digest: d32a8bd90ffc296eae695f1545cd4564dbd62e143260286de44a96f41aead4f7
symbol_refs: []
semantic_role: structure
token_range: (956, 956)
char_offset: (76400, 76417)
source_ref: {'line': 956, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-ab47c03ed45d2506
title: Membership: The `in` Operator
level: 4
chapter: CH-04
parent_section: SECMETA-eaa76c1951df236c
line_no: 973
digest: d973013a52ddd8e940d10bc6739472e6ba1ab8cc396c6dfc97f5f5c92036baf8
symbol_refs: []
semantic_role: structure
token_range: (973, 973)
char_offset: (77760, 77789)
source_ref: {'line': 973, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-b522fb509bee52d0
name: Multiple expressions in a rule body
definition: ```rego
allow if {
    input.user.role == "admin"       # Must be true AND
    input.user.active == true         # Must be true AND
    input.resource.sensitive == false # Must be true
}
```
aliases: []
chapter: CH-05
digest: 4c5a3c04ae14e5ad1b616359fd773b0192428d42895f9d502cea44ac4f8eb49f
symbol_refs: [Multiple expressions in a rule body]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego allow if { input.user.role == "admin" # Must be true AND input.user.active == true # Must be true AND input.resource.sensitive == false # Must be true } ```
:::
:::

::: term
id: TERM-77eaf07b79028829
name: Evaluation
definition: All expressions must evaluate to `true`.
aliases: []
chapter: CH-05
digest: 09bd6a85717431629a170a3393006d804268da3ac6b142eeac340bd499cc6fb8
symbol_refs: [Evaluation]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: All expressions must evaluate to `true`.
:::
:::

::: term
id: TERM-765461e32a3f2ac4
name: Multiple rule bodies
definition: ```rego
allow if {
    input.user.role == "admin"
}

allow if {
    input.action == "read"
    input.resource.public == true
}
```
aliases: []
chapter: CH-05
digest: a3478a3c7cd4e76a9f681562af19733f30c54f2eba86540376a15d808c41087d
symbol_refs: [Multiple rule bodies]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego allow if { input.user.role == "admin" } allow if { input.action == "read" input.resource.public == true } ```
:::
:::

::: term
id: TERM-2e68e77273483d64
name: Evaluation
definition: Any rule body can make `allow` true.
aliases: []
chapter: CH-05
digest: 2251c71e73eb91626d3fcac255049c830fb3abfabb6452bf5d2a5ac34e1e5987
symbol_refs: [Evaluation]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: Any rule body can make `allow` true.
:::
:::

::: term
id: TERM-f0f922c28fb58f42
name: Array Comprehensions
definition: ```rego
# Format: [ <term> | <query> ]

# Simple transformation
squares := [x * x | some x in numbers]

# With filtering
evens := [x | some x in numbers; x % 2 == 0]

# Complex example
admin_emails := [user.email |
    some user in data.users
    "admin" in user.roles
    user.active == true
]

# Nested iteration
pairs := [[x, y] |
    some x in [1, 2, 3]
    some y in ["a", "b", "c"]
]
# Result: [[1, "a"], [1, "b"], [1, "c"], [2, "a"], ...]
```
aliases: []
chapter: CH-05
digest: b7a80845af2751f629ee30fd7d084c1dfb772510297fb6f16bd677e3e2c6b184
symbol_refs: [Array Comprehensions]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Format: [ <term> | <query> ] # Simple transformation squares := [x * x | some x in numbers] # With filtering evens := [x | some x in numbers; x % 2 == 0] # Complex example admin_emails := [user.email | some user in data.users "admin" in user.roles user.active == true ] # Nested iteration pairs := [[x, y] | some x in [1, 2, 3] some y in ["a", "b", "c"] ] # Result: [[1, "a"], [1, "b"], [1, "c"], [2, "a"], ...] ```
:::
:::

::: term
id: TERM-08f1447eec4c64e2
name: Set Comprehensions
definition: ```rego
# Format: { <term> | <query> }

# Remove duplicates
unique := {x | some x in items}

# Extract unique properties
departments := {user.dept | some user in users}

# Complex filtering
valid_ips := {addr |
    some addr in input.addresses
    net.cidr_contains("10.0.0.0/8", addr)
}
```
aliases: []
chapter: CH-05
digest: 11fa057b7709bcaa636c3339d886547c5ed1a69800af0e0d2b4d5347d4c2cd2e
symbol_refs: [Set Comprehensions]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Format: { <term> | <query> } # Remove duplicates unique := {x | some x in items} # Extract unique properties departments := {user.dept | some user in users} # Complex filtering valid_ips := {addr | some addr in input.addresses net.cidr_contains("10.0.0.0/8", addr) } ```
:::
:::

::: term
id: TERM-37943d9555f9fb02
name: Object Comprehensions
definition: ```rego
# Format: { <key>: <value> | <query> }

# Create mapping
name_to_age := {person.name: person.age |
    some person in people
}

# With transformation
doubled := {k: v * 2 |
    some k, v in original
}

# Aggregation
user_counts := {dept: count |
    some dept in departments
    users_in_dept := [u | some u in users; u.dept == dept]
    count := array.length(users_in_dept)
}
```
aliases: []
chapter: CH-05
digest: 62bc43e072b148bf2c854b0ef8848b54c15cd03fda63d529468487120e76065d
symbol_refs: [Object Comprehensions]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # Format: { <key>: <value> | <query> } # Create mapping name_to_age := {person.name: person.age | some person in people } # With transformation doubled := {k: v * 2 | some k, v in original } # Aggregation user_counts := {dept: count | some dept in departments users_in_dept := [u | some u in users; u.dept == dept] count := array.length(users_in_dept) } ```
:::
:::

::: term
id: TERM-12a2bb01df108ca1
name: Three Approaches
definition: 
aliases: []
chapter: CH-05
digest: e0daa292600a4dd30ff72667ac87e09a3a8762f8a9063339433f21e48d83b770
symbol_refs: [Three Approaches]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
:::

::: term
id: TERM-4bf6ca2b25fb033e
name: Negation-as-Failure Semantics
definition: ```rego
# Simple negation
unauthorized if not authorized

# Negation with expressions
invalid if not startswith(input.name, "valid_")

# Check non-membership
not_admin if not "admin" in input.user.roles
```
aliases: []
chapter: CH-05
digest: 990310bc8f9352bb631b0f3e71f4c8ec09c495bd8e915698e21a6435a01d9fff
symbol_refs: [Negation-as-Failure Semantics]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [negation]
vector_summary: ```rego # Simple negation unauthorized if not authorized # Negation with expressions invalid if not startswith(input.name, "valid_") # Check non-membership not_admin if not "admin" in input.user.roles ```
:::
:::

::: term
id: TERM-d3125a26b9e36f78
name: Safety Requirements
definition: ```rego
# ‚ùå Unsafe: user not grounded
unsafe if {
    not blacklisted[user]
}

# ‚úÖ Safe: user grounded first
safe if {
    user := input.user.id
    not blacklisted[user]
}
```
aliases: []
chapter: CH-05
digest: 624a4d440fb47f94c18968a5907bec2a908a87b26ce32b5b0696e09545aff32e
symbol_refs: [Safety Requirements]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
vector_summary: ```rego # ‚ùå Unsafe: user not grounded unsafe if { not blacklisted[user] } # ‚úÖ Safe: user grounded first safe if { user := input.user.id not blacklisted[user] } ```
:::
:::

::: term
id: TERM-61b8c1a83d1cdbdd
name: Common Pitfall ‚Äî Existential vs Universal
definition: ```rego
# ‚ùå WRONG: "Is there any element != 'foo'?"
# This is true if ANY element is not "foo"
has_non_foo if {
    items[_] != "foo"  # Existential quantification
}

# ‚úÖ CORRECT: "Is 'foo' not in array?"
foo_not_present if {
    not "foo" in items
}

# ‚úÖ CORRECT: "Are all elements not foo?"
all_non_foo if not any_foo

any_foo if {
    some item in items
    item == "foo"
}
``` --- 6.2 Built-in Function Categories (Overview) For orientation, here is the taxonomy we‚Äôll use in this chapter: Aggregates: count, sum, product, min, max, sort, all, any Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.* Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.* Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs HTTP & I/O: http.send for outbound HTTP calls Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge UUID/ULID: uuid.*, ulid.generate Graph & Structural Walks: graph.reachable, walk Units: units.parse, units.parse_bytes Metadata & Introspection: rego.metadata.rule, rego.metadata.chain Debugging: print, trace Error Semantics: Strict vs non-strict behavior We‚Äôll now go category by category, with semantics, examples, and pitfalls. 6.3 Aggregates Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR). Key built-ins: count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element min(array) # minimum element sort(array) # sorted copy (ascending) all(array_bool) # AND over boolean array any(array_bool) # OR over boolean array Examples: # Count API keys api_key_count := count(input.api_keys) # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) } # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) } Typing & Errors: sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined. count accepts arrays, sets, strings: count("abc") # 3 count({"a", "b"}) # 2 Pattern: Use count for guardrails: deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" } 6.4 Arrays Arrays are ordered; built-ins treat them as such. Key built-ins: array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy Examples: # Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len) # Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1] Indexing vs slicing: OPA has no direct a[1:3] slicing syntax; use array.slice. Out-of-range indices ‚Üí expression undefined. 6.5 Sets and Set-like Operations Rego sets are unordered, unique collections. Key built-ins: intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # convert array to set Example: allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions) invalid_regions := set_diff(requested_regions, allowed_regions) deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) } Performance pattern: Prefer sets for membership: # Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users # Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list 6.6 Objects & JSON Path Helpers Objects represent mappings from scalar keys to arbitrary values. Key built-ins: object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on conflict object.filter(obj, keys_array) # keep only listed keys json.filter(obj, paths_array) # filter by JSON paths (e.g., "a/b/c") Examples: # Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000) # Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"]) # Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"]) # Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"]) Patterns: Use object.get instead of chaining if input.config.timeout_ms checks everywhere. Use object.remove before logging to avoid PII leaks. 6.6 JSON Filter (json.filter) json.filter allows you to keep only selected fields from a JSON object. Signature (conceptual): json.filter(obj, paths_array) # paths_array: array of slash-delimited strings Example: # Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"]) Path strings are JSON Pointer‚Äìstyle: "user/id" corresponds to conceptual path segments ["user", "id"]. "request/path" corresponds to ["request", "path"]. Think of each string as a slash-delimited path from the root of obj. The function returns a new object containing only the specified paths. 6.7 Strings Rego strings are Unicode text; built-ins operate on code points (not bytes). Key built-ins: concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, base) # "2a" in base 16, etc. indexof(s, substr) # index or -1 lower(s) / upper(s) replace(s, old, new) # replace all occurrences split(s, sep) # split into array sprintf(format, args_array) # printf-style format substring(s, start, length) # slice of string trim(s, chars) # trim characters from both ends trim_space(s) # trim whitespace trim_prefix(s, prefix) trim_suffix(s, suffix) Examples: # Normalize emails norm_email := lower(trim_space(input.user.email)) # Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/") # Slugify a title (rough example) slug := lower(replace(input.title, " ", "-")) # Format numeric IDs hex_id := format_int(input.id, 16) # hex # Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id]) Pitfall: contains is substring, not set membership (for that use in). 6.8 Regular Expressions Regex built-ins are powerful but expensive; use carefully. Key built-ins: regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(pattern, string) # array of splits **Raw Strings (Backticks) - Implementation Note:** The grammar defines raw strings with backticks (`raw-string ::= "`" { CHAR-"`" } "`"`), and examples in documentation may show them. However, **raw strings may not be supported in all OPA versions or implementations**. For maximum compatibility, prefer double-quoted strings with proper escaping: # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value) # May not work in all OPA versions is_hex if regex.match(`^[0-9a-fA-F]+$`, input.value) **Best Practice:** Always use double-quoted strings with escaped backslashes for regex patterns. Test with `opa check` to verify compatibility with your OPA version. **Exception: Multi-Line Test Data** For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve actual newline characters. Unlike double-quoted strings where `\n` is a literal two-character sequence, raw strings interpret newlines as actual line breaks: ```rego
# ‚úÖ CORRECT: Raw string for multi-line test data
test_diff_parsing if {
    diff_content := `+ // TODO: Fix issue
+ function implementation() {`
    # Contains actual newline between lines
    
    mock_input := {"diff": diff_content}
    # Policy regex patterns can now match newlines correctly
}

# ‚ùå PROBLEMATIC: Double-quoted string with \n literal
test_diff_parsing if {
    diff_content := "+ // TODO: Fix issue\n+ function implementation() {"
    # \n is literal backslash + 'n', NOT a newline
    # Regex patterns expecting newlines will fail
}
``` **When to Use Raw Strings:** - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline characters - Content that must preserve line breaks exactly as written **When to Use Double-Quoted Strings:** - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable Performance tips: Avoid regex in tight loops over large collections if possible. Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied). 6.9 Numbers & Numeric Utilities Basic numeric helpers: abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start, ..., end-1] Examples: # Generate ports 8000 to 8099 ports := numbers.range(8000, 8100) # Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit } Combine with aggregates: # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 } 6.10 Type Conversion & Validation Sometimes you ingest loosely typed JSON (forms, CSV turned JSON). Use conversion and validation built-ins: to_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_bool(x) json.is_valid(str) # syntactic JSON validation yaml.is_valid(str) Patterns: # Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 } # Convert dynamic lists tags_set := to_set(input.tags) Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target OPA). 6.11 Encoding, Decoding & Serialization Used to transform payloads between formats or safely embed them. Key built-ins: # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...") # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello" # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value # YAML yaml.marshal(x) yaml.unmarshal(yaml_str) # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1" Examples: # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json := base64url.decode(payload_b64) claims := json.unmarshal(payload_json) # Marshal deny messages for logs deny_json := json.marshal(deny_msgs) 6.12 Type Introspection Type predicates and type_name are invaluable for robust policies: is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", "null", "boolean" Pattern: Defensive guards before deeper logic: valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) } **Input Safety Best Practices:** Always guard access to optional or potentially missing input fields: ```rego
# ‚ùå UNSAFE: May error if input.pr_body is missing or not a string
has_override(marker) if {
    contains(input.pr_body, marker)  # Type error if pr_body missing
}

# ‚úÖ SAFE: Type guard before access
has_override(marker) if {
    is_string(input.pr_body)
    contains(input.pr_body, marker)
}

# ‚úÖ SAFE: Guard array access
input_valid if {
    is_array(input.changed_files)
}

# Then use guard in all rules
deny[msg] if {
    input_valid
    some file in input.changed_files
    # ... rest of logic
}
``` **Common Patterns:** - Check `is_string()` before `contains()`, `startswith()`, `endswith()` - Check `is_array()` before iteration with `some ... in` - Check `is_object()` before property access - Check `is_number()` before arithmetic operations - Create a top-level `input_valid` guard and use it in all rules that access input 6.13 Cryptography & Security Built-ins Security-sensitive policies rely heavily on crypto built-ins. Hash functions & HMAC: crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data) Key-derivation & password hashing: crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password) X.509 and certificates: crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs JWT helpers (in io.jwt namespace): io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt.verify_es256(token, cert) io.jwt.verify_ps256(token, cert) io.jwt.encode_sign_raw(headers, payload, key) Patterns: valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) } deny[msg] if { not valid_token msg := "Invalid JWT" } Security guidance: Never bake secrets into Rego source; pass via data or environment. Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints). 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs). 6.4 Arrays & array.concat Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc. Common built-ins: count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays Concatenation: array.concat([1, 2], [3]) # => [1, 2, 3] Nuances: Both arguments must be arrays. If either argument is null (or not an array), OPA raises a type error. For defensive code, wrap it: safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) } Use safe_concat in paths or pipelines where inputs may be missing or partially null. Time Functions (No time.diff) Time built-ins revolve around: Getting the current time (time.now_ns) Parsing timestamps (time.parse_rfc3339_ns) Formatting (time.format, etc.) Example of computing a duration: now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end) duration_ns := end - start too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes } Important corrections: There is no standard time.diff builtin in OPA. Differences are computed with normal arithmetic on integer nanosecond timestamps: duration_ns := end_ns - start_ns. This approach works consistently across CLI, server, and WASM runtime. 6.15 HTTP Built-ins http.send allows policies to call external services. Use with discipline. resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optional, string with units }) # resp = {"status": 200, "body": ..., "headers": {...}} Characteristics: Potentially slow and side-effectful. Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query. Patterns: Prefer to fetch external data ahead of time and feed via data or input. In CI or admission controllers, avoid http.send altogether if possible. Testing: test_http_policy if { result := policy.check with http.send as mock_http_send } 6.16 Network & CIDR Built-ins Networking helpers are invaluable for Kubernetes and cloud policies. net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_merge(cidr_list) # merge overlapping ranges Example: deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" } 6.17 UUID & ULID Generation Some deployments expose helpers in the standard library or via plugins. Common patterns: uuid := uuid.rfc4122(seed) ulid := ulid.generate() Semantics: uuid.rfc4122(seed): Deterministic for a given string seed. Ideal for tests where you want stable IDs. ulid.generate(): Time-based and non-deterministic. Great for production identifiers, but brittle in tests. Testing recommendations: # Stable UUID in tests test_id := uuid.rfc4122("test-seed-123") # For ULID, either: # - mock it with: with ulid.generate as "fixed-ulid" # - or only check that a ULID exists / matches a regex, not its exact value 6.18 Graph & Structural Walks graph.* functions operate on graph structures (represented as adjacency lists). graph.reachable(graph, ["start"]) # list of reachable nodes walk(x) traverses nested structures and returns [path, value] pairs: pairs := walk(input) # pairs is [[["path","to","value"], value], ...] Patterns: # Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" } 6.19 Units & Parsing For human-friendly sizes or durations: units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant Useful for policies over resource limits: deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi" } 6.20 Metadata & Annotations Rego exposes rule metadata at evaluation time: rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain Usage: Enrich decision logs with rule IDs, owners, severity. Drive governance features (e.g., map violations back to policy owners). Example: deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } } 6.21 Debugging Built-ins: print and trace print is the primary debugging tool for Rego: debug_rule if { x := input.value print("The value of x is:", x) x > 10 } Properties: print(...) always returns true, so it does not change logical semantics. Output appears in OPA logs or opa eval --explain trace output depending on environment. trace may also be available as an alias in some environments; print is the standard. Best practices: Use print liberally during development and experiments. Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod). 6.22 Error Semantics & Strict Mode By default, built-in errors make expressions undefined: # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 } For higher assurance, strict builtin errors convert such errors into hard failures: CLI: opa eval --strict-builtin-errors ... HTTP API: strict-builtin-errors=true query parameter. Use strict mode: In CI to catch unexpected type mismatches and invalid data. In critical policies where silent undefined behavior is unacceptable. Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture. 6.23 Performance Patterns with Built-ins Guard expensive built-ins with cheap checks # Good: fast predicate first deny if { input.method == "POST" regex.match(`(?i)password`, input.body) } Avoid large intermediate arrays via comprehensions if a boolean will do # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 # Good has_admin if { some u in users "admin" in u.roles } Use sets for membership, arrays for ordered sequences Memoization awareness Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached. If inputs differ slightly each time, caching may not help; consider pre-processing. 6.24 Design Patterns & Anti-Patterns Patterns Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere. Canonicalization: Always lowercase/trim user-identifiers before comparison. Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks. Anti-Patterns Regex everywhere: Overuse of regex in hot loops will tank performance. Prefer startswith, endswith, contains, or exact matches when sufficient. Hidden type conversions: Relying on to_number implicitly instead of checking type leads to brittle policies. Unbounded http.send usage: Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths. Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ... Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which you prove that your policies are correct, stable, and maintainable. This chapter builds from basic _test rules up to full-blown policy test architectures, fuzzing, and debugging strategies. ________________________________________ 7.1 Testing Fundamentals Where tests live Tests are Rego modules whose package names end in _test. Convention: Production package: package authz.api Test package: package authz.api_test Naming rules Test rules must start with test_. A test passes if its body can be satisfied (i.e., is true); it fails otherwise. package authz.api_test import data.authz.api test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } } test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"} } } Running tests # All tests in current tree opa test . # Verbose (see individual test names) opa test . -v # Specific path or file opa test policies/ authz_test.rego # With coverage reporting opa test . --coverage --format=json > coverage.json ________________________________________ 7.2 The with Keyword for Mocking with is the cornerstone of Rego testing. It temporarily overrides input, data, or even built-ins for a single evaluation. Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"id": "123"} } } Override data test_role_from_data if { authz.allow with input as {"user": "alice", "action": "read"} with data.roles as {"alice": ["admin"]} } Override built-ins (time, http, etc.) # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 } # in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This makes your policies deterministic and testable, even when they rely on clocks, network calls, or external data. ________________________________________ 7.3 Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests Testing & Tooling This chapter describes patterns for unit tests, integration tests, and golden tests. 7.3 Golden Tests & File I/O (Corrected) Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file. Critically: Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.). A realistic pattern: package compliance_test import data.compliance test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests["pr_large"].expected result := compliance with input as input_case result == expected } Typical harness responsibilities: Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk. Populate data.tests["pr_large"] before invoking opa test or the OPA SDK. Optionally parameterize tests via CLI flags or environment. In other words: Rego: pure data and rules; no file system. Harness: performs all file I/O and passes JSON into Rego as input or data. ________________________________________ 7.4 Debugging with print and opa eval print is your printf. Signature: print(x1, x2, ...) Always returns true, so you can drop it directly inside rule bodies. debug_threshold if { t := input.threshold print("Threshold is:", t) t > 10 } Where output appears opa eval ‚Üí printed to stderr / logs. Embedded OPA ‚Üí appears in OPA logs; your host system should capture these. Key points print doesn‚Äôt alter semantics (just like adding true). Good for: Inspecting variable bindings. Confirming which rule body is being hit. Bad for: Production policies with PII. Flooding logs; use sparingly or behind a debug flag. ________________________________________ 7.5 opa eval Explain & Profile Modes opa eval is both a REPL and microscope. Explain modes opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow' opa eval --explain=full ... notes = high-level reasoning (rule success/failure). full = full derivation tree; great for debugging, painful for huge queries. Profile mode opa eval --profile -d . -i input.json 'data.compliance' You get: Per-rule evaluation counts and cumulative time. A ranking of ‚Äúhot‚Äù rules (the ones to optimize or refactor). Typical workflow Problem: ‚ÄúPolicy is slow for large PRs / big cluster.‚Äù Run: opa eval --profile ... Identify rules with: Many evaluations (thousands or millions). High total time. Refactor: Use sets/objects instead of scanning arrays. Add guard conditions (cheap predicates before expensive ones). Use partial evaluation (¬ß11). ________________________________________ 7.6 Common Errors and How to Diagnose Them rego_unsafe_var_error ‚Äì unsafe variables # ‚ùå Unsafe: user appears only under negation deny if { not blacklisted[user] } Fix: Bind user outside negation. deny if { user := input.user not blacklisted[user] } rego_type_error ‚Äì type mismatch Example: using to_number on an object, or sum over [1, "two"]. Fix: Guard with is_* built-ins (is_number(x), is_array(x)). Normalize incoming data. Rule conflict errors Multiple complete rules with same name produce different values for same input. f(1) := 2 f(1) := 3 # conflict For sets/partial objects this is okay (results are merged); for complete rules & functions it‚Äôs an error. Infinite or pathological recursion Patterns that refer back to themselves without a base case. OPA has guardrails, but logic errors can still create huge evaluation trees. Mitigate with: Explicit depth counters. Clear base rules. ________________________________________ 7.7 String Literal Handling in Tests: JSON vs Rego String Semantics A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files. This difference frequently causes test failures that are difficult to diagnose. 7.7.1 The Newline Escape Sequence Problem When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but critical difference: **JSON Input (via `opa eval --input`):** ```json
{
  "diff": "+ // TODO:\n+ function getUsers() {"
}
``` In JSON, `\n` is interpreted as an actual newline character during JSON parsing. The policy receives a string containing a real line break. **Rego Test File (inline string literal):** ```rego
test_example if {
    mock_input := {"diff": "+ // TODO:\n+ function getUsers() {"}
    # \n here is literal: backslash + 'n', NOT a newline
}
``` In Rego test files, `\n` within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'. It is not decoded to an actual newline. **Impact on Regex Patterns:** ```rego
# Policy expects actual newline
regex.match("TODO:\\s*\\n", file.diff)  # Fails in tests with \n literal

# Test input with \n literal
"diff": "+ // TODO:\n+ function()"  # Contains literal "\n", not newline
``` The regex pattern `TODO:\\s*\\n` expects an actual newline character, but receives the literal string "\n", causing the match to fail. 7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines: ```rego
# ‚úÖ CORRECT: Raw string preserves actual newlines
test_todo_with_newline if {
    diff_content := `+ // TODO:
+ function getUsers() {`
    
    mock_input := {"changed_files": [{
        "path": "file.ts",
        "diff": diff_content
    }]}
    
    # Policy regex now matches correctly
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
``` **Raw String Properties:** - Preserve actual newline characters (not `\n` literals) - Do not interpret escape sequences (`\n`, `\t`, etc.) - Ideal for multi-line test data (diffs, code blocks, structured text) - Compatible with regex patterns expecting real newlines **When to Use Raw Strings vs Double-Quoted:** - **Raw strings (backticks)**: Multi-line content, actual newlines needed, regex patterns matching line breaks - **Double-quoted**: Single-line content, escape sequences acceptable, JSON-like strings 7.7.3 Debugging String Literal Issues **Symptoms:** - Tests fail with `opa test` but pass with `opa eval --input <json-file>` - Regex patterns that work with JSON inputs fail in test files - Multi-line matching fails unexpectedly **Diagnostic Steps:** 1. Compare test input structure with working JSON input 2. Check if regex patterns expect actual newlines vs `\n` literals 3. Use `print()` to inspect actual string content: ```rego
   test_debug if {
       diff := "+ // TODO:\n+ function()"
       print("Length:", count(diff))  # Check if \n is one char or two
       print("Contains newline:", contains(diff, "\n"))  # May fail if literal
   }
   ``` 4. Convert test strings to raw strings (backticks) if multi-line content is needed **Best Practice:** When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavior of JSON inputs. ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns The evaluation context of `with` clauses in tests can affect how rule results are accessed. Understanding these patterns prevents subtle test failures. 7.8.1 Direct Evaluation vs Variable Binding When testing rules that return sets (e.g., `warn`, `deny`), the method of accessing results matters: **Pattern 1: Direct Evaluation (May Fail)** ```rego
# ‚ùå PROBLEMATIC: Direct count() with with clause
test_example if {
    mock_input := {"changed_files": [...]}
    count(policy.warn) >= 1 with input as mock_input
}
``` **Pattern 2: Variable Binding (Recommended)** ```rego
# ‚úÖ CORRECT: Bind result to variable first
test_example if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
``` **Why Variable Binding is Preferred:** - Explicit evaluation context: `with input as mock_input` applies to the rule evaluation, not the `count()` call - Clearer semantics: The rule is evaluated with mocked input, then the result is counted - More reliable: Avoids potential evaluation order issues in complex test expressions - Better debugging: Can inspect `warnings` set before counting 7.8.2 Accessing Set Elements in Tests When a rule returns a set (partial rule with `contains`), accessing elements requires proper iteration: ```rego
# ‚úÖ CORRECT: Iterate set to get first element
test_get_warning_message if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Get first warning message
    warning := [msg | msg := warnings[_]][0]
    contains(warning, "expected text")
}

# ‚ùå WRONG: Sets don't support index access
warning := warnings[0]  # Error: sets don't have indices
``` **Pattern for Multiple Assertions:** ```rego
test_multiple_assertions if {
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check all warnings
    some warning in warnings
    contains(warning, "pattern1")
    
    # Or check specific warning
    specific_warning := [msg | msg := warnings[_]; contains(msg, "pattern2")][0]
    contains(specific_warning, "pattern2")
}
``` 7.8.3 Rule Precedence and Overlapping Conditions When multiple rules can match the same input, understanding evaluation order is critical for test design. **Problem: Overlapping Rule Conditions** ```rego
# Policy has two rules that can both match:
# R15-W02: Meaningful TODO not logged (general check)
# R15-W03: TODO added without reference (specific check for +.*TODO:)

# Both rules check:
# - has_meaningful_todo_keywords(file)
# - not has_tech_debt_reference(file)
# R15-W03 also checks: regex.match("\\+.*TODO:", file.diff)
``` **Test Design Strategy:** ```rego
# ‚úÖ CORRECT: Test for either rule, or check for common message pattern
test_meaningful_todo_not_logged if {
    mock_input := {"changed_files": [{
        "diff": "+ // TODO: Fix issue (workaround)"
    }]}
    
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check for message pattern common to both rules
    some warning in warnings
    contains(warning, "meaningful TODO/FIXME")
    contains(warning, "tech-debt.md")
}

# ‚ùå FRAGILE: Testing for specific rule ID
test_specific_rule if {
    # This may fail if rule precedence changes
    # or if a more specific rule triggers first
}
``` **Best Practice:** Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered). This makes tests more resilient to policy refactoring. ________________________________________ 7.9 Case Sensitivity and String Matching in Tests String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations. 7.9.1 The Case Sensitivity Trap The `contains()` function performs case-sensitive substring matching: ```rego
# Policy checks for lowercase "temporary"
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")  # Lowercase required
}

# ‚ùå TEST FAILS: Test uses "Temporary" (capital T)
test_example if {
    mock_input := {"diff": "+ // FIXME: Temporary hack"}
    # Policy doesn't match "Temporary" (capital T)
    # Test expects warning but gets none
}

# ‚úÖ TEST PASSES: Test uses "temporary" (lowercase)
test_example if {
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # Policy matches "temporary" correctly
}
``` 7.9.2 Mitigation Strategies **Option 1: Normalize Test Inputs** ```rego
# Normalize keywords in test inputs to match policy expectations
test_example if {
    # Use lowercase to match policy checks
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # ...
}
``` **Option 2: Policy-Level Normalization (Recommended for Production)** ```rego
# Policy normalizes input before checking
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    diff_lower := lower(file.diff)
    contains(diff_lower, "temporary")  # Case-insensitive check
}
``` **Option 3: Explicit Case Variants in Policy** ```rego
# Policy checks multiple case variants
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")
}

has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "Temporary")
}
``` **Best Practice:** For production policies, prefer normalization (Option 2) to handle case variations gracefully. For tests, ensure inputs match policy expectations exactly, or document case sensitivity requirements clearly. ________________________________________ 7.7 Advanced Testing: Fuzzing & Mutation For high-assurance policies (security, compliance): Fuzzing: Generate random or adversarial JSON inputs. Run opa eval or opa test against them. Look for panics, regressions, or surprising allow/deny. Mutation testing: Mutate policies (flip conditions, remove clauses). Check that test suite fails appropriately. Failing to detect "killed" mutants = missing tests. This is often orchestrated by external tooling (Python/Go harnesses that call OPA), but the principles are Rego-agnostic. ________________________________________ Chapter 8 ‚Äì OPA Architecture & Integration Patterns This chapter is about where and how you run OPA. ________________________________________ 8.1 The PDP / PEP Split PDP (Policy Decision Point): OPA, evaluating Rego. PEP (Policy Enforcement Point): Your app, proxy, or platform component that: Collects input (HTTP request, Kubernetes object, Terraform plan, CI metadata). Sends it to PDP. Enforces the decision (allow/deny/mutate/log). OPA is only the PDP. The PEP is your responsibility. ________________________________________ 8.2 Deployment Topologies Sidecar / local daemon OPA runs alongside your service, often in the same Pod. Low latency, no network hop beyond localhost. Typical: Envoy external authz ‚Üí OPA. Kubernetes admission controller ‚Üí OPA sidecar in same namespace. Central PDP service OPA (or OPA-based service) runs as a central API. Multiple services call it over the network. Tradeoffs: Pros: Single place to manage policies; simpler distribution. Cons: Latency, scalability, SPOF (unless HA), multi-tenant complexity. Library / SDK Embed OPA: Go: github.com/open-policy-agent/opa/rego WASM: compile Rego to WASM and embed in any WASM host (Node, Rust, etc.). Useful for: Client-side enforcement (e.g., in a browser or mobile app). Edge scenarios. ________________________________________ 8.3 Integration Examples Kubernetes (Gatekeeper & friends) Admission review ‚Üí OPA policy. Rego receives: input.request (raw AdmissionReview). data includes ConstraintTemplates, constraints, reference data. Typical structure: package kubernetes.admission deny[msg] if { input.request.kind.kind == "Pod" some c in input.request.object.spec.containers c.image == "latest" msg := "Images must not use :latest tag" } Envoy / API Gateway Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP. Decision rule: data.envoy.authz.allow. Example: package envoy.authz default allow := false allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc. PR/diff metadata ‚Üí JSON (opa-input.json). OPA evaluates data.compliance. CI interprets deny, warn, override arrays and posts PR comments / fails build. IaC scanning (Terraform, Kubernetes YAML) Terraform plan JSON or Kubernetes manifests as input. Policies check: Public buckets. Unencrypted volumes. Exposed security groups. ________________________________________ 8.4 Multi-layer Policy Architecture on OPA Layers usually look like: Global baseline ‚Äì org-level security/compliance invariants. Domain policies ‚Äì per product or platform (e.g., CRM, billing). Team/service policies ‚Äì localized rules. Tenant overlays ‚Äì per customer/tenant customizations. Implement via: Multiple bundles merged in OPA. Data-driven toggles (e.g., data.tenants[tenant_id].overrides). Rego evaluation order (e.g., base allow, then deny overlays). ________________________________________ 8.5 OPA as a Policy Mesh In large environments, you might have: Many OPAs running across clusters/namespaces. A central bundle server pushing policies. Decision logs shipped to SIEM / data lake. Rego itself doesn‚Äôt change; the architecture around it does. ________________________________________ Chapter 9 ‚Äì Policy Bundling & Distribution OPA is not just an evaluator; it has a bundle system for shipping policies and data. ________________________________________ 9.1 Bundle Basics A bundle is: A .tar.gz containing: /policies/*.rego /data/*.json (or YAML, etc.) .manifest file with metadata. Example manifest (conceptual): { "revision": "git-sha-1234", "roots": ["authz", "compliance"], "metadata": { "version": "1.2.3", "built_at": "2025-11-25T12:00:00Z" } } OPA config: services: policy: url: https://opa-bundles.example.com bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundles, verifies them, and updates its data and policy set. ________________________________________ 9.2 Bundle Layering & Tenancy You can have multiple bundles: global-baseline.tar.gz ‚Üí data.global org-security.tar.gz ‚Üí data.org crm-team.tar.gz ‚Üí data.crm tenant-123.tar.gz ‚Üí data.tenants["123"] OPA merges them in the data document. Patterns: Tenant-specific overrides are just data: package authz default allow := false allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset of OPAs. Compare decisions vs stable. ________________________________________ 9.3 Release Engineering & Versioning Use semantic versioning for bundles: vMAJOR.MINOR.PATCH. Track: Git commit SHA. Build ID. CI pipeline run. Typical pipeline: opa fmt + lint + opa test + opa check --strict. opa build / custom bundler to produce bundle.tar.gz. Sign bundle (e.g., Sigstore, GPG). Upload to bundle server / CDN. Tag release in Git. ________________________________________ Chapter 10 ‚Äì Linting, Style & CI Even perfect policies are useless if they‚Äôre unreadable or unmaintainable. This chapter merges style guides, linting, and CI patterns into an enforceable system. ________________________________________ 10.1 Style Principles (Based on Styra + Enterprise Practice) Readability first Prefer clear, small rules over clever one-liners. Use opa fmt always Standardizes indentation, spacing, and layout. Enforce via CI. Use modern syntax (Rego v1) if, contains, every, some ... in .... Import rego.v1 or future.keywords when needed. Naming conventions Packages: domain.service.component crm.authz.http, infra.k8s.admission. Rules & functions: snake_case. Helper rules: prefix with _ (convention). package crm.authz.http _is_admin(user) if "admin" in user.roles allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package. Imports. Constants/defaults. Then: Helper rules (unexported). Public rules (allow, deny, violation, etc.). ________________________________________ 10.2 Regal (Linter) & Custom Lint Rules Regal is a dedicated Rego linter. Example config (.regal/config.yaml): rules: naming-convention: snake_case: true unused-decls: error no-var-shadowing: error require-some: error no-ambiguous-negation: warn max-rule-size: severity: warn limit: 10 avoid-inline-comprehensions: warn package-path-alignment: error no-import-input: error Typical checks: Snake_case for everything. No unused variables (except _). No variable shadowing. Explicit some declarations. Package name alignment with file path. Metadata required on certain rules (e.g., deny rules). ________________________________________ 10.3 CI Pipeline: From Formatting to Enforcement Lint & format stage ‚Äì GitHub Actions example name: Rego Linting on: [push, pull_request] jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa - name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal - name: Check formatting run: opa fmt --fail . - name: Lint (Regal) run: regal lint --format=github . Test stage name: Rego Tests on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa - name: Run tests run: opa test policies/ tests/ --verbose --timeout 30s Compliance evaluation stage (optional) Run opa eval with CI inputs (like PR diffs) to enforce policy gates. ________________________________________ 10.4 Editor & Developer Experience .editorconfig: [*.rego] indent_style = tab indent_size = 4 Editor extensions: Syntax highlighting, opa fmt on save. Regal integration where possible. For Cursor / custom AI agents: Auto-run opa fmt in pre-commit hooks. Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system. ________________________________________ Chapter 11 ‚Äì Performance Engineering (From Heuristics to Formal Bounds) OPA is fast, but bad policies can be slow. This chapter formalizes the performance story. ________________________________________ 11.1 Complexity Mental Model Roughly: Lookup in objects/sets: ~O(1) Array iteration: O(n) Nested iteration: O(n¬≤) or worse Graph-like recursion: O(depth √ó fan-out), potentially exponential without care Your goal: rewrite policies such that most operations become hash lookups, not brute-force scans. ________________________________________ 11.2 Expression Ordering OPA evaluates rule bodies top to bottom, left to right within that body. Rearranging expressions can dramatically change performance. # Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_regex_check() # expensive } # Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 Index-friendly Data Modeling Given: # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as a map keyed by ID: { "users": { "alice": {"id": "alice", "active": true}, "bob": {"id": "bob", "active": false} } } Then: user := data.users[input.user_id] deny[msg] if { user.active == false msg := "User is inactive" } OPA can automatically index these object lookups, giving near O(1) access. ________________________________________ 11.4 Avoiding Redundant Computation Bad: inefficient if { sum(numbers) > 100 sum(numbers) < 1000 result := sum(numbers) } Good: efficient if { total := sum(numbers) total > 100 total < 1000 result := total } OPA memoizes built-ins within a query, but you still pay the call overhead and it hurts readability. ________________________________________ 11.5 Comprehension Patterns Prefer existential patterns over building large intermediate sets: # Good has_admin if { some u in users "admin" in u.roles } # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Evaluation & Compilation Partial evaluation is like compiling away some of your logic for known inputs. 11.6 Partial Evaluation & WASM Build Modes Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data). Two important workflows: 11.6.1 WASM Compilation (Edge / Embedded) # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/ -t wasm ‚Üí produce a WebAssembly binary. -e 'data.authz.allow' ‚Üí fix the entrypoint. Intended for: Envoy filters In-process SDKs (Go, Node, etc.) Edge runtimes or sidecars. The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module. 11.6.2 General Partial Evaluation (Bundles / CLI) For non-WASM optimization: # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/ This produces: An optimized bundle (policy + data), Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint. Exploratory / ad-hoc partial evaluation: opa eval --partial \ -d policies/ \ 'data.authz.allow' This: Returns residual policy expressions capturing unknowns, Lets you inspect how much work can be pre-computed, Is useful for iterative tuning and performance analysis. Summary: opa build -t wasm ... ‚Üí WASM module for embedded/edge. opa build ... ‚Üí optimized bundle for standard OPA. opa eval --partial ... ‚Üí interactive partial eval for debugging and design. ________________________________________ Chapter 12 ‚Äì Formal Semantics (Doctorate-Level View) Now we go under the hood. You don‚Äôt need this to use Rego, but you do need it to design new policy frameworks, reason about correctness, or write academic work. ________________________________________ 12.1 Rego as a Datalog Variant At its core, a Rego program is a set of Horn clauses (rules) over a Herbrand universe of JSON-like terms. A rule: h(tÃÑ) if { b‚ÇÅ ... b‚Çô } corresponds to: b_1‚àß‚ãØ‚àßb_n‚áíh(t Àâ) Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms. Interpretation: An interpretation Iassigns truth values to all ground atoms (e.g., p("alice", "admin")). The meaning of a program Pis the least fixed point of the immediate consequence operator T_P, analogous to classical Datalog. ________________________________________ 12.2 Immediate Consequence Operator & Fixpoint Define T_Pover interpretations: T_P (I)= set of all heads h(t Àâ)such that there exists a rule h(t Àâ)‚áêb_1,‚Ä¶,b_nand all b_iare satisfied under I. Iterative construction: I_0=‚àÖI_(k+1)=T_P (I_k)"Eval"(P)=‚ãÉ_(k=0)^‚àû I_k Because: Herbrand base is finite for a given finite data and bounded terms. T_Pis monotonic for stratified, positive fragments. ‚Üí Fixpoint is reached in finite steps. ________________________________________ 12.3 Unification & =, :=, == Unification (=): find a most general unifier (MGU) that makes two terms equal. If both sides partially unbound, unify them structurally. Example: [x, "world"] = ["hello", y] MGU: {x‚Ü¶"hello",y‚Ü¶"world"}. Assignment (:=): one-way binding; fails if variable is already bound to a different value. Equality (==): no variable binding; pure comparison. In implementation, OPA uses a mixture of: Unification-like semantics to explore bindings. Assignments and comparisons for clarity and performance in v1 syntax. ________________________________________ 12.4 Negation-as-Failure & Stratification Rego uses NAF (Negation-as-Failure): not p(X) means: ‚Äúit is not provable that p(X) holds‚Äù. Formally: "Eval"(P)‚ä®"not " p(t)" "‚ü∫" Eval"(P)‚ä®Ã∏p(t) To avoid paradoxes (like p :- not p), Rego effectively works in the space of stratified programs (or well-founded semantics): Build a dependency graph between predicates (rules). Require that cycles with negation are disallowed or handled carefully. This is why variables in negated expressions must be grounded elsewhere; otherwise, the semantics become ill-defined. ________________________________________ 12.5 Partial vs Complete Rules: Semantic Interpretation Complete rule (one final value): max_memory := 4 if ... max_memory := 8 if ... default max_memory := 1 Interpreted as a function max_memory : Input ‚Üí Scalar such that: If multiple definitions apply and yield same value ‚Üí OK. If they yield different values ‚Üí conflict (no model). Partial rules (sets/objects): deny[msg] if ... deny[msg] if ... Interpreted as: deny={msg‚à£‚àÉ" body s.t." body‚áímsg} The semantics is set union of instances. ________________________________________ 12.6 Complexity of Evaluation Let: ‚à£D‚à£= size of data. ‚à£I‚à£= size of input. ‚à£P‚à£= size (number of rules/clauses) of program. Then: Basic evaluation (no recursion) is polynomial in ‚à£D‚à£+‚à£I‚à£. General Datalog with negation can be EXPTIME-complete in the worst case, but OPA: Forbids or discourages patterns that would lead to blow-ups. Optimizes with indexing, partial evaluation, grounding. Rule-of-thumb: Flattened, non-recursive Rego with bounded comprehensions behaves like complex SQL queries in terms of complexity. Recursive policies (e.g., graph reachability) behave like graph algorithms. ________________________________________ 12.7 Partial Evaluation Semantics Given: Program P. Known input fragment K‚äÜ(data,input). Define the partial evaluation operator: PE(P,K)‚ÜíP^' such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U) Key points: P^'is smaller and more specialized. OPA uses this to generate WASM or pre-compiled forms that execute efficiently for fixed queries. Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owners, bundles, and tenants without descending into chaos. At scale, you need: ‚Ä¢ Layers: global ‚Üí domain ‚Üí team ‚Üí tenant. ‚Ä¢ Ownership metadata: who owns what, and how severe is it. ‚Ä¢ Override semantics: how do layers combine, and who wins on conflict. ________________________________________ 13.1 Layer Model: Global ‚Üí Domain ‚Üí Team ‚Üí Tenant Think of policies as a stack of overlays: 1. Global Baseline (Organization Level) o Owned by: security/compliance. o Guarantees non-negotiable invariants: ÔÇß ‚ÄúNo public S3 buckets‚Äù ÔÇß ‚ÄúAll admin actions must be audited‚Äù o Usually has the highest precedence for denies (security wins). 2. Domain Policies (Product / Platform Level) o Example domains: ÔÇß crm.*, billing.*, identity.*. o Define domain-specific invariants: ÔÇß ‚ÄúAn Opportunity must have an associated Account‚Äù ÔÇß ‚ÄúA Subscription must have a plan and billing cycle‚Äù 3. Team / Service Policies o Local teams add guardrails and UX-level rules: ÔÇß ‚ÄúThis API must include X-Request-Id‚Äù ÔÇß ‚ÄúThis microservice cannot call that microservice directly‚Äù 4. Tenant Overlays (Customer-Specific) o Per-tenant exceptions and configuration: ÔÇß ‚ÄúTenant A enforces stricter password rules‚Äù ÔÇß ‚ÄúTenant B has a special approval workflow‚Äù OPA sees all of these as data + Rego modules merged into a single virtual data tree. ________________________________________ 13.2 Encoding Layers in Data and Packages One robust pattern: ‚Ä¢ Global policies: package global.* ‚Ä¢ Domains: package domain.<name>.* ‚Ä¢ Teams/services: package svc.<service_name>.* ‚Ä¢ Tenant overlays: data.tenants[tenant_id].* Example structure: policies/ global/ baseline.rego # package global.baseline crm/ authz.rego # package domain.crm.authz schema.rego # package domain.crm.schema svc/ accounts.rego # package svc.accounts.rules tenants/ 123/ overrides.json # data.tenants["123"] 456/ overrides.json ________________________________________ 13.3 Policy Ownership Metadata Every rule that matters should be self-describing. You can store metadata as: ‚Ä¢ A dedicated rule (__meta__) ‚Ä¢ Rego annotations (via rego.metadata.rule()) ‚Ä¢ Comments (less machine-friendly) Example: package crm.policies.account_lifecycle __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVERRIDE | WARN | INFO "version": "1.0.0", "tags": ["lifecycle", "compliance"] } deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Closed accounts cannot be reopened", } } For global policies: package global.network __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", } deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__.rule_id, "msg": "Public S3 bucket forbidden"} } ________________________________________ 13.4 Override Precedence and Combining Layers You need a formal precedence model so people don‚Äôt guess. Think in terms of layer priority and decision semantics. 13.4.1 Priority Model Assign numeric ranks to layers: package policy.layers layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "warn" ‚Ä¢ layer: "global" | "domain" | "team" | "tenant" ________________________________________ 13.4.2 Decision Aggregation Pattern Define a canonical decision document: package decision default result := { "allow": false, "effects": [], # list of all hits from all layers } # Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] } effects[eff] if { eff := data.domain.crm.authz.effects[_] } effects[eff] if { eff := data.svc.accounts.rules.effects[_] } effects[eff] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] } Each eff looks like: { "effect": "deny", "layer": "global", "rule_id": "NET_001", "severity": "BLOCK", "msg": "Public S3 bucket forbidden" } Now: compute final decision. result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]] some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false } # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so. result := { "allow": allow_flag, "effects": all_effects, } if { all_effects := [e | e := effects[_]] not some e in all_effects { e.effect == "deny"; e.severity == "BLOCK" } allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank. ‚Ä¢ Allowing tenant to tighten, but never to weaken global invariants. ________________________________________ 13.5 Tenant Overlays and Safe Customization Tenant-specific rules should be additive and tightening, not weakening: ‚Ä¢ Allowed: o Tenant can restrict their own behavior further. ‚Ä¢ Forbidden: o Tenant cannot bypass global security invariants. Pattern: package authz default allow := false base_allow if { data.global.authz.allow } base_allow if { data.domain.crm.authz.allow } tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg } allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________________________________ Chapter 14 ‚Äì Observability & Audit OPA is not only a decision engine; it‚Äôs an evidence generator. Observability and audit are how you prove that decisions are: ‚Ä¢ Correct ‚Ä¢ Consistent ‚Ä¢ Explainable ‚Ä¢ Compliant with regulation ________________________________________ 14.1 Decision Logs Every OPA decision should be treatable as a replayable event: Minimum recommended fields: ‚Ä¢ decision_id (UUID) ‚Ä¢ timestamp ‚Ä¢ path (e.g., data.authz.allow) ‚Ä¢ input_hash or input (with PII scrubbing) ‚Ä¢ result (decision doc: allow/deny/effects) ‚Ä¢ bundle_revision ‚Ä¢ metrics (evaluation time, rule count) ‚Ä¢ correlation_id (to tie into tracing) Conceptual log: { "decision_id": "3f7b9b1a-0ee2-4e52-9f39-4edb8b6a3a01", "timestamp": "2025-11-25T10:02:45Z", "path": "data.authz.allow", "input_hash": "sha256:abcd...", "result": { "allow": false, "effects": [ { "effect": "deny", "rule_id": "ACCT_001", "layer": "domain", "msg": "Closed accounts cannot be reopened" } ] }, "bundle_revision": "git:1234abcd", "metrics": { "eval_time_ns": 45321, "num_rules_evaluated": 37 }, "correlation_id": "trace-xyz-123" } OPA supports decision logs via configuration; your host system should stream them to: ‚Ä¢ Kafka / Kinesis ‚Ä¢ ELK / Loki ‚Ä¢ Datadog / Prometheus / Grafana ________________________________________ 14.2 Metrics and SLOs To treat OPA like a production service, track at least: ‚Ä¢ Latency: o p50 / p95 / p99 evaluation time. ‚Ä¢ Throughput: o decisions per second. ‚Ä¢ Decision deltas: o How often outcomes change after a new bundle. ‚Ä¢ Error rate: o Number of evaluation failures (e.g., built-in errors in strict mode). Define SLOs like: ‚Ä¢ 99.9% of policy decisions complete in < 10 ms. ‚Ä¢ < 0.1% of decisions result in evaluation error. ‚Ä¢ Decision delta after bundle rollout < 1% for stable inputs (in shadow mode). ________________________________________ 14.3 Correlation IDs and Tracing Policy evaluations rarely stand alone; they‚Äôre part of a larger request trace: ‚Ä¢ HTTP header: o X-Request-Id o traceparent (W3C Trace Context) ‚Ä¢ PEP should pass correlation ID in: o input.trace_id o or embed as part of input.request.headers. Then decision logs include correlation_id, which lets you: ‚Ä¢ Trace a single user‚Äôs journey across services. ‚Ä¢ Root-cause analyze unauthorized/denied requests quickly. Example pattern: package authz default allow := false trace_id := input.request.headers["x-request-id"] allow if { # ...logic... } # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden rule: logs must not become a data breach. ‚Ä¢ Do not log entire input if it contains PII. ‚Ä¢ Instead: o Log hashed fields (hash(email)) o Log ids / foreign keys o Redact sensitive values (e.g., use "redacted") Pattern: safe_input := { "user_id": input.user.id, "tenant_id": input.tenant_id, "resource_id": input.resource.id, "action": input.action, } Your decision logger uses safe_input rather than raw input. ________________________________________ 14.5 Reproducibility & Auditability A compliant audit story usually needs: ‚Ä¢ Given: o bundle_revision o policy_version o input (or hash + associated fixture) ‚Ä¢ You can re-evaluate the decision and get the same result. To achieve this: ‚Ä¢ Store: o Bundle artifacts (bundle.tar.gz) o Manifest metadata (revision, version) o Decision logs + input fixtures (or deterministic reconstruction) ‚Ä¢ Avoid: o Non-deterministic calls in Rego (e.g., random, uncontrolled http.send) When you must use time.now_ns or external data: ‚Ä¢ Either: o Snapshot it in the input used to evaluate. o Or store enough context to reconstruct. ________________________________________ Chapter 15 ‚Äì Stateful & Temporal Extensions OPA itself is stateless: each query sees input and data as immutable snapshots. Yet many policies are stateful or temporal: ‚Ä¢ Rate limits (N requests per unit time) ‚Ä¢ ‚ÄúNo more than 5 failed logins in 10 minutes‚Äù ‚Ä¢ ‚ÄúThis migration must be rolled out only after all canaries pass‚Äù The trick: Move state and time into data + input, not inside Rego. ________________________________________ Stateful & Temporal Extensions OPA is logically stateless: every evaluation sees a snapshot of policy + data. Stateful or temporal behaviors must be modeled via external systems that write to data or pass state through input. 15.1 External State for Rate-Limiting & Anomaly Detection Example of externally managed login counts: # External system populates: # data.state.login_counts = { # "alice": {"last_5m": 12, "last_1h": 42}, # "bob": {"last_5m": 2, "last_1h": 8}, # } package authz too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 } Key properties: OPA never mutates data.state.login_counts. A separate component (stream processor, cron job, gateway) periodically: reads raw events (e.g., login attempts), aggregates them (windowed counts), publishes a new snapshot to: a bundle, or an in-memory structure via the OPA Go SDK, or a shared cache that OPA reads from. Think of the pattern: Events ‚Üí (Kafka / Kinesis / PubSub / Logs) Aggregator ‚Üí (Flink / custom job / Lambda) State Snapshot ‚Üí (bundle / data.state.*) OPA Policy ‚Üí reads data.state.* as a pure input. OPA remains a pure decision engine; all state transitions happen outside. ________________________________________ 15.2 Temporal Logic Using time.* OPA has: ‚Ä¢ time.now_ns() ‚Ä¢ time.parse_ns(layout, string) ‚Ä¢ time.clock(ns) and time.date(ns) ‚Ä¢ time.weekday(ns) Patterns: 1. Business hours 2. package business 3. 4. within_business_hours if { 5. now := time.now_ns() 6. [hour, _, _] := time.clock(now) 7. hour >= 9 8. hour < 17 9. } 10. Sliding window from event log in input Suppose input.events contains last 1 hour of events (pre-filtered by upstream system): package limits default allow := true deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns # events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.action == "login_failure" e.ts >= cutoff } count(recent_failures) > 5 msg := "Too many recent login failures" } OPA sees only a subset; the window is curated by your stateful event pipeline. ________________________________________ 15.3 Event-Driven Architectures with OPA Typical pattern: 1. Events flow into Kafka / Kinesis. 2. A stream processor: o Maintains aggregates: ÔÇß counts, sums, last-seen times, sliding windows. o Writes materialized state to: ÔÇß Redis, DB, or data-bundles for OPA. 3. OPA uses that state to decide: o Allow or deny new events. o Trigger downstream actions/alerts. OPA remains pure ‚Äî no long-lived state, no hidden mutable variables. ________________________________________ 15.4 Time-Scoped Exceptions Sometimes you want: ‚Ä¢ ‚ÄúAllow this temporary override until 2025-12-31.‚Äù Pattern: package overrides temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You encode exceptions in data.overrides, with explicit expiration timestamps. This keeps temporal logic in data, not code. ________________________________________ Chapter 16 ‚Äì Data Policy Models (GraphQL, APIs, Data Filtering) OPA is particularly strong for data access policies because Rego is JSON-native. This chapter focuses on query-shaped inputs like GraphQL and REST. ________________________________________ 16.1 GraphQL AST Policies When a GraphQL query enters your gateway, you can: 1. Parse it into an AST. 2. Send AST + user context to OPA. 3. Enforce: o Field-level authorization. o Query depth/width limits. o Allowed operations. Example input (simplified): { "user": {"id": "alice", "roles": ["user"]}, "operation": "query", "query": { "name": "GetCustomer", "fields": [ {"path": ["customer", "email"]}, {"path": ["customer", "creditCardNumber"]} ] } } Policy: package gql.authz default allow := false default violations := [] # data.gql.allowed_fields = { # "user": { # "customer": ["id", "name", "email"] # }, # "admin": { # "customer": ["*", "creditCardNumber"] # } # } role := r if { r := input.user.roles[_] } # Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"] resource := path[0] field := path[1] not field_allowed(role, resource, field) v := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } } field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard } field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed } allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing This chapter covers structural data policies and cost-based models, especially for GraphQL. 16.2 Field Cost Calculation (Corrected array.concat) Suppose you maintain per-field costs in data.gql.field_costs: # Example: # data.gql.field_costs = { # "Query.users": 1, # "Query.users.email": 2, # "Query.users.orders": 3, # } You want to compute a cost for each field given its path and leaf name. # field_cost([path, field]) := c # path = ["Query", "users"] # field = "email" # full = "Query.users.email" field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] } Corrections and nuances: Use array.concat(path, [field]), not a non-existent append builtin. array.concat([1, 2], [3]) = [1, 2, 3]. If either argument is null or non-array, OPA throws a type error, so in more defensive code: safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] } This function can be used inside a comprehension that walks a GraphQL AST: total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := field_cost([path, name]) }) Here you get: A compositional cost model (paths + leaves). Defensive concatenation. A clean hook for enforcing query limits: deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost } ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1. Treat the request as input: method, path, query params, body. 2. Output a filter document: 3. { 4. "where": { 5. "tenant_id": "tenant-123", 6. "visibility": ["public", "shared_with_user"] 7. } 8. } 9. The service uses that filter to generate SQL. Example: package datafilter default filter := {} filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) } statuses_for(user) := {"active", "pending"} if { "admin" in user.roles } statuses_for(user) := {"active"} if { not "admin" in user.roles } This pattern: ‚Ä¢ Keeps data access rules central. ‚Ä¢ Allows multiple services to enforce the same logic. ________________________________________ Chapter 17 ‚Äì LLM & Agentic Integration with OPA LLMs are good at generating Rego, OPA is good at executing and verifying Rego. Together they form: ‚ÄúAI drafts policy, OPA and tests keep it safe.‚Äù ________________________________________ 17.1 The Agentic Workflow Canonical pipeline: 1. Requirements in natural language: o ‚ÄúAPI keys must not be visible in logs‚Äù o ‚ÄúAdmin role modifications require approval‚Äù 2. LLM drafts: o Rego module. o Test suite (_test.rego). o Metadata (owner, rule_id). 3. Static checks: o opa fmt o Regal lint o opa check --strict 4. Dynamic checks: o opa test (unit + integration tests). o Fuzz/Golden tests for critical policies. 5. Human review: o Security / Policy engineers review diff, semantics. 6. Bundle build & rollout: o Standard policy SDLC. OPA becomes the execution and verification back-end for LLM-authored policy. ________________________________________ 17.2 Guardrails for LLM-Generated Rego When you let an LLM write Rego, you must: ‚Ä¢ Enforce style & safety: o Modern syntax only (import rego.v1 or future.keywords). o No http.send in production rules (unless explicitly allowed). o No secrets in code. o Type guards for all input.* references. ‚Ä¢ Require tests: o At least one positive and one negative case. o Use with overrides instead of real network/time. You can encode this as Rego that reviews Rego: ‚Ä¢ Use rego.metadata.chain() and AST analysis to enforce rules. ‚Ä¢ Or use external tools (Regal) plus your own AST/grep rules. ________________________________________ 17.3 ‚ÄúPolicy Copilot‚Äù Pattern A typical agentic stack: 1. Authoring agent: o Generates initial Rego module + tests from description and examples. 2. Critic agent: o Reads module, runs static analysis (Regal messages, opa check). o Suggests improvements and simplifications. 3. Tester agent: o Proposes additional tests (edge cases, negative paths). o Extends _test.rego. 4. Reviewer agent: o Summarizes behavior in human language. o Flags risky constructs, ambiguous cases. 5. Bundle builder: o Once human approves, compiles into bundle artifact. OPA is the deterministic core all these agents orbit around. ________________________________________ 17.4 LLM Self-Checking with Rego LLMs can call OPA during prompt execution: ‚Ä¢ Use examples like: o ‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù ‚Ä¢ LLM loops: 1. Generate candidate Rego. 2. Invoke opa test programmatically. 3. If tests fail, update policy and try again (up to N iterations). 4. Present final Rego + test report. This turns Rego into a ground truth oracle inside an agentic system. ________________________________________ Chapter 18 ‚Äì Rego Cheat Sheet (Condensed) This chapter is intentionally tight ‚Äì it‚Äôs the 2-page desk reference. ________________________________________ 18.1 Core Rule Types Type Syntax Example Boolean name if { ... } allow if { is_admin } Complete name := value if { ... } max_conns := 10 if is_admin Partial Set name contains x if { ... } deny contains msg if { ... } Partial Obj name[key] := value if { ... } roles[user] := role if { ... } Function f(x) := y if { ... } double(x) := x * 2 Default default name = value default allow = false ________________________________________ 18.2 Assignments & Comparisons ‚Ä¢ := ‚Äì assignment (one-way) ‚Ä¢ == ‚Äì equality (no binding) ‚Ä¢ = ‚Äì unification (binds if unbound, else compares) Examples: x := 10 # assignment ok if x == 10 # comparison [x, "world"] = ["hello", y] # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ Object: {"k": 1, "v": 2} Special: ‚Ä¢ Empty set: `{}` (not `set()`, which is a type conversion function requiring an argument) ‚Ä¢ Empty object: `{}` **Important:** `set()` is a type conversion function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` directly. Using `set()` without arguments will cause a runtime error. ________________________________________ 18.4 Iteration Implicit: arr[_] # all values obj[k] # binds k to each key set[v] # binds v to each member Explicit with some ... in: some x in arr # values some i, x in arr # index, value some k, v in obj # key, value some v in set # members ________________________________________ 18.5 Quantifiers ‚Ä¢ Existential: some x in xs { ... } ‚Ä¢ Universal: o Using every: o all_valid if { o every x in xs { o x.valid == true o } o } o Or via negation: o all_valid if not any_invalid o any_invalid if { o some x in xs o not x.valid o } ________________________________________ 18.6 Negation not cond = ‚Äúcannot prove cond.‚Äù Safety: variables in cond must be bound beforehand. deny if { user := input.user not blacklisted[user] } ________________________________________ 18.7 Built-in Highlights ‚Ä¢ Aggregates: count, sum, max, min ‚Ä¢ Strings: concat, contains, startswith, endswith, split, replace ‚Ä¢ Regex: regex.match, regex.split ‚Ä¢ JSON: json.marshal, json.unmarshal ‚Ä¢ Time: time.now_ns, time.parse_rfc3339_ns, time.clock ‚Ä¢ Crypto: crypto.sha256, io.jwt.* ________________________________________ 18.8 Testing ‚Ä¢ Tests: package ending in _test, rules starting with test_. ‚Ä¢ Use with to override input, data, or built-ins. test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test . ________________________________________ 18.9 Best Practices (Ultra Condensed) ‚Ä¢ Always opa fmt and lint. ‚Ä¢ Use modern syntax (import rego.v1 or future.keywords). ‚Ä¢ Prefer sets/objects for membership tests. ‚Ä¢ Avoid inline comprehensions in complex allow/deny. ‚Ä¢ Use helper rules with clear names. ‚Ä¢ Always have tests for deny/allow semantics. ________________________________________ Chapter 19 ‚Äì Glossary (Rigorous) Alphabetical list of core terms. ________________________________________ ABAC (Attribute-Based Access Control) Access model where decisions are based on attributes of subject, resource, action, and environment, not just roles. Allow / Deny (Effects) Canonical authorization decision outcomes. Frequently modeled via Rego rules like allow and deny or decision documents with effects. AST (Abstract Syntax Tree) Tree representation of parsed input (e.g., GraphQL query), often passed to OPA as input for fine-grained policies. Baseline Policy (Global Baseline) Organization-wide invariant policy layer that lower layers cannot override or weaken (e.g., ‚ÄúNo public S3 buckets‚Äù). Bundle A versioned tarball containing Rego policies, data, and a .manifest file. Used by OPA to load and update policies in production. Complete Rule A Rego rule that defines a single final value (e.g., max_conns := 10 or allow := true). Multiple definitions that produce different values for the same input cause conflicts. ConstraintTemplate (Gatekeeper) Kubernetes CRD that defines reusable OPA policies for Gatekeeper. Users instantiate constraints based on templates. Correlation ID Identifier used to tie together logs and traces across systems, included in OPA decision logs for observability. Data (in OPA) Persistent, relatively static information (loaded from bundles or in-memory), accessed as data.*. May mirror configuration, schemas, user roles, etc. Decision Document The JSON result of an OPA query (e.g., data.authz.allow or a more complex document with allow, deny, effects, risk_score). Decision Log Structured record of each OPA evaluation: includes path, input (or hash), result, metrics, and bundle revision, used for audit and observability. Datalog A subset of Prolog used for declarative logic programming, without complex function symbols. Rego is inspired by Datalog and extends it with JSON-like structures. Deny Rule A partial rule (often deny[msg] or deny contains msg) that accumulates violation messages, typically used in compliance and validation policies. Effect The semantic outcome of a policy evaluation (e.g., "allow", "deny", "warn", "override"), often encoded in decision documents. Fixpoint A stable interpretation of a logic program where applying the immediate consequence operator (deriving new facts) produces no new facts. Rego‚Äôs semantics can be described via least fixpoints. Future Keywords The future.keywords import (Rego v0.x) that enables newer language constructs like if, in, contains, every. In OPA 1.0+ this is replaced by import rego.v1. Global Baseline See Baseline Policy: global layer of policies applied to all services/tenants, usually with highest precedence for security. GraphQL Policy Policy that operates on GraphQL queries represented as AST; can enforce field-level auth, query depth, or cost. HTTP Sidecar Deployment pattern where OPA runs as a sidecar container next to a service, receiving authorization queries over localhost. Input (in OPA) Per-request JSON document provided by the caller to OPA, containing details like user, action, resource, HTTP request, etc. Accessed as input.*. LLM (Large Language Model) Neural network model (like ChatGPT) used to generate or refactor Rego; OPA then validates and executes resulting policies. NAF (Negation-as-Failure) Logic programming semantics where not p(X) means ‚Äúp(X) cannot be proven.‚Äù Used in Rego for negation. OPA (Open Policy Agent) General-purpose policy decision engine that evaluates Rego policies against JSON inputs and data. PDP (Policy Decision Point) Component that computes policy decisions (e.g., OPA). PEP (Policy Enforcement Point) Component that enforces decisions (e.g., API gateway, Kubernetes admission controller). Partial Evaluation (PE) Technique where OPA specializes policies with respect to known input and data, producing an optimized, often smaller program or WASM artifact. Partial Rule A Rego rule that defines members of a virtual set or object incrementally (e.g., deny[msg] or roles[user] := role). Rego OPA‚Äôs declarative policy language, inspired by Datalog and designed for reasoning over JSON-like documents. Regal A dedicated linter for Rego, enforcing style and correctness rules beyond opa fmt. Rule Conflict Runtime error when multiple complete rules or function rules with the same name and arguments produce different values. Schema (JSON Schema) Formal type definition for JSON documents. OPA can use schemas to perform type checking on input or data. Sidecar Deployment pattern where OPA runs alongside an application in the same Pod/host, reducing network latency for policy queries. Stateful Policy Policy whose decision depends on past events or accumulated state. Implemented in OPA by passing state snapshots as data or input, not by mutability in Rego. Stratification Property of a logic program whereby cycles through negation are avoided, enabling well-defined semantics for negation-as-failure. Temporal Policy Policy that involves time (e.g., deadlines, windows, schedules), typically implemented with time.* built-ins and time-stamped state. Tenant Overlay Per-tenant policy or configuration that tightens (but does not weaken) global/domain rules, often stored under data.tenants[tenant_id]. Virtual Document A Rego rule or package that behaves like a JSON document when queried (e.g., data.authz.allow), although it is computed on demand rather than stored. WASM (WebAssembly) Portable binary format that can run Rego policies compiled from OPA in multiple environments (browsers, proxies, services). With (Keyword) Rego keyword that allows overriding input, data, or built-ins for the scope of an expression; heavily used in testing and mocking. Zero-Trust Architecture Security model where no implicit trust is granted to assets or user accounts based solely on network location; OPA policies often implement zero-trust authorization logic. Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision The full decision path for a typical OPA evaluation looks like this: flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[Decision Document] subgraph POLICIES & DATA C D end subgraph INPUTS B end F -->|JSON Response| A A more detailed view that includes partial evaluation and decision logging: flowchart TD R[Request: input] --> OPA[OPA Engine] subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end OPA --> P PE --> D1[Optimized Policy Set] subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end LD --> EV[Evaluate Query] D1 --> EV R --> EV EV --> RES[Decision Document] EV --> LOG[Decision Log Event] RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake] Narrative: Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path. Data from bundles and dynamic sources is loaded into data.*. Each incoming request passes input + compiled policies + current data snapshot into the evaluator. The evaluator returns a structured decision document and emits decision logs for observability and audits. Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram OPA can be deployed in three canonical modes: sidecar, central service, and embedded. flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end subgraph Embedded Library A3[App Process with OPA SDK] end 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar] B[BUNDLE Server] --> OPA Each app pod has its own OPA. Low latency (localhost). Good for microservices and per-tenant tuning. 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE Server] --> OPA_CLUSTER One or a few OPA instances serve many clients. Great for shared policies and simple clients (like Nginx, legacy apps). 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP OPA compiled to WASM or linked via Go library. No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths. Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[Domain Layer\n(product / region)] D --> T[Team Layer\nservice / app] T --> N[Tenant Layer\ncustomer-specific] N --> Q[Final Decision] Conceptual flow: Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds). Domain: Variants per product/region (e.g., EU vs US data rules). Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*). Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists). 13.X.1 Layered Evaluation Example package authz default allow := false # Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes forbidden" } # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent required" } # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billing): admin role required" } # Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant override: feature-x beta allow" } deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] } allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails } This pattern makes layer provenance explicit and traceable. Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OPA --> LOG[Decision Log JSON] LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Data Warehouse] Typical fields in the decision log: input (possibly redacted) result (decision document) path / query labels (instance, version, tenant) metrics (eval time, number of rules evaluated) This pipeline supports: Real-time alerting (SIEM / SOC). Dashboards (latency, volume, error rates). Audit trails (who allowed what, when, and why). Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user. package resources # data.resources.projects = [ # { # "name": "proj-a", # "services": [ # {"name": "svc-1", "env": "prod", "owners": ["alice"]}, # {"name": "svc-2", "env": "dev", "owners": ["bob"]} # ] # }, # { # "name": "proj-b", # "services": [ # {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]} # ] # } # ] prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.projects[_] svc := proj.services[_] svc.env == "prod" svc.owners[_] == user ] } Usage: alice_prod := prod_services_owned_by("alice") This returns: [ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ] Key features: Two nested comprehensions (projects[_], services[_]). Inline filtering by environment and ownership. Structured result objects built inside the comprehension. Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example Complete pattern combining decode, verify, and claim checks. package authz.jwt # Configuration in data.jwt: # data.jwt = { # "issuer": "https://issuer.example.com/", # "audience": "my-api", # "jwks": { ... } # if using embedded JWKS # } default allow := false allow if { token := input.headers.authorization startswith(token, "Bearer ") raw := substring(token, count("Bearer "), -1) # Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw) verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) } verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true # For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true } verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer # aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := aud ) some i aud_array[i] == data.jwt.audience # exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now } verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true # Scope-based check some i payload.scope[i] == "read:orders" } This example is realistic enough to drop into an API gateway or backend service. Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example A typical bundle layout on disk: bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî‚îÄ‚îÄ tenant-2.json 9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] } Meaning: revision is an opaque version string for debugging/rollback. roots tell OPA which prefixes in data this bundle owns: authz ‚Üí data.authz.* (from authz.rego) jwt ‚Üí data.jwt.* (if any data) config ‚Üí data.config.* (from data/config.json) tenants ‚Üí data.tenants.* (from data/tenants/*.json) You can layer bundles by: Using disjoint roots (e.g., authz/ vs pricing/). Or orchestrating versioning in the bundle distribution system. Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system. package authz.multi_tenant default allow := false # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := global_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 } domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 } tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow := count(allow_reasons) > 0 } # Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "allow": final_allow, "source": final_source } } { not global_decision.allow final_allow := false final_source := "global" } { global_decision.allow not domain_decision.allow final_allow := false final_source := "domain" } { global_decision.allow domain_decision.allow tenant_decision.allow final_allow := true final_source := "tenant" } { global_decision.allow domain_decision.allow not tenant_decision.allow final_allow := true final_source := "domain/global" } Clients now get a rich decision document: { "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: feature-x beta"]}, "final": {"allow": true, "source": "tenant"} } Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth Assume: API gateway parses GraphQL into an AST and passes it in input.gql. Schema-driven config is in data.gql. Example config: { "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "support"], "Query.users.email": ["admin"], "Query.users.orders": ["admin", "billing"] } } Rego module: package gql.authz import future.keywords.in default allow := false # input.gql example: # { # "operations": [ # { # "type": "query", # "root": "Query", # "fields": [ # { # "path": ["Query", "users"], # "name": "users", # "subfields": [ # {"path": ["Query", "users", "email"], "name": "email"}, # {"path": ["Query", "users", "orders"], "name": "orders"} # ] # } # ] # } # ], # "user": { # "id": "alice", # "roles": ["support"] # } # } user_roles := input.gql.user.roles # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.gql.roles[full] some r in user_roles r in required } field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] } field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] } # Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.operations[_] f := op.fields[_] ] ++ [ {"path": sf.path, "name": sf.name} | op := input.gql.operations[_] f := op.fields[_] sf := f.subfields[_] ] } total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) }) too_expensive if { total_cost > data.gql.max_cost } unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) } allow if { not too_expensive count(unauthorized_fields) == 0 } decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields } This gives: Field-level auth (field_allowed). Cost-based limiting (total_cost, too_expensive). A rich decision document for clients. Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot] LLM --> CAND[Candidate Rego Policy] CAND --> PIPE[Validation Pipeline] PIPE -->|fail| FEEDBACK[Errors / Suggestions] PIPE -->|pass| BUNDLE[Signed Policy Bundle] BUNDLE --> OPA[OPA Deployments] 17.X.1 Validation Pipeline Steps Syntactic checks: opa fmt, opa check. Unit tests: opa test. Static analysis: internal style & safety rules. Staging OPA: run candidate policy against recorded traffic (shadow mode). Human review for MAD (Major Action/Decision) changes. 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests Candidate Rego (generated by LLM): package authz.orders default allow := false # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id] some order order := data.orders[order_id] ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) } Validation tests: package authz.orders_test import data.authz.orders test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id == "alice" result := orders.allow with input as input result == true } test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_id == "alice" result := orders.allow with input as input result == false } test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} } result := orders.allow with input as input result == true } Pipeline actions: Run opa fmt ‚Üí ensure style. Run opa check ‚Üí catch unknown refs, unsafe vars. Run opa test ‚Üí ensure behavior matches expectations. Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths). If all pass, bundle and distribute. Common Pitfalls: Variable Scoping & Safety 4.X Common Pitfalls: Variable Scoping & Safety Rego‚Äôs scoping rules are simple but unforgiving. Most ‚Äúmysterious‚Äù bugs in policies stem from variable scope and safety issues. Pitfall 1: Accidental Variable Shadowing Inner blocks can rebind a variable name used in an outer block, changing meaning silently. user := input.user allow if { user := data.override_user # shadows outer user user.id == "admin" } The inner user hides the outer one. Prefer distinct names unless you truly mean to shadow: user := input.user allow if { override_user := data.override_user override_user.id == "admin" } Pitfall 2: Unsafe Variables in Rules A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body. # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here } Use opa check to detect this and refactor to ensure all head variables are always bound: # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" } Pitfall 3: Misusing some in Comprehensions some x introduces a new variable local to the current expression. Using it incorrectly can over-constrain or under-constrain rules. # ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices bad if { some i arr[i] == "a" some i arr[i] == "b" } Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names: # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" } Pitfall 4: Assuming Global State in Rules Each rule evaluation is pure and has no hidden global state. Avoid writing rules as if they ‚Äúaccumulate‚Äù across calls: # ‚ùå Misleading mental model: this does not "increment" anything counter := counter + 1 if { ... } # invalid and unsafe Instead, build sets or arrays with comprehensions, then aggregate: violations := { v | some i v := input.items[i] v.level == "HIGH" } violation_count := count(violations) Chapter 6 ‚Äì Common Pitfalls: Nulls, Missing Fields, and Type Guards 6.X Common Pitfalls: Nulls, Missing Fields, and Type Guards Rego is strict about types, but JSON inputs are often messy. Nulls and missing fields are a frequent source of runtime errors. Pitfall 1: Accessing Missing Fields Directly # ‚ùå Panics if input.user is null or missing email := input.user.email Always guard when reading from untrusted inputs: # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email } You can also provide a default: user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email } user_email := "unknown" if { not is_string(user_email) } Pitfall 2: Null vs Missing vs Falsy null, missing, and ‚Äúfalsy‚Äù values are different: Missing: input.user.email ‚Üí error if user missing or not object. Present but null: input.user.email == null is valid. Falsy (e.g., "", 0, false): normal values. Use guards to distinguish: has_email if { is_object(input.user) input.user.email != null } Pitfall 3: Using array.concat on Non-Arrays # ‚ùå Panics if path is null or not an array full := concat(".", array.concat(path, [field])) Wrap in a safe helper or use guards: full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) } Or centralize: safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) } Pitfall 4: Equality Checks with Mixed Types # ‚ùå May silently fail if left/right have different types allowed if input.user.id == data.allowed_ids[_] If input.user.id is a number and data.allowed_ids are strings, this will never match. Normalize types first: allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] } Pitfall 5: Assuming in Works Like SQL for All Types x in y behaves differently depending on whether y is an array, set, or object. Array: x in ["a", "b"] Set: x in {"a", "b"} Object: k in {"a": 1} matches keys, not values. Be explicit about what you mean: # Key membership "k1" in {"k1": 1, "k2": 2} # Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"} Chapter 11 ‚Äì Common Pitfalls: Performance Anti-Patterns 11.X Common Pitfalls: Performance Anti-Patterns Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins. Pitfall 1: Unbounded Linear Scans on Huge Collections # ‚ùå Potentially O(N) scan on large data set every request deny if { some i data.events[i].ip == input.client_ip } Better approaches: Pre-index large data sets offline (e.g., data.events_by_ip[ip]). Use sets for membership checks. # Precomputed: data.events_by_ip = { "1.2.3.4": true, ... } deny if { data.events_by_ip[input.client_ip] } Pitfall 2: Heavy Regex in Hot Paths # ‚ùå Expensive regex on every request deny if re_match(".*(admin|root).*", input.user.name) Mitigations: Push pattern constraints into data modeling if possible. Limit regex to narrow fields and avoid complex patterns. Precompile filters into simpler checks (startswith, contains equivalent logic). Pitfall 3: Recomputing the Same Expression Repeatedly # ‚ùå Recomputes parse for each use deny if { re_match("admin", input.user.name) some p in data.profiles re_match("admin", input.user.name) # repeated } Bind once and reuse: deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call } You can also use helper functions for complex computations. Pitfall 4: Ignoring Partial Evaluation Opportunities Evaluating large, mostly static policies at runtime: # ‚ùå CLI call with huge static config in input opa eval -d policies/ -i big_config.json 'data.authz.allow' If most config is static, bake it into data and use partial evaluation: # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/ Then pass only request-specific input and reap the performance benefits. Pitfall 5: Overusing walk on Large Trees # ‚ùå walk(data) over a huge universe deny if { some path, value walk(data, [path, value]) value == "secret" } walk is powerful but traverses entire trees. Instead: Narrow the search to known subtrees. Maintain dedicated indexes for sensitive values. Use more structured queries instead of full traversal. # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" } 1. Use opa fmt --skip-constraints (most reliable built-in) opa fmt removes unused aliases but NOT unused imports. Example: import data.utils as u If u is never referenced, opa fmt will not remove it. BUT if you write: import data.utils Some versions of opa fmt will rewrite it to: import data.utils ‚Ä¶and will not remove it. Bottom line: opa fmt alone cannot solve unused imports reliably, but helps a bit with alias trimming. ‚úÖ 2. Use opa check --strict This is your best current built-in tool. opa check --strict . This catches: unused function parameters undefined variables shadowed variables ‚Ä¶but NOT unused imports. Still, it improves safety and catches 80% of redundant logic issues. ‚úÖ 3. Use Rego Linter Plugins (best solution) Several teams build a custom linter using rgl, conftest, or their own parser. The best available tool today is: rgl (Rego Lint) GitHub: https://github.com/GearPlug/rgl (community linter) It catches: unused imports unused rules unused local variables dead expressions unreachable rules This is the closest to ESLint/flake8 for Rego. Recommend adding this to CI. ‚úÖ 4. Use Styra DAS Rego Analyzer (if enterprise budget exists) Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags: unused imports unnecessary negations slow queries inefficient comprehensions policy design smells This is the gold standard for production environments but requires paid DAS. ‚úÖ 5. Use editor extensions (Cursor, VSCode, JetBrains) If you‚Äôre using Cursor, the best workflow is: Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] } Then configure a custom linter rule using a regex: import ([^ ]+)( as [^ ]+)? // highlight if alias is unused Cursor can highlight this dynamically. ‚úÖ 6. Organizational best practice: Avoid wildcard imports Never write: import data or: import data.services.* Why? Harder to detect unused segments Harder to find where names come from Encourages shotgun imports Always prefer small, explicit imports: import data.services.crm.allow import data.shared.strings as str import data.shared.constants ‚úÖ 7. Recommended CI rule: Reject files containing unused imports Here is the enterprise-grade script: .ci/lint_unused_imports.sh #!/usr/bin/env bash unused=$(opa inspect . --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path') if [ -n "$unused" ]; then echo "‚ùå Unused imports detected:" echo "$unused" exit 1 fi echo "‚úì No unused imports" This uses: opa inspect (which parses import graph) a small jq filter to detect unused imports This is currently the single best approach that works reliably as of 2024‚Äì2025. üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough opa check --strict üî∂ Detects unused variables, not imports Use always rgl (Rego Lint) ‚úÖ Detects unused imports Best open-source option Styra DAS üî• Enterprise-grade policy analyzer Best paid option CI + opa inspect + jq üî• Fully reliable in CI Recommended Cursor/VSCode rules üî∂ Helps devs during coding Recommended The best lifecycle is: Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional) ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search. Why? Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become: ambiguous fragile order-dependent confusing during refactors conflicting when multiple packages define the same rule And the moment two rule names collide, OPA will throw a conflict or silently evaluate the wrong rule ‚Äî both are terrible in production policy systems. So: ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt count(tech_debt.warn) == 0 with input as mock_input This is the safest, clearest, least ambiguous long-term behavior. üß† Short Answer You Requested (Concise Explanation) Answer: The warn reference comes from the data tree, not from the import. During opa test, OPA loads all policies under services/opa/policies/ into the data namespace. When the test references warn, OPA resolves it by searching all packages for a rule named warn, which finds data.compliance.tech_debt.warn. Because the test never uses tech_debt.warn, the import data.compliance.tech_debt is unused and can be removed. However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define warn. üîç Full Explanation (What‚Äôs Happening Under the Hood) 1. How OPA loads data during tests When you run: opa test services/opa/policies/ services/opa/tests/ OPA loads: every .rego file from policies/ ‚Üí into the data tree every test module in tests/ ‚Üí evaluated with the loaded data This means all rule names become visible under data.*. 2. How warn is resolved When the test evaluates: count(warn) == 0 OPA resolves warn like this: Does the test file define a local variable named warn? No. Does the file import something named warn? No. Search the global data tree for any rule named warn. Finds: data.compliance.tech_debt.warn Thus, the test works, but‚Ä¶ The import is unused because OPA never needs the alias tech_debt to find the rule. ‚ö†Ô∏è Why this is risky If tomorrow someone adds: package compliance.sample warn { ... } Then: warn becomes ambiguous, tests start failing, or worse: OPA selects the wrong one depending on rule type. This is how critical bugs enter policy codebases. üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports Never rely on bare rule names: ‚ùå Bad count(warn) == 0 ‚úîÔ∏è Correct count(tech_debt.warn) == 0 ‚úîÔ∏è Even safer if using as import data.compliance.tech_debt as td count(td.warn) == 0 Your system found: The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused. You removed it, and the tests still worked. ‚úîÔ∏è Why tests still work Because: The tests reference warn without a package prefix: count(warn) == 0 OPA loads all policy packages in /policies/** So the rule warn is available at: data.compliance.tech_debt.warn OPA resolves bare rule names by doing a global search in data. So the import is indeed unused, and removing it does not break the test in the current setup. ‚ö†Ô∏è But removing it is NOT the best practice Even though the import is unused now, this approach is fragile. Why? 1. Bare rule names (warn) are ambiguous Example: If another policy someday adds: package compliance.security warn { ... } Then: count(warn) becomes ambiguous and OPA may: fail pick the wrong rule give unpredictable results 2. Tests become context‚Äêdependent OPA test behavior depends on all loaded policies. If someone changes folder structure or adds a new rule, this test may start failing. 3. Not explicit ‚Üí Not safe in enterprise systems Implicit resolution is one of the most common sources of bugs in OPA deployments. üß† The Better Fix (What I Would Do) ‚ùå Instead of removing the import ‚úîÔ∏è Fix the test to use the import explicitly import data.compliance.tech_debt count(tech_debt.warn) == 0 This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct pattern for all enterprise-grade policy suites. üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate Instead: Use explicit, namespaced references in all tests. The rule: ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly. **Formal Recommendation (Chapter 7.2.1):** In test files, always use explicit package-qualified rule references: ```rego
# ‚úÖ CORRECT: Explicit import and qualified reference
package compliance.tech_debt_test

import data.compliance.tech_debt
import rego.v1

test_example if {
    mock_input := {...}
    warnings := tech_debt.warn with input as mock_input
    count(warnings) >= 1
}
``` **Rationale:** 1. **Ambiguity Prevention**: Multiple packages may define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity. 2. **Maintainability**: Tests remain stable when new policies are added that might introduce naming conflicts. 3. **Clarity**: Explicit references make test intent clear and reduce cognitive load during code review. 4. **Refactoring Safety**: Policy package reorganization doesn't break tests that use explicit references. **Anti-Pattern:** ```rego
# ‚ùå AVOID: Bare rule name resolution
test_example if {
    count(warn) >= 1 with input as mock_input
    # Relies on global data tree search - fragile and ambiguous
}
``` üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test import rego.v1 import data.compliance.tech_debt # ‚Üê keep this count(tech_debt.warn) == 0 with input as mock_input how your test diff strings are represented inside Rego test files. Specifically: ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {" ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character. ‚ùå But in Rego test files, a string such as: "diff": "+ // TODO:\n+ function getUsers() {" does not produce a newline. In Rego test files: \n is literal backslash + ‚Äún‚Äù NOT a line break NOT decoded NOT matched by regex patterns expecting real newlines or multi-line content NOT iterated the same way So your regex patterns such as: regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff) never see the newline, so they fail. This perfectly explains your trace output: __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context. They are being accessed ‚Äî the content is just different from what your rules assume. üî• Proof: Why the three affected tests fail 1. test_todo_without_clear_action Expected: TODO: <newline> function() Actual in test: "TODO:\nfunction" OPA sees: "T O D O : \ n f u n c t i o n" Your regex expects: TODO: function ‚Ä¶but the newline is missing ‚Üí FAIL. 2. test_fixme_added_without_reference Expected: "+ // FIXME: Temporary hack..." Your regex checks: contains(diff, "FIXME:") But OPA sees: "+ // FIXME: Temporary..." Why does this fail? Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g. "+ // FIXME: Temporary hack for authentication" becomes: "+ // FIXME: Temporary hack for authentication" But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context. 3. test_meaningful_todo_not_logged Same issue: Your rule expects: TODO: Fix N+1 query (workaround) OPA evaluates the Rego test literal as: T O D O : \ s F i x ... The pattern never matches because whitespace escaping does NOT behave like in JSON. üß† Why direct opa eval --input JSON works Because JSON ‚Üí OPA decoding translates \n into real newlines. Rego test files do NOT. üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings Rego supports multi-line raw strings: diff := `+ // TODO: + function getUsers() {` This will perfectly match the policy expectations. Update all test inputs to use multi-line raw strings. ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file Instead of: "diff": "+ // TODO:\n+ function getUsers() {" Do: "diff": "+ // TODO: + function getUsers() {" This is the simplest solution. ‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n" Example: regex.match("TODO:(\n|\\\\n)", diff) But this becomes ugly and error-prone. ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy You can add: diff_unescaped := string.replace(file.diff, "\\n", "\n") But this will add noise to all rules. ‚úîÔ∏è What I Recommend Because you‚Äôre building an enterprise system: ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs
aliases: []
chapter: CH-05
digest: 4821f0ebd3778222ac3ff1db15b23a26d3defae41a2f9cc6d47f55702384ec4e
symbol_refs: [Common Pitfall ‚Äî Existential vs Universal]
semantic_role: definition
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz, distribution, negation, observability, performance, testing, theory, unification]
vector_summary: ```rego # ‚ùå WRONG: "Is there any element != 'foo'?" # This is true if ANY element is not "foo" has_non_foo if { items[_] != "foo" # Existential quantification } # ‚úÖ CORRECT: "Is 'foo' not in array?" foo_not_present if { not "foo" in items } # ‚úÖ CORRECT: "Are all elements not foo?" all_non_foo if not any_foo any_foo if { some item in items item == "foo" } ``` --- 6.2 Built-in Function Categories (Overview) For orientation, here is the taxonomy we‚Äôll use in this chapter: Aggregates: count, sum, product, min, max, sort, all, any Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.* Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.* Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs HTTP & I/O: http.send for outbound HTTP calls Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge UUID/ULID: uuid.*, ulid.generate Graph & Structural Walks: graph.reachable, walk Units: units.parse, units.parse_bytes Metadata & Introspection: rego.metadata.rule, rego.metadata.chain Debugging: print, trace Error Semantics: Strict vs non-strict behavior We‚Äôll now go category by category, with semantics, examples, and pitfalls. 6.3 Aggregates Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR). Key built-ins: count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element min(array) # minimum element sort(array) # sorted copy (ascending) all(array_bool) # AND over boolean array any(array_bool) # OR over boolean array Examples: # Count API keys api_key_count := count(input.api_keys) # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) } # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) } Typing & Errors: sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined. count accepts arrays, sets, strings: count("abc") # 3 count({"a", "b"}) # 2 Pattern: Use count for guardrails: deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" } 6.4 Arrays Arrays are ordered; built-ins treat them as such. Key built-ins: array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy Examples: # Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len) # Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1] Indexing vs slicing: OPA has no direct a[1:3] slicing syntax; use array.slice. Out-of-range indices ‚Üí expression undefined. 6.5 Sets and Set-like Operations Rego sets are unordered, unique collections. Key built-ins: intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # convert array to set Example: allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions) invalid_regions := set_diff(requested_regions, allowed_regions) deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) } Performance pattern: Prefer sets for membership: # Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users # Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list 6.6 Objects & JSON Path Helpers Objects represent mappings from scalar keys to arbitrary values. Key built-ins: object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on conflict object.filter(obj, keys_array) # keep only listed keys json.filter(obj, paths_array) # filter by JSON paths (e.g., "a/b/c") Examples: # Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000) # Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"]) # Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"]) # Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"]) Patterns: Use object.get instead of chaining if input.config.timeout_ms checks everywhere. Use object.remove before logging to avoid PII leaks. 6.6 JSON Filter (json.filter) json.filter allows you to keep only selected fields from a JSON object. Signature (conceptual): json.filter(obj, paths_array) # paths_array: array of slash-delimited strings Example: # Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"]) Path strings are JSON Pointer‚Äìstyle: "user/id" corresponds to conceptual path segments ["user", "id"]. "request/path" corresponds to ["request", "path"]. Think of each string as a slash-delimited path from the root of obj. The function returns a new object containing only the specified paths. 6.7 Strings Rego strings are Unicode text; built-ins operate on code points (not bytes). Key built-ins: concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, base) # "2a" in base 16, etc. indexof(s, substr) # index or -1 lower(s) / upper(s) replace(s, old, new) # replace all occurrences split(s, sep) # split into array sprintf(format, args_array) # printf-style format substring(s, start, length) # slice of string trim(s, chars) # trim characters from both ends trim_space(s) # trim whitespace trim_prefix(s, prefix) trim_suffix(s, suffix) Examples: # Normalize emails norm_email := lower(trim_space(input.user.email)) # Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/") # Slugify a title (rough example) slug := lower(replace(input.title, " ", "-")) # Format numeric IDs hex_id := format_int(input.id, 16) # hex # Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id]) Pitfall: contains is substring, not set membership (for that use in). 6.8 Regular Expressions Regex built-ins are powerful but expensive; use carefully. Key built-ins: regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(pattern, string) # array of splits **Raw Strings (Backticks) - Implementation Note:** The grammar defines raw strings with backticks (`raw-string ::= "`" { CHAR-"`" } "`"`), and examples in documentation may show them. However, **raw strings may not be supported in all OPA versions or implementations**. For maximum compatibility, prefer double-quoted strings with proper escaping: # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value) # May not work in all OPA versions is_hex if regex.match(`^[0-9a-fA-F]+$`, input.value) **Best Practice:** Always use double-quoted strings with escaped backslashes for regex patterns. Test with `opa check` to verify compatibility with your OPA version. **Exception: Multi-Line Test Data** For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve actual newline characters. Unlike double-quoted strings where `\n` is a literal two-character sequence, raw strings interpret newlines as actual line breaks: ```rego # ‚úÖ CORRECT: Raw string for multi-line test data test_diff_parsing if { diff_content := `+ // TODO: Fix issue + function implementation() {` # Contains actual newline between lines mock_input := {"diff": diff_content} # Policy regex patterns can now match newlines correctly } # ‚ùå PROBLEMATIC: Double-quoted string with \n literal test_diff_parsing if { diff_content := "+ // TODO: Fix issue\n+ function implementation() {" # \n is literal backslash + 'n', NOT a newline # Regex patterns expecting newlines will fail } ``` **When to Use Raw Strings:** - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline characters - Content that must preserve line breaks exactly as written **When to Use Double-Quoted Strings:** - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable Performance tips: Avoid regex in tight loops over large collections if possible. Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied). 6.9 Numbers & Numeric Utilities Basic numeric helpers: abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start, ..., end-1] Examples: # Generate ports 8000 to 8099 ports := numbers.range(8000, 8100) # Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit } Combine with aggregates: # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 } 6.10 Type Conversion & Validation Sometimes you ingest loosely typed JSON (forms, CSV turned JSON). Use conversion and validation built-ins: to_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_bool(x) json.is_valid(str) # syntactic JSON validation yaml.is_valid(str) Patterns: # Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 } # Convert dynamic lists tags_set := to_set(input.tags) Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target OPA). 6.11 Encoding, Decoding & Serialization Used to transform payloads between formats or safely embed them. Key built-ins: # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...") # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello" # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value # YAML yaml.marshal(x) yaml.unmarshal(yaml_str) # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1" Examples: # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json := base64url.decode(payload_b64) claims := json.unmarshal(payload_json) # Marshal deny messages for logs deny_json := json.marshal(deny_msgs) 6.12 Type Introspection Type predicates and type_name are invaluable for robust policies: is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", "null", "boolean" Pattern: Defensive guards before deeper logic: valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) } **Input Safety Best Practices:** Always guard access to optional or potentially missing input fields: ```rego # ‚ùå UNSAFE: May error if input.pr_body is missing or not a string has_override(marker) if { contains(input.pr_body, marker) # Type error if pr_body missing } # ‚úÖ SAFE: Type guard before access has_override(marker) if { is_string(input.pr_body) contains(input.pr_body, marker) } # ‚úÖ SAFE: Guard array access input_valid if { is_array(input.changed_files) } # Then use guard in all rules deny[msg] if { input_valid some file in input.changed_files # ... rest of logic } ``` **Common Patterns:** - Check `is_string()` before `contains()`, `startswith()`, `endswith()` - Check `is_array()` before iteration with `some ... in` - Check `is_object()` before property access - Check `is_number()` before arithmetic operations - Create a top-level `input_valid` guard and use it in all rules that access input 6.13 Cryptography & Security Built-ins Security-sensitive policies rely heavily on crypto built-ins. Hash functions & HMAC: crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data) Key-derivation & password hashing: crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password) X.509 and certificates: crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs JWT helpers (in io.jwt namespace): io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt.verify_es256(token, cert) io.jwt.verify_ps256(token, cert) io.jwt.encode_sign_raw(headers, payload, key) Patterns: valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) } deny[msg] if { not valid_token msg := "Invalid JWT" } Security guidance: Never bake secrets into Rego source; pass via data or environment. Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints). 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs). 6.4 Arrays & array.concat Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc. Common built-ins: count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays Concatenation: array.concat([1, 2], [3]) # => [1, 2, 3] Nuances: Both arguments must be arrays. If either argument is null (or not an array), OPA raises a type error. For defensive code, wrap it: safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) } Use safe_concat in paths or pipelines where inputs may be missing or partially null. Time Functions (No time.diff) Time built-ins revolve around: Getting the current time (time.now_ns) Parsing timestamps (time.parse_rfc3339_ns) Formatting (time.format, etc.) Example of computing a duration: now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end) duration_ns := end - start too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes } Important corrections: There is no standard time.diff builtin in OPA. Differences are computed with normal arithmetic on integer nanosecond timestamps: duration_ns := end_ns - start_ns. This approach works consistently across CLI, server, and WASM runtime. 6.15 HTTP Built-ins http.send allows policies to call external services. Use with discipline. resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optional, string with units }) # resp = {"status": 200, "body": ..., "headers": {...}} Characteristics: Potentially slow and side-effectful. Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query. Patterns: Prefer to fetch external data ahead of time and feed via data or input. In CI or admission controllers, avoid http.send altogether if possible. Testing: test_http_policy if { result := policy.check with http.send as mock_http_send } 6.16 Network & CIDR Built-ins Networking helpers are invaluable for Kubernetes and cloud policies. net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_merge(cidr_list) # merge overlapping ranges Example: deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" } 6.17 UUID & ULID Generation Some deployments expose helpers in the standard library or via plugins. Common patterns: uuid := uuid.rfc4122(seed) ulid := ulid.generate() Semantics: uuid.rfc4122(seed): Deterministic for a given string seed. Ideal for tests where you want stable IDs. ulid.generate(): Time-based and non-deterministic. Great for production identifiers, but brittle in tests. Testing recommendations: # Stable UUID in tests test_id := uuid.rfc4122("test-seed-123") # For ULID, either: # - mock it with: with ulid.generate as "fixed-ulid" # - or only check that a ULID exists / matches a regex, not its exact value 6.18 Graph & Structural Walks graph.* functions operate on graph structures (represented as adjacency lists). graph.reachable(graph, ["start"]) # list of reachable nodes walk(x) traverses nested structures and returns [path, value] pairs: pairs := walk(input) # pairs is [[["path","to","value"], value], ...] Patterns: # Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" } 6.19 Units & Parsing For human-friendly sizes or durations: units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant Useful for policies over resource limits: deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi" } 6.20 Metadata & Annotations Rego exposes rule metadata at evaluation time: rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain Usage: Enrich decision logs with rule IDs, owners, severity. Drive governance features (e.g., map violations back to policy owners). Example: deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } } 6.21 Debugging Built-ins: print and trace print is the primary debugging tool for Rego: debug_rule if { x := input.value print("The value of x is:", x) x > 10 } Properties: print(...) always returns true, so it does not change logical semantics. Output appears in OPA logs or opa eval --explain trace output depending on environment. trace may also be available as an alias in some environments; print is the standard. Best practices: Use print liberally during development and experiments. Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod). 6.22 Error Semantics & Strict Mode By default, built-in errors make expressions undefined: # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 } For higher assurance, strict builtin errors convert such errors into hard failures: CLI: opa eval --strict-builtin-errors ... HTTP API: strict-builtin-errors=true query parameter. Use strict mode: In CI to catch unexpected type mismatches and invalid data. In critical policies where silent undefined behavior is unacceptable. Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture. 6.23 Performance Patterns with Built-ins Guard expensive built-ins with cheap checks # Good: fast predicate first deny if { input.method == "POST" regex.match(`(?i)password`, input.body) } Avoid large intermediate arrays via comprehensions if a boolean will do # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 # Good has_admin if { some u in users "admin" in u.roles } Use sets for membership, arrays for ordered sequences Memoization awareness Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached. If inputs differ slightly each time, caching may not help; consider pre-processing. 6.24 Design Patterns & Anti-Patterns Patterns Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere. Canonicalization: Always lowercase/trim user-identifiers before comparison. Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks. Anti-Patterns Regex everywhere: Overuse of regex in hot loops will tank performance. Prefer startswith, endswith, contains, or exact matches when sufficient. Hidden type conversions: Relying on to_number implicitly instead of checking type leads to brittle policies. Unbounded http.send usage: Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths. Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ... Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which you prove that your policies are correct, stable, and maintainable. This chapter builds from basic _test rules up to full-blown policy test architectures, fuzzing, and debugging strategies. ________________________________________ 7.1 Testing Fundamentals Where tests live Tests are Rego modules whose package names end in _test. Convention: Production package: package authz.api Test package: package authz.api_test Naming rules Test rules must start with test_. A test passes if its body can be satisfied (i.e., is true); it fails otherwise. package authz.api_test import data.authz.api test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } } test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"} } } Running tests # All tests in current tree opa test . # Verbose (see individual test names) opa test . -v # Specific path or file opa test policies/ authz_test.rego # With coverage reporting opa test . --coverage --format=json > coverage.json ________________________________________ 7.2 The with Keyword for Mocking with is the cornerstone of Rego testing. It temporarily overrides input, data, or even built-ins for a single evaluation. Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"id": "123"} } } Override data test_role_from_data if { authz.allow with input as {"user": "alice", "action": "read"} with data.roles as {"alice": ["admin"]} } Override built-ins (time, http, etc.) # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 } # in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This makes your policies deterministic and testable, even when they rely on clocks, network calls, or external data. ________________________________________ 7.3 Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests Testing & Tooling This chapter describes patterns for unit tests, integration tests, and golden tests. 7.3 Golden Tests & File I/O (Corrected) Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file. Critically: Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.). A realistic pattern: package compliance_test import data.compliance test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests["pr_large"].expected result := compliance with input as input_case result == expected } Typical harness responsibilities: Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk. Populate data.tests["pr_large"] before invoking opa test or the OPA SDK. Optionally parameterize tests via CLI flags or environment. In other words: Rego: pure data and rules; no file system. Harness: performs all file I/O and passes JSON into Rego as input or data. ________________________________________ 7.4 Debugging with print and opa eval print is your printf. Signature: print(x1, x2, ...) Always returns true, so you can drop it directly inside rule bodies. debug_threshold if { t := input.threshold print("Threshold is:", t) t > 10 } Where output appears opa eval ‚Üí printed to stderr / logs. Embedded OPA ‚Üí appears in OPA logs; your host system should capture these. Key points print doesn‚Äôt alter semantics (just like adding true). Good for: Inspecting variable bindings. Confirming which rule body is being hit. Bad for: Production policies with PII. Flooding logs; use sparingly or behind a debug flag. ________________________________________ 7.5 opa eval Explain & Profile Modes opa eval is both a REPL and microscope. Explain modes opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow' opa eval --explain=full ... notes = high-level reasoning (rule success/failure). full = full derivation tree; great for debugging, painful for huge queries. Profile mode opa eval --profile -d . -i input.json 'data.compliance' You get: Per-rule evaluation counts and cumulative time. A ranking of ‚Äúhot‚Äù rules (the ones to optimize or refactor). Typical workflow Problem: ‚ÄúPolicy is slow for large PRs / big cluster.‚Äù Run: opa eval --profile ... Identify rules with: Many evaluations (thousands or millions). High total time. Refactor: Use sets/objects instead of scanning arrays. Add guard conditions (cheap predicates before expensive ones). Use partial evaluation (¬ß11). ________________________________________ 7.6 Common Errors and How to Diagnose Them rego_unsafe_var_error ‚Äì unsafe variables # ‚ùå Unsafe: user appears only under negation deny if { not blacklisted[user] } Fix: Bind user outside negation. deny if { user := input.user not blacklisted[user] } rego_type_error ‚Äì type mismatch Example: using to_number on an object, or sum over [1, "two"]. Fix: Guard with is_* built-ins (is_number(x), is_array(x)). Normalize incoming data. Rule conflict errors Multiple complete rules with same name produce different values for same input. f(1) := 2 f(1) := 3 # conflict For sets/partial objects this is okay (results are merged); for complete rules & functions it‚Äôs an error. Infinite or pathological recursion Patterns that refer back to themselves without a base case. OPA has guardrails, but logic errors can still create huge evaluation trees. Mitigate with: Explicit depth counters. Clear base rules. ________________________________________ 7.7 String Literal Handling in Tests: JSON vs Rego String Semantics A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files. This difference frequently causes test failures that are difficult to diagnose. 7.7.1 The Newline Escape Sequence Problem When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but critical difference: **JSON Input (via `opa eval --input`):** ```json { "diff": "+ // TODO:\n+ function getUsers() {" } ``` In JSON, `\n` is interpreted as an actual newline character during JSON parsing. The policy receives a string containing a real line break. **Rego Test File (inline string literal):** ```rego test_example if { mock_input := {"diff": "+ // TODO:\n+ function getUsers() {"} # \n here is literal: backslash + 'n', NOT a newline } ``` In Rego test files, `\n` within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'. It is not decoded to an actual newline. **Impact on Regex Patterns:** ```rego # Policy expects actual newline regex.match("TODO:\\s*\\n", file.diff) # Fails in tests with \n literal # Test input with \n literal "diff": "+ // TODO:\n+ function()" # Contains literal "\n", not newline ``` The regex pattern `TODO:\\s*\\n` expects an actual newline character, but receives the literal string "\n", causing the match to fail. 7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines: ```rego # ‚úÖ CORRECT: Raw string preserves actual newlines test_todo_with_newline if { diff_content := `+ // TODO: + function getUsers() {` mock_input := {"changed_files": [{ "path": "file.ts", "diff": diff_content }]} # Policy regex now matches correctly warnings := policy.warn with input as mock_input count(warnings) >= 1 } ``` **Raw String Properties:** - Preserve actual newline characters (not `\n` literals) - Do not interpret escape sequences (`\n`, `\t`, etc.) - Ideal for multi-line test data (diffs, code blocks, structured text) - Compatible with regex patterns expecting real newlines **When to Use Raw Strings vs Double-Quoted:** - **Raw strings (backticks)**: Multi-line content, actual newlines needed, regex patterns matching line breaks - **Double-quoted**: Single-line content, escape sequences acceptable, JSON-like strings 7.7.3 Debugging String Literal Issues **Symptoms:** - Tests fail with `opa test` but pass with `opa eval --input <json-file>` - Regex patterns that work with JSON inputs fail in test files - Multi-line matching fails unexpectedly **Diagnostic Steps:** 1. Compare test input structure with working JSON input 2. Check if regex patterns expect actual newlines vs `\n` literals 3. Use `print()` to inspect actual string content: ```rego test_debug if { diff := "+ // TODO:\n+ function()" print("Length:", count(diff)) # Check if \n is one char or two print("Contains newline:", contains(diff, "\n")) # May fail if literal } ``` 4. Convert test strings to raw strings (backticks) if multi-line content is needed **Best Practice:** When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavior of JSON inputs. ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns The evaluation context of `with` clauses in tests can affect how rule results are accessed. Understanding these patterns prevents subtle test failures. 7.8.1 Direct Evaluation vs Variable Binding When testing rules that return sets (e.g., `warn`, `deny`), the method of accessing results matters: **Pattern 1: Direct Evaluation (May Fail)** ```rego # ‚ùå PROBLEMATIC: Direct count() with with clause test_example if { mock_input := {"changed_files": [...]} count(policy.warn) >= 1 with input as mock_input } ``` **Pattern 2: Variable Binding (Recommended)** ```rego # ‚úÖ CORRECT: Bind result to variable first test_example if { mock_input := {"changed_files": [...]} warnings := policy.warn with input as mock_input count(warnings) >= 1 } ``` **Why Variable Binding is Preferred:** - Explicit evaluation context: `with input as mock_input` applies to the rule evaluation, not the `count()` call - Clearer semantics: The rule is evaluated with mocked input, then the result is counted - More reliable: Avoids potential evaluation order issues in complex test expressions - Better debugging: Can inspect `warnings` set before counting 7.8.2 Accessing Set Elements in Tests When a rule returns a set (partial rule with `contains`), accessing elements requires proper iteration: ```rego # ‚úÖ CORRECT: Iterate set to get first element test_get_warning_message if { mock_input := {"changed_files": [...]} warnings := policy.warn with input as mock_input count(warnings) >= 1 # Get first warning message warning := [msg | msg := warnings[_]][0] contains(warning, "expected text") } # ‚ùå WRONG: Sets don't support index access warning := warnings[0] # Error: sets don't have indices ``` **Pattern for Multiple Assertions:** ```rego test_multiple_assertions if { warnings := policy.warn with input as mock_input count(warnings) >= 1 # Check all warnings some warning in warnings contains(warning, "pattern1") # Or check specific warning specific_warning := [msg | msg := warnings[_]; contains(msg, "pattern2")][0] contains(specific_warning, "pattern2") } ``` 7.8.3 Rule Precedence and Overlapping Conditions When multiple rules can match the same input, understanding evaluation order is critical for test design. **Problem: Overlapping Rule Conditions** ```rego # Policy has two rules that can both match: # R15-W02: Meaningful TODO not logged (general check) # R15-W03: TODO added without reference (specific check for +.*TODO:) # Both rules check: # - has_meaningful_todo_keywords(file) # - not has_tech_debt_reference(file) # R15-W03 also checks: regex.match("\\+.*TODO:", file.diff) ``` **Test Design Strategy:** ```rego # ‚úÖ CORRECT: Test for either rule, or check for common message pattern test_meaningful_todo_not_logged if { mock_input := {"changed_files": [{ "diff": "+ // TODO: Fix issue (workaround)" }]} warnings := policy.warn with input as mock_input count(warnings) >= 1 # Check for message pattern common to both rules some warning in warnings contains(warning, "meaningful TODO/FIXME") contains(warning, "tech-debt.md") } # ‚ùå FRAGILE: Testing for specific rule ID test_specific_rule if { # This may fail if rule precedence changes # or if a more specific rule triggers first } ``` **Best Practice:** Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered). This makes tests more resilient to policy refactoring. ________________________________________ 7.9 Case Sensitivity and String Matching in Tests String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations. 7.9.1 The Case Sensitivity Trap The `contains()` function performs case-sensitive substring matching: ```rego # Policy checks for lowercase "temporary" has_meaningful_todo_keywords(file) if { contains(file.diff, "FIXME:") contains(file.diff, "temporary") # Lowercase required } # ‚ùå TEST FAILS: Test uses "Temporary" (capital T) test_example if { mock_input := {"diff": "+ // FIXME: Temporary hack"} # Policy doesn't match "Temporary" (capital T) # Test expects warning but gets none } # ‚úÖ TEST PASSES: Test uses "temporary" (lowercase) test_example if { mock_input := {"diff": "+ // FIXME: temporary hack"} # Policy matches "temporary" correctly } ``` 7.9.2 Mitigation Strategies **Option 1: Normalize Test Inputs** ```rego # Normalize keywords in test inputs to match policy expectations test_example if { # Use lowercase to match policy checks mock_input := {"diff": "+ // FIXME: temporary hack"} # ... } ``` **Option 2: Policy-Level Normalization (Recommended for Production)** ```rego # Policy normalizes input before checking has_meaningful_todo_keywords(file) if { contains(file.diff, "FIXME:") diff_lower := lower(file.diff) contains(diff_lower, "temporary") # Case-insensitive check } ``` **Option 3: Explicit Case Variants in Policy** ```rego # Policy checks multiple case variants has_meaningful_todo_keywords(file) if { contains(file.diff, "FIXME:") contains(file.diff, "temporary") } has_meaningful_todo_keywords(file) if { contains(file.diff, "FIXME:") contains(file.diff, "Temporary") } ``` **Best Practice:** For production policies, prefer normalization (Option 2) to handle case variations gracefully. For tests, ensure inputs match policy expectations exactly, or document case sensitivity requirements clearly. ________________________________________ 7.7 Advanced Testing: Fuzzing & Mutation For high-assurance policies (security, compliance): Fuzzing: Generate random or adversarial JSON inputs. Run opa eval or opa test against them. Look for panics, regressions, or surprising allow/deny. Mutation testing: Mutate policies (flip conditions, remove clauses). Check that test suite fails appropriately. Failing to detect "killed" mutants = missing tests. This is often orchestrated by external tooling (Python/Go harnesses that call OPA), but the principles are Rego-agnostic. ________________________________________ Chapter 8 ‚Äì OPA Architecture & Integration Patterns This chapter is about where and how you run OPA. ________________________________________ 8.1 The PDP / PEP Split PDP (Policy Decision Point): OPA, evaluating Rego. PEP (Policy Enforcement Point): Your app, proxy, or platform component that: Collects input (HTTP request, Kubernetes object, Terraform plan, CI metadata). Sends it to PDP. Enforces the decision (allow/deny/mutate/log). OPA is only the PDP. The PEP is your responsibility. ________________________________________ 8.2 Deployment Topologies Sidecar / local daemon OPA runs alongside your service, often in the same Pod. Low latency, no network hop beyond localhost. Typical: Envoy external authz ‚Üí OPA. Kubernetes admission controller ‚Üí OPA sidecar in same namespace. Central PDP service OPA (or OPA-based service) runs as a central API. Multiple services call it over the network. Tradeoffs: Pros: Single place to manage policies; simpler distribution. Cons: Latency, scalability, SPOF (unless HA), multi-tenant complexity. Library / SDK Embed OPA: Go: github.com/open-policy-agent/opa/rego WASM: compile Rego to WASM and embed in any WASM host (Node, Rust, etc.). Useful for: Client-side enforcement (e.g., in a browser or mobile app). Edge scenarios. ________________________________________ 8.3 Integration Examples Kubernetes (Gatekeeper & friends) Admission review ‚Üí OPA policy. Rego receives: input.request (raw AdmissionReview). data includes ConstraintTemplates, constraints, reference data. Typical structure: package kubernetes.admission deny[msg] if { input.request.kind.kind == "Pod" some c in input.request.object.spec.containers c.image == "latest" msg := "Images must not use :latest tag" } Envoy / API Gateway Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP. Decision rule: data.envoy.authz.allow. Example: package envoy.authz default allow := false allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc. PR/diff metadata ‚Üí JSON (opa-input.json). OPA evaluates data.compliance. CI interprets deny, warn, override arrays and posts PR comments / fails build. IaC scanning (Terraform, Kubernetes YAML) Terraform plan JSON or Kubernetes manifests as input. Policies check: Public buckets. Unencrypted volumes. Exposed security groups. ________________________________________ 8.4 Multi-layer Policy Architecture on OPA Layers usually look like: Global baseline ‚Äì org-level security/compliance invariants. Domain policies ‚Äì per product or platform (e.g., CRM, billing). Team/service policies ‚Äì localized rules. Tenant overlays ‚Äì per customer/tenant customizations. Implement via: Multiple bundles merged in OPA. Data-driven toggles (e.g., data.tenants[tenant_id].overrides). Rego evaluation order (e.g., base allow, then deny overlays). ________________________________________ 8.5 OPA as a Policy Mesh In large environments, you might have: Many OPAs running across clusters/namespaces. A central bundle server pushing policies. Decision logs shipped to SIEM / data lake. Rego itself doesn‚Äôt change; the architecture around it does. ________________________________________ Chapter 9 ‚Äì Policy Bundling & Distribution OPA is not just an evaluator; it has a bundle system for shipping policies and data. ________________________________________ 9.1 Bundle Basics A bundle is: A .tar.gz containing: /policies/*.rego /data/*.json (or YAML, etc.) .manifest file with metadata. Example manifest (conceptual): { "revision": "git-sha-1234", "roots": ["authz", "compliance"], "metadata": { "version": "1.2.3", "built_at": "2025-11-25T12:00:00Z" } } OPA config: services: policy: url: https://opa-bundles.example.com bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundles, verifies them, and updates its data and policy set. ________________________________________ 9.2 Bundle Layering & Tenancy You can have multiple bundles: global-baseline.tar.gz ‚Üí data.global org-security.tar.gz ‚Üí data.org crm-team.tar.gz ‚Üí data.crm tenant-123.tar.gz ‚Üí data.tenants["123"] OPA merges them in the data document. Patterns: Tenant-specific overrides are just data: package authz default allow := false allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset of OPAs. Compare decisions vs stable. ________________________________________ 9.3 Release Engineering & Versioning Use semantic versioning for bundles: vMAJOR.MINOR.PATCH. Track: Git commit SHA. Build ID. CI pipeline run. Typical pipeline: opa fmt + lint + opa test + opa check --strict. opa build / custom bundler to produce bundle.tar.gz. Sign bundle (e.g., Sigstore, GPG). Upload to bundle server / CDN. Tag release in Git. ________________________________________ Chapter 10 ‚Äì Linting, Style & CI Even perfect policies are useless if they‚Äôre unreadable or unmaintainable. This chapter merges style guides, linting, and CI patterns into an enforceable system. ________________________________________ 10.1 Style Principles (Based on Styra + Enterprise Practice) Readability first Prefer clear, small rules over clever one-liners. Use opa fmt always Standardizes indentation, spacing, and layout. Enforce via CI. Use modern syntax (Rego v1) if, contains, every, some ... in .... Import rego.v1 or future.keywords when needed. Naming conventions Packages: domain.service.component crm.authz.http, infra.k8s.admission. Rules & functions: snake_case. Helper rules: prefix with _ (convention). package crm.authz.http _is_admin(user) if "admin" in user.roles allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package. Imports. Constants/defaults. Then: Helper rules (unexported). Public rules (allow, deny, violation, etc.). ________________________________________ 10.2 Regal (Linter) & Custom Lint Rules Regal is a dedicated Rego linter. Example config (.regal/config.yaml): rules: naming-convention: snake_case: true unused-decls: error no-var-shadowing: error require-some: error no-ambiguous-negation: warn max-rule-size: severity: warn limit: 10 avoid-inline-comprehensions: warn package-path-alignment: error no-import-input: error Typical checks: Snake_case for everything. No unused variables (except _). No variable shadowing. Explicit some declarations. Package name alignment with file path. Metadata required on certain rules (e.g., deny rules). ________________________________________ 10.3 CI Pipeline: From Formatting to Enforcement Lint & format stage ‚Äì GitHub Actions example name: Rego Linting on: [push, pull_request] jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa - name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal - name: Check formatting run: opa fmt --fail . - name: Lint (Regal) run: regal lint --format=github . Test stage name: Rego Tests on: [push, pull_request] jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa - name: Run tests run: opa test policies/ tests/ --verbose --timeout 30s Compliance evaluation stage (optional) Run opa eval with CI inputs (like PR diffs) to enforce policy gates. ________________________________________ 10.4 Editor & Developer Experience .editorconfig: [*.rego] indent_style = tab indent_size = 4 Editor extensions: Syntax highlighting, opa fmt on save. Regal integration where possible. For Cursor / custom AI agents: Auto-run opa fmt in pre-commit hooks. Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system. ________________________________________ Chapter 11 ‚Äì Performance Engineering (From Heuristics to Formal Bounds) OPA is fast, but bad policies can be slow. This chapter formalizes the performance story. ________________________________________ 11.1 Complexity Mental Model Roughly: Lookup in objects/sets: ~O(1) Array iteration: O(n) Nested iteration: O(n¬≤) or worse Graph-like recursion: O(depth √ó fan-out), potentially exponential without care Your goal: rewrite policies such that most operations become hash lookups, not brute-force scans. ________________________________________ 11.2 Expression Ordering OPA evaluates rule bodies top to bottom, left to right within that body. Rearranging expressions can dramatically change performance. # Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_regex_check() # expensive } # Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 Index-friendly Data Modeling Given: # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as a map keyed by ID: { "users": { "alice": {"id": "alice", "active": true}, "bob": {"id": "bob", "active": false} } } Then: user := data.users[input.user_id] deny[msg] if { user.active == false msg := "User is inactive" } OPA can automatically index these object lookups, giving near O(1) access. ________________________________________ 11.4 Avoiding Redundant Computation Bad: inefficient if { sum(numbers) > 100 sum(numbers) < 1000 result := sum(numbers) } Good: efficient if { total := sum(numbers) total > 100 total < 1000 result := total } OPA memoizes built-ins within a query, but you still pay the call overhead and it hurts readability. ________________________________________ 11.5 Comprehension Patterns Prefer existential patterns over building large intermediate sets: # Good has_admin if { some u in users "admin" in u.roles } # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Evaluation & Compilation Partial evaluation is like compiling away some of your logic for known inputs. 11.6 Partial Evaluation & WASM Build Modes Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data). Two important workflows: 11.6.1 WASM Compilation (Edge / Embedded) # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/ -t wasm ‚Üí produce a WebAssembly binary. -e 'data.authz.allow' ‚Üí fix the entrypoint. Intended for: Envoy filters In-process SDKs (Go, Node, etc.) Edge runtimes or sidecars. The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module. 11.6.2 General Partial Evaluation (Bundles / CLI) For non-WASM optimization: # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/ This produces: An optimized bundle (policy + data), Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint. Exploratory / ad-hoc partial evaluation: opa eval --partial \ -d policies/ \ 'data.authz.allow' This: Returns residual policy expressions capturing unknowns, Lets you inspect how much work can be pre-computed, Is useful for iterative tuning and performance analysis. Summary: opa build -t wasm ... ‚Üí WASM module for embedded/edge. opa build ... ‚Üí optimized bundle for standard OPA. opa eval --partial ... ‚Üí interactive partial eval for debugging and design. ________________________________________ Chapter 12 ‚Äì Formal Semantics (Doctorate-Level View) Now we go under the hood. You don‚Äôt need this to use Rego, but you do need it to design new policy frameworks, reason about correctness, or write academic work. ________________________________________ 12.1 Rego as a Datalog Variant At its core, a Rego program is a set of Horn clauses (rules) over a Herbrand universe of JSON-like terms. A rule: h(tÃÑ) if { b‚ÇÅ ... b‚Çô } corresponds to: b_1‚àß‚ãØ‚àßb_n‚áíh(t Àâ) Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms. Interpretation: An interpretation Iassigns truth values to all ground atoms (e.g., p("alice", "admin")). The meaning of a program Pis the least fixed point of the immediate consequence operator T_P, analogous to classical Datalog. ________________________________________ 12.2 Immediate Consequence Operator & Fixpoint Define T_Pover interpretations: T_P (I)= set of all heads h(t Àâ)such that there exists a rule h(t Àâ)‚áêb_1,‚Ä¶,b_nand all b_iare satisfied under I. Iterative construction: I_0=‚àÖI_(k+1)=T_P (I_k)"Eval"(P)=‚ãÉ_(k=0)^‚àû I_k Because: Herbrand base is finite for a given finite data and bounded terms. T_Pis monotonic for stratified, positive fragments. ‚Üí Fixpoint is reached in finite steps. ________________________________________ 12.3 Unification & =, :=, == Unification (=): find a most general unifier (MGU) that makes two terms equal. If both sides partially unbound, unify them structurally. Example: [x, "world"] = ["hello", y] MGU: {x‚Ü¶"hello",y‚Ü¶"world"}. Assignment (:=): one-way binding; fails if variable is already bound to a different value. Equality (==): no variable binding; pure comparison. In implementation, OPA uses a mixture of: Unification-like semantics to explore bindings. Assignments and comparisons for clarity and performance in v1 syntax. ________________________________________ 12.4 Negation-as-Failure & Stratification Rego uses NAF (Negation-as-Failure): not p(X) means: ‚Äúit is not provable that p(X) holds‚Äù. Formally: "Eval"(P)‚ä®"not " p(t)" "‚ü∫" Eval"(P)‚ä®Ã∏p(t) To avoid paradoxes (like p :- not p), Rego effectively works in the space of stratified programs (or well-founded semantics): Build a dependency graph between predicates (rules). Require that cycles with negation are disallowed or handled carefully. This is why variables in negated expressions must be grounded elsewhere; otherwise, the semantics become ill-defined. ________________________________________ 12.5 Partial vs Complete Rules: Semantic Interpretation Complete rule (one final value): max_memory := 4 if ... max_memory := 8 if ... default max_memory := 1 Interpreted as a function max_memory : Input ‚Üí Scalar such that: If multiple definitions apply and yield same value ‚Üí OK. If they yield different values ‚Üí conflict (no model). Partial rules (sets/objects): deny[msg] if ... deny[msg] if ... Interpreted as: deny={msg‚à£‚àÉ" body s.t." body‚áímsg} The semantics is set union of instances. ________________________________________ 12.6 Complexity of Evaluation Let: ‚à£D‚à£= size of data. ‚à£I‚à£= size of input. ‚à£P‚à£= size (number of rules/clauses) of program. Then: Basic evaluation (no recursion) is polynomial in ‚à£D‚à£+‚à£I‚à£. General Datalog with negation can be EXPTIME-complete in the worst case, but OPA: Forbids or discourages patterns that would lead to blow-ups. Optimizes with indexing, partial evaluation, grounding. Rule-of-thumb: Flattened, non-recursive Rego with bounded comprehensions behaves like complex SQL queries in terms of complexity. Recursive policies (e.g., graph reachability) behave like graph algorithms. ________________________________________ 12.7 Partial Evaluation Semantics Given: Program P. Known input fragment K‚äÜ(data,input). Define the partial evaluation operator: PE(P,K)‚ÜíP^' such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U) Key points: P^'is smaller and more specialized. OPA uses this to generate WASM or pre-compiled forms that execute efficiently for fixed queries. Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owners, bundles, and tenants without descending into chaos. At scale, you need: ‚Ä¢ Layers: global ‚Üí domain ‚Üí team ‚Üí tenant. ‚Ä¢ Ownership metadata: who owns what, and how severe is it. ‚Ä¢ Override semantics: how do layers combine, and who wins on conflict. ________________________________________ 13.1 Layer Model: Global ‚Üí Domain ‚Üí Team ‚Üí Tenant Think of policies as a stack of overlays: 1. Global Baseline (Organization Level) o Owned by: security/compliance. o Guarantees non-negotiable invariants: ÔÇß ‚ÄúNo public S3 buckets‚Äù ÔÇß ‚ÄúAll admin actions must be audited‚Äù o Usually has the highest precedence for denies (security wins). 2. Domain Policies (Product / Platform Level) o Example domains: ÔÇß crm.*, billing.*, identity.*. o Define domain-specific invariants: ÔÇß ‚ÄúAn Opportunity must have an associated Account‚Äù ÔÇß ‚ÄúA Subscription must have a plan and billing cycle‚Äù 3. Team / Service Policies o Local teams add guardrails and UX-level rules: ÔÇß ‚ÄúThis API must include X-Request-Id‚Äù ÔÇß ‚ÄúThis microservice cannot call that microservice directly‚Äù 4. Tenant Overlays (Customer-Specific) o Per-tenant exceptions and configuration: ÔÇß ‚ÄúTenant A enforces stricter password rules‚Äù ÔÇß ‚ÄúTenant B has a special approval workflow‚Äù OPA sees all of these as data + Rego modules merged into a single virtual data tree. ________________________________________ 13.2 Encoding Layers in Data and Packages One robust pattern: ‚Ä¢ Global policies: package global.* ‚Ä¢ Domains: package domain.<name>.* ‚Ä¢ Teams/services: package svc.<service_name>.* ‚Ä¢ Tenant overlays: data.tenants[tenant_id].* Example structure: policies/ global/ baseline.rego # package global.baseline crm/ authz.rego # package domain.crm.authz schema.rego # package domain.crm.schema svc/ accounts.rego # package svc.accounts.rules tenants/ 123/ overrides.json # data.tenants["123"] 456/ overrides.json ________________________________________ 13.3 Policy Ownership Metadata Every rule that matters should be self-describing. You can store metadata as: ‚Ä¢ A dedicated rule (__meta__) ‚Ä¢ Rego annotations (via rego.metadata.rule()) ‚Ä¢ Comments (less machine-friendly) Example: package crm.policies.account_lifecycle __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVERRIDE | WARN | INFO "version": "1.0.0", "tags": ["lifecycle", "compliance"] } deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Closed accounts cannot be reopened", } } For global policies: package global.network __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", } deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__.rule_id, "msg": "Public S3 bucket forbidden"} } ________________________________________ 13.4 Override Precedence and Combining Layers You need a formal precedence model so people don‚Äôt guess. Think in terms of layer priority and decision semantics. 13.4.1 Priority Model Assign numeric ranks to layers: package policy.layers layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "warn" ‚Ä¢ layer: "global" | "domain" | "team" | "tenant" ________________________________________ 13.4.2 Decision Aggregation Pattern Define a canonical decision document: package decision default result := { "allow": false, "effects": [], # list of all hits from all layers } # Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] } effects[eff] if { eff := data.domain.crm.authz.effects[_] } effects[eff] if { eff := data.svc.accounts.rules.effects[_] } effects[eff] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] } Each eff looks like: { "effect": "deny", "layer": "global", "rule_id": "NET_001", "severity": "BLOCK", "msg": "Public S3 bucket forbidden" } Now: compute final decision. result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]] some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false } # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so. result := { "allow": allow_flag, "effects": all_effects, } if { all_effects := [e | e := effects[_]] not some e in all_effects { e.effect == "deny"; e.severity == "BLOCK" } allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank. ‚Ä¢ Allowing tenant to tighten, but never to weaken global invariants. ________________________________________ 13.5 Tenant Overlays and Safe Customization Tenant-specific rules should be additive and tightening, not weakening: ‚Ä¢ Allowed: o Tenant can restrict their own behavior further. ‚Ä¢ Forbidden: o Tenant cannot bypass global security invariants. Pattern: package authz default allow := false base_allow if { data.global.authz.allow } base_allow if { data.domain.crm.authz.allow } tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg } allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________________________________ Chapter 14 ‚Äì Observability & Audit OPA is not only a decision engine; it‚Äôs an evidence generator. Observability and audit are how you prove that decisions are: ‚Ä¢ Correct ‚Ä¢ Consistent ‚Ä¢ Explainable ‚Ä¢ Compliant with regulation ________________________________________ 14.1 Decision Logs Every OPA decision should be treatable as a replayable event: Minimum recommended fields: ‚Ä¢ decision_id (UUID) ‚Ä¢ timestamp ‚Ä¢ path (e.g., data.authz.allow) ‚Ä¢ input_hash or input (with PII scrubbing) ‚Ä¢ result (decision doc: allow/deny/effects) ‚Ä¢ bundle_revision ‚Ä¢ metrics (evaluation time, rule count) ‚Ä¢ correlation_id (to tie into tracing) Conceptual log: { "decision_id": "3f7b9b1a-0ee2-4e52-9f39-4edb8b6a3a01", "timestamp": "2025-11-25T10:02:45Z", "path": "data.authz.allow", "input_hash": "sha256:abcd...", "result": { "allow": false, "effects": [ { "effect": "deny", "rule_id": "ACCT_001", "layer": "domain", "msg": "Closed accounts cannot be reopened" } ] }, "bundle_revision": "git:1234abcd", "metrics": { "eval_time_ns": 45321, "num_rules_evaluated": 37 }, "correlation_id": "trace-xyz-123" } OPA supports decision logs via configuration; your host system should stream them to: ‚Ä¢ Kafka / Kinesis ‚Ä¢ ELK / Loki ‚Ä¢ Datadog / Prometheus / Grafana ________________________________________ 14.2 Metrics and SLOs To treat OPA like a production service, track at least: ‚Ä¢ Latency: o p50 / p95 / p99 evaluation time. ‚Ä¢ Throughput: o decisions per second. ‚Ä¢ Decision deltas: o How often outcomes change after a new bundle. ‚Ä¢ Error rate: o Number of evaluation failures (e.g., built-in errors in strict mode). Define SLOs like: ‚Ä¢ 99.9% of policy decisions complete in < 10 ms. ‚Ä¢ < 0.1% of decisions result in evaluation error. ‚Ä¢ Decision delta after bundle rollout < 1% for stable inputs (in shadow mode). ________________________________________ 14.3 Correlation IDs and Tracing Policy evaluations rarely stand alone; they‚Äôre part of a larger request trace: ‚Ä¢ HTTP header: o X-Request-Id o traceparent (W3C Trace Context) ‚Ä¢ PEP should pass correlation ID in: o input.trace_id o or embed as part of input.request.headers. Then decision logs include correlation_id, which lets you: ‚Ä¢ Trace a single user‚Äôs journey across services. ‚Ä¢ Root-cause analyze unauthorized/denied requests quickly. Example pattern: package authz default allow := false trace_id := input.request.headers["x-request-id"] allow if { # ...logic... } # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden rule: logs must not become a data breach. ‚Ä¢ Do not log entire input if it contains PII. ‚Ä¢ Instead: o Log hashed fields (hash(email)) o Log ids / foreign keys o Redact sensitive values (e.g., use "redacted") Pattern: safe_input := { "user_id": input.user.id, "tenant_id": input.tenant_id, "resource_id": input.resource.id, "action": input.action, } Your decision logger uses safe_input rather than raw input. ________________________________________ 14.5 Reproducibility & Auditability A compliant audit story usually needs: ‚Ä¢ Given: o bundle_revision o policy_version o input (or hash + associated fixture) ‚Ä¢ You can re-evaluate the decision and get the same result. To achieve this: ‚Ä¢ Store: o Bundle artifacts (bundle.tar.gz) o Manifest metadata (revision, version) o Decision logs + input fixtures (or deterministic reconstruction) ‚Ä¢ Avoid: o Non-deterministic calls in Rego (e.g., random, uncontrolled http.send) When you must use time.now_ns or external data: ‚Ä¢ Either: o Snapshot it in the input used to evaluate. o Or store enough context to reconstruct. ________________________________________ Chapter 15 ‚Äì Stateful & Temporal Extensions OPA itself is stateless: each query sees input and data as immutable snapshots. Yet many policies are stateful or temporal: ‚Ä¢ Rate limits (N requests per unit time) ‚Ä¢ ‚ÄúNo more than 5 failed logins in 10 minutes‚Äù ‚Ä¢ ‚ÄúThis migration must be rolled out only after all canaries pass‚Äù The trick: Move state and time into data + input, not inside Rego. ________________________________________ Stateful & Temporal Extensions OPA is logically stateless: every evaluation sees a snapshot of policy + data. Stateful or temporal behaviors must be modeled via external systems that write to data or pass state through input. 15.1 External State for Rate-Limiting & Anomaly Detection Example of externally managed login counts: # External system populates: # data.state.login_counts = { # "alice": {"last_5m": 12, "last_1h": 42}, # "bob": {"last_5m": 2, "last_1h": 8}, # } package authz too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 } Key properties: OPA never mutates data.state.login_counts. A separate component (stream processor, cron job, gateway) periodically: reads raw events (e.g., login attempts), aggregates them (windowed counts), publishes a new snapshot to: a bundle, or an in-memory structure via the OPA Go SDK, or a shared cache that OPA reads from. Think of the pattern: Events ‚Üí (Kafka / Kinesis / PubSub / Logs) Aggregator ‚Üí (Flink / custom job / Lambda) State Snapshot ‚Üí (bundle / data.state.*) OPA Policy ‚Üí reads data.state.* as a pure input. OPA remains a pure decision engine; all state transitions happen outside. ________________________________________ 15.2 Temporal Logic Using time.* OPA has: ‚Ä¢ time.now_ns() ‚Ä¢ time.parse_ns(layout, string) ‚Ä¢ time.clock(ns) and time.date(ns) ‚Ä¢ time.weekday(ns) Patterns: 1. Business hours 2. package business 3. 4. within_business_hours if { 5. now := time.now_ns() 6. [hour, _, _] := time.clock(now) 7. hour >= 9 8. hour < 17 9. } 10. Sliding window from event log in input Suppose input.events contains last 1 hour of events (pre-filtered by upstream system): package limits default allow := true deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns # events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.action == "login_failure" e.ts >= cutoff } count(recent_failures) > 5 msg := "Too many recent login failures" } OPA sees only a subset; the window is curated by your stateful event pipeline. ________________________________________ 15.3 Event-Driven Architectures with OPA Typical pattern: 1. Events flow into Kafka / Kinesis. 2. A stream processor: o Maintains aggregates: ÔÇß counts, sums, last-seen times, sliding windows. o Writes materialized state to: ÔÇß Redis, DB, or data-bundles for OPA. 3. OPA uses that state to decide: o Allow or deny new events. o Trigger downstream actions/alerts. OPA remains pure ‚Äî no long-lived state, no hidden mutable variables. ________________________________________ 15.4 Time-Scoped Exceptions Sometimes you want: ‚Ä¢ ‚ÄúAllow this temporary override until 2025-12-31.‚Äù Pattern: package overrides temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You encode exceptions in data.overrides, with explicit expiration timestamps. This keeps temporal logic in data, not code. ________________________________________ Chapter 16 ‚Äì Data Policy Models (GraphQL, APIs, Data Filtering) OPA is particularly strong for data access policies because Rego is JSON-native. This chapter focuses on query-shaped inputs like GraphQL and REST. ________________________________________ 16.1 GraphQL AST Policies When a GraphQL query enters your gateway, you can: 1. Parse it into an AST. 2. Send AST + user context to OPA. 3. Enforce: o Field-level authorization. o Query depth/width limits. o Allowed operations. Example input (simplified): { "user": {"id": "alice", "roles": ["user"]}, "operation": "query", "query": { "name": "GetCustomer", "fields": [ {"path": ["customer", "email"]}, {"path": ["customer", "creditCardNumber"]} ] } } Policy: package gql.authz default allow := false default violations := [] # data.gql.allowed_fields = { # "user": { # "customer": ["id", "name", "email"] # }, # "admin": { # "customer": ["*", "creditCardNumber"] # } # } role := r if { r := input.user.roles[_] } # Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"] resource := path[0] field := path[1] not field_allowed(role, resource, field) v := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } } field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard } field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed } allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing This chapter covers structural data policies and cost-based models, especially for GraphQL. 16.2 Field Cost Calculation (Corrected array.concat) Suppose you maintain per-field costs in data.gql.field_costs: # Example: # data.gql.field_costs = { # "Query.users": 1, # "Query.users.email": 2, # "Query.users.orders": 3, # } You want to compute a cost for each field given its path and leaf name. # field_cost([path, field]) := c # path = ["Query", "users"] # field = "email" # full = "Query.users.email" field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] } Corrections and nuances: Use array.concat(path, [field]), not a non-existent append builtin. array.concat([1, 2], [3]) = [1, 2, 3]. If either argument is null or non-array, OPA throws a type error, so in more defensive code: safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] } This function can be used inside a comprehension that walks a GraphQL AST: total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := field_cost([path, name]) }) Here you get: A compositional cost model (paths + leaves). Defensive concatenation. A clean hook for enforcing query limits: deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost } ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1. Treat the request as input: method, path, query params, body. 2. Output a filter document: 3. { 4. "where": { 5. "tenant_id": "tenant-123", 6. "visibility": ["public", "shared_with_user"] 7. } 8. } 9. The service uses that filter to generate SQL. Example: package datafilter default filter := {} filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) } statuses_for(user) := {"active", "pending"} if { "admin" in user.roles } statuses_for(user) := {"active"} if { not "admin" in user.roles } This pattern: ‚Ä¢ Keeps data access rules central. ‚Ä¢ Allows multiple services to enforce the same logic. ________________________________________ Chapter 17 ‚Äì LLM & Agentic Integration with OPA LLMs are good at generating Rego, OPA is good at executing and verifying Rego. Together they form: ‚ÄúAI drafts policy, OPA and tests keep it safe.‚Äù ________________________________________ 17.1 The Agentic Workflow Canonical pipeline: 1. Requirements in natural language: o ‚ÄúAPI keys must not be visible in logs‚Äù o ‚ÄúAdmin role modifications require approval‚Äù 2. LLM drafts: o Rego module. o Test suite (_test.rego). o Metadata (owner, rule_id). 3. Static checks: o opa fmt o Regal lint o opa check --strict 4. Dynamic checks: o opa test (unit + integration tests). o Fuzz/Golden tests for critical policies. 5. Human review: o Security / Policy engineers review diff, semantics. 6. Bundle build & rollout: o Standard policy SDLC. OPA becomes the execution and verification back-end for LLM-authored policy. ________________________________________ 17.2 Guardrails for LLM-Generated Rego When you let an LLM write Rego, you must: ‚Ä¢ Enforce style & safety: o Modern syntax only (import rego.v1 or future.keywords). o No http.send in production rules (unless explicitly allowed). o No secrets in code. o Type guards for all input.* references. ‚Ä¢ Require tests: o At least one positive and one negative case. o Use with overrides instead of real network/time. You can encode this as Rego that reviews Rego: ‚Ä¢ Use rego.metadata.chain() and AST analysis to enforce rules. ‚Ä¢ Or use external tools (Regal) plus your own AST/grep rules. ________________________________________ 17.3 ‚ÄúPolicy Copilot‚Äù Pattern A typical agentic stack: 1. Authoring agent: o Generates initial Rego module + tests from description and examples. 2. Critic agent: o Reads module, runs static analysis (Regal messages, opa check). o Suggests improvements and simplifications. 3. Tester agent: o Proposes additional tests (edge cases, negative paths). o Extends _test.rego. 4. Reviewer agent: o Summarizes behavior in human language. o Flags risky constructs, ambiguous cases. 5. Bundle builder: o Once human approves, compiles into bundle artifact. OPA is the deterministic core all these agents orbit around. ________________________________________ 17.4 LLM Self-Checking with Rego LLMs can call OPA during prompt execution: ‚Ä¢ Use examples like: o ‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù ‚Ä¢ LLM loops: 1. Generate candidate Rego. 2. Invoke opa test programmatically. 3. If tests fail, update policy and try again (up to N iterations). 4. Present final Rego + test report. This turns Rego into a ground truth oracle inside an agentic system. ________________________________________ Chapter 18 ‚Äì Rego Cheat Sheet (Condensed) This chapter is intentionally tight ‚Äì it‚Äôs the 2-page desk reference. ________________________________________ 18.1 Core Rule Types Type Syntax Example Boolean name if { ... } allow if { is_admin } Complete name := value if { ... } max_conns := 10 if is_admin Partial Set name contains x if { ... } deny contains msg if { ... } Partial Obj name[key] := value if { ... } roles[user] := role if { ... } Function f(x) := y if { ... } double(x) := x * 2 Default default name = value default allow = false ________________________________________ 18.2 Assignments & Comparisons ‚Ä¢ := ‚Äì assignment (one-way) ‚Ä¢ == ‚Äì equality (no binding) ‚Ä¢ = ‚Äì unification (binds if unbound, else compares) Examples: x := 10 # assignment ok if x == 10 # comparison [x, "world"] = ["hello", y] # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ Object: {"k": 1, "v": 2} Special: ‚Ä¢ Empty set: `{}` (not `set()`, which is a type conversion function requiring an argument) ‚Ä¢ Empty object: `{}` **Important:** `set()` is a type conversion function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` directly. Using `set()` without arguments will cause a runtime error. ________________________________________ 18.4 Iteration Implicit: arr[_] # all values obj[k] # binds k to each key set[v] # binds v to each member Explicit with some ... in: some x in arr # values some i, x in arr # index, value some k, v in obj # key, value some v in set # members ________________________________________ 18.5 Quantifiers ‚Ä¢ Existential: some x in xs { ... } ‚Ä¢ Universal: o Using every: o all_valid if { o every x in xs { o x.valid == true o } o } o Or via negation: o all_valid if not any_invalid o any_invalid if { o some x in xs o not x.valid o } ________________________________________ 18.6 Negation not cond = ‚Äúcannot prove cond.‚Äù Safety: variables in cond must be bound beforehand. deny if { user := input.user not blacklisted[user] } ________________________________________ 18.7 Built-in Highlights ‚Ä¢ Aggregates: count, sum, max, min ‚Ä¢ Strings: concat, contains, startswith, endswith, split, replace ‚Ä¢ Regex: regex.match, regex.split ‚Ä¢ JSON: json.marshal, json.unmarshal ‚Ä¢ Time: time.now_ns, time.parse_rfc3339_ns, time.clock ‚Ä¢ Crypto: crypto.sha256, io.jwt.* ________________________________________ 18.8 Testing ‚Ä¢ Tests: package ending in _test, rules starting with test_. ‚Ä¢ Use with to override input, data, or built-ins. test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test . ________________________________________ 18.9 Best Practices (Ultra Condensed) ‚Ä¢ Always opa fmt and lint. ‚Ä¢ Use modern syntax (import rego.v1 or future.keywords). ‚Ä¢ Prefer sets/objects for membership tests. ‚Ä¢ Avoid inline comprehensions in complex allow/deny. ‚Ä¢ Use helper rules with clear names. ‚Ä¢ Always have tests for deny/allow semantics. ________________________________________ Chapter 19 ‚Äì Glossary (Rigorous) Alphabetical list of core terms. ________________________________________ ABAC (Attribute-Based Access Control) Access model where decisions are based on attributes of subject, resource, action, and environment, not just roles. Allow / Deny (Effects) Canonical authorization decision outcomes. Frequently modeled via Rego rules like allow and deny or decision documents with effects. AST (Abstract Syntax Tree) Tree representation of parsed input (e.g., GraphQL query), often passed to OPA as input for fine-grained policies. Baseline Policy (Global Baseline) Organization-wide invariant policy layer that lower layers cannot override or weaken (e.g., ‚ÄúNo public S3 buckets‚Äù). Bundle A versioned tarball containing Rego policies, data, and a .manifest file. Used by OPA to load and update policies in production. Complete Rule A Rego rule that defines a single final value (e.g., max_conns := 10 or allow := true). Multiple definitions that produce different values for the same input cause conflicts. ConstraintTemplate (Gatekeeper) Kubernetes CRD that defines reusable OPA policies for Gatekeeper. Users instantiate constraints based on templates. Correlation ID Identifier used to tie together logs and traces across systems, included in OPA decision logs for observability. Data (in OPA) Persistent, relatively static information (loaded from bundles or in-memory), accessed as data.*. May mirror configuration, schemas, user roles, etc. Decision Document The JSON result of an OPA query (e.g., data.authz.allow or a more complex document with allow, deny, effects, risk_score). Decision Log Structured record of each OPA evaluation: includes path, input (or hash), result, metrics, and bundle revision, used for audit and observability. Datalog A subset of Prolog used for declarative logic programming, without complex function symbols. Rego is inspired by Datalog and extends it with JSON-like structures. Deny Rule A partial rule (often deny[msg] or deny contains msg) that accumulates violation messages, typically used in compliance and validation policies. Effect The semantic outcome of a policy evaluation (e.g., "allow", "deny", "warn", "override"), often encoded in decision documents. Fixpoint A stable interpretation of a logic program where applying the immediate consequence operator (deriving new facts) produces no new facts. Rego‚Äôs semantics can be described via least fixpoints. Future Keywords The future.keywords import (Rego v0.x) that enables newer language constructs like if, in, contains, every. In OPA 1.0+ this is replaced by import rego.v1. Global Baseline See Baseline Policy: global layer of policies applied to all services/tenants, usually with highest precedence for security. GraphQL Policy Policy that operates on GraphQL queries represented as AST; can enforce field-level auth, query depth, or cost. HTTP Sidecar Deployment pattern where OPA runs as a sidecar container next to a service, receiving authorization queries over localhost. Input (in OPA) Per-request JSON document provided by the caller to OPA, containing details like user, action, resource, HTTP request, etc. Accessed as input.*. LLM (Large Language Model) Neural network model (like ChatGPT) used to generate or refactor Rego; OPA then validates and executes resulting policies. NAF (Negation-as-Failure) Logic programming semantics where not p(X) means ‚Äúp(X) cannot be proven.‚Äù Used in Rego for negation. OPA (Open Policy Agent) General-purpose policy decision engine that evaluates Rego policies against JSON inputs and data. PDP (Policy Decision Point) Component that computes policy decisions (e.g., OPA). PEP (Policy Enforcement Point) Component that enforces decisions (e.g., API gateway, Kubernetes admission controller). Partial Evaluation (PE) Technique where OPA specializes policies with respect to known input and data, producing an optimized, often smaller program or WASM artifact. Partial Rule A Rego rule that defines members of a virtual set or object incrementally (e.g., deny[msg] or roles[user] := role). Rego OPA‚Äôs declarative policy language, inspired by Datalog and designed for reasoning over JSON-like documents. Regal A dedicated linter for Rego, enforcing style and correctness rules beyond opa fmt. Rule Conflict Runtime error when multiple complete rules or function rules with the same name and arguments produce different values. Schema (JSON Schema) Formal type definition for JSON documents. OPA can use schemas to perform type checking on input or data. Sidecar Deployment pattern where OPA runs alongside an application in the same Pod/host, reducing network latency for policy queries. Stateful Policy Policy whose decision depends on past events or accumulated state. Implemented in OPA by passing state snapshots as data or input, not by mutability in Rego. Stratification Property of a logic program whereby cycles through negation are avoided, enabling well-defined semantics for negation-as-failure. Temporal Policy Policy that involves time (e.g., deadlines, windows, schedules), typically implemented with time.* built-ins and time-stamped state. Tenant Overlay Per-tenant policy or configuration that tightens (but does not weaken) global/domain rules, often stored under data.tenants[tenant_id]. Virtual Document A Rego rule or package that behaves like a JSON document when queried (e.g., data.authz.allow), although it is computed on demand rather than stored. WASM (WebAssembly) Portable binary format that can run Rego policies compiled from OPA in multiple environments (browsers, proxies, services). With (Keyword) Rego keyword that allows overriding input, data, or built-ins for the scope of an expression; heavily used in testing and mocking. Zero-Trust Architecture Security model where no implicit trust is granted to assets or user accounts based solely on network location; OPA policies often implement zero-trust authorization logic. Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision The full decision path for a typical OPA evaluation looks like this: flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[Decision Document] subgraph POLICIES & DATA C D end subgraph INPUTS B end F -->|JSON Response| A A more detailed view that includes partial evaluation and decision logging: flowchart TD R[Request: input] --> OPA[OPA Engine] subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end OPA --> P PE --> D1[Optimized Policy Set] subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end LD --> EV[Evaluate Query] D1 --> EV R --> EV EV --> RES[Decision Document] EV --> LOG[Decision Log Event] RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake] Narrative: Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path. Data from bundles and dynamic sources is loaded into data.*. Each incoming request passes input + compiled policies + current data snapshot into the evaluator. The evaluator returns a structured decision document and emits decision logs for observability and audits. Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram OPA can be deployed in three canonical modes: sidecar, central service, and embedded. flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end subgraph Embedded Library A3[App Process with OPA SDK] end 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar] B[BUNDLE Server] --> OPA Each app pod has its own OPA. Low latency (localhost). Good for microservices and per-tenant tuning. 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE Server] --> OPA_CLUSTER One or a few OPA instances serve many clients. Great for shared policies and simple clients (like Nginx, legacy apps). 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP OPA compiled to WASM or linked via Go library. No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths. Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[Domain Layer\n(product / region)] D --> T[Team Layer\nservice / app] T --> N[Tenant Layer\ncustomer-specific] N --> Q[Final Decision] Conceptual flow: Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds). Domain: Variants per product/region (e.g., EU vs US data rules). Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*). Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists). 13.X.1 Layered Evaluation Example package authz default allow := false # Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes forbidden" } # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent required" } # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billing): admin role required" } # Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant override: feature-x beta allow" } deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] } allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails } This pattern makes layer provenance explicit and traceable. Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OPA --> LOG[Decision Log JSON] LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Data Warehouse] Typical fields in the decision log: input (possibly redacted) result (decision document) path / query labels (instance, version, tenant) metrics (eval time, number of rules evaluated) This pipeline supports: Real-time alerting (SIEM / SOC). Dashboards (latency, volume, error rates). Audit trails (who allowed what, when, and why). Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user. package resources # data.resources.projects = [ # { # "name": "proj-a", # "services": [ # {"name": "svc-1", "env": "prod", "owners": ["alice"]}, # {"name": "svc-2", "env": "dev", "owners": ["bob"]} # ] # }, # { # "name": "proj-b", # "services": [ # {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]} # ] # } # ] prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.projects[_] svc := proj.services[_] svc.env == "prod" svc.owners[_] == user ] } Usage: alice_prod := prod_services_owned_by("alice") This returns: [ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ] Key features: Two nested comprehensions (projects[_], services[_]). Inline filtering by environment and ownership. Structured result objects built inside the comprehension. Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example Complete pattern combining decode, verify, and claim checks. package authz.jwt # Configuration in data.jwt: # data.jwt = { # "issuer": "https://issuer.example.com/", # "audience": "my-api", # "jwks": { ... } # if using embedded JWKS # } default allow := false allow if { token := input.headers.authorization startswith(token, "Bearer ") raw := substring(token, count("Bearer "), -1) # Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw) verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) } verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true # For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true } verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer # aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := aud ) some i aud_array[i] == data.jwt.audience # exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now } verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true # Scope-based check some i payload.scope[i] == "read:orders" } This example is realistic enough to drop into an API gateway or backend service. Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example A typical bundle layout on disk: bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî‚îÄ‚îÄ tenant-2.json 9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] } Meaning: revision is an opaque version string for debugging/rollback. roots tell OPA which prefixes in data this bundle owns: authz ‚Üí data.authz.* (from authz.rego) jwt ‚Üí data.jwt.* (if any data) config ‚Üí data.config.* (from data/config.json) tenants ‚Üí data.tenants.* (from data/tenants/*.json) You can layer bundles by: Using disjoint roots (e.g., authz/ vs pricing/). Or orchestrating versioning in the bundle distribution system. Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system. package authz.multi_tenant default allow := false # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := global_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 } domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 } tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow := count(allow_reasons) > 0 } # Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "allow": final_allow, "source": final_source } } { not global_decision.allow final_allow := false final_source := "global" } { global_decision.allow not domain_decision.allow final_allow := false final_source := "domain" } { global_decision.allow domain_decision.allow tenant_decision.allow final_allow := true final_source := "tenant" } { global_decision.allow domain_decision.allow not tenant_decision.allow final_allow := true final_source := "domain/global" } Clients now get a rich decision document: { "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: feature-x beta"]}, "final": {"allow": true, "source": "tenant"} } Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth Assume: API gateway parses GraphQL into an AST and passes it in input.gql. Schema-driven config is in data.gql. Example config: { "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "support"], "Query.users.email": ["admin"], "Query.users.orders": ["admin", "billing"] } } Rego module: package gql.authz import future.keywords.in default allow := false # input.gql example: # { # "operations": [ # { # "type": "query", # "root": "Query", # "fields": [ # { # "path": ["Query", "users"], # "name": "users", # "subfields": [ # {"path": ["Query", "users", "email"], "name": "email"}, # {"path": ["Query", "users", "orders"], "name": "orders"} # ] # } # ] # } # ], # "user": { # "id": "alice", # "roles": ["support"] # } # } user_roles := input.gql.user.roles # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.gql.roles[full] some r in user_roles r in required } field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] } field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] } # Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.operations[_] f := op.fields[_] ] ++ [ {"path": sf.path, "name": sf.name} | op := input.gql.operations[_] f := op.fields[_] sf := f.subfields[_] ] } total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) }) too_expensive if { total_cost > data.gql.max_cost } unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) } allow if { not too_expensive count(unauthorized_fields) == 0 } decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields } This gives: Field-level auth (field_allowed). Cost-based limiting (total_cost, too_expensive). A rich decision document for clients. Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot] LLM --> CAND[Candidate Rego Policy] CAND --> PIPE[Validation Pipeline] PIPE -->|fail| FEEDBACK[Errors / Suggestions] PIPE -->|pass| BUNDLE[Signed Policy Bundle] BUNDLE --> OPA[OPA Deployments] 17.X.1 Validation Pipeline Steps Syntactic checks: opa fmt, opa check. Unit tests: opa test. Static analysis: internal style & safety rules. Staging OPA: run candidate policy against recorded traffic (shadow mode). Human review for MAD (Major Action/Decision) changes. 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests Candidate Rego (generated by LLM): package authz.orders default allow := false # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id] some order order := data.orders[order_id] ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) } Validation tests: package authz.orders_test import data.authz.orders test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id == "alice" result := orders.allow with input as input result == true } test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_id == "alice" result := orders.allow with input as input result == false } test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} } result := orders.allow with input as input result == true } Pipeline actions: Run opa fmt ‚Üí ensure style. Run opa check ‚Üí catch unknown refs, unsafe vars. Run opa test ‚Üí ensure behavior matches expectations. Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths). If all pass, bundle and distribute. Common Pitfalls: Variable Scoping & Safety 4.X Common Pitfalls: Variable Scoping & Safety Rego‚Äôs scoping rules are simple but unforgiving. Most ‚Äúmysterious‚Äù bugs in policies stem from variable scope and safety issues. Pitfall 1: Accidental Variable Shadowing Inner blocks can rebind a variable name used in an outer block, changing meaning silently. user := input.user allow if { user := data.override_user # shadows outer user user.id == "admin" } The inner user hides the outer one. Prefer distinct names unless you truly mean to shadow: user := input.user allow if { override_user := data.override_user override_user.id == "admin" } Pitfall 2: Unsafe Variables in Rules A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body. # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here } Use opa check to detect this and refactor to ensure all head variables are always bound: # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" } Pitfall 3: Misusing some in Comprehensions some x introduces a new variable local to the current expression. Using it incorrectly can over-constrain or under-constrain rules. # ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices bad if { some i arr[i] == "a" some i arr[i] == "b" } Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names: # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" } Pitfall 4: Assuming Global State in Rules Each rule evaluation is pure and has no hidden global state. Avoid writing rules as if they ‚Äúaccumulate‚Äù across calls: # ‚ùå Misleading mental model: this does not "increment" anything counter := counter + 1 if { ... } # invalid and unsafe Instead, build sets or arrays with comprehensions, then aggregate: violations := { v | some i v := input.items[i] v.level == "HIGH" } violation_count := count(violations) Chapter 6 ‚Äì Common Pitfalls: Nulls, Missing Fields, and Type Guards 6.X Common Pitfalls: Nulls, Missing Fields, and Type Guards Rego is strict about types, but JSON inputs are often messy. Nulls and missing fields are a frequent source of runtime errors. Pitfall 1: Accessing Missing Fields Directly # ‚ùå Panics if input.user is null or missing email := input.user.email Always guard when reading from untrusted inputs: # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email } You can also provide a default: user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email } user_email := "unknown" if { not is_string(user_email) } Pitfall 2: Null vs Missing vs Falsy null, missing, and ‚Äúfalsy‚Äù values are different: Missing: input.user.email ‚Üí error if user missing or not object. Present but null: input.user.email == null is valid. Falsy (e.g., "", 0, false): normal values. Use guards to distinguish: has_email if { is_object(input.user) input.user.email != null } Pitfall 3: Using array.concat on Non-Arrays # ‚ùå Panics if path is null or not an array full := concat(".", array.concat(path, [field])) Wrap in a safe helper or use guards: full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) } Or centralize: safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) } Pitfall 4: Equality Checks with Mixed Types # ‚ùå May silently fail if left/right have different types allowed if input.user.id == data.allowed_ids[_] If input.user.id is a number and data.allowed_ids are strings, this will never match. Normalize types first: allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] } Pitfall 5: Assuming in Works Like SQL for All Types x in y behaves differently depending on whether y is an array, set, or object. Array: x in ["a", "b"] Set: x in {"a", "b"} Object: k in {"a": 1} matches keys, not values. Be explicit about what you mean: # Key membership "k1" in {"k1": 1, "k2": 2} # Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"} Chapter 11 ‚Äì Common Pitfalls: Performance Anti-Patterns 11.X Common Pitfalls: Performance Anti-Patterns Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins. Pitfall 1: Unbounded Linear Scans on Huge Collections # ‚ùå Potentially O(N) scan on large data set every request deny if { some i data.events[i].ip == input.client_ip } Better approaches: Pre-index large data sets offline (e.g., data.events_by_ip[ip]). Use sets for membership checks. # Precomputed: data.events_by_ip = { "1.2.3.4": true, ... } deny if { data.events_by_ip[input.client_ip] } Pitfall 2: Heavy Regex in Hot Paths # ‚ùå Expensive regex on every request deny if re_match(".*(admin|root).*", input.user.name) Mitigations: Push pattern constraints into data modeling if possible. Limit regex to narrow fields and avoid complex patterns. Precompile filters into simpler checks (startswith, contains equivalent logic). Pitfall 3: Recomputing the Same Expression Repeatedly # ‚ùå Recomputes parse for each use deny if { re_match("admin", input.user.name) some p in data.profiles re_match("admin", input.user.name) # repeated } Bind once and reuse: deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call } You can also use helper functions for complex computations. Pitfall 4: Ignoring Partial Evaluation Opportunities Evaluating large, mostly static policies at runtime: # ‚ùå CLI call with huge static config in input opa eval -d policies/ -i big_config.json 'data.authz.allow' If most config is static, bake it into data and use partial evaluation: # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/ Then pass only request-specific input and reap the performance benefits. Pitfall 5: Overusing walk on Large Trees # ‚ùå walk(data) over a huge universe deny if { some path, value walk(data, [path, value]) value == "secret" } walk is powerful but traverses entire trees. Instead: Narrow the search to known subtrees. Maintain dedicated indexes for sensitive values. Use more structured queries instead of full traversal. # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" } 1. Use opa fmt --skip-constraints (most reliable built-in) opa fmt removes unused aliases but NOT unused imports. Example: import data.utils as u If u is never referenced, opa fmt will not remove it. BUT if you write: import data.utils Some versions of opa fmt will rewrite it to: import data.utils ‚Ä¶and will not remove it. Bottom line: opa fmt alone cannot solve unused imports reliably, but helps a bit with alias trimming. ‚úÖ 2. Use opa check --strict This is your best current built-in tool. opa check --strict . This catches: unused function parameters undefined variables shadowed variables ‚Ä¶but NOT unused imports. Still, it improves safety and catches 80% of redundant logic issues. ‚úÖ 3. Use Rego Linter Plugins (best solution) Several teams build a custom linter using rgl, conftest, or their own parser. The best available tool today is: rgl (Rego Lint) GitHub: https://github.com/GearPlug/rgl (community linter) It catches: unused imports unused rules unused local variables dead expressions unreachable rules This is the closest to ESLint/flake8 for Rego. Recommend adding this to CI. ‚úÖ 4. Use Styra DAS Rego Analyzer (if enterprise budget exists) Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags: unused imports unnecessary negations slow queries inefficient comprehensions policy design smells This is the gold standard for production environments but requires paid DAS. ‚úÖ 5. Use editor extensions (Cursor, VSCode, JetBrains) If you‚Äôre using Cursor, the best workflow is: Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] } Then configure a custom linter rule using a regex: import ([^ ]+)( as [^ ]+)? // highlight if alias is unused Cursor can highlight this dynamically. ‚úÖ 6. Organizational best practice: Avoid wildcard imports Never write: import data or: import data.services.* Why? Harder to detect unused segments Harder to find where names come from Encourages shotgun imports Always prefer small, explicit imports: import data.services.crm.allow import data.shared.strings as str import data.shared.constants ‚úÖ 7. Recommended CI rule: Reject files containing unused imports Here is the enterprise-grade script: .ci/lint_unused_imports.sh #!/usr/bin/env bash unused=$(opa inspect . --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path') if [ -n "$unused" ]; then echo "‚ùå Unused imports detected:" echo "$unused" exit 1 fi echo "‚úì No unused imports" This uses: opa inspect (which parses import graph) a small jq filter to detect unused imports This is currently the single best approach that works reliably as of 2024‚Äì2025. üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough opa check --strict üî∂ Detects unused variables, not imports Use always rgl (Rego Lint) ‚úÖ Detects unused imports Best open-source option Styra DAS üî• Enterprise-grade policy analyzer Best paid option CI + opa inspect + jq üî• Fully reliable in CI Recommended Cursor/VSCode rules üî∂ Helps devs during coding Recommended The best lifecycle is: Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional) ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search. Why? Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become: ambiguous fragile order-dependent confusing during refactors conflicting when multiple packages define the same rule And the moment two rule names collide, OPA will throw a conflict or silently evaluate the wrong rule ‚Äî both are terrible in production policy systems. So: ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt count(tech_debt.warn) == 0 with input as mock_input This is the safest, clearest, least ambiguous long-term behavior. üß† Short Answer You Requested (Concise Explanation) Answer: The warn reference comes from the data tree, not from the import. During opa test, OPA loads all policies under services/opa/policies/ into the data namespace. When the test references warn, OPA resolves it by searching all packages for a rule named warn, which finds data.compliance.tech_debt.warn. Because the test never uses tech_debt.warn, the import data.compliance.tech_debt is unused and can be removed. However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define warn. üîç Full Explanation (What‚Äôs Happening Under the Hood) 1. How OPA loads data during tests When you run: opa test services/opa/policies/ services/opa/tests/ OPA loads: every .rego file from policies/ ‚Üí into the data tree every test module in tests/ ‚Üí evaluated with the loaded data This means all rule names become visible under data.*. 2. How warn is resolved When the test evaluates: count(warn) == 0 OPA resolves warn like this: Does the test file define a local variable named warn? No. Does the file import something named warn? No. Search the global data tree for any rule named warn. Finds: data.compliance.tech_debt.warn Thus, the test works, but‚Ä¶ The import is unused because OPA never needs the alias tech_debt to find the rule. ‚ö†Ô∏è Why this is risky If tomorrow someone adds: package compliance.sample warn { ... } Then: warn becomes ambiguous, tests start failing, or worse: OPA selects the wrong one depending on rule type. This is how critical bugs enter policy codebases. üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports Never rely on bare rule names: ‚ùå Bad count(warn) == 0 ‚úîÔ∏è Correct count(tech_debt.warn) == 0 ‚úîÔ∏è Even safer if using as import data.compliance.tech_debt as td count(td.warn) == 0 Your system found: The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused. You removed it, and the tests still worked. ‚úîÔ∏è Why tests still work Because: The tests reference warn without a package prefix: count(warn) == 0 OPA loads all policy packages in /policies/** So the rule warn is available at: data.compliance.tech_debt.warn OPA resolves bare rule names by doing a global search in data. So the import is indeed unused, and removing it does not break the test in the current setup. ‚ö†Ô∏è But removing it is NOT the best practice Even though the import is unused now, this approach is fragile. Why? 1. Bare rule names (warn) are ambiguous Example: If another policy someday adds: package compliance.security warn { ... } Then: count(warn) becomes ambiguous and OPA may: fail pick the wrong rule give unpredictable results 2. Tests become context‚Äêdependent OPA test behavior depends on all loaded policies. If someone changes folder structure or adds a new rule, this test may start failing. 3. Not explicit ‚Üí Not safe in enterprise systems Implicit resolution is one of the most common sources of bugs in OPA deployments. üß† The Better Fix (What I Would Do) ‚ùå Instead of removing the import ‚úîÔ∏è Fix the test to use the import explicitly import data.compliance.tech_debt count(tech_debt.warn) == 0 This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct pattern for all enterprise-grade policy suites. üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate Instead: Use explicit, namespaced references in all tests. The rule: ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly. **Formal Recommendation (Chapter 7.2.1):** In test files, always use explicit package-qualified rule references: ```rego # ‚úÖ CORRECT: Explicit import and qualified reference package compliance.tech_debt_test import data.compliance.tech_debt import rego.v1 test_example if { mock_input := {...} warnings := tech_debt.warn with input as mock_input count(warnings) >= 1 } ``` **Rationale:** 1. **Ambiguity Prevention**: Multiple packages may define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity. 2. **Maintainability**: Tests remain stable when new policies are added that might introduce naming conflicts. 3. **Clarity**: Explicit references make test intent clear and reduce cognitive load during code review. 4. **Refactoring Safety**: Policy package reorganization doesn't break tests that use explicit references. **Anti-Pattern:** ```rego # ‚ùå AVOID: Bare rule name resolution test_example if { count(warn) >= 1 with input as mock_input # Relies on global data tree search - fragile and ambiguous } ``` üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test import rego.v1 import data.compliance.tech_debt # ‚Üê keep this count(tech_debt.warn) == 0 with input as mock_input how your test diff strings are represented inside Rego test files. Specifically: ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {" ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character. ‚ùå But in Rego test files, a string such as: "diff": "+ // TODO:\n+ function getUsers() {" does not produce a newline. In Rego test files: \n is literal backslash + ‚Äún‚Äù NOT a line break NOT decoded NOT matched by regex patterns expecting real newlines or multi-line content NOT iterated the same way So your regex patterns such as: regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff) never see the newline, so they fail. This perfectly explains your trace output: __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context. They are being accessed ‚Äî the content is just different from what your rules assume. üî• Proof: Why the three affected tests fail 1. test_todo_without_clear_action Expected: TODO: <newline> function() Actual in test: "TODO:\nfunction" OPA sees: "T O D O : \ n f u n c t i o n" Your regex expects: TODO: function ‚Ä¶but the newline is missing ‚Üí FAIL. 2. test_fixme_added_without_reference Expected: "+ // FIXME: Temporary hack..." Your regex checks: contains(diff, "FIXME:") But OPA sees: "+ // FIXME: Temporary..." Why does this fail? Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g. "+ // FIXME: Temporary hack for authentication" becomes: "+ // FIXME: Temporary hack for authentication" But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context. 3. test_meaningful_todo_not_logged Same issue: Your rule expects: TODO: Fix N+1 query (workaround) OPA evaluates the Rego test literal as: T O D O : \ s F i x ... The pattern never matches because whitespace escaping does NOT behave like in JSON. üß† Why direct opa eval --input JSON works Because JSON ‚Üí OPA decoding translates \n into real newlines. Rego test files do NOT. üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings Rego supports multi-line raw strings: diff := `+ // TODO: + function getUsers() {` This will perfectly match the policy expectations. Update all test inputs to use multi-line raw strings. ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file Instead of: "diff": "+ // TODO:\n+ function getUsers() {" Do: "diff": "+ // TODO: + function getUsers() {" This is the simplest solution. ‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n" Example: regex.match("TODO:(\n|\\\\n)", diff) But this becomes ugly and error-prone. ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy You can add: diff_unescaped := string.replace(file.diff, "\\n", "\n") But this will add noise to all rules. ‚úîÔ∏è What I Recommend Because you‚Äôre building an enterprise system: ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs
:::
:::

::: concept
id: BLK-ef0eb00e6bda8ba3
summary: 6.2 Built-in Function Categories (Overview).
digest: ba196881ebd3f85a68c175e308223c851e5e76dfbc1821eb7000c5a3b037eb52
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.2 Built-in Function Categories (Overview)..
vector_summary: 6.2 Built-in Function Categories (Overview).
chapter: CH-05
:::
6.2 Built-in Function Categories (Overview)
:::

::: concept
id: BLK-49055f6875f1cc73
summary: For orientation, here is the taxonomy we‚Äôll use in this chapter:.
digest: d6daa4b0d9b9d5545660a5bb22a7bd069363ef4b05ce3f6a9eafccfc12e75f7f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For orientation, here is the taxonomy we‚Äôll use in this chapter:..
vector_summary: For orientation, here is the taxonomy we‚Äôll use in this chapter:.
chapter: CH-05
:::
For orientation, here is the taxonomy we‚Äôll use in this chapter:
:::

::: concept
id: BLK-cf46e6696f6b22f0
summary: Aggregates: count, sum, product, min, max, sort, all, any.
digest: f3d2cd46b8d2dfda463b61a5a619ac87bd07fcb3e60eb7098c70ec3308bd3e0c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Aggregates: count, sum, product, min, max, sort, all, any..
vector_summary: Aggregates: count, sum, product, min, max, sort, all, any.
chapter: CH-05
:::
Aggregates: count, sum, product, min, max, sort, all, any
:::

::: concept
id: BLK-b772a28e5960357e
summary: Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter.
digest: 336a600a3a0b6d13a1b12bd154db932bab97064ad5fade25646eee7f2123708f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter..
vector_summary: Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter.
chapter: CH-05
:::
Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter
:::

::: concept
id: BLK-6e16416ce945a0fe
summary: Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set.
digest: 21b445bcbce27e419233f950efa141abdc6c3dd97510af83de45e6d5882333fe
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set..
vector_summary: Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set.
chapter: CH-05
:::
Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set
:::

::: concept
id: BLK-b6acfeb73ecfb3bd
summary: Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter.
digest: 04c69d2b6e1d66a8a1d45dfd987553268907e845313dc00bac850ff5ba60ccaf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter..
vector_summary: Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter.
chapter: CH-05
:::
Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter
:::

::: concept
id: BLK-ffa6ad16a050d7d9
summary: Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family.
digest: dd5826e76368354c89c9c0aaa7082cf28fd380a5e5f3b40611d3d760ded34cb1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family..
vector_summary: Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family.
chapter: CH-05
:::
Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family
:::

::: concept
id: BLK-3d88482e4061db9e
summary: Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split.
digest: fb59c631a1bee0a7f96c143b496ceac9a479ed5a6ab5ea63d8b3d5e398d64505
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split..
vector_summary: Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split.
chapter: CH-05
:::
Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split
:::

::: concept
id: BLK-aad1a170dd666677
summary: Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons.
digest: bb6f4964c96aabbace6f40e0dd48b99617084f24f97e16a0a5baf5898fefece5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons..
vector_summary: Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons.
chapter: CH-05
:::
Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons
:::

::: concept
id: BLK-ccdb280747300dd7
summary: Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid.
digest: cc810f8df810c448038b6c6a6bdb71f6ec68750a4b0be96752d3011328cf2acc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid..
vector_summary: Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid.
chapter: CH-05
:::
Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid
:::

::: concept
id: BLK-6019bf75ef6624c0
summary: Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.*.
digest: d2a6d30479bd0e615a1ae4a011c36348a59cc3b4e8e02b4195e74e83d881fc02
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.*..
vector_summary: Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.*.
chapter: CH-05
:::
Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.*
:::

::: concept
id: BLK-6b408802776a93cd
summary: Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name.
digest: d94fea50fb0624b9534133b1541892eea8967d0da40a807bb9ce6a547edfdb94
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name..
vector_summary: Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name.
graph_neighbors: [CODE-fa97df2a115ae029]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name
:::

::: concept
id: BLK-f4ead349338c8ef6
summary: Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.*.
digest: 8bbef7b238a0b074fb6f0f5fb8b60f4819ac3cfbe0b7ed990f92aad000fa7daa
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.*..
vector_summary: Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.*.
chapter: CH-05
:::
Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.*
:::

::: concept
id: BLK-54e2cf6d9a981dc3
summary: Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs.
digest: c2e7b35fae5158fc8a8976a841108ed88075fdca8c7222958c1d57e9540282b5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs..
vector_summary: Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs.
chapter: CH-05
:::
Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs
:::

::: concept
id: BLK-c595ba2ed67a0e45
summary: HTTP & I/O: http.send for outbound HTTP calls.
digest: adcdd4fa4cc860361a1ed82756f6cd6b451474cb4a72ae1ec0076125533c2ae1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that HTTP & I/O: http.send for outbound HTTP calls..
vector_summary: HTTP & I/O: http.send for outbound HTTP calls.
chapter: CH-05
:::
HTTP & I/O: http.send for outbound HTTP calls
:::

::: concept
id: BLK-c7baced805939b57
summary: Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge.
digest: a90d7ff390ad1b4acf3292c6cf637c3ca477f63855d6f28fccd160af56f3cbcd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge..
vector_summary: Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge.
chapter: CH-05
:::
Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge
:::

::: concept
id: BLK-82cc3ccae9f078e0
summary: UUID/ULID: uuid.*, ulid.generate.
digest: 760dd3cdab43df16516b74a7feb7927787d021ac61549844dfba88d3959b6ce8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that UUID/ULID: uuid.*, ulid.generate..
vector_summary: UUID/ULID: uuid.*, ulid.generate.
chapter: CH-05
:::
UUID/ULID: uuid.*, ulid.generate
:::

::: concept
id: BLK-cdbdae08e6768e75
summary: Graph & Structural Walks: graph.reachable, walk.
digest: f0e1b62d3ebce4c42bd109d546df366114b3a4b5d27fb3e82629a925ce88538a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Graph & Structural Walks: graph.reachable, walk..
vector_summary: Graph & Structural Walks: graph.reachable, walk.
chapter: CH-05
:::
Graph & Structural Walks: graph.reachable, walk
:::

::: concept
id: BLK-872e72b8a1e0cda1
summary: Units: units.parse, units.parse_bytes.
digest: 2c2707ccfa9db50bd16c82233eb09cd55fb97f24410fbc5cc077187aee4845b7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Units: units.parse, units.parse_bytes..
vector_summary: Units: units.parse, units.parse_bytes.
chapter: CH-05
:::
Units: units.parse, units.parse_bytes
:::

::: concept
id: BLK-00a76d3fd313f7d0
summary: Debugging: print, trace.
digest: d8d3838f96e8e6baf3055a45b5d8d1e67439fc37963e573ed0e63bbd6653ace8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Debugging: print, trace..
vector_summary: Debugging: print, trace.
chapter: CH-05
:::
Debugging: print, trace
:::

::: concept
id: BLK-2ef44c7e2eba38d6
summary: Error Semantics: Strict vs non-strict behavior.
digest: 7eb4a177571432e6319a7770a031beb7f716887d7bf7da13fb04256d2d3464d6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Error Semantics: Strict vs non-strict behavior..
vector_summary: Error Semantics: Strict vs non-strict behavior.
chapter: CH-05
:::
Error Semantics: Strict vs non-strict behavior
:::

::: concept
id: BLK-962ae7799bfaea26
summary: We‚Äôll now go category by category, with semantics, examples, and pitfalls.
digest: de41e11cf5d44150f8ccdd6102b7ec6c46e431f0014138db928e712b90ef5e33
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that We‚Äôll now go category by category, with semantics, examples, and pitfalls..
vector_summary: We‚Äôll now go category by category, with semantics, examples, and pitfalls.
graph_neighbors: [TERM-7189e73f44e918ef]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
We‚Äôll now go category by category, with semantics, examples, and pitfalls.
:::

::: concept
id: BLK-596d0d11df0a2b34
summary: Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR).
digest: 44f58fc8f7ff63548be69487e74890a7bd56b466a3237260d62803b69bd29ebe
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR)..
vector_summary: Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR).
chapter: CH-05
:::
Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR).
:::

::: concept
id: BLK-7934af716417f7d8
summary: Count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element...
digest: 3c1cd4957cdf1f0df8eca75945fa3187e0ee9fc2952094ad128f8b4b8b6f1864
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element....
vector_summary: Count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element...
chapter: CH-05
:::
count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element min(array) # minimum element sort(array) # sorted copy (ascending) all(array_bool) # AND over boolean array any(array_bool) # OR over boolean array
:::

::: concept
id: BLK-791542a3ee72c589
summary: # Count API keys api_key_count := count(input.api_keys).
digest: 4cac19509195ee7736b155bd6f8ad6ec2bd9848da923669325e66bc70b99f97a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Count API keys api_key_count := count(input.api_keys)..
vector_summary: # Count API keys api_key_count := count(input.api_keys).
chapter: CH-05
:::
# Count API keys api_key_count := count(input.api_keys)
:::

::: concept
id: BLK-f48113faff5c16ae
summary: # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) }.
digest: 9527a1bbfcdbae3d3ebb88b39ec279ad0982d774e10f44cd13e29858e105e5a0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) }..
vector_summary: # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) }.
chapter: CH-05
:::
# Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) }
:::

::: concept
id: BLK-74ff565e561f01ba
summary: Sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined.
digest: 733590d33f82c6d0394d8af8f1eef7b781cf543283387776bb6f4a14c61d42d2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined..
vector_summary: Sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined.
chapter: CH-05
:::
sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined.
:::

::: concept
id: BLK-2c081e539ff9ca26
summary: Count accepts arrays, sets, strings:.
digest: 2f47ce9220e1db533d40876624168f0f231f1ab62e02abf2305b670059d6eb31
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count accepts arrays, sets, strings:..
vector_summary: Count accepts arrays, sets, strings:.
chapter: CH-05
:::
count accepts arrays, sets, strings:
:::

::: concept
id: BLK-15482deb4216bdc0
summary: Count("abc") # 3 count({"a", "b"}) # 2.
digest: 59b555036443d043a9b52ce83a453b5428bd149369015972ec330a3480809c5b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count("abc") # 3 count({"a", "b"}) # 2..
vector_summary: Count("abc") # 3 count({"a", "b"}) # 2.
chapter: CH-05
:::
count("abc") # 3 count({"a", "b"}) # 2
:::

::: concept
id: BLK-99bc66bd2d2d22ac
summary: Pattern: Use count for guardrails:.
digest: 7009c0f15e92c507e9b0ade36a2ef2012cea3893bbd773148ea6f95934562aab
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pattern: Use count for guardrails:..
vector_summary: Pattern: Use count for guardrails:.
chapter: CH-05
:::
Pattern: Use count for guardrails:
:::

::: concept
id: BLK-bbc8d74e03606e88
summary: Deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" }.
digest: b64ea629921a991987420dbc9cd41c98146174d242b53a886923c512b0cbd10e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" }..
vector_summary: Deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" }.
chapter: CH-05
:::
deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" }
:::

::: concept
id: BLK-63f3203792f6dd9a
summary: Arrays are ordered; built-ins treat them as such.
digest: 90ddeef5ace95fc365eeb05e84416e303b0fed88560806a8d14095e8236071a4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Arrays are ordered; built-ins treat them as such..
vector_summary: Arrays are ordered; built-ins treat them as such.
chapter: CH-05
:::
Arrays are ordered; built-ins treat them as such.
:::

::: concept
id: BLK-0170fbca460ac05f
summary: Array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy.
digest: c3acd7de6bf285ba431e2acceecd39f78a8ac22593368c0cae724ef5528a4c7f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy..
vector_summary: Array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy.
chapter: CH-05
:::
array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy
:::

::: concept
id: BLK-fe1ce0476ba80606
summary: # Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len).
digest: 8c50ab4dc393e722df43aaa1cb9ddd473fc549dda4df5e93b3ecc3faf4ae8b82
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len)..
vector_summary: # Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len).
chapter: CH-05
:::
# Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len)
:::

::: concept
id: BLK-404c395d3ea15d7a
summary: # Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1].
digest: 346e5cb98f392e46ef9facbde3351f4514ac4871a9a0819d9a071f563bb30013
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1]..
vector_summary: # Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1].
chapter: CH-05
:::
# Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1]
:::

::: concept
id: BLK-21aad7baea9ba2e2
summary: Indexing vs slicing:.
digest: 0e1f4dfe100f500e3ab70afe698e9d9a9fef3326a67639f03b6dffc52e15b7cb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Indexing vs slicing:..
vector_summary: Indexing vs slicing:.
chapter: CH-05
:::
Indexing vs slicing:
:::

::: concept
id: BLK-e94daebb356ba43f
summary: Out-of-range indices ‚Üí expression undefined.
digest: 164dea8ed9f4ce4e5f2bc597b75b1077496538b6fa9d9ead074583093776bca7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Out-of-range indices ‚Üí expression undefined..
vector_summary: Out-of-range indices ‚Üí expression undefined.
chapter: CH-05
:::
Out-of-range indices ‚Üí expression undefined.
:::

::: concept
id: BLK-08cda054b5b03bbf
summary: 6.5 Sets and Set-like Operations.
digest: f47456072d5fb42c7586ef3cc662983a4e78b776c5bf7054a5a70bcb9e987ffa
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.5 Sets and Set-like Operations..
vector_summary: 6.5 Sets and Set-like Operations.
chapter: CH-05
:::
6.5 Sets and Set-like Operations
:::

::: concept
id: BLK-e37b22113d09ec95
summary: Intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # co...
digest: aa76a84ed6064e2596cd79bc1b716bdb7ccc5f0c168f0d951d8a754adc96f541
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # co....
vector_summary: Intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # co...
chapter: CH-05
:::
intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # convert array to set
:::

::: concept
id: BLK-12487ad1b10432e4
summary: Allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions).
digest: fce5b47def5dcf548e5c0c995d1f6134144403cd0caf2b87bf166b4045ee3b2a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions)..
vector_summary: Allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions).
chapter: CH-05
:::
allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions)
:::

::: concept
id: BLK-3db95d70e67fc31e
summary: Invalid_regions := set_diff(requested_regions, allowed_regions).
digest: cfb5369ef0140e1c75ffde9a26e39cedc4ce62cb80678ed0a45c24ffc2f07107
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Invalid_regions := set_diff(requested_regions, allowed_regions)..
vector_summary: Invalid_regions := set_diff(requested_regions, allowed_regions).
chapter: CH-05
:::
invalid_regions := set_diff(requested_regions, allowed_regions)
:::

::: concept
id: BLK-523debf78d115993
summary: Deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) }.
digest: 79f4a78c90c062cf23ce92a4b32227613161300b6fb515836c2a7ce4bdb1dcdf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) }..
vector_summary: Deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) }.
chapter: CH-05
:::
deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) }
:::

::: concept
id: BLK-d047ca3d47b07bab
summary: Performance pattern: Prefer sets for membership:.
digest: cdd32f7479109e10a67a0da6dfb3f197fc552acb1523d8075e96cbee5f91ac85
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Performance pattern: Prefer sets for membership:..
vector_summary: Performance pattern: Prefer sets for membership:.
chapter: CH-05
:::
Performance pattern: Prefer sets for membership:
:::

::: concept
id: BLK-958bba1048ce58c0
summary: # Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users.
digest: 7b573ac7d4e905d77b7f62067704e0f1a92bc8bc86b6be3d206d6cab5d151563
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users..
vector_summary: # Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users.
chapter: CH-05
:::
# Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users
:::

::: concept
id: BLK-9936fd64e4071bcd
summary: # Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list.
digest: 5dfaa35d9c3c34215d18e7d4ea00a341ce6469a97470aea528b3bcd702787bd4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list..
vector_summary: # Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list.
chapter: CH-05
:::
# Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list
:::

::: concept
id: BLK-b7a1e245e128d594
summary: 6.6 Objects & JSON Path Helpers.
digest: 5a82afa25ee18dd8fb97d56759490afa28e264ee15b722d7182806623ce39931
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.6 Objects & JSON Path Helpers..
vector_summary: 6.6 Objects & JSON Path Helpers.
chapter: CH-05
:::
6.6 Objects & JSON Path Helpers
:::

::: concept
id: BLK-6896accc71c6a5e8
summary: Objects represent mappings from scalar keys to arbitrary values.
digest: 5cad10cd3ce4c7429586fceffc73106e4b48a8a3308607ff203263c8fc2a939b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Objects represent mappings from scalar keys to arbitrary values..
vector_summary: Objects represent mappings from scalar keys to arbitrary values.
chapter: CH-05
:::
Objects represent mappings from scalar keys to arbitrary values.
:::

::: concept
id: BLK-6809c3d7905f3972
summary: Object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on co...
digest: a89a5242db6f43340119b3e8d3ea989d7dfe9277527ef892838bd653c69faf72
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on co....
vector_summary: Object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on co...
chapter: CH-05
:::
object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on conflict object.filter(obj, keys_array) # keep only listed keys json.filter(obj, paths_array) # filter by JSON paths (e.g., "a/b/c")
:::

::: concept
id: BLK-64caf7147f83da01
summary: # Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000).
digest: 4504e4e4eaf25a3240feaf1c4f1724e7d455eca828a16f50978610976f2f6134
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000)..
vector_summary: # Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000).
chapter: CH-05
:::
# Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000)
:::

::: concept
id: BLK-966c15b0885f6587
summary: # Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"]).
digest: 243cb615762e6481ad625151c0714a03215b54a142a9a23f282c54f751de6914
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"])..
vector_summary: # Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"]).
chapter: CH-05
:::
# Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"])
:::

::: concept
id: BLK-e6aca8c5011c2c92
summary: # Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"]).
digest: b97a22aa1c758fa95a6e935c29b5e73f5a800cd373deb20be3df71b1f69f0fe5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"])..
vector_summary: # Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"]).
chapter: CH-05
:::
# Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"])
:::

::: concept
id: BLK-f16c75347a49cfc8
summary: # Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"]).
digest: a9b7606832c725c461ac0629a7d14224041fbec1463581936b615b6a063913e2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"])..
vector_summary: # Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"]).
chapter: CH-05
:::
# Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"])
:::

::: concept
id: BLK-bc0e62af97ec9ecb
summary: Use object.get instead of chaining if input.config.timeout_ms checks everywhere.
digest: ec840b36fd495999d064c4b48fdcfe13d64876d3b3c781fdd4f5cfaebad3ff2f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use object.get instead of chaining if input.config.timeout_ms checks everywhere..
vector_summary: Use object.get instead of chaining if input.config.timeout_ms checks everywhere.
chapter: CH-05
:::
Use object.get instead of chaining if input.config.timeout_ms checks everywhere.
:::

::: concept
id: BLK-8db7cb02fa0d8019
summary: Use object.remove before logging to avoid PII leaks.
digest: 013c00bf48bbed1040e23048d392573ee426310f8d87b380579ac781da1d8916
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use object.remove before logging to avoid PII leaks..
vector_summary: Use object.remove before logging to avoid PII leaks.
chapter: CH-05
:::
Use object.remove before logging to avoid PII leaks.
:::

::: concept
id: BLK-7ff764ddb3c09d45
summary: 6.6 JSON Filter (json.filter).
digest: 6bfcb52e36f5fdfe43639afce930ec9ec980762d6c870f078ca221b5cc9b00ec
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.6 JSON Filter (json.filter)..
vector_summary: 6.6 JSON Filter (json.filter).
chapter: CH-05
:::
6.6 JSON Filter (json.filter)
:::

::: concept
id: BLK-560f57c44741f42a
summary: Json.filter allows you to keep only selected fields from a JSON object.
digest: 8dabb9f19af5c6ed6223034679922640d630e532474b1983a70b00043ad8498b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Json.filter allows you to keep only selected fields from a JSON object..
vector_summary: Json.filter allows you to keep only selected fields from a JSON object.
chapter: CH-05
:::
json.filter allows you to keep only selected fields from a JSON object.
:::

::: concept
id: BLK-5d036547953a8f35
summary: Signature (conceptual):.
digest: 8f989705311136df54dc822d647f6580e0bac1ba657a2d7f643f8ac22b7c24ed
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Signature (conceptual):..
vector_summary: Signature (conceptual):.
chapter: CH-05
:::
Signature (conceptual):
:::

::: concept
id: BLK-aa4996164f00b4c3
summary: Json.filter(obj, paths_array) # paths_array: array of slash-delimited strings.
digest: 581ac7b33d03fd60b5489d5dea9c8864143b51f5ad04d2dc16838f789dd8d5d8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Json.filter(obj, paths_array) # paths_array: array of slash-delimited strings..
vector_summary: Json.filter(obj, paths_array) # paths_array: array of slash-delimited strings.
chapter: CH-05
:::
json.filter(obj, paths_array) # paths_array: array of slash-delimited strings
:::

::: concept
id: BLK-f8d1eedc439ab8ec
summary: # Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"]).
digest: 8146c75d185630409bf6addd69a09ba9c7137b09bdab35f63fbc51f8dcd3623e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"])..
vector_summary: # Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"]).
chapter: CH-05
:::
# Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"])
:::

::: concept
id: BLK-f9b6faf28a2028a5
summary: Path strings are JSON Pointer‚Äìstyle:.
digest: 87826b867e95073db43941875a0a141c9137bc40ce8e38a6992b7a49aa4da359
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Path strings are JSON Pointer‚Äìstyle:..
vector_summary: Path strings are JSON Pointer‚Äìstyle:.
chapter: CH-05
:::
Path strings are JSON Pointer‚Äìstyle:
:::

::: concept
id: BLK-0bb7c9be9909cc35
summary: "user/id" corresponds to conceptual path segments ["user", "id"].
digest: 32dbfc7ce4ef4106a17b5b034e828b5180451f9d003dd4eb4fc83f6e1a0f7ed3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "user/id" corresponds to conceptual path segments ["user", "id"]..
vector_summary: "user/id" corresponds to conceptual path segments ["user", "id"].
chapter: CH-05
:::
"user/id" corresponds to conceptual path segments ["user", "id"].
:::

::: concept
id: BLK-a9fcb33c5ea171bc
summary: "request/path" corresponds to ["request", "path"].
digest: e58632c1e7d7a223fa9f215de9c5460e81b44bc37ce7d6a391a5cbf4dbef5286
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "request/path" corresponds to ["request", "path"]..
vector_summary: "request/path" corresponds to ["request", "path"].
chapter: CH-05
:::
"request/path" corresponds to ["request", "path"].
:::

::: concept
id: BLK-5054224961c85436
summary: Think of each string as a slash-delimited path from the root of obj.
digest: 6662ea2c78306d1ae0b7ee662b305aada1b8ec52403145d0a5bd8f9b1581bc8e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Think of each string as a slash-delimited path from the root of obj..
vector_summary: Think of each string as a slash-delimited path from the root of obj.
chapter: CH-05
:::
Think of each string as a slash-delimited path from the root of obj. The function returns a new object containing only the specified paths.
:::

::: concept
id: BLK-1827c164cec5cced
summary: Concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, bas...
digest: 52ea81c30862e3f0d6c350fa841f4c7cdaca0ad2e431d55c829f4882b7716c2e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, bas....
vector_summary: Concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, bas...
chapter: CH-05
:::
concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, base) # "2a" in base 16, etc. indexof(s, substr) # index or -1 lower(s) / upper(s) replace(s, old, new) # replace all occurrences split(s, sep) # split into array sprintf(format, args_array) # printf-style format substring(s, start, length) # slice of string trim(s, chars) # trim characters from both ends trim_space(s) # trim whitespace trim_prefix(s, prefix) trim_suffix(s, suffix)
:::

::: concept
id: BLK-d1f0e80b99a8855a
summary: # Normalize emails norm_email := lower(trim_space(input.user.email)).
digest: 590e6fed91c085ec698d8f1841278dbd85ae9425b1a4771f13e55140d80ed06f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Normalize emails norm_email := lower(trim_space(input.user.email))..
vector_summary: # Normalize emails norm_email := lower(trim_space(input.user.email)).
chapter: CH-05
:::
# Normalize emails norm_email := lower(trim_space(input.user.email))
:::

::: concept
id: BLK-034df081487c6e14
summary: # Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/").
digest: 2b027814f6c19a31a4c284251cd28eccd8933ffdf861d959aed4e2a0eea65399
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/")..
vector_summary: # Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/").
chapter: CH-05
:::
# Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/")
:::

::: concept
id: BLK-3d6a7a0519d02f65
summary: # Slugify a title (rough example) slug := lower(replace(input.title, " ", "-")).
digest: 03d085931fbdc77b1f3dc82c3d604816deed211d67a933b543dd9d3b32ad913c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Slugify a title (rough example) slug := lower(replace(input.title, " ", "-"))..
vector_summary: # Slugify a title (rough example) slug := lower(replace(input.title, " ", "-")).
chapter: CH-05
:::
# Slugify a title (rough example) slug := lower(replace(input.title, " ", "-"))
:::

::: concept
id: BLK-5f55f27905af292b
summary: # Format numeric IDs hex_id := format_int(input.id, 16) # hex.
digest: 4c93d8458cd71556c4f246146304f8d15f4e20b1c41ed3c963c180589f16fdc0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Format numeric IDs hex_id := format_int(input.id, 16) # hex..
vector_summary: # Format numeric IDs hex_id := format_int(input.id, 16) # hex.
chapter: CH-05
:::
# Format numeric IDs hex_id := format_int(input.id, 16) # hex
:::

::: concept
id: BLK-99ce09c802bf60a2
summary: # Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id]).
digest: 66188b4564ee7cad43e623b20cd680bfd1015e420e16b62547e5ca37cf7039b1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id])..
vector_summary: # Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id]).
chapter: CH-05
:::
# Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id])
:::

::: concept
id: BLK-8d0cec0d56f71772
summary: 6.8 Regular Expressions.
digest: a3bf0a38f0df507f4dc0e7c5a9eee749d90f71b5dda52b89472658ad5ba73344
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.8 Regular Expressions..
vector_summary: 6.8 Regular Expressions.
chapter: CH-05
:::
6.8 Regular Expressions
:::

::: concept
id: BLK-c2126d6032b00de1
summary: Regex built-ins are powerful but expensive; use carefully.
digest: 8b8b634653161aaa5420b09fd016750075482a0019d6a5917cedda5386deb2ac
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Regex built-ins are powerful but expensive; use carefully..
vector_summary: Regex built-ins are powerful but expensive; use carefully.
chapter: CH-05
:::
Regex built-ins are powerful but expensive; use carefully.
:::

::: concept
id: BLK-d0a0341eae3035cf
summary: Regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(patter...
digest: 1a407f98fd3b22d755a291391b731ba1ea34fa7bf9a25ae672c5e8bbabef2e02
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(patter....
vector_summary: Regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(patter...
chapter: CH-05
:::
regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(pattern, string) # array of splits
:::

::: concept
id: BLK-19d08c340d427069
summary: Raw Strings (Backticks) - Implementation Note:.
digest: 8baaec764f0cb6e9601d85f38c8caf9d095c55f2bfb59bced77f793b11b773f5
symbol_refs: [Raw Strings (Backticks) - Implementation Note:]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Raw Strings (Backticks) - Implementation Note:..
vector_summary: Raw Strings (Backticks) - Implementation Note:.
chapter: CH-05
:::
**Raw Strings (Backticks) - Implementation Note:**
:::

::: concept
id: BLK-c2a495572332a234
summary: However, raw strings may not be supported in all OPA versions or implementations.
digest: ff0bd93f56c92a011c0feffb7b33eb7bade66aaf279baf5b58d511982ee02768
symbol_refs: [raw-string ::= ", " } ", raw strings may not be supported in all OPA versions or implementations]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that However, raw strings may not be supported in all OPA versions or implementations..
vector_summary: However, raw strings may not be supported in all OPA versions or implementations.
graph_neighbors: [TERM-7189e73f44e918ef]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
The grammar defines raw strings with backticks (`raw-string ::= "`" { CHAR-"`" } "`"`), and examples in documentation may show them. However, **raw strings may not be supported in all OPA versions or implementations**. For maximum compatibility, prefer double-quoted strings with proper escaping:
:::

::: concept
id: BLK-cea8ae8e888936e9
summary: # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value).
digest: 60f82b36a01b6c041a84bf46b28c0711c4bc543838d924da8c92fdedab76272c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value)..
vector_summary: # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value).
chapter: CH-05
:::
# Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value)
:::

::: concept
id: BLK-85c57404aa7470a5
summary: Exception: Multi-Line Test Data.
digest: 6f21de52b5136969756e970854646b98b244104b329315f98e9c7c5fe5e70363
symbol_refs: [Exception: Multi-Line Test Data]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Exception: Multi-Line Test Data..
vector_summary: Exception: Multi-Line Test Data.
chapter: CH-05
:::
**Exception: Multi-Line Test Data**
:::

::: concept
id: BLK-5653ea053fcd305c
summary: For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve ac...
digest: 64587bf205bacae9937715d1dce64c822e6ff8c157e097854f643ed64a41601f
symbol_refs: [\n]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve ac....
vector_summary: For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve ac...
chapter: CH-05
:::
For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve actual newline characters. Unlike double-quoted strings where `\n` is a literal two-character sequence, raw strings interpret newlines as actual line breaks:
:::

::: concept
id: BLK-5b85cd23416fe10a
summary: When to Use Double-Quoted Strings: - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable.
digest: b9a4c92eae3266aadf16940781b10f54e7ed3de9bc2c54f001237c657f8ad0d9
symbol_refs: [When to Use Double-Quoted Strings:]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When to Use Double-Quoted Strings: - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable..
vector_summary: When to Use Double-Quoted Strings: - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable.
graph_neighbors: [TERM-4176bf4a5b555c86]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
**When to Use Double-Quoted Strings:** - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable
:::

::: concept
id: BLK-0aca188dad8fd4c4
summary: Avoid regex in tight loops over large collections if possible.
digest: 2eb2c5a2752e4f598841a26a6c1fde8afc09aa8e61dcd30b52245303d8c54c6c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Avoid regex in tight loops over large collections if possible..
vector_summary: Avoid regex in tight loops over large collections if possible.
chapter: CH-05
:::
Avoid regex in tight loops over large collections if possible.
:::

::: concept
id: BLK-27494b43ea9a88cc
summary: Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied).
digest: aa2e03a0e88ef413a160d33c75a0df4b7209738f74429cf788904a045b146e3d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied)..
vector_summary: Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied).
chapter: CH-05
:::
Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied).
:::

::: concept
id: BLK-bffd0561a132a3ee
summary: 6.9 Numbers & Numeric Utilities.
digest: 093db37466694e8e3e6d7a994b19d80bc3ad1395dfe261b6eccbe3211b33b8ae
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.9 Numbers & Numeric Utilities..
vector_summary: 6.9 Numbers & Numeric Utilities.
chapter: CH-05
:::
6.9 Numbers & Numeric Utilities
:::

::: concept
id: BLK-cfbd6b5720d1c8c4
summary: Basic numeric helpers:.
digest: 065aadb82c1ae17efcb75895d646c9c03bc845cbdaeb4631dec04caa7d47ea9f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Basic numeric helpers:..
vector_summary: Basic numeric helpers:.
chapter: CH-05
:::
Basic numeric helpers:
:::

::: concept
id: BLK-dc5923a0cbbecea4
summary: Abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start,...
digest: a7f10d7b35e6bfc2e2c59e381b8492902bd507d5af6d898e88652db993135467
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start,....
vector_summary: Abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start,...
chapter: CH-05
:::
abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start, ..., end-1]
:::

::: concept
id: BLK-389040bd2c4e208b
summary: # Generate ports 8000 to 8099 ports := numbers.range(8000, 8100).
digest: ffa37f6c5c3f27487c6270723144b2af46b43a5f5007da5a85366fdc3d64d075
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Generate ports 8000 to 8099 ports := numbers.range(8000, 8100)..
vector_summary: # Generate ports 8000 to 8099 ports := numbers.range(8000, 8100).
chapter: CH-05
:::
# Generate ports 8000 to 8099 ports := numbers.range(8000, 8100)
:::

::: concept
id: BLK-78c2cb371a96496e
summary: # Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit }.
digest: ea3c71c7f5d0e193b3c1d583c08dcf458afef9fa64c276e5b50d49811c9be1fe
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit }..
vector_summary: # Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit }.
chapter: CH-05
:::
# Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit }
:::

::: concept
id: BLK-7a4ef4151bc05f13
summary: Combine with aggregates:.
digest: 6aa964248fc193e8ce8b272cc2470e1022f59ae8e2dc722a2ba383d0f70c2f3f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Combine with aggregates:..
vector_summary: Combine with aggregates:.
chapter: CH-05
:::
Combine with aggregates:
:::

::: concept
id: BLK-a307644bd6c65dd0
summary: # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 }.
digest: cccf48c36a2c8158dfeedee7f36cedb8d2b2a3a5d07e26f8af9c40e1459b6e21
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 }..
vector_summary: # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 }.
chapter: CH-05
:::
# Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 }
:::

::: concept
id: BLK-da60e2ba3a9d9f8b
summary: 6.10 Type Conversion & Validation.
digest: 055c2261fef2dafa3f125b08b33f452d3f717affbedb939c5dc87f7cadf0db19
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.10 Type Conversion & Validation..
vector_summary: 6.10 Type Conversion & Validation.
chapter: CH-05
:::
6.10 Type Conversion & Validation
:::

::: concept
id: BLK-92acd8f218475798
summary: Sometimes you ingest loosely typed JSON (forms, CSV turned JSON).
digest: a7795be7d9e032ac8a22e87e52add8a16349c165d4cd7c747ca324f13a61446c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Sometimes you ingest loosely typed JSON (forms, CSV turned JSON)..
vector_summary: Sometimes you ingest loosely typed JSON (forms, CSV turned JSON).
chapter: CH-05
:::
Sometimes you ingest loosely typed JSON (forms, CSV turned JSON). Use conversion and validation built-ins:
:::

::: concept
id: BLK-7df6e314b23533aa
summary: To_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_...
digest: 14f67a39f0086e7af8872277a404908d555fe1f873660559c401f231f8c2442b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that To_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_....
vector_summary: To_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_...
chapter: CH-05
:::
to_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_bool(x) json.is_valid(str) # syntactic JSON validation yaml.is_valid(str)
:::

::: concept
id: BLK-d5763b6b5eb0bf7a
summary: # Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 }.
digest: 95f052f9a6b94ba63c7d8f83dc9973edebf7872eac6e78e12d89ef3155991146
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 }..
vector_summary: # Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 }.
chapter: CH-05
:::
# Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 }
:::

::: concept
id: BLK-c7d5202b059d4f66
summary: # Convert dynamic lists tags_set := to_set(input.tags).
digest: 918120c257d6e48cc1d152ae258b5a44433e3d9d25a664de57747e597c820470
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Convert dynamic lists tags_set := to_set(input.tags)..
vector_summary: # Convert dynamic lists tags_set := to_set(input.tags).
chapter: CH-05
:::
# Convert dynamic lists tags_set := to_set(input.tags)
:::

::: concept
id: BLK-f103384b14a876e2
summary: 6.11 Encoding, Decoding & Serialization.
digest: 0ad2c3324b9574070f36a555f263fdb4cb658e535fe53a187a8d46534969a1cd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.11 Encoding, Decoding & Serialization..
vector_summary: 6.11 Encoding, Decoding & Serialization.
chapter: CH-05
:::
6.11 Encoding, Decoding & Serialization
:::

::: concept
id: BLK-fb68755b272d7cd1
summary: Used to transform payloads between formats or safely embed them.
digest: c2e0c3d82876fc4ef8b7a7c9533f3adbb7adf5c8fbe4743e719391f53c754d52
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Used to transform payloads between formats or safely embed them..
vector_summary: Used to transform payloads between formats or safely embed them.
chapter: CH-05
:::
Used to transform payloads between formats or safely embed them.
:::

::: concept
id: BLK-c57d596903f7cb47
summary: # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...").
digest: eb374ce4185658cd761020ceb5b236192ad4e4298b40667bc588fdcfce646eb1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...")..
vector_summary: # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...").
chapter: CH-05
:::
# Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...")
:::

::: concept
id: BLK-e5d2cae50c0adf8e
summary: # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello".
digest: 2613244dd6091aa534b694187a451ba3c6b90e06fed17ef197cd4f4fde861a33
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello"..
vector_summary: # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello".
chapter: CH-05
:::
# Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello"
:::

::: concept
id: BLK-773b97e3f4d9044f
summary: # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value.
digest: 1ca56d1b4d5ab1bc864b1a891931090f1e53c4f20c56414d49aa079c7044f80b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value..
vector_summary: # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value.
chapter: CH-05
:::
# JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value
:::

::: concept
id: BLK-7f1aa0c4b22de975
summary: # YAML yaml.marshal(x) yaml.unmarshal(yaml_str).
digest: 9d17a5bf5cebcb21ac9460490a7402b8bff03cc77c82efd08f981b7b25733d17
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # YAML yaml.marshal(x) yaml.unmarshal(yaml_str)..
vector_summary: # YAML yaml.marshal(x) yaml.unmarshal(yaml_str).
chapter: CH-05
:::
# YAML yaml.marshal(x) yaml.unmarshal(yaml_str)
:::

::: concept
id: BLK-f25b0aaead0e1ce8
summary: # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1".
digest: 6fb8378601fa47b86ac83df8b3cb876433c4452600118a27e07dd2f077dc4ea0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1"..
vector_summary: # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1".
chapter: CH-05
:::
# URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1"
:::

::: concept
id: BLK-3bd110a004054aa9
summary: # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json :...
digest: 83968d95daaf567450b1d067d5aa1ff3ef52f49ba71bc93822f2a748c90bd249
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json :....
vector_summary: # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json :...
chapter: CH-05
:::
# Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json := base64url.decode(payload_b64) claims := json.unmarshal(payload_json)
:::

::: concept
id: BLK-365175335364136d
summary: # Marshal deny messages for logs deny_json := json.marshal(deny_msgs).
digest: 0de3e944cb5914e2276740e22bec6ce1c0dc498a1882643a2dfebd4ab6af1443
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Marshal deny messages for logs deny_json := json.marshal(deny_msgs)..
vector_summary: # Marshal deny messages for logs deny_json := json.marshal(deny_msgs).
chapter: CH-05
:::
# Marshal deny messages for logs deny_json := json.marshal(deny_msgs)
:::

::: concept
id: BLK-393080aa0cc18d4b
summary: 6.12 Type Introspection.
digest: c8f014b6c50514fc20c7256ab32cfcc7a80ccf730d1bb20014a2959b4bcaae68
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.12 Type Introspection..
vector_summary: 6.12 Type Introspection.
graph_neighbors: [CODE-fa97df2a115ae029]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
6.12 Type Introspection
:::

::: concept
id: BLK-f590cb8820f569fa
summary: Type predicates and type_name are invaluable for robust policies:.
digest: 0ca48671eba7412df630e5fae27e7c044ef4f58bbad57cb49145e57bdbf80f80
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Type predicates and type_name are invaluable for robust policies:..
vector_summary: Type predicates and type_name are invaluable for robust policies:.
chapter: CH-05
:::
Type predicates and type_name are invaluable for robust policies:
:::

::: concept
id: BLK-74c7bb9f41c91813
summary: Is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", ...
digest: 79e5e302837d873016f05cd74e345d61160b83d6d392e9ffc0ed73fcc3627c26
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", ....
vector_summary: Is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", ...
chapter: CH-05
:::
is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", "null", "boolean"
:::

::: concept
id: BLK-26988fbc99af1428
summary: Pattern: Defensive guards before deeper logic:.
digest: a383e99a8ee764b3a96d47011a234da5c31e1228eb3d73e74f0fe32b2ccbf4f0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pattern: Defensive guards before deeper logic:..
vector_summary: Pattern: Defensive guards before deeper logic:.
chapter: CH-05
:::
Pattern: Defensive guards before deeper logic:
:::

::: concept
id: BLK-3e50cfb0dfea9e5b
summary: Valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) }.
digest: 19e612a887dc3cb19835218daac37fe78eee422b5398b1cb05ca98b8937c9924
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) }..
vector_summary: Valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) }.
chapter: CH-05
:::
valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) }
:::

::: concept
id: BLK-fe1e428678f12304
summary: Input Safety Best Practices:.
digest: 8a94ad86c46f5578011ff88c96ef82cc251eeae1c5ce39d88c59a260f9c46cd2
symbol_refs: [Input Safety Best Practices:]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Input Safety Best Practices:..
vector_summary: Input Safety Best Practices:.
chapter: CH-05
:::
**Input Safety Best Practices:**
:::

::: concept
id: BLK-9931b529da7c6226
summary: 6.13 Cryptography & Security Built-ins.
digest: 53d7d4fe5477ab58bd17c8807576c95ade736fdf8908285ce4d9879bc35e9c16
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.13 Cryptography & Security Built-ins..
vector_summary: 6.13 Cryptography & Security Built-ins.
chapter: CH-05
:::
6.13 Cryptography & Security Built-ins
:::

::: concept
id: BLK-7ad70344cf0fd579
summary: Security-sensitive policies rely heavily on crypto built-ins.
digest: bc9dec89424675ec47966bcd762811ff08863349d93a1e9734495cd30584fda5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Security-sensitive policies rely heavily on crypto built-ins..
vector_summary: Security-sensitive policies rely heavily on crypto built-ins.
chapter: CH-05
:::
Security-sensitive policies rely heavily on crypto built-ins.
:::

::: concept
id: BLK-e82692da642da4e6
summary: Hash functions & HMAC:.
digest: adc5f11648de1d22765e4eec3059839d2b3544819c15e692bedc1b6b541f4fcc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Hash functions & HMAC:..
vector_summary: Hash functions & HMAC:.
chapter: CH-05
:::
Hash functions & HMAC:
:::

::: concept
id: BLK-07cc51248e326726
summary: Crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data).
digest: 7a4d80b94b39da6c5fcf25479bb5f75a92c94d1753db0b334aacbc4ff8a969fc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data)..
vector_summary: Crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data).
chapter: CH-05
:::
crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data)
:::

::: concept
id: BLK-0c4673919ffeab0f
summary: Key-derivation & password hashing:.
digest: 708949db0642797837dfb4f4f517f89d228bb1260658d103413c27d78fd3d34b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Key-derivation & password hashing:..
vector_summary: Key-derivation & password hashing:.
chapter: CH-05
:::
Key-derivation & password hashing:
:::

::: concept
id: BLK-760d822b72ca8385
summary: Crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password).
digest: ccb809d67640588bde06af1bc4fcd9bc161c0bf3b85af5bf9043cf0ed8b90b7f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password)..
vector_summary: Crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password).
chapter: CH-05
:::
crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password)
:::

::: concept
id: BLK-38e55e81ea44e29b
summary: X.509 and certificates:.
digest: eed5212e744ce5107f24f85c29a61836653b6af095548dded7f2493ad6c767f7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that X.509 and certificates:..
vector_summary: X.509 and certificates:.
chapter: CH-05
:::
X.509 and certificates:
:::

::: concept
id: BLK-92df017ca6dd0a84
summary: Crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs.
digest: e989cacb1e424f562bf992230d4c54e358c2be268a35c7a6f976bcb6ec834efa
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs..
semantic_categories: [distribution]
vector_summary: Crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs.
chapter: CH-05
:::
crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs
:::

::: concept
id: BLK-bca085b327a54593
summary: JWT helpers (in io.jwt namespace):.
digest: 18034f893532e5690667a25f6e5a20686da6b5b4f7c5646958aa6ae07f579025
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that JWT helpers (in io.jwt namespace):..
vector_summary: JWT helpers (in io.jwt namespace):.
chapter: CH-05
:::
JWT helpers (in io.jwt namespace):
:::

::: concept
id: BLK-c51a72be2c4f7943
summary: Io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt....
digest: 7fbd76a3e471e75006982747ae8bed6b3a6026e75116ca8f1b18000935c720a7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt.....
vector_summary: Io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt....
chapter: CH-05
:::
io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt.verify_es256(token, cert) io.jwt.verify_ps256(token, cert) io.jwt.encode_sign_raw(headers, payload, key)
:::

::: concept
id: BLK-9c235109ac4fb55a
summary: Valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) }.
digest: 5b32cd3a0867df9a5060b4268b428dcfaec58edd4794d19f3f0ac5ef17a20e2c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) }..
vector_summary: Valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) }.
chapter: CH-05
:::
valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) }
:::

::: concept
id: BLK-79d62f89dc8c2bbe
summary: Deny[msg] if { not valid_token msg := "Invalid JWT" }.
digest: 6f6242d580cb8c2c178d8e9eaa98919e5e3e2a7aec22deca5742348ae8022497
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { not valid_token msg := "Invalid JWT" }..
vector_summary: Deny[msg] if { not valid_token msg := "Invalid JWT" }.
chapter: CH-05
:::
deny[msg] if { not valid_token msg := "Invalid JWT" }
:::

::: concept
id: BLK-381855197c8a3986
summary: Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints).
digest: 80a182386c556961ea59ab35dfb20958c507d2fb1b52ceed112d9497ffbb5ed6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints)..
vector_summary: Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints).
chapter: CH-05
:::
Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints).
:::

::: concept
id: BLK-cb82c0a969ee513d
summary: 6.4 Arrays & array.concat.
digest: 55c7e7b640f3bbd9a58bc5d89d9f5b53756210b1d5a694bcff9171ad1ba3df22
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.4 Arrays & array.concat..
vector_summary: 6.4 Arrays & array.concat.
chapter: CH-05
:::
6.4 Arrays & array.concat
:::

::: concept
id: BLK-492775404d6858a1
summary: Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc.
digest: daf818768b59abad25fa4adb3b0ebb5792a9e63e46f8517a6de5e69e175250f4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc..
vector_summary: Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc.
chapter: CH-05
:::
Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc.
:::

::: concept
id: BLK-803815e4948a9134
summary: Count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays.
digest: 46e6fef5f3482801920054c64f0073a3993e714749713a7fdac231d9bbeaa307
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays..
vector_summary: Count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays.
chapter: CH-05
:::
count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays
:::

::: concept
id: BLK-6d905df2ae0be4ca
summary: Array.concat([1, 2], [3]) # => [1, 2, 3].
digest: 53b164458734dec0ec6e442bc5567c0366ed0e94264dc41ca8bf5c898b07b585
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Array.concat([1, 2], [3]) # => [1, 2, 3]..
vector_summary: Array.concat([1, 2], [3]) # => [1, 2, 3].
chapter: CH-05
:::
array.concat([1, 2], [3]) # => [1, 2, 3]
:::

::: concept
id: BLK-95bea7dff21c1179
summary: For defensive code, wrap it:.
digest: 252b1bf130a501eea89773d648bd888bdb34bee93ad9e97a17875449a40d5d54
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For defensive code, wrap it:..
vector_summary: For defensive code, wrap it:.
chapter: CH-05
:::
For defensive code, wrap it:
:::

::: concept
id: BLK-01eb9f65fbee8e12
summary: Safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }.
digest: 9e7a6658972fadb72ba0486fcdde7d3bc76780938e16a80cd5610f1f85ece851
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }..
vector_summary: Safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }.
chapter: CH-05
:::
safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }
:::

::: concept
id: BLK-5970ca9ef37640be
summary: Use safe_concat in paths or pipelines where inputs may be missing or partially null.
digest: 337ad44290fc6bea6d184384c8db5eb884a9088c9acb553171d81bce55468393
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use safe_concat in paths or pipelines where inputs may be missing or partially null..
vector_summary: Use safe_concat in paths or pipelines where inputs may be missing or partially null.
chapter: CH-05
:::
Use safe_concat in paths or pipelines where inputs may be missing or partially null.
:::

::: concept
id: BLK-03437db7242e9e11
summary: Time Functions (No time.diff).
digest: 3ac12bdc08553ad2001cee924b99d8af96ed9c3bf357b1f27c56a211762e5ce9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Time Functions (No time.diff)..
vector_summary: Time Functions (No time.diff).
chapter: CH-05
:::
Time Functions (No time.diff)
:::

::: concept
id: BLK-323678c5fae3b216
summary: Time built-ins revolve around:.
digest: 9edd994746e1b5c8d3182d22801260290fa185fe4ed27beca91d78285d53ebb6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Time built-ins revolve around:..
vector_summary: Time built-ins revolve around:.
chapter: CH-05
:::
Time built-ins revolve around:
:::

::: concept
id: BLK-36093a3541d6fac4
summary: Getting the current time (time.now_ns).
digest: 51469e926b7784e7be770b985d7122c61fb2dbd9dbc7613081e4986ed244af1d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Getting the current time (time.now_ns)..
vector_summary: Getting the current time (time.now_ns).
chapter: CH-05
:::
Getting the current time (time.now_ns)
:::

::: concept
id: BLK-9f58a11b445194e4
summary: Parsing timestamps (time.parse_rfc3339_ns).
digest: 5e7cdcceea4aebcee8b30b6d627f29112c1bb20790cbf5aa4702094c48a9b055
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Parsing timestamps (time.parse_rfc3339_ns)..
vector_summary: Parsing timestamps (time.parse_rfc3339_ns).
chapter: CH-05
:::
Parsing timestamps (time.parse_rfc3339_ns)
:::

::: concept
id: BLK-98d4acbef290299c
summary: Formatting (time.format, etc.).
digest: a6585ef4752cd903bece6a2e224454d0636fdcd1489e1c574d214d69735d9a60
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Formatting (time.format, etc.)..
vector_summary: Formatting (time.format, etc.).
chapter: CH-05
:::
Formatting (time.format, etc.)
:::

::: concept
id: BLK-4b147b9e016ab307
summary: Example of computing a duration:.
digest: 1bafbcb200a100416bb600ff3f16157b2a39d850e2b674258b81457b88870cc9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Example of computing a duration:..
vector_summary: Example of computing a duration:.
chapter: CH-05
:::
Example of computing a duration:
:::

::: concept
id: BLK-5110d5b6e76c6c72
summary: Now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end).
digest: d3814664011b3a50fb25bf8c9fb6e45e16e9bb5004a2ae58688d4d1507ebe632
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end)..
vector_summary: Now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end).
chapter: CH-05
:::
now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end)
:::

::: concept
id: BLK-4f8b95221334c8fd
summary: Duration_ns := end - start.
digest: 7157b2197fe7538455ef0406d65e6b67854b775134a5d57b7e4c5a11116d5579
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Duration_ns := end - start..
vector_summary: Duration_ns := end - start.
chapter: CH-05
:::
duration_ns := end - start
:::

::: concept
id: BLK-b93a0cab2b781de4
summary: Too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes }.
digest: ef87d227b8fd5aa1cce8f7b65e8d69e5759c65d89c06dedceca518bc4992b177
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes }..
vector_summary: Too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes }.
chapter: CH-05
:::
too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes }
:::

::: concept
id: BLK-17b123b1fff6830e
summary: Differences are computed with normal arithmetic on integer nanosecond timestamps:.
digest: 31b2f857525f84a9505e122629243e5fa1e66f477f51773fdc3a75517b86f101
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Differences are computed with normal arithmetic on integer nanosecond timestamps:..
vector_summary: Differences are computed with normal arithmetic on integer nanosecond timestamps:.
chapter: CH-05
:::
Differences are computed with normal arithmetic on integer nanosecond timestamps:
:::

::: concept
id: BLK-9f8bb9e36136d01a
summary: Duration_ns := end_ns - start_ns.
digest: fda62d00144038ae673bb27eaa5c842eb69e17ff376fb58f97728f3ac4432050
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Duration_ns := end_ns - start_ns..
vector_summary: Duration_ns := end_ns - start_ns.
chapter: CH-05
:::
duration_ns := end_ns - start_ns.
:::

::: concept
id: BLK-91a7da1dc4599199
summary: This approach works consistently across CLI, server, and WASM runtime.
digest: 4b2e2e5b969660db99c870d99ad137ec6942f567bb5283f61eba023b7b501176
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This approach works consistently across CLI, server, and WASM runtime..
vector_summary: This approach works consistently across CLI, server, and WASM runtime.
chapter: CH-05
:::
This approach works consistently across CLI, server, and WASM runtime.
:::

::: concept
id: BLK-aced02aaabc583d3
summary: Http.send allows policies to call external services.
digest: 8c8b77366211f848b2877f77ede545e262927f1e68f3764f45257b742ab4c328
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Http.send allows policies to call external services..
vector_summary: Http.send allows policies to call external services.
chapter: CH-05
:::
http.send allows policies to call external services. Use with discipline.
:::

::: concept
id: BLK-7e8468a95010fff3
summary: Resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optio...
digest: 56371c1aeb8a2abd7fb8653367ce292e4c85524fc1a76fbc4c61a5e0de5078c4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optio....
vector_summary: Resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optio...
chapter: CH-05
:::
resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optional, string with units })
:::

::: concept
id: BLK-0c67765085ae094c
summary: # resp = {"status": 200, "body": ..., "headers": {...}}.
digest: 41c67655dcc5485fc94bd242a0e292046aaf415f94232dd02f8493a547621a13
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # resp = {"status": 200, "body": ..., "headers": {...}}..
vector_summary: # resp = {"status": 200, "body": ..., "headers": {...}}.
chapter: CH-05
:::
# resp = {"status": 200, "body": ..., "headers": {...}}
:::

::: concept
id: BLK-c7e05fd3fbe19ba7
summary: Potentially slow and side-effectful.
digest: d51de9d42431c9d6728cee8bdb11941db02b5bc2c467800571fd9092b3302599
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Potentially slow and side-effectful..
vector_summary: Potentially slow and side-effectful.
chapter: CH-05
:::
Potentially slow and side-effectful.
:::

::: concept
id: BLK-1d62064b846fefe8
summary: Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query.
digest: 60256c3d37bf740db90a539a9ea2680b2385f45e84c80baf2098a94634a7119b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query..
vector_summary: Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query.
:::

::: concept
id: BLK-1f0979248041848f
summary: Prefer to fetch external data ahead of time and feed via data or input.
digest: 21cc3f0c41531d39facaa589c14402c9af7980ef39fc79818519da48a2064552
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Prefer to fetch external data ahead of time and feed via data or input..
vector_summary: Prefer to fetch external data ahead of time and feed via data or input.
chapter: CH-05
:::
Prefer to fetch external data ahead of time and feed via data or input.
:::

::: concept
id: BLK-4f352c6a1c6b58e9
summary: In CI or admission controllers, avoid http.send altogether if possible.
digest: 6a47fa246de8283107cd12db22091381b902e6698f8588258aa72fbb6f439281
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In CI or admission controllers, avoid http.send altogether if possible..
vector_summary: In CI or admission controllers, avoid http.send altogether if possible.
chapter: CH-05
:::
In CI or admission controllers, avoid http.send altogether if possible.
:::

::: concept
id: BLK-0275e80b2c04c6f4
summary: 6.16 Network & CIDR Built-ins.
digest: f9afc6e2fa95f11e62bab741670fa8e57f586184f14037fee2036764a14862c5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.16 Network & CIDR Built-ins..
vector_summary: 6.16 Network & CIDR Built-ins.
chapter: CH-05
:::
6.16 Network & CIDR Built-ins
:::

::: concept
id: BLK-52d1864741c9bdce
summary: Networking helpers are invaluable for Kubernetes and cloud policies.
digest: dfc8757ba4591362f993e6fc0a3a799a26809127ef7e11c09a8882a233c7c5da
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Networking helpers are invaluable for Kubernetes and cloud policies..
vector_summary: Networking helpers are invaluable for Kubernetes and cloud policies.
chapter: CH-05
:::
Networking helpers are invaluable for Kubernetes and cloud policies.
:::

::: concept
id: BLK-d809a65103391f7e
summary: Net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_...
digest: 4a16c1f1007188327236dd3b57d70e7f04d4bfd05f9c3fcfeb857296599fbdcc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_....
vector_summary: Net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_...
chapter: CH-05
:::
net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_merge(cidr_list) # merge overlapping ranges
:::

::: concept
id: BLK-44848643a647fa46
summary: Deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" }.
digest: bfaf8304af4d1c87d3b242753c4c976df34277495dc0981d3575268dd87b268d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" }..
vector_summary: Deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" }.
chapter: CH-05
:::
deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" }
:::

::: concept
id: BLK-da20c90c9d182979
summary: 6.17 UUID & ULID Generation.
digest: c6ce192feba7c5000ea9bf3884f31b96ade36cddd412580f90a6aa81f85b784e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.17 UUID & ULID Generation..
vector_summary: 6.17 UUID & ULID Generation.
chapter: CH-05
:::
6.17 UUID & ULID Generation
:::

::: concept
id: BLK-fd859354759e8d82
summary: Some deployments expose helpers in the standard library or via plugins.
digest: a75a13134543994b970956b1f31c6697525b2716b7419eb9655efa3f8299a7d6
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some deployments expose helpers in the standard library or via plugins..
vector_summary: Some deployments expose helpers in the standard library or via plugins.
chapter: CH-05
:::
Some deployments expose helpers in the standard library or via plugins. Common patterns:
:::

::: concept
id: BLK-eebd69b192e04b25
summary: Uuid := uuid.rfc4122(seed) ulid := ulid.generate().
digest: d624325399d959a38a7a5de21fa0ce2708061cc65acfd14778ae806d04e68e17
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Uuid := uuid.rfc4122(seed) ulid := ulid.generate()..
vector_summary: Uuid := uuid.rfc4122(seed) ulid := ulid.generate().
chapter: CH-05
:::
uuid := uuid.rfc4122(seed) ulid := ulid.generate()
:::

::: concept
id: BLK-22cafa7883ad8583
summary: Deterministic for a given string seed.
digest: 8240e35721323cc38801a70975fccb15444467e41e491c4200b00a5afccd345f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deterministic for a given string seed..
vector_summary: Deterministic for a given string seed.
chapter: CH-05
:::
Deterministic for a given string seed.
:::

::: concept
id: BLK-9e2b48aeaea0a3b0
summary: Ideal for tests where you want stable IDs.
digest: f9b3d16a51a5921a506711945f2d14f62030e2beb021a1280080ddf1bc019bfa
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Ideal for tests where you want stable IDs..
vector_summary: Ideal for tests where you want stable IDs.
chapter: CH-05
:::
Ideal for tests where you want stable IDs.
:::

::: concept
id: BLK-088670189c3d74cf
summary: Time-based and non-deterministic.
digest: 19cb316c4ab7890f3fb146ae20161c63a437d723a6c3a004e351ca5c14e4d0e6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Time-based and non-deterministic..
vector_summary: Time-based and non-deterministic.
chapter: CH-05
:::
Time-based and non-deterministic.
:::

::: concept
id: BLK-3bd9a709d1537f2e
summary: Great for production identifiers, but brittle in tests.
digest: b51da24378ab56d15c6d9a94f096c505c46ac9488bcef5dce53377d772fc860c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Great for production identifiers, but brittle in tests..
vector_summary: Great for production identifiers, but brittle in tests.
chapter: CH-05
:::
Great for production identifiers, but brittle in tests.
:::

::: concept
id: BLK-dabc7897b0693fc8
summary: Testing recommendations:.
digest: 21481ce531c5ee38b504da7f8fb382bcc788c424ab26ac3100d4f17933cf89e4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Testing recommendations:..
semantic_categories: [testing]
vector_summary: Testing recommendations:.
graph_neighbors: [CODE-efd78ba9916ca447, CODE-031e381b7120fc25, CODE-8ac93f8eb365af28, CODE-141a39bba2be1ded, CODE-213aa0a6ee07643a]
graph_degree: 5
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Testing recommendations:
:::

::: concept
id: BLK-170f2a1e591e04fa
summary: # Stable UUID in tests test_id := uuid.rfc4122("test-seed-123").
digest: a44d966ca50fc35ee98920285f7123dcd9cacb893a70b33108ec0971838e07d2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Stable UUID in tests test_id := uuid.rfc4122("test-seed-123")..
vector_summary: # Stable UUID in tests test_id := uuid.rfc4122("test-seed-123").
chapter: CH-05
:::
# Stable UUID in tests test_id := uuid.rfc4122("test-seed-123")
:::

::: concept
id: BLK-a04d8dafcc0fa4ec
summary: # - mock it with: with ulid.generate as "fixed-ulid".
digest: 8e0a6cf65434576c662dc58a24ce8a0f3c687a86a9eae3e590eff8d3d5633b7c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # - mock it with: with ulid.generate as "fixed-ulid"..
vector_summary: # - mock it with: with ulid.generate as "fixed-ulid".
chapter: CH-05
:::
# - mock it with: with ulid.generate as "fixed-ulid"
:::

::: concept
id: BLK-8c0b2ddbd669fce8
summary: # - or only check that a ULID exists / matches a regex, not its exact value.
digest: 1d2ac2015e928dcb644356c49dd66d0ba897799ca97ec56a8a09507505eb54f0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # - or only check that a ULID exists / matches a regex, not its exact value..
vector_summary: # - or only check that a ULID exists / matches a regex, not its exact value.
chapter: CH-05
:::
# - or only check that a ULID exists / matches a regex, not its exact value
:::

::: concept
id: BLK-25b1b7cd937cb1b3
summary: 6.18 Graph & Structural Walks.
digest: 457e07f6a43a792653ab46abcfd69b432e5484589d221ea70589f1d9e85743ac
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.18 Graph & Structural Walks..
vector_summary: 6.18 Graph & Structural Walks.
chapter: CH-05
:::
6.18 Graph & Structural Walks
:::

::: concept
id: BLK-5893372fbb305323
summary: Graph.* functions operate on graph structures (represented as adjacency lists).
digest: 3a530638838eaf92ca4c1c0875132d0d074676d4164d609ef9bad08cff207035
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Graph.* functions operate on graph structures (represented as adjacency lists)..
vector_summary: Graph.* functions operate on graph structures (represented as adjacency lists).
chapter: CH-05
:::
graph.* functions operate on graph structures (represented as adjacency lists).
:::

::: concept
id: BLK-40bcf556b793fb46
summary: Graph.reachable(graph, ["start"]) # list of reachable nodes.
digest: 9338f43eadcc1ab2b2fc847645c9f96d911b096ef30e5b7f89a0c3a8aa8aa56b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Graph.reachable(graph, ["start"]) # list of reachable nodes..
vector_summary: Graph.reachable(graph, ["start"]) # list of reachable nodes.
chapter: CH-05
:::
graph.reachable(graph, ["start"]) # list of reachable nodes
:::

::: concept
id: BLK-a50a80fdc1c25566
summary: Walk(x) traverses nested structures and returns [path, value] pairs:.
digest: b0937fa6a915cb027d9049b3a6c605b4ac669eb73d7f1979c1e6e22dcfb3ed91
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Walk(x) traverses nested structures and returns [path, value] pairs:..
vector_summary: Walk(x) traverses nested structures and returns [path, value] pairs:.
chapter: CH-05
:::
walk(x) traverses nested structures and returns [path, value] pairs:
:::

::: concept
id: BLK-92e3fc7d804a2808
summary: Pairs := walk(input).
digest: 2fa7fe34f8142429d4004c40e61e0ebafc3d86e0bd130c5dc11efa6e0d29c965
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pairs := walk(input)..
vector_summary: Pairs := walk(input).
chapter: CH-05
:::
pairs := walk(input)
:::

::: concept
id: BLK-7bf0cd27ee7a741b
summary: # pairs is [[["path","to","value"], value], ...].
digest: 4a568fd3e45068e4f03b9cc0c04a6e446c8857e3dad77dfadcba79cc820864c7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # pairs is [[["path","to","value"], value], ...]..
vector_summary: # pairs is [[["path","to","value"], value], ...].
chapter: CH-05
:::
# pairs is [[["path","to","value"], value], ...]
:::

::: concept
id: BLK-bf0bc41d6b2d1316
summary: # Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" }.
digest: 13a0facb14c5c8432c4cac2d1dcf6d3ca364353f7e7e27eb50dd8342920b13b2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" }..
vector_summary: # Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" }.
chapter: CH-05
:::
# Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" }
:::

::: concept
id: BLK-c8affe0478937bf0
summary: 6.19 Units & Parsing.
digest: 82f84d402679dba7818692177f8d9e237b9e430509b5e7deae83cc8b10825211
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.19 Units & Parsing..
vector_summary: 6.19 Units & Parsing.
chapter: CH-05
:::
6.19 Units & Parsing
:::

::: concept
id: BLK-b205c1c7c5b4d6cf
summary: For human-friendly sizes or durations:.
digest: 989338814271fdd1dc2e2f44f950f41a85c5d97217a767430166107505d1e6e1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For human-friendly sizes or durations:..
vector_summary: For human-friendly sizes or durations:.
chapter: CH-05
:::
For human-friendly sizes or durations:
:::

::: concept
id: BLK-6ff4f186b7b2630a
summary: Units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant.
digest: 1ba0ff0e1c248f45710ee41d48f84f8e4244d7c4c74a8592d4f8505d18953a95
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant..
vector_summary: Units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant.
chapter: CH-05
:::
units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant
:::

::: concept
id: BLK-af94401090888bac
summary: Useful for policies over resource limits:.
digest: 95f3f3dd9a5b5446db8113cbdc6e81b2035cdf92094da2f0106e70592504294d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Useful for policies over resource limits:..
vector_summary: Useful for policies over resource limits:.
chapter: CH-05
:::
Useful for policies over resource limits:
:::

::: concept
id: BLK-3b7e4e77e5997407
summary: Deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi...
digest: 79c47a2fc2a65cea753eca71547178c9ce8385106a4c8ae2038decb1d85cf10e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi....
vector_summary: Deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi...
chapter: CH-05
:::
deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi" }
:::

::: concept
id: BLK-37ac9c46cd3b8691
summary: 6.20 Metadata & Annotations.
digest: 402dcd400880c35b37d5bc21c0c3232b10714705d3b4d9b3642a8c4dcc80adda
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.20 Metadata & Annotations..
vector_summary: 6.20 Metadata & Annotations.
chapter: CH-05
:::
6.20 Metadata & Annotations
:::

::: concept
id: BLK-42bca06a919a5ae8
summary: Drive governance features (e.g., map violations back to policy owners).
digest: b56657e172a56d5069f1f12e381ef96c8d6c4ecf28c52bd34203ce7f9033ab0a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Drive governance features (e.g., map violations back to policy owners)..
vector_summary: Drive governance features (e.g., map violations back to policy owners).
chapter: CH-05
:::
Drive governance features (e.g., map violations back to policy owners).
:::

::: concept
id: BLK-89b0fd99072a7ad9
summary: 6.21 Debugging Built-ins: print and trace.
digest: be0eee97166378f60c5f6d39d57a9f83e24b6d6cbe7801b39a04156ffee1e5d2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.21 Debugging Built-ins: print and trace..
vector_summary: 6.21 Debugging Built-ins: print and trace.
chapter: CH-05
:::
6.21 Debugging Built-ins: print and trace
:::

::: concept
id: BLK-fb39667760c12b4c
summary: Print(...) always returns true, so it does not change logical semantics.
digest: cb776a73a12d1abefd255a53c3ff801faca5a475904783abd8a3d646da96ec6e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Print(...) always returns true, so it does not change logical semantics..
vector_summary: Print(...) always returns true, so it does not change logical semantics.
chapter: CH-05
:::
print(...) always returns true, so it does not change logical semantics.
:::

::: concept
id: BLK-e1788d332fd4b6ad
summary: Trace may also be available as an alias in some environments; print is the standard.
digest: b38b3b925f78094720397bf8d524365ac80a0bc71331b70f303726246964b127
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Trace may also be available as an alias in some environments; print is the standard..
vector_summary: Trace may also be available as an alias in some environments; print is the standard.
chapter: CH-05
:::
trace may also be available as an alias in some environments; print is the standard.
:::

::: concept
id: BLK-abf7fb28b77ba86b
summary: Use print liberally during development and experiments.
digest: 4180a2b7410f5bbc16aa2a6cfa8910ef604d9acb4c7792af7f78d2e188fbdf93
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use print liberally during development and experiments..
vector_summary: Use print liberally during development and experiments.
chapter: CH-05
:::
Use print liberally during development and experiments.
:::

::: concept
id: BLK-e61c1e6a7ef98607
summary: Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod).
digest: 51e951de56c495ceac91a2788a13161f4c2965f6bff59df1bcc3ae6ea679fc94
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod)..
vector_summary: Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod).
chapter: CH-05
:::
Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod).
:::

::: concept
id: BLK-9de1de98fdc727e3
summary: 6.22 Error Semantics & Strict Mode.
digest: 635d4447db1744b724c9020672b2c09239dd545bee0881f251724dac94254f3b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.22 Error Semantics & Strict Mode..
vector_summary: 6.22 Error Semantics & Strict Mode.
chapter: CH-05
:::
6.22 Error Semantics & Strict Mode
:::

::: concept
id: BLK-98bcb77cc1ac5811
summary: By default, built-in errors make expressions undefined:.
digest: dabc15f4cb6ff4ac6b33a4c4066d4105caa68a74b90b6413226c72137e382e59
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that By default, built-in errors make expressions undefined:..
vector_summary: By default, built-in errors make expressions undefined:.
chapter: CH-05
:::
By default, built-in errors make expressions undefined:
:::

::: concept
id: BLK-8cc9eedcab25fd2b
summary: For higher assurance, strict builtin errors convert such errors into hard failures:.
digest: 62ffa3cc87a53f33c0703cc7970ef73566f895ff95787f138dbc685d6679891b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For higher assurance, strict builtin errors convert such errors into hard failures:..
vector_summary: For higher assurance, strict builtin errors convert such errors into hard failures:.
chapter: CH-05
:::
For higher assurance, strict builtin errors convert such errors into hard failures:
:::

::: concept
id: BLK-629475ec5c0d3bfb
summary: HTTP API: strict-builtin-errors=true query parameter.
digest: 7ea50fbb7044110acd064fc083069b7538a4de2aeac274f77fb770803c753641
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that HTTP API: strict-builtin-errors=true query parameter..
vector_summary: HTTP API: strict-builtin-errors=true query parameter.
chapter: CH-05
:::
HTTP API: strict-builtin-errors=true query parameter.
:::

::: concept
id: BLK-93ad46a2fdd8ff11
summary: In CI to catch unexpected type mismatches and invalid data.
digest: d2a77a33e47f5c138ec082a5926f96891537939278f98df58b9f35dfa0d51c95
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In CI to catch unexpected type mismatches and invalid data..
vector_summary: In CI to catch unexpected type mismatches and invalid data.
chapter: CH-05
:::
In CI to catch unexpected type mismatches and invalid data.
:::

::: concept
id: BLK-557953aa35227612
summary: In critical policies where silent undefined behavior is unacceptable.
digest: 15f1a0a0251640ccc8179c923be1c5f97c3472284cf25f709577f27f62e592b7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In critical policies where silent undefined behavior is unacceptable..
vector_summary: In critical policies where silent undefined behavior is unacceptable.
chapter: CH-05
:::
In critical policies where silent undefined behavior is unacceptable.
:::

::: concept
id: BLK-22b57961d600fe2f
summary: Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
digest: 6b9303b921147f9a3f063da6001b64a8cc50f6afdc57511370eccf25fbc6bb69
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture..
vector_summary: Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
chapter: CH-05
:::
Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
:::

::: concept
id: BLK-f3b1c72ce3eb55c9
summary: 6.23 Performance Patterns with Built-ins.
digest: c1f703d785d0c8285ce674c5a54c57a7661063e3042229262b0dc8ec6e24535e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.23 Performance Patterns with Built-ins..
vector_summary: 6.23 Performance Patterns with Built-ins.
chapter: CH-05
:::
6.23 Performance Patterns with Built-ins
:::

::: concept
id: BLK-52537d28f7f19d80
summary: Guard expensive built-ins with cheap checks.
digest: 032e4a0ea6e573e0525f6c339f875920f412fd3dafba736e99e37a59af434779
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Guard expensive built-ins with cheap checks..
vector_summary: Guard expensive built-ins with cheap checks.
chapter: CH-05
:::
Guard expensive built-ins with cheap checks
:::

::: concept
id: BLK-2a74bde34951ff9b
summary: # Good: fast predicate first deny if { input.method == "POST" regex.match((?i)password, input.body) }.
digest: ac4cfbf773f0a3d99cca5f2484ba0b235393bea17ce173cb0aac7963be28d853
symbol_refs: [(?i)password]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Good: fast predicate first deny if { input.method == "POST" regex.match((?i)password, input.body) }..
vector_summary: # Good: fast predicate first deny if { input.method == "POST" regex.match((?i)password, input.body) }.
chapter: CH-05
:::
# Good: fast predicate first deny if { input.method == "POST" regex.match(`(?i)password`, input.body) }
:::

::: concept
id: BLK-85e73235529b5c88
summary: Avoid large intermediate arrays via comprehensions if a boolean will do.
digest: 01132c449fb30f43d5db9bdbc45ea3ed10db4b01be777040b920f29a989c1a4a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Avoid large intermediate arrays via comprehensions if a boolean will do..
vector_summary: Avoid large intermediate arrays via comprehensions if a boolean will do.
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Avoid large intermediate arrays via comprehensions if a boolean will do
:::

::: concept
id: BLK-c6e81d159f73459d
summary: # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0.
digest: c1352ade30b117a51bb43abb00d78378b4d5ae32569e629320599c70bcab9b07
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0..
vector_summary: # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0.
chapter: CH-05
:::
# Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0
:::

::: concept
id: BLK-8237d2a05c87c232
summary: # Good has_admin if { some u in users "admin" in u.roles }.
digest: 27d842462ccca01eb7a8f17a4584aaf0b7f7e2510a1eb50e940859a932786ac9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Good has_admin if { some u in users "admin" in u.roles }..
vector_summary: # Good has_admin if { some u in users "admin" in u.roles }.
chapter: CH-05
:::
# Good has_admin if { some u in users "admin" in u.roles }
:::

::: concept
id: BLK-c15df4c67851208d
summary: Use sets for membership, arrays for ordered sequences.
digest: 58caa27a0a73db5861444a9628621a760ec17f65826c48e9c1b28ac1107d6107
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use sets for membership, arrays for ordered sequences..
vector_summary: Use sets for membership, arrays for ordered sequences.
chapter: CH-05
:::
Use sets for membership, arrays for ordered sequences
:::

::: concept
id: BLK-62c2e97c399eb38b
summary: Memoization awareness.
digest: fbc18f7834dc7e92038c03f6ea719bfdccb01e55e528741fc1052cee604ced46
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Memoization awareness..
vector_summary: Memoization awareness.
chapter: CH-05
:::
Memoization awareness
:::

::: concept
id: BLK-a6bde4c24ae6370c
summary: Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached.
digest: bf8ad31e158a1d29eba66c6306f93f443e0e810ae4856f023d9d07d6d1c2f2de
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached..
vector_summary: Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached.
chapter: CH-05
:::
Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached.
:::

::: concept
id: BLK-25cc50c2bf8d6039
summary: If inputs differ slightly each time, caching may not help; consider pre-processing.
digest: fa6b1d88baff63c21187f2f5fb30ccb4bdd363e996cd27a20507e92767a77367
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If inputs differ slightly each time, caching may not help; consider pre-processing..
vector_summary: If inputs differ slightly each time, caching may not help; consider pre-processing.
chapter: CH-05
:::
If inputs differ slightly each time, caching may not help; consider pre-processing.
:::

::: concept
id: BLK-f78bd271000af25a
summary: Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks.
digest: a084fffa29408daac8f82444733c3cee460a2ec9e5f993be65cdb608ba702e18
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks..
vector_summary: Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks.
chapter: CH-05
:::
Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks.
:::

::: concept
id: BLK-6d542199f9475a27
summary: Overuse of regex in hot loops will tank performance.
digest: 0663f1e05c5be6e238a201eb01decd2678c8ef423a41932e127c9de442112ee3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Overuse of regex in hot loops will tank performance..
vector_summary: Overuse of regex in hot loops will tank performance.
chapter: CH-05
:::
Overuse of regex in hot loops will tank performance.
:::

::: concept
id: BLK-5851e4a3db9f9ac3
summary: Prefer startswith, endswith, contains, or exact matches when sufficient.
digest: cdf498b8582cc4da924226e6936bbe92c4abf72a93659747e61d966aed84ca62
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Prefer startswith, endswith, contains, or exact matches when sufficient..
vector_summary: Prefer startswith, endswith, contains, or exact matches when sufficient.
chapter: CH-05
:::
Prefer startswith, endswith, contains, or exact matches when sufficient.
:::

::: concept
id: BLK-2467bf0ffb43ccb1
summary: Hidden type conversions:.
digest: 308a968eb989e6d1d181b550e53d4bf6f89f081a9dead90be959bd123ef10048
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Hidden type conversions:..
vector_summary: Hidden type conversions:.
chapter: CH-05
:::
Hidden type conversions:
:::

::: concept
id: BLK-e4f27c62a91903fd
summary: Relying on to_number implicitly instead of checking type leads to brittle policies.
digest: d30890386382102ab25284e664bdca82629ac6c5527e4068dc02da484231976a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Relying on to_number implicitly instead of checking type leads to brittle policies..
vector_summary: Relying on to_number implicitly instead of checking type leads to brittle policies.
chapter: CH-05
:::
Relying on to_number implicitly instead of checking type leads to brittle policies.
:::

::: concept
id: BLK-4510e9e029402fb5
summary: Unbounded http.send usage:.
digest: 02278c4f96dfcc3bc3301260535cd3ecde5b36324a4305c36c2f7121193b5693
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Unbounded http.send usage:..
vector_summary: Unbounded http.send usage:.
chapter: CH-05
:::
Unbounded http.send usage:
:::

::: concept
id: BLK-fe080225bb5195ba
summary: Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths.
digest: a140d22740839d420b9e5e4a911085026e492f609d02e282425b6e84f538847e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths..
semantic_categories: [authz]
vector_summary: Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths.
graph_neighbors: [CODE-f9165857ee2c0c68, CODE-4d2ad0d6df9f48c1, CODE-ae589d488d5196d2, CODE-e3021412b7e801e0, CODE-22a3c940e76c1893, CODE-1f681853ebf733fb, CODE-4b643428b4f2edd0, CODE-e8a2139bac84c4a0, CODE-3152b6a89a146d23, CODE-ff0c5e5c7e41a636, CODE-322fb8a04486fb51]
graph_degree: 11
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths.
:::

::: concept
id: BLK-980b341fb19bb54f
summary: Import data.authz.api.
digest: 948a4bbaf15d659b760b8143d97631a2e78039c0eecc97cf29a1bf9835c7ba7f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.authz.api..
vector_summary: Import data.authz.api.
chapter: CH-05
:::
import data.authz.api
:::

::: concept
id: BLK-aee13c5bae097378
summary: Test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } }.
digest: 9133360bcfa72642013d76c89d866b7fdf7612570a11d8c2bd6124a3270fe0a3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } }..
vector_summary: Test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } }.
chapter: CH-05
:::
test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } }
:::

::: concept
id: BLK-0b8df7beeb5c08e5
summary: Test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"...
digest: 92afc85eeb0ef95d2daf453fe88a6a9d2ee9406d8c5e6fe8365e4e984916e0fd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"....
vector_summary: Test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"...
chapter: CH-05
:::
test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"} } } Running tests
:::

::: concept
id: BLK-ed251b560e4430b0
summary: # in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This...
digest: b96ce283eb277276d5acf44fa3b5922d67fe77f5d8d58a61d93e5109a12ec105
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This....
semantic_categories: [testing]
vector_summary: # in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This...
graph_neighbors: [CODE-efd78ba9916ca447, CODE-031e381b7120fc25, CODE-8ac93f8eb365af28, CODE-141a39bba2be1ded, CODE-213aa0a6ee07643a]
graph_degree: 5
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
# in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This makes your policies deterministic and testable, even when they rely on clocks, network calls, or external data. ________________________________________ 7.3 Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests Testing & Tooling
:::

::: concept
id: BLK-f47d37f0ebabc839
summary: This chapter describes patterns for unit tests, integration tests, and golden tests.
digest: 84a16e831d720d4f04787a83bac6eb8b5084ca8fd89f4c872b38ce7b7137e095
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This chapter describes patterns for unit tests, integration tests, and golden tests..
vector_summary: This chapter describes patterns for unit tests, integration tests, and golden tests.
chapter: CH-05
:::
This chapter describes patterns for unit tests, integration tests, and golden tests.
:::

::: concept
id: BLK-2fb586d6bc481c5d
summary: Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file.
digest: 0da44fcee0fb18c61cc5036023b021fcc964c8db018f7c601c037bc1934b8c3a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file..
vector_summary: Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file.
chapter: CH-05
:::
Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file. Critically:
:::

::: concept
id: BLK-a43afad2bf2ed56f
summary: A realistic pattern:.
digest: f94dde84a56ecc24ecf53ae58b2a7aa2f8ca98dae8ba815bb518e4b6371e9d6a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A realistic pattern:..
vector_summary: A realistic pattern:.
chapter: CH-05
:::
A realistic pattern:
:::

::: concept
id: BLK-12a6c33c25aad45a
summary: Package compliance_test.
digest: 17dfb8533166e20f81561fb9bdee2b27baa061f04c1013c4a1ed363d11345c0a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Package compliance_test..
vector_summary: Package compliance_test.
chapter: CH-05
:::
package compliance_test
:::

::: concept
id: BLK-ee543555b43f4c19
summary: Import data.compliance.
digest: db5f4fefd814b5eb7709f9a6093eef17df525d93a3e831eec15d675f6f3e6621
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.compliance..
vector_summary: Import data.compliance.
chapter: CH-05
:::
import data.compliance
:::

::: concept
id: BLK-216d33dfeabb69f0
summary: Test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests[...
digest: 55dfc375d3a1bf191ecdc3a26109fdb860ab6bc0415cfaaf1b14bc3965f3f020
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests[....
vector_summary: Test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests[...
chapter: CH-05
:::
test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests["pr_large"].expected
:::

::: concept
id: BLK-72a460040bb5dc02
summary: Result := compliance with input as input_case result == expected }.
digest: 4f433abef52cfc5c404829953f6ecf9f1aceef77674d14abc1ba327533dd1548
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Result := compliance with input as input_case result == expected }..
vector_summary: Result := compliance with input as input_case result == expected }.
chapter: CH-05
:::
result := compliance with input as input_case result == expected }
:::

::: concept
id: BLK-3418174c65cc2e6b
summary: Typical harness responsibilities:.
digest: 7f2e26c51c5491058e21121dbf24e285ddd0f1b16e4744ce101aa7210bf0d16e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Typical harness responsibilities:..
vector_summary: Typical harness responsibilities:.
chapter: CH-05
:::
Typical harness responsibilities:
:::

::: concept
id: BLK-b114e264b1a95140
summary: Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk.
digest: e636427a5744c4aa82a8c6580cedf7951b837e35d4785e0c09b426e9d84eb7ae
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk..
vector_summary: Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk.
chapter: CH-05
:::
Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk.
:::

::: concept
id: BLK-ae51cdad26736c7b
summary: Optionally parameterize tests via CLI flags or environment.
digest: ea1d7313ecb6b964af6d3a3a79e51e6394f918c1b68c09bac159f2311ed30b1d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Optionally parameterize tests via CLI flags or environment..
vector_summary: Optionally parameterize tests via CLI flags or environment.
chapter: CH-05
:::
Optionally parameterize tests via CLI flags or environment.
:::

::: concept
id: BLK-b4984dc6c3976f8c
summary: 7.7.1 The Newline Escape Sequence Problem.
digest: 770eab61b0508f4019c9e44f783ba3ee5c52447412a04e23f293fd428cefe548
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.7.1 The Newline Escape Sequence Problem..
vector_summary: 7.7.1 The Newline Escape Sequence Problem.
chapter: CH-05
:::
7.7.1 The Newline Escape Sequence Problem
:::

::: concept
id: BLK-2fefd1ebc0822d3c
summary: When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but ...
digest: 961922dac1822c548a1efda6dc71407133bb237feeedd3438ced13b096eac1bf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but ....
semantic_categories: [testing]
vector_summary: When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but ...
graph_neighbors: [CODE-efd78ba9916ca447, CODE-031e381b7120fc25, CODE-8ac93f8eb365af28, CODE-141a39bba2be1ded, CODE-213aa0a6ee07643a]
graph_degree: 5
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but critical difference:
:::

::: concept
id: BLK-bc9f823fd5cedebf
summary: Impact on Regex Patterns:.
digest: f7c42c53bb2592f96000cd03618dcd4fdb12ba95137b959471886283e59a7f6d
symbol_refs: [Impact on Regex Patterns:]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Impact on Regex Patterns:..
vector_summary: Impact on Regex Patterns:.
chapter: CH-05
:::
**Impact on Regex Patterns:**
:::

::: concept
id: BLK-e8ea5973a9c2c4fa
summary: The regex pattern TODO:\\s*\\n expects an actual newline character, but receives the literal string "\n", causing the match to fail.
digest: 9c38ebb249ee28e7d0b35c6767d8e94b70e38736d7fcd0164edb378e21994a0e
symbol_refs: [TODO:\\s*\\n]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The regex pattern TODO:\\s*\\n expects an actual newline character, but receives the literal string "\n", causing the match to fail..
vector_summary: The regex pattern TODO:\\s*\\n expects an actual newline character, but receives the literal string "\n", causing the match to fail.
chapter: CH-05
:::
The regex pattern `TODO:\\s*\\n` expects an actual newline character, but receives the literal string "\n", causing the match to fail.
:::

::: concept
id: BLK-d8d63540cecf04c9
summary: 7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data.
digest: cdc13702d9d05ea6bf8290d5f145d4d4b248cfd58ce54ae656f235c760b7fbab
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data..
vector_summary: 7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data.
chapter: CH-05
:::
7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data
:::

::: concept
id: BLK-a733b1236eb837cb
summary: For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines:.
digest: 20a742d87424ee9698476b11cdf91b6654233fedf5da1b988a43ccdee157e067
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines:..
vector_summary: For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines:.
chapter: CH-05
:::
For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines:
:::

::: concept
id: BLK-3ab344a17a6684a1
summary: Raw String Properties: - Preserve actual newline characters (not \n literals) - Do not interpret escape sequences (\n, \t, etc.) - Ideal for multi-...
digest: d9d38bf71a5c1c1e3ddf01014744346cc32e1af401df1ccae344049d534fa7ea
symbol_refs: [Raw String Properties:, \t, \n]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Raw String Properties: - Preserve actual newline characters (not \n literals) - Do not interpret escape sequences (\n, \t, etc.) - Ideal for multi-....
vector_summary: Raw String Properties: - Preserve actual newline characters (not \n literals) - Do not interpret escape sequences (\n, \t, etc.) - Ideal for multi-...
chapter: CH-05
:::
**Raw String Properties:** - Preserve actual newline characters (not `\n` literals) - Do not interpret escape sequences (`\n`, `\t`, etc.) - Ideal for multi-line test data (diffs, code blocks, structured text) - Compatible with regex patterns expecting real newlines
:::

::: concept
id: BLK-82a0ab5d24aee213
summary: When to Use Raw Strings vs Double-Quoted: - Raw strings (backticks): Multi-line content, actual newlines needed, regex patterns matching line break...
digest: 4654b64c230263e8dae63dc6905d1fc64868f74ff73b278b3017c67baa267303
symbol_refs: [Raw strings (backticks), When to Use Raw Strings vs Double-Quoted:, Double-quoted]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When to Use Raw Strings vs Double-Quoted: - Raw strings (backticks): Multi-line content, actual newlines needed, regex patterns matching line break....
vector_summary: When to Use Raw Strings vs Double-Quoted: - Raw strings (backticks): Multi-line content, actual newlines needed, regex patterns matching line break...
graph_neighbors: [TERM-4176bf4a5b555c86]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
**When to Use Raw Strings vs Double-Quoted:** - **Raw strings (backticks)**: Multi-line content, actual newlines needed, regex patterns matching line breaks - **Double-quoted**: Single-line content, escape sequences acceptable, JSON-like strings
:::

::: concept
id: BLK-b18ce5c52c9d7ec8
summary: 7.7.3 Debugging String Literal Issues.
digest: 5818c396e23d2f375012c0adcd1d1fd2cda15939d96b1be371be8e79c94c0527
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.7.3 Debugging String Literal Issues..
vector_summary: 7.7.3 Debugging String Literal Issues.
chapter: CH-05
:::
7.7.3 Debugging String Literal Issues
:::

::: concept
id: BLK-7c6331f584245e6f
summary: ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns.
digest: 1462b0b8f7b901034504abb6f8cf0df1e22583940f0e84796b0769496effe067
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns..
vector_summary: ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns
:::

::: concept
id: BLK-86120ccbf9fd371f
summary: 7.8.1 Direct Evaluation vs Variable Binding.
digest: c65a15b1a9dc71c1bb5bbe04da026e8ee6547ebeec456e233091ee8ff6f6ec39
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.8.1 Direct Evaluation vs Variable Binding..
vector_summary: 7.8.1 Direct Evaluation vs Variable Binding.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
7.8.1 Direct Evaluation vs Variable Binding
:::

::: concept
id: BLK-df4e849b650f07a7
summary: When testing rules that return sets (e.g., warn, deny), the method of accessing results matters:.
digest: e6774b5a0ac24498225099c52158fb57bd6d2b8b78019cf11a833309078d316d
symbol_refs: [warn, deny]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When testing rules that return sets (e.g., warn, deny), the method of accessing results matters:..
semantic_categories: [testing]
vector_summary: When testing rules that return sets (e.g., warn, deny), the method of accessing results matters:.
graph_neighbors: [CODE-efd78ba9916ca447, CODE-031e381b7120fc25, CODE-8ac93f8eb365af28, CODE-141a39bba2be1ded, CODE-213aa0a6ee07643a]
graph_degree: 5
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
When testing rules that return sets (e.g., `warn`, `deny`), the method of accessing results matters:
:::

::: concept
id: BLK-0acff6661b16050d
summary: Pattern 1: Direct Evaluation (May Fail).
digest: 7fcd6fdacdee69bc132d74b71338ff4f2cc28f8a99ebf8cd6b4d571370512495
symbol_refs: [Pattern 1: Direct Evaluation (May Fail)]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pattern 1: Direct Evaluation (May Fail)..
vector_summary: Pattern 1: Direct Evaluation (May Fail).
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
**Pattern 1: Direct Evaluation (May Fail)**
:::

::: concept
id: BLK-7cbd323bc9f94955
summary: Pattern 2: Variable Binding (Recommended).
digest: 12efabe7563fdabfed43e8a53d7363fb30627e7ecf488432e65c41855d353f80
symbol_refs: [Pattern 2: Variable Binding (Recommended)]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pattern 2: Variable Binding (Recommended)..
vector_summary: Pattern 2: Variable Binding (Recommended).
chapter: CH-05
:::
**Pattern 2: Variable Binding (Recommended)**
:::

::: concept
id: BLK-cf01220d4f2b5562
summary: Why Variable Binding is Preferred: - Explicit evaluation context: with input as mock_input applies to the rule evaluation, not the count() call - C...
digest: d476163450e9a27ae77e49e9f3fefc2ace3e4f20efac56a13e8a9f86714ed890
symbol_refs: [with input as mock_input, warnings, count(), Why Variable Binding is Preferred:]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Why Variable Binding is Preferred: - Explicit evaluation context: with input as mock_input applies to the rule evaluation, not the count() call - C....
vector_summary: Why Variable Binding is Preferred: - Explicit evaluation context: with input as mock_input applies to the rule evaluation, not the count() call - C...
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
**Why Variable Binding is Preferred:** - Explicit evaluation context: `with input as mock_input` applies to the rule evaluation, not the `count()` call - Clearer semantics: The rule is evaluated with mocked input, then the result is counted - More reliable: Avoids potential evaluation order issues in complex test expressions - Better debugging: Can inspect `warnings` set before counting
:::

::: concept
id: BLK-9bf695cdc0aa522c
summary: 7.8.2 Accessing Set Elements in Tests.
digest: ed60b90d886b3f2672b4a0e7d7ffa24fc8eedad786d5b5f068e79fb414d42951
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.8.2 Accessing Set Elements in Tests..
vector_summary: 7.8.2 Accessing Set Elements in Tests.
chapter: CH-05
:::
7.8.2 Accessing Set Elements in Tests
:::

::: concept
id: BLK-eab8babc80ad3a19
summary: Pattern for Multiple Assertions:.
digest: c1d3d2e08ae4ba3fc56798ba297120350ba666e22213cc70c22d147fae16b679
symbol_refs: [Pattern for Multiple Assertions:]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pattern for Multiple Assertions:..
vector_summary: Pattern for Multiple Assertions:.
chapter: CH-05
:::
**Pattern for Multiple Assertions:**
:::

::: concept
id: BLK-33daea6eded19bdb
summary: Test Design Strategy:.
digest: 64226abd7e9e1365612176f41747d1805a4838814e2f7399e28431a825af04b0
symbol_refs: [Test Design Strategy:]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test Design Strategy:..
vector_summary: Test Design Strategy:.
chapter: CH-05
:::
**Test Design Strategy:**
:::

::: concept
id: BLK-3cce476e79eee5ee
summary: ________________________________________ 7.9 Case Sensitivity and String Matching in Tests.
digest: d871a9825df27bdffc0fc4e7be6d6eabd3ecc0a9c686d10773153da858abe284
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ________________________________________ 7.9 Case Sensitivity and String Matching in Tests..
vector_summary: ________________________________________ 7.9 Case Sensitivity and String Matching in Tests.
chapter: CH-05
:::
________________________________________ 7.9 Case Sensitivity and String Matching in Tests
:::

::: concept
id: BLK-8e340303a8cff7d0
summary: The contains() function performs case-sensitive substring matching:.
digest: c5a8c308b0e39321710dde869c56302d2ff3b613d028a31fed4f284fa7889d46
symbol_refs: [contains()]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The contains() function performs case-sensitive substring matching:..
vector_summary: The contains() function performs case-sensitive substring matching:.
chapter: CH-05
:::
The `contains()` function performs case-sensitive substring matching:
:::

::: concept
id: BLK-76ca8f44b0c02913
summary: 7.9.2 Mitigation Strategies.
digest: 953bf34000229b2a8a668f430bb2593b29fcecc3b19a2297fba925ea452f4d70
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.9.2 Mitigation Strategies..
vector_summary: 7.9.2 Mitigation Strategies.
chapter: CH-05
:::
7.9.2 Mitigation Strategies
:::

::: concept
id: BLK-67d5c6760b15e129
summary: Option 1: Normalize Test Inputs.
digest: fad8472dc6cabb9854b1c3d05b03285bc813776130de4aa00eb0cc6c241ed3a6
symbol_refs: [Option 1: Normalize Test Inputs]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Option 1: Normalize Test Inputs..
vector_summary: Option 1: Normalize Test Inputs.
chapter: CH-05
:::
**Option 1: Normalize Test Inputs**
:::

::: concept
id: BLK-2d0d11c237ce14cb
summary: Look for panics, regressions, or surprising allow/deny.
digest: 09f19703a61d761484ba06de3527efcd70e17a7b6d44115593c0b6605c34f477
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Look for panics, regressions, or surprising allow/deny..
semantic_categories: [testing]
vector_summary: Look for panics, regressions, or surprising allow/deny.
graph_neighbors: [TERM-7189e73f44e918ef, CODE-efd78ba9916ca447, CODE-031e381b7120fc25, CODE-8ac93f8eb365af28, CODE-141a39bba2be1ded, CODE-213aa0a6ee07643a]
graph_degree: 6
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
________________________________________ 7.7 Advanced Testing: Fuzzing & Mutation For high-assurance policies (security, compliance): Fuzzing: Generate random or adversarial JSON inputs. Run opa eval or opa test against them. Look for panics, regressions, or surprising allow/deny. Mutation testing: Mutate policies (flip conditions, remove clauses). Check that test suite fails appropriately. Failing to detect "killed" mutants = missing tests. This is often orchestrated by external tooling (Python/Go harnesses that call OPA), but the principles are Rego-agnostic. ________________________________________ Chapter 8 ‚Äì OPA Architecture & Integration Patterns This chapter is about where and how you run OPA. ________________________________________ 8.1 The PDP / PEP Split PDP (Policy Decision Point): OPA, evaluating Rego. PEP (Policy Enforcement Point): Your app, proxy, or platform component that: Collects input (HTTP request, Kubernetes object, Terraform plan, CI metadata). Sends it to PDP. Enforces the decision (allow/deny/mutate/log). OPA is only the PDP. The PEP is your responsibility. ________________________________________ 8.2 Deployment Topologies Sidecar / local daemon OPA runs alongside your service, often in the same Pod. Low latency, no network hop beyond localhost. Typical: Envoy external authz ‚Üí OPA. Kubernetes admission controller ‚Üí OPA sidecar in same namespace. Central PDP service OPA (or OPA-based service) runs as a central API. Multiple services call it over the network. Tradeoffs: Pros: Single place to manage policies; simpler distribution. Cons: Latency, scalability, SPOF (unless HA), multi-tenant complexity. Library / SDK Embed OPA: Go: github.com/open-policy-agent/opa/rego WASM: compile Rego to WASM and embed in any WASM host (Node, Rust, etc.). Useful for: Client-side enforcement (e.g., in a browser or mobile app). Edge scenarios. ________________________________________ 8.3 Integration Examples Kubernetes (Gatekeeper & friends) Admission review ‚Üí OPA policy. Rego receives: input.request (raw AdmissionReview). data includes ConstraintTemplates, constraints, reference data. Typical structure: package kubernetes.admission
:::

::: concept
id: BLK-94d881df8f040676
summary: Default allow := false.
digest: 925fe20c397c155dd276a6de96ae2fc02b885e1df68cc4a7420c81bb63add8fb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-226d4d54f908a22c
summary: Allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc.
digest: 85a6e1d42cef6c75bc56921c2c786d02e1f3788fc0aeec7589216165e719cc7c
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc..
semantic_categories: [distribution, observability]
vector_summary: Allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc. PR/diff metadata ‚Üí JSON (opa-input.json). OPA evaluates data.compliance. CI interprets deny, warn, override arrays and posts PR comments / fails build. IaC scanning (Terraform, Kubernetes YAML) Terraform plan JSON or Kubernetes manifests as input. Policies check: Public buckets. Unencrypted volumes. Exposed security groups. ________________________________________ 8.4 Multi-layer Policy Architecture on OPA Layers usually look like: Global baseline ‚Äì org-level security/compliance invariants. Domain policies ‚Äì per product or platform (e.g., CRM, billing). Team/service policies ‚Äì localized rules. Tenant overlays ‚Äì per customer/tenant customizations. Implement via: Multiple bundles merged in OPA. Data-driven toggles (e.g., data.tenants[tenant_id].overrides). Rego evaluation order (e.g., base allow, then deny overlays). ________________________________________ 8.5 OPA as a Policy Mesh In large environments, you might have: Many OPAs running across clusters/namespaces. A central bundle server pushing policies. Decision logs shipped to SIEM / data lake. Rego itself doesn‚Äôt change; the architecture around it does. ________________________________________ Chapter 9 ‚Äì Policy Bundling & Distribution OPA is not just an evaluator; it has a bundle system for shipping policies and data. ________________________________________ 9.1 Bundle Basics A bundle is: A .tar.gz containing: /policies/*.rego /data/*.json (or YAML, etc.) .manifest file with metadata. Example manifest (conceptual): { "revision": "git-sha-1234", "roots": ["authz", "compliance"], "metadata": { "version": "1.2.3", "built_at": "2025-11-25T12:00:00Z" } } OPA config: services: policy: url: https://opa-bundles.example.com
:::

::: concept
id: BLK-262b6cf7fecd7591
summary: Default allow := false.
digest: 55011375d798f54dd3d885a8033846b9e018b37e45adfd59ee1f83350db82e42
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-e5ca9a3a2bcfb757
summary: _is_admin(user) if "admin" in user.roles.
digest: db89002efbfec0af4de87eb2fbb92799ac5ac4d3d094885b1a4b4fa7153a1458
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that _is_admin(user) if "admin" in user.roles..
vector_summary: _is_admin(user) if "admin" in user.roles.
chapter: CH-05
:::
_is_admin(user) if "admin" in user.roles
:::

::: concept
id: BLK-c25057b8a38b65d8
summary: Jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4.
digest: f98161d7db2aa2b50978f9223c3508028cadee3426fc65e026feeafd7628d6dc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4..
vector_summary: Jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4.
chapter: CH-05
:::
jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4
:::

::: concept
id: BLK-fb09f96c638665e9
summary: Name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal.
digest: 4f27b533fdd564ec3aec8bfd1ac0f422b0a652d96e83c918232c8a2f5960ef56
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal..
vector_summary: Name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal.
chapter: CH-05
:::
- name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal
:::

::: concept
id: BLK-2af9eec9bfb6a27e
summary: # Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_re...
digest: 32e97bdf697bd043276d0a48c41cb22264879bac2bee715d7a393eec25cac8f6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_re....
vector_summary: # Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_re...
chapter: CH-05
:::
# Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_regex_check() # expensive }
:::

::: concept
id: BLK-a55ef7691563b3b5
summary: # Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 ...
digest: d0c18136b59bc8c9c27611b23cad9dfc3d7bff2623dc176eae057c02987f9f76
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 ....
vector_summary: # Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 ...
chapter: CH-05
:::
# Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 Index-friendly Data Modeling Given:
:::

::: concept
id: BLK-99f7241a145fddb0
summary: # Good has_admin if { some u in users "admin" in u.roles }.
digest: 8cdb2f9b60866d49e864342e6d9c2fbfbb7a95c7a7580ebca52cf63ce5db2463
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Good has_admin if { some u in users "admin" in u.roles }..
vector_summary: # Good has_admin if { some u in users "admin" in u.roles }.
chapter: CH-05
:::
# Good has_admin if { some u in users "admin" in u.roles }
:::

::: concept
id: BLK-8ce4a80f2b54bd39
summary: # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Eval...
digest: 355eb7f1814a1efee2e8ae27b0d24dea318ec6520789bbd01624529401951d47
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Eval....
semantic_categories: [performance]
vector_summary: # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Eval...
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
# Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Evaluation & Compilation Partial evaluation is like compiling away some of your logic for known inputs. 11.6 Partial Evaluation & WASM Build Modes
:::

::: concept
id: BLK-79fbf7e37836b953
summary: Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data).
digest: a40df4bc9937ad65a9c66d459eabf4116b9dcfba87e08328f01e71ff9c1b8a5b
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data)..
semantic_categories: [performance]
vector_summary: Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data).
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data).
:::

::: concept
id: BLK-c4708b67898ef8d9
summary: Two important workflows:.
digest: 73efed25dc16244d85a704e2c93ad79f8992bc6921d89ecc731f8b7ba6b48090
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Two important workflows:..
vector_summary: Two important workflows:.
chapter: CH-05
:::
Two important workflows:
:::

::: concept
id: BLK-30f8a1f3bad5f945
summary: 11.6.1 WASM Compilation (Edge / Embedded).
digest: 76e88bbe0ad5cdd1f9608f0ca3fbf9c6ecd4ba076f933768070aa72b378efe29
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 11.6.1 WASM Compilation (Edge / Embedded)..
vector_summary: 11.6.1 WASM Compilation (Edge / Embedded).
chapter: CH-05
:::
11.6.1 WASM Compilation (Edge / Embedded)
:::

::: concept
id: BLK-94d092d110d895e4
summary: -t wasm ‚Üí produce a WebAssembly binary.
digest: 52b746fef0813e65ca82cba4a9b5853469df509c656ad424656e7946538136fd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that -t wasm ‚Üí produce a WebAssembly binary..
vector_summary: -t wasm ‚Üí produce a WebAssembly binary.
chapter: CH-05
:::
-t wasm ‚Üí produce a WebAssembly binary.
:::

::: concept
id: BLK-c1e7ab5edbc34051
summary: -e 'data.authz.allow' ‚Üí fix the entrypoint.
digest: ce9c8aa9a7c13ac543b55eef572fadc57e6052979dc2aed9a9964b00eec7fab3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that -e 'data.authz.allow' ‚Üí fix the entrypoint..
vector_summary: -e 'data.authz.allow' ‚Üí fix the entrypoint.
chapter: CH-05
:::
-e 'data.authz.allow' ‚Üí fix the entrypoint.
:::

::: concept
id: BLK-da13a43f73416bc2
summary: In-process SDKs (Go, Node, etc.).
digest: 02bff77c495778ec777a003343215853837e19669ea9baf37da1c1013ffbe1d5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In-process SDKs (Go, Node, etc.)..
vector_summary: In-process SDKs (Go, Node, etc.).
chapter: CH-05
:::
In-process SDKs (Go, Node, etc.)
:::

::: concept
id: BLK-23529cac1f63a029
summary: Edge runtimes or sidecars.
digest: 53e8b93cc638d28603aa293070da8ceff7334f525f175b35404accfd2518c4f9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Edge runtimes or sidecars..
vector_summary: Edge runtimes or sidecars.
chapter: CH-05
:::
Edge runtimes or sidecars.
:::

::: concept
id: BLK-ad917938449c7e7e
summary: The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module.
digest: d739cfaada1ae7224c4447e075d7a6176386759807c454f8939f7141ea3ae195
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module..
semantic_categories: [performance]
vector_summary: The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module.
:::

::: concept
id: BLK-ba6adeec0ea6c0dd
summary: 11.6.2 General Partial Evaluation (Bundles / CLI).
digest: 644eaeba9f2c2bea5866cfb2791748a2954b542cbf71554d082c0c522f38707c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 11.6.2 General Partial Evaluation (Bundles / CLI)..
semantic_categories: [distribution, performance]
vector_summary: 11.6.2 General Partial Evaluation (Bundles / CLI).
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
11.6.2 General Partial Evaluation (Bundles / CLI)
:::

::: concept
id: BLK-524a614cce84f31a
summary: For non-WASM optimization:.
digest: 4c8397b1933d8866e9165e10e596e3d533aa344196ff133899acbccb178dcf8d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that For non-WASM optimization:..
vector_summary: For non-WASM optimization:.
chapter: CH-05
:::
For non-WASM optimization:
:::

::: concept
id: BLK-923558ff279a8861
summary: Exploratory / ad-hoc partial evaluation:.
digest: 23e5e4e479e6bd5e16ca2b991324e896b66ac320fd01b4966c1c04954cad301e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Exploratory / ad-hoc partial evaluation:..
semantic_categories: [performance]
vector_summary: Exploratory / ad-hoc partial evaluation:.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Exploratory / ad-hoc partial evaluation:
:::

::: concept
id: BLK-0d6e5a6876e52458
summary: Lets you inspect how much work can be pre-computed,.
digest: eef0cf2dcbb177e96de85b3bb91828c87bfa57a08a3b940cbc1dd82c3f95c374
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Lets you inspect how much work can be pre-computed,..
vector_summary: Lets you inspect how much work can be pre-computed,.
chapter: CH-05
:::
Lets you inspect how much work can be pre-computed,
:::

::: concept
id: BLK-2f48550b2fa1529c
summary: Is useful for iterative tuning and performance analysis.
digest: 00920b27fe8ce3744295cdf0df86f296f44d15942dfd3148f426f06ddea70b78
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Is useful for iterative tuning and performance analysis..
vector_summary: Is useful for iterative tuning and performance analysis.
chapter: CH-05
:::
Is useful for iterative tuning and performance analysis.
:::

::: concept
id: BLK-e3939d7108ad8277
summary: Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms.
digest: 6413d81a3392f74d1cb5502deadbff2a6bf9b475086bfcca839332832fc05f1c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms..
semantic_categories: [theory]
vector_summary: Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms.
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms. Interpretation: An interpretation Iassigns truth values to all ground atoms (e.g., p("alice", "admin")). The meaning of a program Pis the least fixed point of the immediate consequence operator T_P, analogous to classical Datalog. ________________________________________ 12.2 Immediate Consequence Operator & Fixpoint Define T_Pover interpretations: T_P (I)= set of all heads h(t Àâ)such that there exists a rule h(t Àâ)‚áêb_1,‚Ä¶,b_nand all b_iare satisfied under I. Iterative construction: I_0=‚àÖI_(k+1)=T_P (I_k)"Eval"(P)=‚ãÉ_(k=0)^‚àû I_k
:::

::: concept
id: BLK-137908516f846d9b
summary: Because: Herbrand base is finite for a given finite data and bounded terms.
digest: 0b2bb5046bd47b464c464326e392f86a712be18bae0baeb3bb68fb245fca577e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Because: Herbrand base is finite for a given finite data and bounded terms..
semantic_categories: [negation, theory, unification]
vector_summary: Because: Herbrand base is finite for a given finite data and bounded terms.
chapter: CH-05
:::
Because: Herbrand base is finite for a given finite data and bounded terms. T_Pis monotonic for stratified, positive fragments. ‚Üí Fixpoint is reached in finite steps. ________________________________________ 12.3 Unification & =, :=, == Unification (=): find a most general unifier (MGU) that makes two terms equal. If both sides partially unbound, unify them structurally. Example: [x, "world"] = ["hello", y] MGU: {x‚Ü¶"hello",y‚Ü¶"world"}. Assignment (:=): one-way binding; fails if variable is already bound to a different value. Equality (==): no variable binding; pure comparison. In implementation, OPA uses a mixture of: Unification-like semantics to explore bindings. Assignments and comparisons for clarity and performance in v1 syntax. ________________________________________ 12.4 Negation-as-Failure & Stratification Rego uses NAF (Negation-as-Failure): not p(X) means: ‚Äúit is not provable that p(X) holds‚Äù. Formally: "Eval"(P)‚ä®"not " p(t)" "‚ü∫" Eval"(P)‚ä®Ã∏p(t)
:::

::: concept
id: BLK-cc03bee3c83123fb
summary: The semantics is set union of instances.
digest: 08a7f3a9432a205f10590f1fe9a1e134ab138eea58a9ffdb6debfdcc6905fd4e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The semantics is set union of instances..
semantic_categories: [negation, performance]
vector_summary: The semantics is set union of instances.
graph_neighbors: [CODE-2cbe0767daa4b7a0, TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 3
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
The semantics is set union of instances. ________________________________________ 12.6 Complexity of Evaluation Let: ‚à£D‚à£= size of data. ‚à£I‚à£= size of input. ‚à£P‚à£= size (number of rules/clauses) of program. Then: Basic evaluation (no recursion) is polynomial in ‚à£D‚à£+‚à£I‚à£. General Datalog with negation can be EXPTIME-complete in the worst case, but OPA: Forbids or discourages patterns that would lead to blow-ups. Optimizes with indexing, partial evaluation, grounding. Rule-of-thumb: Flattened, non-recursive Rego with bounded comprehensions behaves like complex SQL queries in terms of complexity. Recursive policies (e.g., graph reachability) behave like graph algorithms. ________________________________________ 12.7 Partial Evaluation Semantics Given: Program P. Known input fragment K‚äÜ(data,input). Define the partial evaluation operator: PE(P,K)‚ÜíP^'
:::

::: concept
id: BLK-c1c5efdfcf097b54
summary: Such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U).
digest: 9382f799e268f37955de7ad1d9a26d96ffc066b653d19cdc79f5828e997ee072
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U)..
vector_summary: Such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U).
chapter: CH-05
:::
such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U)
:::

::: concept
id: BLK-91f4730964a13670
summary: Deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__....
digest: 8499eea9a30f51794443d750085c00f22979b8a64a61bdf633454c422a9adac7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__.....
vector_summary: Deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__....
chapter: CH-05
:::
deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__.rule_id, "msg": "Public S3 bucket forbidden"} } ________________________________________ 13.4 Override Precedence and Combining Layers You need a formal precedence model so people don‚Äôt guess. Think in terms of layer priority and decision semantics. 13.4.1 Priority Model Assign numeric ranks to layers: package policy.layers
:::

::: concept
id: BLK-4984619c0e0050a5
summary: Layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "wa...
digest: 7143016e8f0b001aa42672248436cbe67f54f52acff82ae774219073948d7c30
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "wa....
vector_summary: Layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "wa...
graph_neighbors: [CODEPAT-a00d797a81733169, CODE-4522197481045bd4, CODE-704f6e731c295b92, CODEPAT-c4c47ef6c7df1e75, CODEPAT-3f603bb00d12d7e6, CODE-6fd3a2913e47883e, CODEPAT-e3a1766e8b78df14, CODE-55a5cc5eed674559, CODEPAT-190e5fc8d209ddec, CODEPAT-f8e30e7deeeb39fa, CODEPAT-90bf40e525478abf, CODEPAT-67fa0ef89ef6b03c, CODE-1b4cef265aa6f5e3, CODE-8cd9f756e7ad785f, CODEPAT-ce3111aa333c1369]
graph_degree: 15
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "warn" ‚Ä¢ layer: "global" | "domain" | "team" | "tenant" ________________________________________ 13.4.2 Decision Aggregation Pattern Define a canonical decision document: package decision
:::

::: concept
id: BLK-f7e87b62755ad0fa
summary: Default result := { "allow": false, "effects": [], # list of all hits from all layers }.
digest: fb082d38f978c023fd36652b42b1d58cfb015f75057f3b01c0155d61631408ba
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default result := { "allow": false, "effects": [], # list of all hits from all layers }..
vector_summary: Default result := { "allow": false, "effects": [], # list of all hits from all layers }.
chapter: CH-05
:::
default result := { "allow": false, "effects": [], # list of all hits from all layers }
:::

::: concept
id: BLK-69c05c427b8cd3f3
summary: # Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] }.
digest: 71297b72b1ad25a28c999110290cceb1813044b308ee3b89884969b2fa1c8c5b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] }..
vector_summary: # Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] }.
chapter: CH-05
:::
# Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] }
:::

::: concept
id: BLK-10a064964dd99bf1
summary: Effects[eff] if { eff := data.domain.crm.authz.effects[_] }.
digest: ca3595a8637058e70baa2abff71ae5ddf1ad369d3fb150e31f81af33465b0aac
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Effects[eff] if { eff := data.domain.crm.authz.effects[_] }..
vector_summary: Effects[eff] if { eff := data.domain.crm.authz.effects[_] }.
chapter: CH-05
:::
effects[eff] if { eff := data.domain.crm.authz.effects[_] }
:::

::: concept
id: BLK-57b5b916a2a46835
summary: Some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false }.
digest: 042fc46f8f5ffcd2f36b35422d71b5f8a666982f75895bae1ef641f60612761a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false }..
vector_summary: Some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false }.
chapter: CH-05
:::
some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false }
:::

::: concept
id: BLK-0e7a6c61b883e7e6
summary: Default allow := false.
digest: 0c4d2d87c0fd61a6f2dd1e87baf06712e5e27d985d975b9ac033403b25d8dc23
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-06a52347059013ef
summary: Base_allow if { data.global.authz.allow }.
digest: 23d1c3c54bb2438e505ce399cd86b11c5f9d7cf164bae98c1745d31a4ae8201c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Base_allow if { data.global.authz.allow }..
vector_summary: Base_allow if { data.global.authz.allow }.
chapter: CH-05
:::
base_allow if { data.global.authz.allow }
:::

::: concept
id: BLK-8c1040019d74489c
summary: Base_allow if { data.domain.crm.authz.allow }.
digest: 0f10d269683cf61f4ee5efaa0b0d749775db26a82c26eb06bc8f32b5bcc386f9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Base_allow if { data.domain.crm.authz.allow }..
vector_summary: Base_allow if { data.domain.crm.authz.allow }.
chapter: CH-05
:::
base_allow if { data.domain.crm.authz.allow }
:::

::: concept
id: BLK-b530a84aa5f3112f
summary: Tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg }.
digest: 5b42b850451c45de50fa5449330e0798730c6998001261ea9b614dc4efbf1b10
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg }..
vector_summary: Tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg }.
chapter: CH-05
:::
tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg }
:::

::: concept
id: BLK-b64bd35f4b861874
summary: Default allow := false.
digest: 5cd03520639213e0ab216a2d68b6ba747248f178ee6a60899bf1bf1672f03f5d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-52900d5604afced9
summary: Trace_id := input.request.headers["x-request-id"].
digest: 8e343771af9e4d4a1f2e8571f5c65beaa7334b775a27531426aa44f698927116
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Trace_id := input.request.headers["x-request-id"]..
vector_summary: Trace_id := input.request.headers["x-request-id"].
chapter: CH-05
:::
trace_id := input.request.headers["x-request-id"]
:::

::: concept
id: BLK-4eae47b5b88ac30b
summary: Allow if { # ...logic...
digest: 8c4e6d30048406a7a202372076d5ddf72d63f2ac02b6b4d97d481b43b83d53a6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { # ...logic....
vector_summary: Allow if { # ...logic...
chapter: CH-05
:::
allow if { # ...logic... }
:::

::: concept
id: BLK-5d68765eb3fb6b23
summary: 15.1 External State for Rate-Limiting & Anomaly Detection.
digest: cff16c980b2076f25fb471b0a75628f07126e14180715155b9d96ef93f7a4b55
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 15.1 External State for Rate-Limiting & Anomaly Detection..
vector_summary: 15.1 External State for Rate-Limiting & Anomaly Detection.
chapter: CH-05
:::
15.1 External State for Rate-Limiting & Anomaly Detection
:::

::: concept
id: BLK-602cdb4b50a087c9
summary: Example of externally managed login counts:.
digest: 994852af2a2277fc72b31e4764f862444456d27caa19a372d739f5f1df5a3b66
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Example of externally managed login counts:..
vector_summary: Example of externally managed login counts:.
chapter: CH-05
:::
Example of externally managed login counts:
:::

::: concept
id: BLK-d3b7e29e9b95c9dc
summary: # External system populates:.
digest: 75d2ebbdee9c4e061890ebdb8aa5030c88455bcad3b80b2e5d8351d86d98cc56
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # External system populates:..
vector_summary: # External system populates:.
chapter: CH-05
:::
# External system populates:
:::

::: concept
id: BLK-7c4c29ca27d52d01
summary: # data.state.login_counts = {.
digest: c0ccca441209ed1d22926f4232a6675f0275174b82ba90ee136467dc7785dd8f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # data.state.login_counts = {..
vector_summary: # data.state.login_counts = {.
chapter: CH-05
:::
# data.state.login_counts = {
:::

::: concept
id: BLK-881ee9741315002c
summary: # "alice": {"last_5m": 12, "last_1h": 42},.
digest: 43b110e28d1e841f72bec251a33c17f3e8ef4b9a3009b7363933f4670be38bce
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "alice": {"last_5m": 12, "last_1h": 42},..
vector_summary: # "alice": {"last_5m": 12, "last_1h": 42},.
chapter: CH-05
:::
# "alice": {"last_5m": 12, "last_1h": 42},
:::

::: concept
id: BLK-0016265f5a3c2c5b
summary: # "bob": {"last_5m": 2, "last_1h": 8},.
digest: 68e5c0aa8fb672c166eb20981e78abe9b343e055e6349fcc0e98111230cec064
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "bob": {"last_5m": 2, "last_1h": 8},..
vector_summary: # "bob": {"last_5m": 2, "last_1h": 8},.
chapter: CH-05
:::
# "bob": {"last_5m": 2, "last_1h": 8},
:::

::: concept
id: BLK-044c7de784844b9b
summary: Too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 }.
digest: fdff20cb930b29172a51a9828befb94bea0d06dd93ad9cc220e4ebcef10aa62b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 }..
vector_summary: Too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 }.
chapter: CH-05
:::
too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 }
:::

::: concept
id: BLK-7fb970abfedb4ed3
summary: A separate component (stream processor, cron job, gateway) periodically:.
digest: 4910e0f8f8ad5427066b0b600fe0f0cd28430840e26845e020753abae3b5a829
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A separate component (stream processor, cron job, gateway) periodically:..
vector_summary: A separate component (stream processor, cron job, gateway) periodically:.
chapter: CH-05
:::
A separate component (stream processor, cron job, gateway) periodically:
:::

::: concept
id: BLK-301f517072826bc8
summary: Reads raw events (e.g., login attempts),.
digest: a11ed1e006d5e0325689fb2d74bfab1029d346c16ed94f48a322dd0b86be842e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Reads raw events (e.g., login attempts),..
vector_summary: Reads raw events (e.g., login attempts),.
chapter: CH-05
:::
reads raw events (e.g., login attempts),
:::

::: concept
id: BLK-fa54db274a3f8d73
summary: Aggregates them (windowed counts),.
digest: 5fe91881051fa916f4daacd2e435a7f12fd597cabaf6f1d3f7e9419271561c4e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Aggregates them (windowed counts),..
vector_summary: Aggregates them (windowed counts),.
chapter: CH-05
:::
aggregates them (windowed counts),
:::

::: concept
id: BLK-c0d4ff0c2c28803e
summary: Publishes a new snapshot to:.
digest: c6c23915931ab0fcfa51d8aac8962c755344e8a77bc998d733f3b51b5bd6411c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Publishes a new snapshot to:..
vector_summary: Publishes a new snapshot to:.
chapter: CH-05
:::
publishes a new snapshot to:
:::

::: concept
id: BLK-9b773aae56da6674
summary: Think of the pattern:.
digest: 1c0eed490f1ff6c07cf693d9d5016b38d6bb64bcccdae1c8e85c36ba89c42294
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Think of the pattern:..
vector_summary: Think of the pattern:.
chapter: CH-05
:::
Think of the pattern:
:::

::: concept
id: BLK-53fedeb32bc6499b
summary: Events ‚Üí (Kafka / Kinesis / PubSub / Logs).
digest: 48b59a4fe48c6dbab116c3f0ef4192eec1d7e84f5a3bac56921951ce299f9d27
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Events ‚Üí (Kafka / Kinesis / PubSub / Logs)..
vector_summary: Events ‚Üí (Kafka / Kinesis / PubSub / Logs).
chapter: CH-05
:::
Events ‚Üí (Kafka / Kinesis / PubSub / Logs)
:::

::: concept
id: BLK-a9c9f10372751d58
summary: Aggregator ‚Üí (Flink / custom job / Lambda).
digest: 2d70e6e484aa123bb84bedf468e5b1bef5d8496ca8e8efa22c8887eaa4b9da72
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Aggregator ‚Üí (Flink / custom job / Lambda)..
vector_summary: Aggregator ‚Üí (Flink / custom job / Lambda).
chapter: CH-05
:::
Aggregator ‚Üí (Flink / custom job / Lambda)
:::

::: concept
id: BLK-79a22ef860c5e85f
summary: State Snapshot ‚Üí (bundle / data.state.*).
digest: 1be05a42d7d00d3b20f0ac5e9ed423dbc0cababbbbd50b3eb85f2eed5f31bec1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that State Snapshot ‚Üí (bundle / data.state.*)..
semantic_categories: [distribution]
vector_summary: State Snapshot ‚Üí (bundle / data.state.*).
chapter: CH-05
:::
State Snapshot ‚Üí (bundle / data.state.*)
:::

::: concept
id: BLK-0765a0f81e468faa
summary: Default allow := true.
digest: a27145391660d1518c9fa7ab29971acfb9a060b59a228698c1bcb4a3f058bde2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := true..
vector_summary: Default allow := true.
chapter: CH-05
:::
default allow := true
:::

::: concept
id: BLK-e89c971ac66c2591
summary: Deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns.
digest: eadd0c0db9ba70185ba6e1f86fc6cb9392320168d40aed5185d8d78220e86f85
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns..
vector_summary: Deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns.
chapter: CH-05
:::
deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns
:::

::: concept
id: BLK-3641c3e33c8e8566
summary: # events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.a...
digest: c36d3360b4dc9d5d058d6ebef518676cedd0e2b2a53fc0c50cff234b58d01f86
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.a....
vector_summary: # events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.a...
chapter: CH-05
:::
# events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.action == "login_failure" e.ts >= cutoff }
:::

::: concept
id: BLK-22ea3c1f6e7bd5de
summary: Temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You e...
digest: c1e2a3a81b08487d00e45b0273c61f8bfb878707526aed29f67de072508139e8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You e....
semantic_categories: [authz]
vector_summary: Temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You e...
graph_neighbors: [CODE-f9165857ee2c0c68, CODE-4d2ad0d6df9f48c1, CODE-ae589d488d5196d2, CODE-e3021412b7e801e0, CODE-22a3c940e76c1893, CODE-1f681853ebf733fb, CODE-4b643428b4f2edd0, CODE-e8a2139bac84c4a0, CODE-3152b6a89a146d23, CODE-ff0c5e5c7e41a636, CODE-322fb8a04486fb51]
graph_degree: 11
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You encode exceptions in data.overrides, with explicit expiration timestamps. This keeps temporal logic in data, not code. ________________________________________ Chapter 16 ‚Äì Data Policy Models (GraphQL, APIs, Data Filtering) OPA is particularly strong for data access policies because Rego is JSON-native. This chapter focuses on query-shaped inputs like GraphQL and REST. ________________________________________ 16.1 GraphQL AST Policies When a GraphQL query enters your gateway, you can: 1. Parse it into an AST. 2. Send AST + user context to OPA. 3. Enforce: o Field-level authorization. o Query depth/width limits. o Allowed operations. Example input (simplified): { "user": {"id": "alice", "roles": ["user"]}, "operation": "query", "query": { "name": "GetCustomer", "fields": [ {"path": ["customer", "email"]}, {"path": ["customer", "creditCardNumber"]} ] } } Policy: package gql.authz
:::

::: concept
id: BLK-eae51f08b14c25ab
summary: Default allow := false default violations := [].
digest: 25940778ae0be85b8330e06e3bdd23bf221d726636c1360ced9ae3feb3e6dcad
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false default violations := []..
vector_summary: Default allow := false default violations := [].
chapter: CH-05
:::
default allow := false default violations := []
:::

::: concept
id: BLK-96cfa439c2ca2a38
summary: # data.gql.allowed_fields = {.
digest: 9a4674f00e1fa5887c6093e366dcf43970b2dcefa538d052122705a277c9a9f7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # data.gql.allowed_fields = {..
vector_summary: # data.gql.allowed_fields = {.
chapter: CH-05
:::
# data.gql.allowed_fields = {
:::

::: concept
id: BLK-8bb9ccc71d144b2c
summary: # "customer": ["id", "name", "email"].
digest: 44a7a3947e6e10f5370d8cb78a46c4808ad7b2af010060a0a98276de210f1f0d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "customer": ["id", "name", "email"]..
vector_summary: # "customer": ["id", "name", "email"].
chapter: CH-05
:::
# "customer": ["id", "name", "email"]
:::

::: concept
id: BLK-476ba186ec97144b
summary: # "customer": ["*", "creditCardNumber"].
digest: fb5c31b70349f23ebe644a0d5ed4413bc8e80246039b31e3cda51f239f89df5c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "customer": ["*", "creditCardNumber"]..
vector_summary: # "customer": ["*", "creditCardNumber"].
chapter: CH-05
:::
# "customer": ["*", "creditCardNumber"]
:::

::: concept
id: BLK-708c71e7c73e35f2
summary: Role := r if { r := input.user.roles[_] }.
digest: 04226b8568d12aa7f153592d2a76ff456fc495cc63b4b44da7c330ee5b463953
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Role := r if { r := input.user.roles[_] }..
vector_summary: Role := r if { r := input.user.roles[_] }.
chapter: CH-05
:::
role := r if { r := input.user.roles[_] }
:::

::: concept
id: BLK-b8ae9bf60f3a1989
summary: # Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"].
digest: 5805bdfe2ba6c2a4877f0b5c8f182737c4ff96390f61c4d0c145322240d4a475
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"]..
vector_summary: # Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"].
chapter: CH-05
:::
# Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"]
:::

::: concept
id: BLK-492bd318f6c337d0
summary: Resource := path[0] field := path[1].
digest: 0ecb886fe064571236de6ec651178a5b3c604dcb2a3e298da467510830cc9a6b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Resource := path[0] field := path[1]..
vector_summary: Resource := path[0] field := path[1].
chapter: CH-05
:::
resource := path[0] field := path[1]
:::

::: concept
id: BLK-adc62466f65013a1
summary: Not field_allowed(role, resource, field).
digest: 13561d1e2cb0be85c871e88b70c4a06cc8d5fe281320a0d91fc73fb6812edf8f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Not field_allowed(role, resource, field)..
vector_summary: Not field_allowed(role, resource, field).
chapter: CH-05
:::
not field_allowed(role, resource, field)
:::

::: concept
id: BLK-6fd70c9d544e887a
summary: V := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } }.
digest: b118a156b79d71be6259fa0d968974305c58a2b8e014a90953fd5fffaaa711ae
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that V := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } }..
vector_summary: V := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } }.
chapter: CH-05
:::
v := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } }
:::

::: concept
id: BLK-137c2fd546a4d073
summary: Field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard }.
digest: 09a26f2f2cb019da4e07972dd55efcac275f6a7afa21c7c95c616dd3f88ebd8e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard }..
vector_summary: Field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard }.
chapter: CH-05
:::
field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard }
:::

::: concept
id: BLK-2c687b2f253cfbe4
summary: Field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed }.
digest: a0e030479f93cc6b260182e49c179817a1f007b19b0bf99d29b7f15956ebf406
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed }..
vector_summary: Field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed }.
chapter: CH-05
:::
field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed }
:::

::: concept
id: BLK-d016298bd014580e
summary: This chapter covers structural data policies and cost-based models, especially for GraphQL.
digest: bd55e5cb878e8d941192c395b44d2456909a2812eec677ef4145224c7b5a305f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This chapter covers structural data policies and cost-based models, especially for GraphQL..
vector_summary: This chapter covers structural data policies and cost-based models, especially for GraphQL.
chapter: CH-05
:::
This chapter covers structural data policies and cost-based models, especially for GraphQL.
:::

::: concept
id: BLK-e32fefe6aa6f262a
summary: Suppose you maintain per-field costs in data.gql.field_costs:.
digest: b3f153c390bf6a8225e77b86116ebfb9405d0b2b99f55f509408e258ea4bbc7b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Suppose you maintain per-field costs in data.gql.field_costs:..
vector_summary: Suppose you maintain per-field costs in data.gql.field_costs:.
chapter: CH-05
:::
Suppose you maintain per-field costs in data.gql.field_costs:
:::

::: concept
id: BLK-e73b9199be66d077
summary: # data.gql.field_costs = {.
digest: 7eb9134dec90aea961f9252715345334f6208ba141ddde92512b7c6150727a52
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # data.gql.field_costs = {..
vector_summary: # data.gql.field_costs = {.
chapter: CH-05
:::
# data.gql.field_costs = {
:::

::: concept
id: BLK-29afb65bc79a3e3b
summary: # "Query.users.email": 2,.
digest: c84d0fb959246a3bc259c3ac793c0094845577becbae187f990e4f1f15bc32b3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "Query.users.email": 2,..
vector_summary: # "Query.users.email": 2,.
chapter: CH-05
:::
# "Query.users.email": 2,
:::

::: concept
id: BLK-da9d1cf4f0f47cfe
summary: # "Query.users.orders": 3,.
digest: ed2d1a0fa52cf09d678a8cabbd9b7f1fd436b91dcf3486f5ffd17bf39b351990
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "Query.users.orders": 3,..
vector_summary: # "Query.users.orders": 3,.
chapter: CH-05
:::
# "Query.users.orders": 3,
:::

::: concept
id: BLK-6d1f67793e063be6
summary: You want to compute a cost for each field given its path and leaf name.
digest: b5bb8de549d0fee17250a6baf1f702209c9b860e0f9d2d0ac1007e1555cc830d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You want to compute a cost for each field given its path and leaf name..
vector_summary: You want to compute a cost for each field given its path and leaf name.
chapter: CH-05
:::
You want to compute a cost for each field given its path and leaf name.
:::

::: concept
id: BLK-2e2e66e96d2b3f2e
summary: # field_cost([path, field]) := c.
digest: 200bee63745e897f5751ce092cd2127c5cfbbaa532380056c00e306d43fe1fe8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # field_cost([path, field]) := c..
vector_summary: # field_cost([path, field]) := c.
chapter: CH-05
:::
# field_cost([path, field]) := c
:::

::: concept
id: BLK-96475ac62d55d092
summary: # path = ["Query", "users"].
digest: 50ab1d4c1bcdf637b786e166dd03942ef62d2de10975632656552d35dd02578f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # path = ["Query", "users"]..
vector_summary: # path = ["Query", "users"].
chapter: CH-05
:::
# path = ["Query", "users"]
:::

::: concept
id: BLK-1d1bce0ed2b5d5f2
summary: # full = "Query.users.email".
digest: 3f0072153700f576b7460e78b4d3bf1d3841d51412c24f08e6ff37ff186993d3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # full = "Query.users.email"..
vector_summary: # full = "Query.users.email".
chapter: CH-05
:::
# full = "Query.users.email"
:::

::: concept
id: BLK-177acd5879ae1eb5
summary: Field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }.
digest: c425851a28eff033bbd76c06456eb8e2ddd8b7bd212d89e269c9c372513319d1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }..
vector_summary: Field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }.
chapter: CH-05
:::
field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }
:::

::: concept
id: BLK-073cbe3299458fca
summary: Use array.concat(path, [field]), not a non-existent append builtin.
digest: 2ef7020827982543af5f342716b873ffce1929fa6be239c8dc455fc697b66967
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use array.concat(path, [field]), not a non-existent append builtin..
vector_summary: Use array.concat(path, [field]), not a non-existent append builtin.
chapter: CH-05
:::
Use array.concat(path, [field]), not a non-existent append builtin.
:::

::: concept
id: BLK-3f86fc771487f729
summary: Array.concat([1, 2], [3]) = [1, 2, 3].
digest: 8274c9b3c8d13fa16e7bf066bb1924fbf776bceb2586093e7050079131d44367
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Array.concat([1, 2], [3]) = [1, 2, 3]..
vector_summary: Array.concat([1, 2], [3]) = [1, 2, 3].
chapter: CH-05
:::
array.concat([1, 2], [3]) = [1, 2, 3].
:::

::: concept
id: BLK-daffda34523491fc
summary: Safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs...
digest: d8042695ddcc2352478afda67cd8f6b240f185b20245624e542e683c267305d9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs....
vector_summary: Safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs...
chapter: CH-05
:::
safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }
:::

::: concept
id: BLK-d766db30ebdfc849
summary: This function can be used inside a comprehension that walks a GraphQL AST:
digest: bf104acdd36da6af9f79b5119721c8a7dbdf4232051e5316c00ea6f711edfd31
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This function can be used inside a comprehension that walks a GraphQL AST:.
vector_summary: This function can be used inside a comprehension that walks a GraphQL AST:
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
This function can be used inside a comprehension that walks a GraphQL AST:
:::

::: concept
id: BLK-6b73a05c5f7af41e
summary: Total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := f...
digest: 267e7bdbd5a0cf21d8ae609cd8231ac6966c09785c6daba809eb6b71988878c2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := f....
vector_summary: Total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := f...
chapter: CH-05
:::
total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := field_cost([path, name]) })
:::

::: concept
id: BLK-95369408c55face3
summary: A compositional cost model (paths + leaves).
digest: d580de4ba5fb02baed0209db6910f9e048be45fb47f755c5592eb6ad86a6cc3d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A compositional cost model (paths + leaves)..
vector_summary: A compositional cost model (paths + leaves).
chapter: CH-05
:::
A compositional cost model (paths + leaves).
:::

::: concept
id: BLK-e23b8f98ae17ad67
summary: Defensive concatenation.
digest: d597e9d8bb818c46822fdd29ab8101a89e1ce6f218cc12d3bee70e9320ba445c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Defensive concatenation..
vector_summary: Defensive concatenation.
chapter: CH-05
:::
Defensive concatenation.
:::

::: concept
id: BLK-95a4d919e71a1c12
summary: A clean hook for enforcing query limits:.
digest: 9a3455871c486dd7d4207697f1835ae993ae66d440c4799baee38c73fe44e625
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A clean hook for enforcing query limits:..
vector_summary: A clean hook for enforcing query limits:.
chapter: CH-05
:::
A clean hook for enforcing query limits:
:::

::: concept
id: BLK-b9edbad05e484b05
summary: Deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost }.
digest: b2c80912bff26ffa976f7f8bd6477078c935d12395f1195e61a874229d36f1fd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost }..
vector_summary: Deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost }.
chapter: CH-05
:::
deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost }
:::

::: concept
id: BLK-f3552229f486fc05
summary: ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1.
digest: 519390d7b1ba4c8b4c79ea1ddf9442ace97b561e97272efdf29c0cb856d4363f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1..
vector_summary: ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1.
chapter: CH-05
:::
________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1. Treat the request as input: method, path, query params, body. 2. Output a filter document: 3. { 4. "where": { 5. "tenant_id": "tenant-123", 6. "visibility": ["public", "shared_with_user"] 7. } 8. } 9. The service uses that filter to generate SQL. Example: package datafilter
:::

::: concept
id: BLK-393f7de2a0c944c2
summary: Default filter := {}.
digest: f50655a9046041c16387cfada223e754ade5db4fc7c9937b6cb5198a070d2f04
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default filter := {}..
vector_summary: Default filter := {}.
chapter: CH-05
:::
default filter := {}
:::

::: concept
id: BLK-fbf68ce59d9c01f8
summary: Filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) }.
digest: 51c2b60cf537b9aae48b0183fceba0298dca4cf9c183fbd44b1c8eec45ec1b6b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) }..
vector_summary: Filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) }.
chapter: CH-05
:::
filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) }
:::

::: concept
id: BLK-2ee574aac09ad686
summary: Statuses_for(user) := {"active", "pending"} if { "admin" in user.roles }.
digest: c5e723183ede8b4a194a288096d359aaf6f05538219bb99090cd3561b6c654b5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Statuses_for(user) := {"active", "pending"} if { "admin" in user.roles }..
vector_summary: Statuses_for(user) := {"active", "pending"} if { "admin" in user.roles }.
chapter: CH-05
:::
statuses_for(user) := {"active", "pending"} if { "admin" in user.roles }
:::

::: concept
id: BLK-85a476063d06921f
summary: [x, "world"] = ["hello", y].
digest: 60db3675ec37b4c23ce1a9b40903bfc9c953a01bdc9b6fef116ac7a402da3e6a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that [x, "world"] = ["hello", y]..
vector_summary: [x, "world"] = ["hello", y].
chapter: CH-05
:::
[x, "world"] = ["hello", y]
:::

::: concept
id: BLK-2c5e711e15ee03f4
summary: # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ O...
digest: 5b11612898e7c9221c1af48f70c5f7aaf1c14b9f43c9d6b5955099b8572ac079
symbol_refs: [{}, set()]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ O....
vector_summary: # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ O...
chapter: CH-05
:::
# => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ Object: {"k": 1, "v": 2} Special: ‚Ä¢ Empty set: `{}` (not `set()`, which is a type conversion function requiring an argument) ‚Ä¢ Empty object: `{}`
:::

::: concept
id: BLK-e0278fba1f055245
summary: Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision.
digest: 65b75dd0f8a22149adfec15aaacd64e77769b49f64e3c28c5941e7ebc2fd2aaa
symbol_refs: []
semantic_role: decision-flow
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision..
vector_summary: Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision
:::

::: concept
id: BLK-7572efde313bc676
summary: Subgraph POLICIES & DATA C D end.
digest: e9760cd6e15e1d468a7552378e8aaeed8c9b62240f93c5b82bc47a6e7f293707
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Subgraph POLICIES & DATA C D end..
vector_summary: Subgraph POLICIES & DATA C D end.
chapter: CH-05
:::
subgraph POLICIES & DATA C D end
:::

::: concept
id: BLK-f623d12ad47f73ed
summary: Subgraph INPUTS B end.
digest: a31f3f038a07b068659ba8fd8a7abfce2dc45a13386fc8cee236c0cb4f90e9db
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Subgraph INPUTS B end..
vector_summary: Subgraph INPUTS B end.
chapter: CH-05
:::
subgraph INPUTS B end
:::

::: concept
id: BLK-b0acb177781b0063
summary: F -->|JSON Response| A.
digest: 3a91481890d7329e791ebe55d05c141990187ee10da30f3aaa3f7699bd0e5fcd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that F -->|JSON Response| A..
vector_summary: F -->|JSON Response| A.
chapter: CH-05
:::
F -->|JSON Response| A
:::

::: concept
id: BLK-74371f1f90bb0e83
summary: A more detailed view that includes partial evaluation and decision logging:.
digest: c2eb16836123e4d2a1a7d390ac59b73882bc2d7cfb1f49ef72d9f4926a0b585b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A more detailed view that includes partial evaluation and decision logging:..
semantic_categories: [observability, performance]
vector_summary: A more detailed view that includes partial evaluation and decision logging:.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
A more detailed view that includes partial evaluation and decision logging:
:::

::: concept
id: BLK-d20e8dfa86879fc7
summary: Subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end.
digest: 24f16d66f4471689e601574ede426ba4a545cd803b9a337aa4b6b43d1a5e69be
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end..
semantic_categories: [distribution]
vector_summary: Subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end.
chapter: CH-05
:::
subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end
:::

::: concept
id: BLK-30ddfd3dd392bd32
summary: LD --> EV[Evaluate Query] D1 --> EV R --> EV.
digest: aac56bd77b17af75f9a13ec327f052ae962286a881d4d0b0614a9ba92a819c5a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that LD --> EV[Evaluate Query] D1 --> EV R --> EV..
vector_summary: LD --> EV[Evaluate Query] D1 --> EV R --> EV.
chapter: CH-05
:::
LD --> EV[Evaluate Query] D1 --> EV R --> EV
:::

::: concept
id: BLK-2e5f3039527c7503
summary: EV --> RES[Decision Document] EV --> LOG[Decision Log Event].
digest: 6e4186507dbaaa9b4697c91909f2874194e42d3e76139520e7a831fa4548ebab
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that EV --> RES[Decision Document] EV --> LOG[Decision Log Event]..
semantic_categories: [observability]
vector_summary: EV --> RES[Decision Document] EV --> LOG[Decision Log Event].
chapter: CH-05
:::
EV --> RES[Decision Document] EV --> LOG[Decision Log Event]
:::

::: concept
id: BLK-d495a3815b3b05b9
summary: RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake].
digest: d4bbde9201a71aed5bad469a1e1d4268a293840fedeccdb19bcbd8687afb9669
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake]..
vector_summary: RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake].
chapter: CH-05
:::
RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake]
:::

::: concept
id: BLK-35f656550b066ee3
summary: Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path.
digest: cc8dab99ebb6d5960b107aeb77b80870ce06a89739ceb361ebf02ccddf193323
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path..
semantic_categories: [performance]
vector_summary: Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path.
:::

::: concept
id: BLK-e06cf468a4849f5c
summary: Data from bundles and dynamic sources is loaded into data.*.
digest: 7ce90f39a7e68f97a3881cddca8d59c5c652e5c2308dcfefb1ea694040f598e7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Data from bundles and dynamic sources is loaded into data.*..
semantic_categories: [distribution]
vector_summary: Data from bundles and dynamic sources is loaded into data.*.
chapter: CH-05
:::
Data from bundles and dynamic sources is loaded into data.*.
:::

::: concept
id: BLK-f223eb01cf8eba29
summary: Each incoming request passes input + compiled policies + current data snapshot into the evaluator.
digest: e7e1b8c0e3d762afc97483e1408a612121879cd054d7154b7634b9751a2524de
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Each incoming request passes input + compiled policies + current data snapshot into the evaluator..
vector_summary: Each incoming request passes input + compiled policies + current data snapshot into the evaluator.
chapter: CH-05
:::
Each incoming request passes input + compiled policies + current data snapshot into the evaluator.
:::

::: concept
id: BLK-312401e4a78cb757
summary: The evaluator returns a structured decision document and emits decision logs for observability and audits.
digest: ef2c6365d4a93392f81ed13aa04302f13a42fa77faf43b77c07227123647730f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The evaluator returns a structured decision document and emits decision logs for observability and audits..
semantic_categories: [observability]
vector_summary: The evaluator returns a structured decision document and emits decision logs for observability and audits.
chapter: CH-05
:::
The evaluator returns a structured decision document and emits decision logs for observability and audits.
:::

::: concept
id: BLK-b172f82260025d9b
summary: Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram.
digest: 66041c9a1c50fa65b6fe9c920756ca2b83e811d5bdec2d8c237be6d184d5dd97
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram..
vector_summary: Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram.
chapter: CH-05
:::
Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram
:::

::: concept
id: BLK-b19700b3080dc69c
summary: Low latency (localhost).
digest: 6230cf0f36423d487d2386c3a2d240eba539ec1d100ce839ec02f66840b34707
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Low latency (localhost)..
vector_summary: Low latency (localhost).
chapter: CH-05
:::
Low latency (localhost).
:::

::: concept
id: BLK-37b6ab540b493df4
summary: Good for microservices and per-tenant tuning.
digest: e43180737fb82fa60cf3f5ff5ef05c5bf8e88b4e7fcb222994835ec2e1493ddb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Good for microservices and per-tenant tuning..
vector_summary: Good for microservices and per-tenant tuning.
chapter: CH-05
:::
Good for microservices and per-tenant tuning.
:::

::: concept
id: BLK-2c956a537c865bff
summary: Great for shared policies and simple clients (like Nginx, legacy apps).
digest: 797b47cc976f4ae1e2f45dfbc7d3f89f4cdc2896f2847635e0267a0cd5fd5a02
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Great for shared policies and simple clients (like Nginx, legacy apps)..
vector_summary: Great for shared policies and simple clients (like Nginx, legacy apps).
chapter: CH-05
:::
Great for shared policies and simple clients (like Nginx, legacy apps).
:::

::: concept
id: BLK-7984539227277d1e
summary: No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths.
digest: 0983b97011d3c4e72af24c875a60e413f71e70cf1b4d71d662f438aab95d2546
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths..
vector_summary: No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths.
chapter: CH-05
:::
No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths.
:::

::: concept
id: BLK-c6a16c819faf270c
summary: N --> Q[Final Decision].
digest: d0505589b7ced9e8ef4d99e6f997116686b9821d0a85fe80c55f2bf1c8d74e5b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that N --> Q[Final Decision]..
vector_summary: N --> Q[Final Decision].
chapter: CH-05
:::
N --> Q[Final Decision]
:::

::: concept
id: BLK-ac0efa57c504e47d
summary: Domain: Variants per product/region (e.g., EU vs US data rules).
digest: 97f93dc4d29052c6c1a70923e9ea18f53bf0fe4237dc745f652d68a4b14b4f4b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Domain: Variants per product/region (e.g., EU vs US data rules)..
vector_summary: Domain: Variants per product/region (e.g., EU vs US data rules).
chapter: CH-05
:::
Domain: Variants per product/region (e.g., EU vs US data rules).
:::

::: concept
id: BLK-9b47d89fb37632a4
summary: Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*).
digest: d30dc4b350bfda462e9cbfb0da2e50fb7688bd2843f30fc785c2417649e33527
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*)..
vector_summary: Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*).
chapter: CH-05
:::
Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*).
:::

::: concept
id: BLK-be239d14ac089893
summary: Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists).
digest: 41b7bb488b91ceb0012ae3be2d68f60cae1f1c12a49486824517c5c9dda67a4e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists)..
vector_summary: Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists).
chapter: CH-05
:::
Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists).
:::

::: concept
id: BLK-fb9f85c09a41dacf
summary: 13.X.1 Layered Evaluation Example package authz.
digest: 1bdf889db7b032bc7091663577a5fbe5454eecb9b480d22732cc007ac46a34e0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 13.X.1 Layered Evaluation Example package authz..
vector_summary: 13.X.1 Layered Evaluation Example package authz.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
13.X.1 Layered Evaluation Example package authz
:::

::: concept
id: BLK-29dadeb3f0a54d1b
summary: Default allow := false.
digest: 5854a10f76f9fb2a13e1087eef1b7427c2d81611f894e12089e16213643a78f8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-a6ad7c1547585e40
summary: # Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes...
digest: e326c92cebdb182728e55cef9e6bc19b0f82ab2b5b1208792dfc1cbcc8b82df2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes....
vector_summary: # Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes...
chapter: CH-05
:::
# Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes forbidden" }
:::

::: concept
id: BLK-c37d51b33f8c33c7
summary: # Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant overrid...
digest: bb78738aca2a3e680d7a1870743d507546af02e2e3c81ef12775029ab87b1196
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant overrid....
vector_summary: # Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant overrid...
chapter: CH-05
:::
# Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant override: feature-x beta allow" }
:::

::: concept
id: BLK-26016fa8bb549e8a
summary: Allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails }.
digest: 39988e2bfa3bc9da6ce947b58ef1f9b8a1faf603fcb03f9168b1ede21a65ab1b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails }..
vector_summary: Allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails }.
chapter: CH-05
:::
allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails }
:::

::: concept
id: BLK-5ff9a90c174543e6
summary: This pattern makes layer provenance explicit and traceable.
digest: 502d87a9f72505a71fd5d0fdfa6ebf477bdc0e494b531e763acc8ca511d54d42
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This pattern makes layer provenance explicit and traceable..
vector_summary: This pattern makes layer provenance explicit and traceable.
chapter: CH-05
:::
This pattern makes layer provenance explicit and traceable.
:::

::: concept
id: BLK-a1aba1f7c35dda91
summary: LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Da...
digest: d0f9c660cb57a8b0305b8b18906143c35f2012bf1b486b6a6ee191b425e7351c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Da....
semantic_categories: [observability]
vector_summary: LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Da...
chapter: CH-05
:::
LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Data Warehouse]
:::

::: concept
id: BLK-f13d3c0879266a61
summary: Typical fields in the decision log:.
digest: d25afe64508ceadca5ff11fb982c17490ec4d5905cbaf5fbbf0a133807408e21
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Typical fields in the decision log:..
semantic_categories: [observability]
vector_summary: Typical fields in the decision log:.
chapter: CH-05
:::
Typical fields in the decision log:
:::

::: concept
id: BLK-5d6ddaa19e8cfcaf
summary: Input (possibly redacted).
digest: 8a193a45a32b3963a44c8fee4751c82728dcbb3c3a7ef0c4395a28ccddde30c8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Input (possibly redacted)..
vector_summary: Input (possibly redacted).
chapter: CH-05
:::
input (possibly redacted)
:::

::: concept
id: BLK-42e8f5f868517157
summary: Result (decision document).
digest: bd76cb3bad0cd521d325f2cd0709c5777fb860f104461487bb74e4e33ba240a9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Result (decision document)..
vector_summary: Result (decision document).
chapter: CH-05
:::
result (decision document)
:::

::: concept
id: BLK-0e27cac7a34ed96c
summary: Labels (instance, version, tenant).
digest: f663549f53203c284723a5f8795f6951694c686f485ad7d9f099d76d1f0bb6c8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Labels (instance, version, tenant)..
vector_summary: Labels (instance, version, tenant).
chapter: CH-05
:::
labels (instance, version, tenant)
:::

::: concept
id: BLK-9d3aeb0abc8fd54e
summary: This pipeline supports:
digest: c857081d20d6f8f891ac90752d92aea4d1b029a25b955cbec82c6e00dee82d69
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This pipeline supports:.
vector_summary: This pipeline supports:
chapter: CH-05
:::
This pipeline supports:
:::

::: concept
id: BLK-56a7595a69adae94
summary: Real-time alerting (SIEM / SOC).
digest: 63af85b49e4a0f3d85019ed7487da283837f0edb0a607633d9bdeaaa3708545e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Real-time alerting (SIEM / SOC)..
vector_summary: Real-time alerting (SIEM / SOC).
chapter: CH-05
:::
Real-time alerting (SIEM / SOC).
:::

::: concept
id: BLK-5e0ef2d16b64008e
summary: Dashboards (latency, volume, error rates).
digest: f25ed62d7de826cc0f0423a75fa9718301cda20341cd90219780f6a7228fcfc2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Dashboards (latency, volume, error rates)..
vector_summary: Dashboards (latency, volume, error rates).
chapter: CH-05
:::
Dashboards (latency, volume, error rates).
:::

::: concept
id: BLK-81be0a89ed2bbdeb
summary: Audit trails (who allowed what, when, and why).
digest: 884407343b7ce02bf709d276f4c0a1d3d182ebefc9ada43d5b803f8523434f0d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Audit trails (who allowed what, when, and why)..
vector_summary: Audit trails (who allowed what, when, and why).
chapter: CH-05
:::
Audit trails (who allowed what, when, and why).
:::

::: concept
id: BLK-976f4a3022f5c700
summary: Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering.
digest: 48cf191f57c33742b3b3567a079c3aef1396712d4984f8db55062f25369bfbbf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering..
vector_summary: Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering.
graph_neighbors: [TERM-7189e73f44e918ef, CODE-2cbe0767daa4b7a0]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering
:::

::: concept
id: BLK-2b29aec02bdf3804
summary: Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user.
digest: ce2f75267cd79d92fbcb3b088e31f7bae007786730acedbb74f21f5816bf4574
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user..
vector_summary: Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user.
chapter: CH-05
:::
Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user.
:::

::: concept
id: BLK-9ee40e622c0b8c69
summary: # data.resources.projects = [.
digest: c21abd873406d8ad553a30346e8d36982453dceb08584b8297890d7e096e94e5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # data.resources.projects = [..
vector_summary: # data.resources.projects = [.
chapter: CH-05
:::
# data.resources.projects = [
:::

::: concept
id: BLK-62df538504d93142
summary: # {"name": "svc-1", "env": "prod", "owners": ["alice"]},.
digest: 0ac5563e14b1ccaeeb7d8e8b79fb5b35f6617c9421a5d9bc4cecd172f886f4af
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # {"name": "svc-1", "env": "prod", "owners": ["alice"]},..
vector_summary: # {"name": "svc-1", "env": "prod", "owners": ["alice"]},.
chapter: CH-05
:::
# {"name": "svc-1", "env": "prod", "owners": ["alice"]},
:::

::: concept
id: BLK-8564f950737ad167
summary: # {"name": "svc-2", "env": "dev", "owners": ["bob"]}.
digest: 730d9cad8dc68da05b493a7329a1c1b834a92de728838e5e4869b47f89d60482
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # {"name": "svc-2", "env": "dev", "owners": ["bob"]}..
vector_summary: # {"name": "svc-2", "env": "dev", "owners": ["bob"]}.
chapter: CH-05
:::
# {"name": "svc-2", "env": "dev", "owners": ["bob"]}
:::

::: concept
id: BLK-81063a0c4670fed4
summary: # {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]}.
digest: 8e4842c279032788d623de316ecc550238af44d5ac160196f060cce769398352
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]}..
vector_summary: # {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]}.
chapter: CH-05
:::
# {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]}
:::

::: concept
id: BLK-710e9c5927914bb2
summary: Prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.project...
digest: 68f781d4707566a74dfea581a605890b4dd81eed2c5eb388caddcf00903ec758
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.project....
vector_summary: Prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.project...
chapter: CH-05
:::
prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.projects[_] svc := proj.services[_]
:::

::: concept
id: BLK-a2f928d215b1d576
summary: Svc.env == "prod" svc.owners[_] == user ] }.
digest: 188437234e14d7849eb4c3552f8241f765b2fade291fcfa84f2337ce8052270a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Svc.env == "prod" svc.owners[_] == user ] }..
vector_summary: Svc.env == "prod" svc.owners[_] == user ] }.
chapter: CH-05
:::
svc.env == "prod" svc.owners[_] == user ] }
:::

::: concept
id: BLK-35b8084f79c559ed
summary: Alice_prod := prod_services_owned_by("alice").
digest: ddcc77dad2aa0d65917dbd78d49ac7619ff128ec1cb3b89d04ec4e3f69dc9138
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Alice_prod := prod_services_owned_by("alice")..
vector_summary: Alice_prod := prod_services_owned_by("alice").
chapter: CH-05
:::
alice_prod := prod_services_owned_by("alice")
:::

::: concept
id: BLK-f51067adb203c9c1
summary: [ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ].
digest: b7ec0315c47e598683a71fccd7ec24e7107607238f874a1e2138e8bdc85d3a2e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that [ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ]..
vector_summary: [ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ].
chapter: CH-05
:::
[ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ]
:::

::: concept
id: BLK-c947320997cd09cc
summary: Two nested comprehensions (projects[_], services[_]).
digest: 500bbbced5df1b89b29c9ae53781da7a038b2812ec9a263e55a14e630251572b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Two nested comprehensions (projects[_], services[_])..
vector_summary: Two nested comprehensions (projects[_], services[_]).
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Two nested comprehensions (projects[_], services[_]).
:::

::: concept
id: BLK-bb993ad92ca88b76
summary: Inline filtering by environment and ownership.
digest: d83727c1fc89c8f7401db4ba80a17c046e0effaea5e059d2b0cc0a74b59a5394
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Inline filtering by environment and ownership..
vector_summary: Inline filtering by environment and ownership.
chapter: CH-05
:::
Inline filtering by environment and ownership.
:::

::: concept
id: BLK-813a09749e866fe6
summary: Structured result objects built inside the comprehension.
digest: 53e0f59dc5b064834ac3a9f24de6933ceeb60577e80b7849dcfafb7157458af1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Structured result objects built inside the comprehension..
vector_summary: Structured result objects built inside the comprehension.
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Structured result objects built inside the comprehension.
:::

::: concept
id: BLK-2ceb4799a2c96bb9
summary: Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example.
digest: 0b75c1b3752d1622560f3c5447f74a7c02d5f25da664d247958ef6352b33933b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example..
vector_summary: Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example.
chapter: CH-05
:::
Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example
:::

::: concept
id: BLK-fac5338924d4d432
summary: Complete pattern combining decode, verify, and claim checks.
digest: 2a91cafa1dd21b3fb13fd946acd08e8e65a5877bc8c0cb8d3b5315459a83fcfc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Complete pattern combining decode, verify, and claim checks..
vector_summary: Complete pattern combining decode, verify, and claim checks.
chapter: CH-05
:::
Complete pattern combining decode, verify, and claim checks.
:::

::: concept
id: BLK-f5eae2ff1df643e4
summary: # Configuration in data.jwt:.
digest: 375e9b7f5c3413da77de6edd0b8c67f9be194ed7c46c0fdae6a8308870abb5c2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Configuration in data.jwt:..
vector_summary: # Configuration in data.jwt:.
chapter: CH-05
:::
# Configuration in data.jwt:
:::

::: concept
id: BLK-9dd87631232b80f5
summary: # "issuer": "https://issuer.example.com/",.
digest: 9ee4df5bfedc48baa76cda7f93411532b1c0650c2bc805b3e0150f61447efe54
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "issuer": "https://issuer.example.com/",..
vector_summary: # "issuer": "https://issuer.example.com/",.
chapter: CH-05
:::
# "issuer": "https://issuer.example.com/",
:::

::: concept
id: BLK-b7a8495733a99b9e
summary: # "audience": "my-api",.
digest: 234f2b73406dea05b9dcaeb8ee57108e915dde9f47e54032cf305f6d898a5c16
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "audience": "my-api",..
vector_summary: # "audience": "my-api",.
chapter: CH-05
:::
# "audience": "my-api",
:::

::: concept
id: BLK-6e4d17c6138f8e98
summary: # "jwks": { ..
digest: 20862015340d522553a30d0ce28899b62cf5d4a78ac6829699cb8608c05c9841
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "jwks": { ...
vector_summary: # "jwks": { ..
chapter: CH-05
:::
# "jwks": { ... } # if using embedded JWKS
:::

::: concept
id: BLK-8ad24621e33d0824
summary: Default allow := false.
digest: 42d97e550b5ee60aa137c2fbaa1eaeccfde4c74acab8e78e56c1426fc87282c2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-5a57193e78bc4589
summary: Allow if { token := input.headers.authorization startswith(token, "Bearer ").
digest: 64ec38e79634e0be5e4e82c8ff9c08d0a97cd3a8b8763450ec4e24981feffb43
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { token := input.headers.authorization startswith(token, "Bearer ")..
semantic_categories: [authz]
vector_summary: Allow if { token := input.headers.authorization startswith(token, "Bearer ").
graph_neighbors: [CODE-f9165857ee2c0c68, CODE-4d2ad0d6df9f48c1, CODE-ae589d488d5196d2, CODE-e3021412b7e801e0, CODE-22a3c940e76c1893, CODE-1f681853ebf733fb, CODE-4b643428b4f2edd0, CODE-e8a2139bac84c4a0, CODE-3152b6a89a146d23, CODE-ff0c5e5c7e41a636, CODE-322fb8a04486fb51]
graph_degree: 11
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
allow if { token := input.headers.authorization startswith(token, "Bearer ")
:::

::: concept
id: BLK-d4ff7978dd13cf56
summary: Raw := substring(token, count("Bearer "), -1).
digest: 8b0c16f605319d61e8baf4e250523776ea851548a6a186ed32d95ae03d7b83e4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Raw := substring(token, count("Bearer "), -1)..
vector_summary: Raw := substring(token, count("Bearer "), -1).
chapter: CH-05
:::
raw := substring(token, count("Bearer "), -1)
:::

::: concept
id: BLK-c163d16de7a9a92c
summary: # Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw).
digest: ba6dbb43aad2c60f6b93c4356313d20292ed51e835998996a6e4c0292aad2e59
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw)..
vector_summary: # Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw).
chapter: CH-05
:::
# Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw)
:::

::: concept
id: BLK-477027788171287a
summary: Verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) }.
digest: 7c666df3c809e785e6213656e12f4be15735bba73d21db4b1931a77c073ba09f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) }..
vector_summary: Verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) }.
chapter: CH-05
:::
verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) }
:::

::: concept
id: BLK-1003fa1dd551feed
summary: Verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true.
digest: bec5664d5a45250390e1fa2249510c500af19f3fe0413a5c57a0a022567522f8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true..
vector_summary: Verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true.
chapter: CH-05
:::
verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true
:::

::: concept
id: BLK-a99828297e3dc974
summary: # For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true }.
digest: 5e3323b0b73c4e1830cf599bb0f82173efe181bda2657c0fbc51832522296051
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true }..
vector_summary: # For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true }.
chapter: CH-05
:::
# For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true }
:::

::: concept
id: BLK-ed618edd2a05c651
summary: Verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer.
digest: 9e7517164c00622571233a5d550927552727a25b4c2406579f763a1d4435ec93
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer..
vector_summary: Verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer.
chapter: CH-05
:::
verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer
:::

::: concept
id: BLK-80e59217aeec7749
summary: # aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := au...
digest: 18f047f6e3ca580fdad39c01ce3638dd791985f8ace2d769e4c36b805bd845e3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := au....
vector_summary: # aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := au...
chapter: CH-05
:::
# aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := aud )
:::

::: concept
id: BLK-2326d2661bb082c0
summary: Some i aud_array[i] == data.jwt.audience.
digest: c4e6f49a186b6e220784968949770de5ed72f0d2c480c461b9457475e4b47ff5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some i aud_array[i] == data.jwt.audience..
vector_summary: Some i aud_array[i] == data.jwt.audience.
chapter: CH-05
:::
some i aud_array[i] == data.jwt.audience
:::

::: concept
id: BLK-b4e88b76bdf8c0c0
summary: # exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now }.
digest: 7dfb97815ef8eb04e0dbc9bab57d3bec25d77cdb5038f488254d6c622e84de41
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now }..
vector_summary: # exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now }.
chapter: CH-05
:::
# exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now }
:::

::: concept
id: BLK-b75673f31a5a408f
summary: Verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true.
digest: 2ed8cc8ce8afd9cff01543d047258eeb33b6f0ce7cf0757c57d55b9dbfdd87a5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true..
vector_summary: Verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true.
chapter: CH-05
:::
verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true
:::

::: concept
id: BLK-05ff27cf94f0f286
summary: # Scope-based check some i payload.scope[i] == "read:orders" }.
digest: e52526e0dbd0d1fa04d9682941e62faebfc8332eae791e051d1db1418f7b88c7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Scope-based check some i payload.scope[i] == "read:orders" }..
vector_summary: # Scope-based check some i payload.scope[i] == "read:orders" }.
chapter: CH-05
:::
# Scope-based check some i payload.scope[i] == "read:orders" }
:::

::: concept
id: BLK-441c9184c5a43cc2
summary: This example is realistic enough to drop into an API gateway or backend service.
digest: f9692be58a97f78140f359b6955b36f0f4f8ee4c4932344b840f520cd14b0829
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This example is realistic enough to drop into an API gateway or backend service..
vector_summary: This example is realistic enough to drop into an API gateway or backend service.
chapter: CH-05
:::
This example is realistic enough to drop into an API gateway or backend service.
:::

::: concept
id: BLK-bda11239f7ba578b
summary: Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example.
digest: 47ee5e82ec754ff9254001bc49f2cbf55c730ae96b1a5bc51a4d8bc243e31f96
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example..
semantic_categories: [distribution]
vector_summary: Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example.
chapter: CH-05
:::
Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example
:::

::: concept
id: BLK-d34d0d419aa0c7e2
summary: A typical bundle layout on disk:.
digest: e9b64164882794dca4d2bd22279273d948c4e0230a0d113f4675a04a3e26ab94
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A typical bundle layout on disk:..
semantic_categories: [distribution]
vector_summary: A typical bundle layout on disk:.
chapter: CH-05
:::
A typical bundle layout on disk:
:::

::: concept
id: BLK-69b6a886fdd31d76
summary: 9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] }.
digest: 042ceca72e8a6ea1907b6e10c31fbc98d78fe897175c5261461236e511115be3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] }..
vector_summary: 9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] }.
chapter: CH-05
:::
9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] }
:::

::: concept
id: BLK-0ac25a2b767e2140
summary: Jwt ‚Üí data.jwt.* (if any data).
digest: 0014f820df3dda04eaefe9839eac9c17c87fab2bbb2e1235c43dc2f40fbcc089
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Jwt ‚Üí data.jwt.* (if any data)..
vector_summary: Jwt ‚Üí data.jwt.* (if any data).
chapter: CH-05
:::
jwt ‚Üí data.jwt.* (if any data)
:::

::: concept
id: BLK-c70f9f364e197266
summary: Config ‚Üí data.config.* (from data/config.json).
digest: 4fbabd90aef6890e9ce9f55893d01fae5038cf921b51acab083d735838ec1618
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Config ‚Üí data.config.* (from data/config.json)..
vector_summary: Config ‚Üí data.config.* (from data/config.json).
chapter: CH-05
:::
config ‚Üí data.config.* (from data/config.json)
:::

::: concept
id: BLK-f5381b4672ab8919
summary: Tenants ‚Üí data.tenants.* (from data/tenants/*.json).
digest: bdd6fae6112f3972d37895358a6f2f2bfbcbb24cdb281924160573b1236bc59b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Tenants ‚Üí data.tenants.* (from data/tenants/*.json)..
vector_summary: Tenants ‚Üí data.tenants.* (from data/tenants/*.json).
chapter: CH-05
:::
tenants ‚Üí data.tenants.* (from data/tenants/*.json)
:::

::: concept
id: BLK-f65b10d7491c5a74
summary: You can layer bundles by:.
digest: a47a2a639ad52b1346270d5043264645ad6658a74675cd2076448f9da430975b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You can layer bundles by:..
semantic_categories: [distribution]
vector_summary: You can layer bundles by:.
chapter: CH-05
:::
You can layer bundles by:
:::

::: concept
id: BLK-0e8c5e2011dd4b9b
summary: Using disjoint roots (e.g., authz/ vs pricing/).
digest: 6f87e72f4aa083aaba9a0960049c128eb942cd787712993d1b44d2fa00363044
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Using disjoint roots (e.g., authz/ vs pricing/)..
vector_summary: Using disjoint roots (e.g., authz/ vs pricing/).
chapter: CH-05
:::
Using disjoint roots (e.g., authz/ vs pricing/).
:::

::: concept
id: BLK-c8f0e1b1efee8906
summary: Or orchestrating versioning in the bundle distribution system.
digest: 48bd33517b9f15f548f26f52df49d76f4fff85f01288f7b23c9e5d410137c077
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Or orchestrating versioning in the bundle distribution system..
semantic_categories: [distribution]
vector_summary: Or orchestrating versioning in the bundle distribution system.
chapter: CH-05
:::
Or orchestrating versioning in the bundle distribution system.
:::

::: concept
id: BLK-c1dbf3b38ab667e9
summary: Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document.
digest: ac7e30a5be2b42b67a6ce1bd3d73b895ead080fcf05399a126ca26f8793b9bab
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document..
vector_summary: Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document.
graph_neighbors: [CODEPAT-a00d797a81733169, CODE-4522197481045bd4, CODE-704f6e731c295b92, CODEPAT-c4c47ef6c7df1e75, CODEPAT-3f603bb00d12d7e6, CODE-6fd3a2913e47883e, CODEPAT-e3a1766e8b78df14, CODE-55a5cc5eed674559, CODEPAT-190e5fc8d209ddec, CODEPAT-f8e30e7deeeb39fa, CODEPAT-90bf40e525478abf, CODEPAT-67fa0ef89ef6b03c, CODE-1b4cef265aa6f5e3, CODE-8cd9f756e7ad785f, CODEPAT-ce3111aa333c1369]
graph_degree: 15
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document
:::

::: concept
id: BLK-778e8e4ce5250571
summary: Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system.
digest: 58835a9bdb46faef9ccd91fa9f96611cf4bf012a9e71638bea45f6f9fe687216
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system..
vector_summary: Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system.
chapter: CH-05
:::
Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system.
:::

::: concept
id: BLK-35e5e00ecdd4703e
summary: Package authz.multi_tenant.
digest: 9543ba978863b4519dd6fe11f6629a39112da82e2e266d1db5e1ddb26900dd06
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Package authz.multi_tenant..
vector_summary: Package authz.multi_tenant.
chapter: CH-05
:::
package authz.multi_tenant
:::

::: concept
id: BLK-edc2afac6508d102
summary: Default allow := false.
digest: e2ea5132e5a1debe4c61cebf4e68400611fb78aa390dbbe6934fc5d6c35a2de5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-217a40a7d3f6722c
summary: Domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := ...
digest: e0a01a438e43892f47a35f8fe93f087cbf908890b339eaa36cef9bbf24766fb0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := ....
vector_summary: Domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := ...
chapter: CH-05
:::
domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 }
:::

::: concept
id: BLK-5feaf7cf3b0268ba
summary: Tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow ...
digest: 1e3c5ff5185c882fff086232705996e9c874c4132d6d2eb5f4afda4d92c013c3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow ....
vector_summary: Tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow ...
chapter: CH-05
:::
tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow := count(allow_reasons) > 0 }
:::

::: concept
id: BLK-3632bbb69a6a4073
summary: # Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "a...
digest: a795982b4270e7f504d4e587689ad04d902d1ac590cddcc05b61cd719177d587
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "a....
vector_summary: # Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "a...
chapter: CH-05
:::
# Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "allow": final_allow, "source": final_source } } { not global_decision.allow final_allow := false final_source := "global" } { global_decision.allow not domain_decision.allow final_allow := false final_source := "domain" } { global_decision.allow domain_decision.allow tenant_decision.allow final_allow := true final_source := "tenant" } { global_decision.allow domain_decision.allow not tenant_decision.allow final_allow := true final_source := "domain/global" }
:::

::: concept
id: BLK-ecab223a7c0486a1
summary: Clients now get a rich decision document:.
digest: 5a0acd28d1dbf4f671f501ce984ef89dfcc9351bc1b24b9aa92460db4351e14a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Clients now get a rich decision document:..
vector_summary: Clients now get a rich decision document:.
chapter: CH-05
:::
Clients now get a rich decision document:
:::

::: concept
id: BLK-09019c1063d48428
summary: { "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: featu...
digest: 5385a6092c543d246a84f0ed35b0588905240d1ccfe1cd4a56dfc7c6e86f68ae
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that { "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: featu....
vector_summary: { "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: featu...
chapter: CH-05
:::
{ "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: feature-x beta"]}, "final": {"allow": true, "source": "tenant"} }
:::

::: concept
id: BLK-5e538168da6683e7
summary: Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth.
digest: a24389c9c75be4044de98fbf91110a5fc841b99eeb63649edd2fd4d8470a375a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth..
semantic_categories: [authz]
vector_summary: Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth.
graph_neighbors: [CODE-f9165857ee2c0c68, CODE-4d2ad0d6df9f48c1, CODE-ae589d488d5196d2, CODE-e3021412b7e801e0, CODE-22a3c940e76c1893, CODE-1f681853ebf733fb, CODE-4b643428b4f2edd0, CODE-e8a2139bac84c4a0, CODE-3152b6a89a146d23, CODE-ff0c5e5c7e41a636, CODE-322fb8a04486fb51]
graph_degree: 11
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth
:::

::: concept
id: BLK-75950f14edf8397e
summary: API gateway parses GraphQL into an AST and passes it in input.gql.
digest: 25c97be25b385b60e04be5aba75e6a9918ab632965c72993fcc9f15abc452004
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that API gateway parses GraphQL into an AST and passes it in input.gql..
vector_summary: API gateway parses GraphQL into an AST and passes it in input.gql.
chapter: CH-05
:::
API gateway parses GraphQL into an AST and passes it in input.gql.
:::

::: concept
id: BLK-aa71c08475407014
summary: Schema-driven config is in data.gql.
digest: 001177726711664866d158bb53a52c05efd8af3b34cffed9f53d2e18bd22e4e5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Schema-driven config is in data.gql..
vector_summary: Schema-driven config is in data.gql.
chapter: CH-05
:::
Schema-driven config is in data.gql.
:::

::: concept
id: BLK-1708ce308bfcfad0
summary: { "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "suppor...
digest: 0cd00a401c29b55e260be29d26db46599534d0fe40a2aca5d9d30ad2ca15be67
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that { "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "suppor....
vector_summary: { "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "suppor...
chapter: CH-05
:::
{ "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "support"], "Query.users.email": ["admin"], "Query.users.orders": ["admin", "billing"] } }
:::

::: concept
id: BLK-bb3abd47870bb2d7
summary: Import future.keywords.in.
digest: b1268e45ac0f7b9060df60f60145bd1c1a65d707c56d7421fee7d9dd4cdbfcdc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import future.keywords.in..
vector_summary: Import future.keywords.in.
chapter: CH-05
:::
import future.keywords.in
:::

::: concept
id: BLK-2f580e08bcbba95e
summary: Default allow := false.
digest: 34b899f2bdbdb030abeb27918b8ba1906222da14d6614ee9c12b787e33d45dc1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-2a2bc1ccf807b459
summary: # input.gql example:.
digest: 8f176629f4787831357c8ad4fb72005d0df5ca3e63a87451384033b5d21f7901
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # input.gql example:..
vector_summary: # input.gql example:.
chapter: CH-05
:::
# input.gql example:
:::

::: concept
id: BLK-3dc6f99a487983ea
summary: # "path": ["Query", "users"],.
digest: f1003e9600dae3493ae970c36aba4e460b8ff4c1d50304017664b999017c4c54
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "path": ["Query", "users"],..
vector_summary: # "path": ["Query", "users"],.
chapter: CH-05
:::
# "path": ["Query", "users"],
:::

::: concept
id: BLK-489f1a3e7b195d7f
summary: # {"path": ["Query", "users", "email"], "name": "email"},.
digest: 1ace821be7cf99a1e483b47a3027a8186349f5bc5922bba0d597366ea68275fb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # {"path": ["Query", "users", "email"], "name": "email"},..
vector_summary: # {"path": ["Query", "users", "email"], "name": "email"},.
chapter: CH-05
:::
# {"path": ["Query", "users", "email"], "name": "email"},
:::

::: concept
id: BLK-23d21738b0f1b56f
summary: # {"path": ["Query", "users", "orders"], "name": "orders"}.
digest: b695f6bf1fdf4c8cf53e1c6753dc26f8d491ac0cda36a2b6c112d23306973690
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # {"path": ["Query", "users", "orders"], "name": "orders"}..
vector_summary: # {"path": ["Query", "users", "orders"], "name": "orders"}.
chapter: CH-05
:::
# {"path": ["Query", "users", "orders"], "name": "orders"}
:::

::: concept
id: BLK-d94d9a8b50f394c0
summary: # "roles": ["support"].
digest: e8393bd7b49e0c605cf147c68ba51cac748067af1bf7d756be0b63ce2bf5240c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # "roles": ["support"]..
vector_summary: # "roles": ["support"].
chapter: CH-05
:::
# "roles": ["support"]
:::

::: concept
id: BLK-84861e440fcba053
summary: User_roles := input.gql.user.roles.
digest: 383f673fd26c9c817b74aa1cbc319d3bac80c8dfa984da4de940ecda50293923
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that User_roles := input.gql.user.roles..
vector_summary: User_roles := input.gql.user.roles.
chapter: CH-05
:::
user_roles := input.gql.user.roles
:::

::: concept
id: BLK-b5bff85150d3377c
summary: Field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }.
digest: d8cb9473197abaec5ca484c62fea8eb6cad1e56c21bef4d8bc423e8529a58aaf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }..
vector_summary: Field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }.
chapter: CH-05
:::
field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }
:::

::: concept
id: BLK-baba7ac4a7b4d63d
summary: Field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] }.
digest: 0e04897c38f4d5375b3eb3a1172109c83f1d0d8d632ec6f74efead1a93f40508
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] }..
vector_summary: Field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] }.
chapter: CH-05
:::
field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] }
:::

::: concept
id: BLK-e0c6ec40c537eb08
summary: # Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.op...
digest: c858c7f211d3d2b5948a551c167ef18e30f8aef7087214a538a5c10592183dd3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.op....
vector_summary: # Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.op...
chapter: CH-05
:::
# Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.operations[_] f := op.fields[_] ] ++ [ {"path": sf.path, "name": sf.name} | op := input.gql.operations[_] f := op.fields[_] sf := f.subfields[_] ] }
:::

::: concept
id: BLK-1804a20482d1b343
summary: Total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) }).
digest: 0250650fab8274d62e4ee8494dc58c629182b507b44591fe891cb5d0fdf26cf7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) })..
vector_summary: Total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) }).
chapter: CH-05
:::
total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) })
:::

::: concept
id: BLK-39ed6f20348b8623
summary: Too_expensive if { total_cost > data.gql.max_cost }.
digest: a2b4d843e5bd65691c03c71f7085a2aa2419da14a94b8aa515ed4e26fb337e1b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Too_expensive if { total_cost > data.gql.max_cost }..
vector_summary: Too_expensive if { total_cost > data.gql.max_cost }.
chapter: CH-05
:::
too_expensive if { total_cost > data.gql.max_cost }
:::

::: concept
id: BLK-2290e821ea646404
summary: Unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) }.
digest: 9cac36125e487f102446fe5d27b04573a1bff9e43fa0e7638613b5b297676861
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) }..
vector_summary: Unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) }.
chapter: CH-05
:::
unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) }
:::

::: concept
id: BLK-0f57f72096c4c8a0
summary: Allow if { not too_expensive count(unauthorized_fields) == 0 }.
digest: c15c89cd9a6b24812248f6307afb7e8a80739cdc631eac432d9e4347091de4f8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { not too_expensive count(unauthorized_fields) == 0 }..
vector_summary: Allow if { not too_expensive count(unauthorized_fields) == 0 }.
chapter: CH-05
:::
allow if { not too_expensive count(unauthorized_fields) == 0 }
:::

::: concept
id: BLK-4ce77748e8276750
summary: Decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields }.
digest: cf610f121768f0beb3d007b0bf41576e322fccde05e3b56b2101068faeff4e67
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields }..
vector_summary: Decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields }.
chapter: CH-05
:::
decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields }
:::

::: concept
id: BLK-d936cb7e30a4ea67
summary: Field-level auth (field_allowed).
digest: 57a4e075cbde2f671ccb44835f37c34648469585d6aa22a3553c45bd4b7cb268
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Field-level auth (field_allowed)..
vector_summary: Field-level auth (field_allowed).
chapter: CH-05
:::
Field-level auth (field_allowed).
:::

::: concept
id: BLK-36ea9500bf4999b0
summary: Cost-based limiting (total_cost, too_expensive).
digest: ba34f4badc0c8a406a4a053d3960233a136d174f96c9efa8e78b2d7b196eb147
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Cost-based limiting (total_cost, too_expensive)..
vector_summary: Cost-based limiting (total_cost, too_expensive).
chapter: CH-05
:::
Cost-based limiting (total_cost, too_expensive).
:::

::: concept
id: BLK-d8cbad3b94589fdb
summary: A rich decision document for clients.
digest: cd77120bfeb93d1735be60c8be9e37a33bc7ecd14fb34e67a4402dad1ee2ed2c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A rich decision document for clients..
vector_summary: A rich decision document for clients.
chapter: CH-05
:::
A rich decision document for clients.
:::

::: concept
id: BLK-3ed64c8d88ca8eca
summary: 17.X.1 Validation Pipeline Steps.
digest: 874ee9881f058549420bab373c8955070098a8366575b23780f8ee44a1d31584
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 17.X.1 Validation Pipeline Steps..
vector_summary: 17.X.1 Validation Pipeline Steps.
chapter: CH-05
:::
17.X.1 Validation Pipeline Steps
:::

::: concept
id: BLK-d10604b78eaedde3
summary: Human review for MAD (Major Action/Decision) changes.
digest: fdd15f1e81312a6d21254a7f8e4117d58eab543c4870f2fb769b997c170475ce
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Human review for MAD (Major Action/Decision) changes..
vector_summary: Human review for MAD (Major Action/Decision) changes.
chapter: CH-05
:::
Human review for MAD (Major Action/Decision) changes.
:::

::: concept
id: BLK-3cec2ea33dbc48c5
summary: 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests.
digest: 9c8fcb2a60390b2aa95ff49b202c467fe359c917a667886767a704f282fc2652
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests..
vector_summary: 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests.
chapter: CH-05
:::
17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests
:::

::: concept
id: BLK-33fa20a5d4c88b66
summary: Package authz.orders.
digest: 8110c131aed8b58e2e2dc91b946603d16673db3b989a214b055717c8cf853106
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Package authz.orders..
vector_summary: Package authz.orders.
chapter: CH-05
:::
package authz.orders
:::

::: concept
id: BLK-70478133c7e3b2e9
summary: Default allow := false.
digest: 01f885115c2b6b1a1a08f4d2ab2dddcff257e11cfd2ff9a6cf93fe43443ab61d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Default allow := false..
vector_summary: Default allow := false.
chapter: CH-05
:::
default allow := false
:::

::: concept
id: BLK-03fccd8e6d2155ad
summary: # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id].
digest: 416e6d81d16269764f0db425d76c14aa1a376f67bf1903d336a68cb8ed1690e3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id]..
vector_summary: # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id].
chapter: CH-05
:::
# Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id]
:::

::: concept
id: BLK-270b38e64b2b00e3
summary: Some order order := data.orders[order_id].
digest: 83743a66e50b3576a1925b17716e9e80a9b9b3a63d043ba424dbc8396cb7d217
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some order order := data.orders[order_id]..
vector_summary: Some order order := data.orders[order_id].
chapter: CH-05
:::
some order order := data.orders[order_id]
:::

::: concept
id: BLK-70a8f91f82a18e3d
summary: ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) }.
digest: 1c89ce5dd1b90996b85f1fdcaf4d55cfd7cf94f6f2c446837ba08d45fb5aa7c7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) }..
vector_summary: ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) }.
chapter: CH-05
:::
( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) }
:::

::: concept
id: BLK-fbbe119189f2ab36
summary: Package authz.orders_test.
digest: f0b36be4962e785ade7643172d474237c574e34b767ccd60015a83b5b0dae864
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Package authz.orders_test..
vector_summary: Package authz.orders_test.
chapter: CH-05
:::
package authz.orders_test
:::

::: concept
id: BLK-54d277aeaababbe9
summary: Import data.authz.orders.
digest: 2157074d35f0d9bd405d7a5a66b958b690b0f26d5ff9eeec9e51ae21014025fc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.authz.orders..
vector_summary: Import data.authz.orders.
chapter: CH-05
:::
import data.authz.orders
:::

::: concept
id: BLK-405a975fd98ce06b
summary: Test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id ==...
digest: 51665fbaf1db7e6102d4340532f922270557c9e90c55580722d6a346aeb01c32
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id ==....
vector_summary: Test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id ==...
chapter: CH-05
:::
test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id == "alice"
:::

::: concept
id: BLK-7f7b19bbfe9ca742
summary: Result := orders.allow with input as input result == true }.
digest: 4aa1f881f8979b982d4a444d882ca8e47c03c47e56e20774b62929110c353135
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Result := orders.allow with input as input result == true }..
vector_summary: Result := orders.allow with input as input result == true }.
chapter: CH-05
:::
result := orders.allow with input as input result == true }
:::

::: concept
id: BLK-09066e199d225e96
summary: Test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_...
digest: bcbf1498653df9810aa0c47307df83984af344db5ccaea7ce3900a33299895e2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_....
vector_summary: Test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_...
chapter: CH-05
:::
test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_id == "alice"
:::

::: concept
id: BLK-2ef9e325c3ede69b
summary: Result := orders.allow with input as input result == false }.
digest: fe3cec019ce00992cf9ac5de72d7468600606447f1106bf15bf2fd9510b10d21
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Result := orders.allow with input as input result == false }..
vector_summary: Result := orders.allow with input as input result == false }.
chapter: CH-05
:::
result := orders.allow with input as input result == false }
:::

::: concept
id: BLK-6c4f81cc9fa85914
summary: Test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} }.
digest: a6c70f469a6dbd78217f9cdd9a4492e2f1317a0327288903a798e463980d374f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} }..
vector_summary: Test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} }.
chapter: CH-05
:::
test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} }
:::

::: concept
id: BLK-0e04cfd232a00a3d
summary: Result := orders.allow with input as input result == true }.
digest: e1e7f904375aaf6b9dd6240057628b0d598a0136fea9a6d0040388dcd0bdec4c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Result := orders.allow with input as input result == true }..
vector_summary: Result := orders.allow with input as input result == true }.
chapter: CH-05
:::
result := orders.allow with input as input result == true }
:::

::: concept
id: BLK-a39d79842263ba83
summary: Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths).
digest: fdd79f58e7c4bbce19f931604786fe01947af6c58a08634eafe144ae7ff5e8b0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths)..
vector_summary: Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths).
chapter: CH-05
:::
Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths).
:::

::: concept
id: BLK-8c30db71e7f93b4d
summary: If all pass, bundle and distribute.
digest: 834c320a1c6e16f5117fcbf23daf3b2ea3afd3f5f3ee6ce3a5a82389899798d3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If all pass, bundle and distribute..
semantic_categories: [distribution]
vector_summary: If all pass, bundle and distribute.
chapter: CH-05
:::
If all pass, bundle and distribute.
:::

::: concept
id: BLK-94f8c149d00a676c
summary: Inner blocks can rebind a variable name used in an outer block, changing meaning silently.
digest: cf3dc42ad108453f0a4c4d4da5b0fe7d38a1a2fb2725a12f8bd067bb10a8a9e3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Inner blocks can rebind a variable name used in an outer block, changing meaning silently..
vector_summary: Inner blocks can rebind a variable name used in an outer block, changing meaning silently.
chapter: CH-05
:::
Inner blocks can rebind a variable name used in an outer block, changing meaning silently.
:::

::: concept
id: BLK-c1e1ad2a784b9961
summary: Allow if { user := data.override_user # shadows outer user user.id == "admin" }.
digest: 2f56e8c2427cee76db3209ff66197d11ba78d82c6116432d67abb539b6236f97
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { user := data.override_user # shadows outer user user.id == "admin" }..
vector_summary: Allow if { user := data.override_user # shadows outer user user.id == "admin" }.
chapter: CH-05
:::
allow if { user := data.override_user # shadows outer user user.id == "admin" }
:::

::: concept
id: BLK-e9a2a703bbdc8110
summary: The inner user hides the outer one.
digest: 0e943174f21bbc62cfcdae499d0d7395dcc77f36d3e0a690d5316dc9ee6ccf97
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The inner user hides the outer one..
vector_summary: The inner user hides the outer one.
chapter: CH-05
:::
The inner user hides the outer one. Prefer distinct names unless you truly mean to shadow:
:::

::: concept
id: BLK-5fe91289cef7406b
summary: Allow if { override_user := data.override_user override_user.id == "admin" }.
digest: 5e0b7f9f9e5b8ce3390f891fa0fc9e6a438c720d82faadcdbee2135c47cd8ce1
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { override_user := data.override_user override_user.id == "admin" }..
vector_summary: Allow if { override_user := data.override_user override_user.id == "admin" }.
chapter: CH-05
:::
allow if { override_user := data.override_user override_user.id == "admin" }
:::

::: concept
id: BLK-66161b54f3ab4c92
summary: Use distinct names:.
digest: cfcecd7866a8db9543d4124538b1a8f840280a05c1fe71021f58f708747f74f0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use distinct names:..
vector_summary: Use distinct names:.
chapter: CH-05
:::
Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names:
:::

::: concept
id: BLK-633a4a5154649ed1
summary: Instead, build sets or arrays with comprehensions, then aggregate:.
digest: 83d2673fcec0bad229d5116fe642b49ab4cff8e04b39185a072dc141da31c910
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Instead, build sets or arrays with comprehensions, then aggregate:..
vector_summary: Instead, build sets or arrays with comprehensions, then aggregate:.
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Instead, build sets or arrays with comprehensions, then aggregate:
:::

::: concept
id: BLK-4504655151caa66a
summary: Violations := { v | some i v := input.items[i] v.level == "HIGH" }.
digest: be072b580e8ecd3043d49f1769a6c125538207d04854b8a61ae90415a359be70
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Violations := { v | some i v := input.items[i] v.level == "HIGH" }..
vector_summary: Violations := { v | some i v := input.items[i] v.level == "HIGH" }.
chapter: CH-05
:::
violations := { v | some i v := input.items[i] v.level == "HIGH" }
:::

::: concept
id: BLK-b7db79b559c9a8be
summary: Violation_count := count(violations).
digest: aa4d215711ba072684bcaecf9788498c79514d6e1eb50e619b4470cdf249b151
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Violation_count := count(violations)..
vector_summary: Violation_count := count(violations).
chapter: CH-05
:::
violation_count := count(violations)
:::

::: concept
id: BLK-dc69febaea17b4d4
summary: You can also provide a default:.
digest: c2b66acba521fd4996367628acfe017a100ab5d3430623c1fad0a41eadd0492c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You can also provide a default:..
vector_summary: You can also provide a default:.
chapter: CH-05
:::
You can also provide a default:
:::

::: concept
id: BLK-e47efc5955420f53
summary: User_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }.
digest: cd2b725e9db623ce4b93a0d6c2e68c043d1ec3666f85e81123bdf1c2f71be1c5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that User_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }..
vector_summary: User_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }.
chapter: CH-05
:::
user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }
:::

::: concept
id: BLK-7c1a3d4a579c38de
summary: User_email := "unknown" if { not is_string(user_email) }.
digest: 813cdad010ea58ebcae77333d9f1b42e2e9592f0fed58d0a567e907e7a8d475a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that User_email := "unknown" if { not is_string(user_email) }..
vector_summary: User_email := "unknown" if { not is_string(user_email) }.
chapter: CH-05
:::
user_email := "unknown" if { not is_string(user_email) }
:::

::: concept
id: BLK-e4237f7442d9769a
summary: Null, missing, and ‚Äúfalsy‚Äù values are different:.
digest: 3d4a1e14e10c487ea7273a5c628bf2cb6307cc171d00b102fb88d62f99748a7c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Null, missing, and ‚Äúfalsy‚Äù values are different:..
vector_summary: Null, missing, and ‚Äúfalsy‚Äù values are different:.
chapter: CH-05
:::
null, missing, and ‚Äúfalsy‚Äù values are different:
:::

::: concept
id: BLK-365c96c74e794ad8
summary: Missing: input.user.email ‚Üí error if user missing or not object.
digest: 8e3a43a94baedceb0fdfa3b7337ac0f02fe6b90284cd7710d60407855bb7a9b4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Missing: input.user.email ‚Üí error if user missing or not object..
vector_summary: Missing: input.user.email ‚Üí error if user missing or not object.
chapter: CH-05
:::
Missing: input.user.email ‚Üí error if user missing or not object.
:::

::: concept
id: BLK-624f75dd97acc370
summary: Present but null: input.user.email == null is valid.
digest: a3c62d1d19c0eeb690e3afdef46d805f50af1d00a9d298775f668bcfe2ca3687
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Present but null: input.user.email == null is valid..
vector_summary: Present but null: input.user.email == null is valid.
chapter: CH-05
:::
Present but null: input.user.email == null is valid.
:::

::: concept
id: BLK-7b110b84bf4a7140
summary: Falsy (e.g., "", 0, false): normal values.
digest: cf54819e392b55f702b9d91939e05598e065ece83e33477af3bb71634b65a4f5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Falsy (e.g., "", 0, false): normal values..
vector_summary: Falsy (e.g., "", 0, false): normal values.
chapter: CH-05
:::
Falsy (e.g., "", 0, false): normal values.
:::

::: concept
id: BLK-d4b34685c6fe166d
summary: Use guards to distinguish:.
digest: 72723658c27049a02018f1b21018d92ec917c5d1eac4988572b0799d2c8c0df5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use guards to distinguish:..
vector_summary: Use guards to distinguish:.
chapter: CH-05
:::
Use guards to distinguish:
:::

::: concept
id: BLK-21057b3108817270
summary: Has_email if { is_object(input.user) input.user.email != null }.
digest: 22b703f1bf5a1d6b56ec74aff58d3e66f2a25f857219f5b0455e503222b90695
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Has_email if { is_object(input.user) input.user.email != null }..
vector_summary: Has_email if { is_object(input.user) input.user.email != null }.
chapter: CH-05
:::
has_email if { is_object(input.user) input.user.email != null }
:::

::: concept
id: BLK-9c0b54c322f0cfd2
summary: Wrap in a safe helper or use guards:.
digest: 66c612c5791501e7e712808f4d46000f938bdbbef24d52ef71a70a1b8efb8fcf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Wrap in a safe helper or use guards:..
vector_summary: Wrap in a safe helper or use guards:.
chapter: CH-05
:::
Wrap in a safe helper or use guards:
:::

::: concept
id: BLK-831a0270acb78581
summary: Full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) }.
digest: 35eda475a49d874d3fa75cbcca5f0ae2426684cbb68fffe23a2b96653cace8cf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) }..
vector_summary: Full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) }.
chapter: CH-05
:::
full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) }
:::

::: concept
id: BLK-825177e2f70d19a9
summary: Safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }.
digest: cd3e723c51444042e58a16b617165a6cade7059ab230b3541497a528cf7eb604
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }..
vector_summary: Safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }.
chapter: CH-05
:::
safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }
:::

::: concept
id: BLK-55ada30082a8703f
summary: Allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] }.
digest: d5eb7cd0abaa9f5cb5a421937ef00101a254cbc75aea38b30ada7a158806ab5d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] }..
vector_summary: Allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] }.
chapter: CH-05
:::
allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] }
:::

::: concept
id: BLK-b5937dcce3d0252f
summary: X in y behaves differently depending on whether y is an array, set, or object.
digest: 1a2822f04291ef0bc337b3950ea8e421e044ec1e9f2bc7404e4600ba43410229
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that X in y behaves differently depending on whether y is an array, set, or object..
vector_summary: X in y behaves differently depending on whether y is an array, set, or object.
chapter: CH-05
:::
x in y behaves differently depending on whether y is an array, set, or object.
:::

::: concept
id: BLK-79448506eb420437
summary: Array: x in ["a", "b"].
digest: 4c7e75e7d1f31d58611e3fede8a5afa67757091290947a86624abdbd677bcedb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Array: x in ["a", "b"]..
vector_summary: Array: x in ["a", "b"].
chapter: CH-05
:::
Array: x in ["a", "b"]
:::

::: concept
id: BLK-b7157bcb8e94b0ed
summary: Set: x in {"a", "b"}.
digest: 89d3f30e7ab6d4c658f7ef0ff520a357f4354eb780d4399f8b1f06f0b3b2a8cd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Set: x in {"a", "b"}..
vector_summary: Set: x in {"a", "b"}.
chapter: CH-05
:::
Set: x in {"a", "b"}
:::

::: concept
id: BLK-2e17d5deecfb16e9
summary: Object: k in {"a": 1} matches keys, not values.
digest: 8d2da194a4568f23b534c429989b0ca16e03bf732347fe7f2c78e4e83b045348
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Object: k in {"a": 1} matches keys, not values..
vector_summary: Object: k in {"a": 1} matches keys, not values.
chapter: CH-05
:::
Object: k in {"a": 1} matches keys, not values.
:::

::: concept
id: BLK-d2517da8161f68a7
summary: Be explicit about what you mean:.
digest: caefbb767c1220c464d52c432363ffd1a62d373c4bc3910f11360e7eaa3106c8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Be explicit about what you mean:..
vector_summary: Be explicit about what you mean:.
chapter: CH-05
:::
Be explicit about what you mean:
:::

::: concept
id: BLK-c6c12d42e06d1082
summary: # Key membership "k1" in {"k1": 1, "k2": 2}.
digest: 89c699542f51a7298523e1b98ced896673a4ef40c9c63ee4e9bb35165421a6f6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Key membership "k1" in {"k1": 1, "k2": 2}..
vector_summary: # Key membership "k1" in {"k1": 1, "k2": 2}.
chapter: CH-05
:::
# Key membership "k1" in {"k1": 1, "k2": 2}
:::

::: concept
id: BLK-352021e25dd18271
summary: # Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"}.
digest: 87a7c2e5a6fd57a39e05eb954e8150c1d02753914e0b1c7d2067c32ca4b04e87
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"}..
vector_summary: # Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"}.
chapter: CH-05
:::
# Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"}
:::

::: concept
id: BLK-5178d3c470aafde0
summary: Pre-index large data sets offline (e.g., data.events_by_ip[ip]).
digest: c392cafb15fc51402c65c9cd167e2caac4758a8731d641ee24562fd1734fe7b3
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Pre-index large data sets offline (e.g., data.events_by_ip[ip])..
vector_summary: Pre-index large data sets offline (e.g., data.events_by_ip[ip]).
chapter: CH-05
:::
Pre-index large data sets offline (e.g., data.events_by_ip[ip]).
:::

::: concept
id: BLK-99693fd9c0631dc9
summary: Use sets for membership checks.
digest: 1ddd194407ab3b5e68483451f57b0ed0075b93934769cb416130d949b3fa6835
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use sets for membership checks..
vector_summary: Use sets for membership checks.
chapter: CH-05
:::
Use sets for membership checks.
:::

::: concept
id: BLK-89b4222f574f5bd8
summary: # Precomputed: data.events_by_ip = { "1.2.3.4": true, ..
digest: 9ef8a9534a708b909f60eefab4315757a44fde07056764d1a94dfeb3ee15d72f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Precomputed: data.events_by_ip = { "1.2.3.4": true, ...
vector_summary: # Precomputed: data.events_by_ip = { "1.2.3.4": true, ..
chapter: CH-05
:::
# Precomputed: data.events_by_ip = { "1.2.3.4": true, ... }
:::

::: concept
id: BLK-2b4b1821e0d0db43
summary: Deny if { data.events_by_ip[input.client_ip] }.
digest: f70625e43c93643bb2f4837c294f701681555d23fc44754eadf13d48bf41e824
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny if { data.events_by_ip[input.client_ip] }..
vector_summary: Deny if { data.events_by_ip[input.client_ip] }.
chapter: CH-05
:::
deny if { data.events_by_ip[input.client_ip] }
:::

::: concept
id: BLK-b992c588b72a15d0
summary: Push pattern constraints into data modeling if possible.
digest: bb87d62f1338705cc00a5e3a1b4c4a115a7910af77c802441462335018c81bde
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Push pattern constraints into data modeling if possible..
vector_summary: Push pattern constraints into data modeling if possible.
chapter: CH-05
:::
Push pattern constraints into data modeling if possible.
:::

::: concept
id: BLK-a62e5ffefca78bb2
summary: Limit regex to narrow fields and avoid complex patterns.
digest: fc7a4f0c119df49e9c65e902320aaaa0da7a30d7cd077ed5a4623d19cf3cc4b5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Limit regex to narrow fields and avoid complex patterns..
vector_summary: Limit regex to narrow fields and avoid complex patterns.
chapter: CH-05
:::
Limit regex to narrow fields and avoid complex patterns.
:::

::: concept
id: BLK-a0d6a6b70fe5fdb9
summary: Precompile filters into simpler checks (startswith, contains equivalent logic).
digest: 82ef46460bbd40f12ae62350e012a1ed3fe6116231ce806ed8b20f77b50b1ec6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Precompile filters into simpler checks (startswith, contains equivalent logic)..
vector_summary: Precompile filters into simpler checks (startswith, contains equivalent logic).
chapter: CH-05
:::
Precompile filters into simpler checks (startswith, contains equivalent logic).
:::

::: concept
id: BLK-d2bdd9db4aebc3a8
summary: Bind once and reuse:.
digest: 11ea54608b8203a565645aa0ee7026ba6364646e40cdc08475fdf9ba2ea6f483
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Bind once and reuse:..
vector_summary: Bind once and reuse:.
chapter: CH-05
:::
Bind once and reuse:
:::

::: concept
id: BLK-637e77339c5814ec
summary: Deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call }.
digest: 37aff4f01cad3bd485cdb87c1e351e80cc4737c46df4df2365dc3b28edb11932
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call }..
vector_summary: Deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call }.
chapter: CH-05
:::
deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call }
:::

::: concept
id: BLK-8824da1c32a641ad
summary: You can also use helper functions for complex computations.
digest: 509b26879c4d5be41fe33a4390569a098cf988b69b79020fa8ce9828b95696c5
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You can also use helper functions for complex computations..
vector_summary: You can also use helper functions for complex computations.
chapter: CH-05
:::
You can also use helper functions for complex computations.
:::

::: concept
id: BLK-13991d114e5dea7e
summary: Evaluating large, mostly static policies at runtime:.
digest: da5d71e852efa8434611d7712f7454df9aab4b058989191f61f28233d48914da
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Evaluating large, mostly static policies at runtime:..
vector_summary: Evaluating large, mostly static policies at runtime:.
chapter: CH-05
:::
Evaluating large, mostly static policies at runtime:
:::

::: concept
id: BLK-52bb492156ce1912
summary: If most config is static, bake it into data and use partial evaluation:.
digest: 0184be72b6bcdff87280ed45e2e41785b6ca3102eb92ea49e8e65d95c483a8e9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If most config is static, bake it into data and use partial evaluation:..
semantic_categories: [performance]
vector_summary: If most config is static, bake it into data and use partial evaluation:.
graph_neighbors: [TERM-77eaf07b79028829, TERM-2e68e77273483d64]
graph_degree: 2
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
If most config is static, bake it into data and use partial evaluation:
:::

::: concept
id: BLK-0ce0885ddcf9ff4e
summary: Then pass only request-specific input and reap the performance benefits.
digest: 658d7510f4afe2dd690b2c5fcdcb16dc98603b29a0cee94a5a731f791ee64341
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Then pass only request-specific input and reap the performance benefits..
vector_summary: Then pass only request-specific input and reap the performance benefits.
graph_neighbors: [TERM-fa93cc1275da4b1d]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
Then pass only request-specific input and reap the performance benefits.
:::

::: concept
id: BLK-1b7adba70540b67a
summary: Walk is powerful but traverses entire trees.
digest: 44291cbc0014dce918a97775deacb39ee04c1b9e588e4d6b7f492e70351c0e61
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Walk is powerful but traverses entire trees..
vector_summary: Walk is powerful but traverses entire trees.
chapter: CH-05
:::
walk is powerful but traverses entire trees. Instead:
:::

::: concept
id: BLK-a7dbd4176f57e16c
summary: Narrow the search to known subtrees.
digest: a17d3f25e1a11b2bba018caf9a74b7928531158a5c69631852388e74616a3cc4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Narrow the search to known subtrees..
vector_summary: Narrow the search to known subtrees.
chapter: CH-05
:::
Narrow the search to known subtrees.
:::

::: concept
id: BLK-223e103f0ca5d229
summary: Maintain dedicated indexes for sensitive values.
digest: 0073f43efaf0f3222903c4bddc9b751dc847ce44d815135369000a44fe3d9f4f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Maintain dedicated indexes for sensitive values..
vector_summary: Maintain dedicated indexes for sensitive values.
chapter: CH-05
:::
Maintain dedicated indexes for sensitive values.
:::

::: concept
id: BLK-f467d2011eab9dfc
summary: Use more structured queries instead of full traversal.
digest: 62e6370e0f60cc34002000095751f3bf7505c07b75e7219dec9cef9bf13e4328
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use more structured queries instead of full traversal..
vector_summary: Use more structured queries instead of full traversal.
chapter: CH-05
:::
Use more structured queries instead of full traversal.
:::

::: concept
id: BLK-981ffefdcd4afb94
summary: Import data.utils as u.
digest: 3a3dcb90aa9b35fb024b4fcc68411fb37953655dc2edf356f1642853f0d14045
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.utils as u..
vector_summary: Import data.utils as u.
chapter: CH-05
:::
import data.utils as u
:::

::: concept
id: BLK-bc5639f652d5d406
summary: This is your best current built-in tool.
digest: fb26d700eeca89ceca3a85ce09ef256489d4f79c55e4eb09ef8ac0596de71f5c
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is your best current built-in tool..
vector_summary: This is your best current built-in tool.
chapter: CH-05
:::
This is your best current built-in tool.
:::

::: concept
id: BLK-b9153a25532c29d8
summary: Unused function parameters.
digest: b9cf914deb8b68395b42c06b53854f53f6023a2a646ffa13ceebe5fc775938b6
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Unused function parameters..
vector_summary: Unused function parameters.
chapter: CH-05
:::
unused function parameters
:::

::: concept
id: BLK-eca62ba9be73fa32
summary: ‚Ä¶but NOT unused imports.
digest: 1fa6da6fa5b4f4bba69bfd2e86351430be83a699b3d9fa3135728ee99d9f7c99
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚Ä¶but NOT unused imports..
vector_summary: ‚Ä¶but NOT unused imports.
chapter: CH-05
:::
‚Ä¶but NOT unused imports.
:::

::: concept
id: BLK-677d05531da1a273
summary: Still, it improves safety and catches 80% of redundant logic issues.
digest: 55014ed0d9d055b3ac83e01e238046860a45226a50668a3f4a5d5886971ad616
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Still, it improves safety and catches 80% of redundant logic issues..
vector_summary: Still, it improves safety and catches 80% of redundant logic issues.
chapter: CH-05
:::
Still, it improves safety and catches 80% of redundant logic issues.
:::

::: concept
id: BLK-1a7182fdc95d78a0
summary: Several teams build a custom linter using rgl, conftest, or their own parser.
digest: ef48127ad0395f426c3b49ef5d6e78f6014649aa0741e48690b5f013da8ac152
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Several teams build a custom linter using rgl, conftest, or their own parser..
vector_summary: Several teams build a custom linter using rgl, conftest, or their own parser.
chapter: CH-05
:::
Several teams build a custom linter using rgl, conftest, or their own parser.
:::

::: concept
id: BLK-15363c301ec7d7cb
summary: The best available tool today is:.
digest: 767d68ceaedb59ec9ef7625c94fb6c7fb4b5c3a0e7ad9f38bf31dac829870273
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The best available tool today is:..
vector_summary: The best available tool today is:.
chapter: CH-05
:::
The best available tool today is:
:::

::: concept
id: BLK-c888ec6fcbcc9a8d
summary: GitHub: https://github.com/GearPlug/rgl (community linter).
digest: 24a3c1f567a3fb65e229263826ca9c0d50d4a2e3b2a72fd611f8e60bd5111c37
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that GitHub: https://github.com/GearPlug/rgl (community linter)..
vector_summary: GitHub: https://github.com/GearPlug/rgl (community linter).
chapter: CH-05
:::
GitHub: https://github.com/GearPlug/rgl (community linter)
:::

::: concept
id: BLK-1e5b7b422e5753f5
summary: Unused local variables.
digest: 3fb9f808b14bdecf82b93aac0ec3754fddb4193faa4f11ee693b479a22b96623
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Unused local variables..
vector_summary: Unused local variables.
chapter: CH-05
:::
unused local variables
:::

::: concept
id: BLK-96e5ec08b719db94
summary: Recommend adding this to CI.
digest: 2857e98445564d345afc939b0c580b58d98ab11c4378e87af6ea5b202dfaf073
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Recommend adding this to CI..
vector_summary: Recommend adding this to CI.
chapter: CH-05
:::
Recommend adding this to CI.
:::

::: concept
id: BLK-8aab5191c0a4c854
summary: Unnecessary negations.
digest: 1a9c92e9051189cd204d22c623e614cac2612ed4affa9907918ce3c9c3163082
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Unnecessary negations..
semantic_categories: [negation]
vector_summary: Unnecessary negations.
chapter: CH-05
:::
unnecessary negations
:::

::: concept
id: BLK-e671dc0247adca2d
summary: Inefficient comprehensions.
digest: 1cad3ce7e8a9c61cb4f4a4209adc231e9258f06467d1a653787b6c7182447bed
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Inefficient comprehensions..
vector_summary: Inefficient comprehensions.
graph_neighbors: [CODE-2cbe0767daa4b7a0]
graph_degree: 1
graph_two_hop: []
graph_three_hop: []
chapter: CH-05
:::
inefficient comprehensions
:::

::: concept
id: BLK-88cc3f7309a3f03e
summary: This is the gold standard for production environments but requires paid DAS.
digest: 8df6c0cea1ebe5830659a09218e59c94ed71df0f360bde95926ef0ccd344e2bb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is the gold standard for production environments but requires paid DAS..
vector_summary: This is the gold standard for production environments but requires paid DAS.
chapter: CH-05
:::
This is the gold standard for production environments but requires paid DAS.
:::

::: concept
id: BLK-3ded27af0667e46d
summary: If you‚Äôre using Cursor, the best workflow is:.
digest: 1d030f6a4cef62eea64bf26fb1a3ff8990254388be8686c93ba8e6155b9fac52
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If you‚Äôre using Cursor, the best workflow is:..
vector_summary: If you‚Äôre using Cursor, the best workflow is:.
chapter: CH-05
:::
If you‚Äôre using Cursor, the best workflow is:
:::

::: concept
id: BLK-01855145c4052297
summary: Import ([^ ]+)( as [^ ]+)? // highlight if alias is unused.
digest: 889de90d613eda7cc335c91329a8fa6998357083a3ffad7330aeb1008e90f147
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import ([^ ]+)( as [^ ]+)? // highlight if alias is unused..
vector_summary: Import ([^ ]+)( as [^ ]+)? // highlight if alias is unused.
chapter: CH-05
:::
import ([^ ]+)( as [^ ]+)? // highlight if alias is unused
:::

::: concept
id: BLK-e91de7f88c47fe02
summary: Cursor can highlight this dynamically.
digest: 37eb878f5682725e4f6d48923ed5c5b9c52a5f6f14c94a6f8b7dc5673fceb43b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Cursor can highlight this dynamically..
vector_summary: Cursor can highlight this dynamically.
chapter: CH-05
:::
Cursor can highlight this dynamically.
:::

::: concept
id: BLK-27062c2f2ad4bea0
summary: Import data.services.*.
digest: 11f1209f73dc1fa78b09c19b4636215d18de30214e0345c8a5f2bbf7949f8d3d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.services.*..
vector_summary: Import data.services.*.
chapter: CH-05
:::
import data.services.*
:::

::: concept
id: BLK-bf8a85428b528a50
summary: Harder to detect unused segments.
digest: fc2845ab4213d1f885f9cedd04279cfe3a21d800a8bfde4a66dc82cbb1b65b0f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Harder to detect unused segments..
vector_summary: Harder to detect unused segments.
chapter: CH-05
:::
Harder to detect unused segments
:::

::: concept
id: BLK-9a8c8c3ad33b8ee2
summary: Harder to find where names come from.
digest: a1377d5eb07eeef9b84ac07048e599da537a7a5f4682ddfe2e0dd959e5248cfc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Harder to find where names come from..
vector_summary: Harder to find where names come from.
chapter: CH-05
:::
Harder to find where names come from
:::

::: concept
id: BLK-0fc3cbba44a5ab8b
summary: Encourages shotgun imports.
digest: 58f556c7ccade87fdae348acd63356f53542cf3ef4a3d95601d4a9a32ee22679
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Encourages shotgun imports..
vector_summary: Encourages shotgun imports.
chapter: CH-05
:::
Encourages shotgun imports
:::

::: concept
id: BLK-a55c36241eba7524
summary: Import data.services.crm.allow import data.shared.strings as str import data.shared.constants.
digest: 6f60436d5f1ac893c6a2d73912ded8b0e79ddb003cd3c412bfcf10a6f23bc675
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.services.crm.allow import data.shared.strings as str import data.shared.constants..
vector_summary: Import data.services.crm.allow import data.shared.strings as str import data.shared.constants.
chapter: CH-05
:::
import data.services.crm.allow import data.shared.strings as str import data.shared.constants
:::

::: concept
id: BLK-442aa4acd401c5ce
summary: Here is the enterprise-grade script:
digest: bb74d20cd6a7b4766beb68a0788c50dcb3ed61972678eec7451458c9cb4b15ef
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Here is the enterprise-grade script:.
vector_summary: Here is the enterprise-grade script:
chapter: CH-05
:::
Here is the enterprise-grade script:
:::

::: concept
id: BLK-befcf2864cbe4ba2
summary: .ci/lint_unused_imports.sh #!/usr/bin/env bash.
digest: 539a41e3c30e12a1d0fdb34fb41aecd31673b846c2513bd550e115dad89e9419
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that .ci/lint_unused_imports.sh #!/usr/bin/env bash..
vector_summary: .ci/lint_unused_imports.sh #!/usr/bin/env bash.
chapter: CH-05
:::
.ci/lint_unused_imports.sh #!/usr/bin/env bash
:::

::: concept
id: BLK-4e06b56bed56546c
summary: Echo "‚úì No unused imports".
digest: b07160ecfcd17ce8b5f6bf60752f9e821ee48324be2ecdc4f6a3387dbd2f2363
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Echo "‚úì No unused imports"..
vector_summary: Echo "‚úì No unused imports".
chapter: CH-05
:::
echo "‚úì No unused imports"
:::

::: concept
id: BLK-bd36eb180f9a0870
summary: A small jq filter to detect unused imports.
digest: ae28c04efb016bccc12d398a96a869319e4e1a1d104f53a91e4047ebc93d1a27
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A small jq filter to detect unused imports..
vector_summary: A small jq filter to detect unused imports.
chapter: CH-05
:::
a small jq filter to detect unused imports
:::

::: concept
id: BLK-0f79a0a4b3796507
summary: This is currently the single best approach that works reliably as of 2024‚Äì2025.
digest: c35f1ef219280ea494e2426182ce8bbabff3e554abd1f95c5b5dfa08f75e3586
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is currently the single best approach that works reliably as of 2024‚Äì2025..
vector_summary: This is currently the single best approach that works reliably as of 2024‚Äì2025.
chapter: CH-05
:::
This is currently the single best approach that works reliably as of 2024‚Äì2025.
:::

::: concept
id: BLK-6f78ccb1a2aa0db5
summary: The best lifecycle is:.
digest: 7cc2c76fb5bd499d18a308cde35b05629f5aaea33083d05cd0312c2a096bd0ba
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The best lifecycle is:..
vector_summary: The best lifecycle is:.
chapter: CH-05
:::
The best lifecycle is:
:::

::: concept
id: BLK-fe348bf4a59d3eca
summary: Confusing during refactors.
digest: 610b3326a12ee3c32b31ec5c95536e889563ef0f71aead1f313d85beb143f15f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Confusing during refactors..
vector_summary: Confusing during refactors.
chapter: CH-05
:::
confusing during refactors
:::

::: concept
id: BLK-8bcbd5638e8f2f52
summary: ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt.
digest: 86dec04dad635dfe973d29d37c8d7d097a3f000e61f29b8e3daf3ee54ff25297
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt..
vector_summary: ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt.
chapter: CH-05
:::
‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt
:::

::: concept
id: BLK-811010e43f08ad56
summary: Count(tech_debt.warn) == 0 with input as mock_input.
digest: d8e5864bc061b514f5652aa80a6ff6b3dfe9a31014fc7a2f96ffad1cc6bcb9c2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count(tech_debt.warn) == 0 with input as mock_input..
vector_summary: Count(tech_debt.warn) == 0 with input as mock_input.
chapter: CH-05
:::
count(tech_debt.warn) == 0 with input as mock_input
:::

::: concept
id: BLK-402d3ae84b7a6ec5
summary: This is the safest, clearest, least ambiguous long-term behavior.
digest: 346045c06dd883933cb428997906ef3d489992a7330b4fa3cc86235323635480
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is the safest, clearest, least ambiguous long-term behavior..
vector_summary: This is the safest, clearest, least ambiguous long-term behavior.
chapter: CH-05
:::
This is the safest, clearest, least ambiguous long-term behavior.
:::

::: concept
id: BLK-8912a891da49a895
summary: üß† Short Answer You Requested (Concise Explanation).
digest: 06635f550ce94944b247270c01578b1ee6fefb5b8cc854663e416877dbfd424a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üß† Short Answer You Requested (Concise Explanation)..
vector_summary: üß† Short Answer You Requested (Concise Explanation).
chapter: CH-05
:::
üß† Short Answer You Requested (Concise Explanation)
:::

::: concept
id: BLK-a0487d3cbb802b3d
summary: However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define ...
digest: 0acb7a7ceeb8e896a848ac78bd12972c0f7c73c20ecffd27bc5e7cb81431f12e
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define ....
vector_summary: However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define ...
chapter: CH-05
:::
However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define warn.
:::

::: concept
id: BLK-46c7fbb1283483ac
summary: Every test module in tests/ ‚Üí evaluated with the loaded data.
digest: 951ee766592a2201d343a7ece8caad4385a868becb990dd3dcd7aa7b88ea07a4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Every test module in tests/ ‚Üí evaluated with the loaded data..
vector_summary: Every test module in tests/ ‚Üí evaluated with the loaded data.
chapter: CH-05
:::
every test module in tests/ ‚Üí evaluated with the loaded data
:::

::: concept
id: BLK-f4849492414ac27e
summary: How warn is resolved.
digest: 552080ced40cc2d7f27fc1e864b8510b4f961cfc6982565e9d33dfe51bd57ffb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that How warn is resolved..
vector_summary: How warn is resolved.
chapter: CH-05
:::
2. How warn is resolved
:::

::: concept
id: BLK-e496ef913bfa6596
summary: When the test evaluates:.
digest: c6efe386626afa394a254570adcd68d672f30be902e833be8dba0be941aa160e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When the test evaluates:..
vector_summary: When the test evaluates:.
chapter: CH-05
:::
When the test evaluates:
:::

::: concept
id: BLK-c83570b0bab95162
summary: Does the test file define a local variable named warn? No.
digest: b3b48fff41012fc1e4f83c7d2ee698796b94bf26cc4bc6513cca6e3a4c46c715
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Does the test file define a local variable named warn? No..
vector_summary: Does the test file define a local variable named warn? No.
chapter: CH-05
:::
Does the test file define a local variable named warn? No.
:::

::: concept
id: BLK-cdba5783ce8acf92
summary: Does the file import something named warn? No.
digest: 19f45efc7a98f2f88446c0150a50cc9058931110fe54116047297fc18c6de8fb
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Does the file import something named warn? No..
vector_summary: Does the file import something named warn? No.
chapter: CH-05
:::
Does the file import something named warn? No.
:::

::: concept
id: BLK-522dcd428818f34e
summary: Thus, the test works, but‚Ä¶.
digest: a634820b3ba8ac0171afab8f3e682c90c572102f5c5947428a52209c3d36ba06
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Thus, the test works, but‚Ä¶..
vector_summary: Thus, the test works, but‚Ä¶.
chapter: CH-05
:::
Thus, the test works, but‚Ä¶
:::

::: concept
id: BLK-87787a835dbfdc8d
summary: ‚ö†Ô∏è Why this is risky.
digest: 6a9c12065922d1f9cf261ce857db15b6837e534548ba5147eb64a40fb2e5ea4f
symbol_refs: []
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚ö†Ô∏è Why this is risky..
vector_summary: ‚ö†Ô∏è Why this is risky.
chapter: CH-05
:::
‚ö†Ô∏è Why this is risky
:::

::: concept
id: BLK-03e7fcc4768817d5
summary: If tomorrow someone adds:.
digest: 2214caaaebf7ed44295f044f055221355ee64a39b55b1f3bd95e5e081d822a77
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If tomorrow someone adds:..
vector_summary: If tomorrow someone adds:.
chapter: CH-05
:::
If tomorrow someone adds:
:::

::: concept
id: BLK-8751d75b24bfe192
summary: Package compliance.sample warn { ..
digest: 2df839e245162c45464ef9a9d8a219826c8093173afe9b118a484546686056a9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Package compliance.sample warn { ...
vector_summary: Package compliance.sample warn { ..
chapter: CH-05
:::
package compliance.sample warn { ... }
:::

::: concept
id: BLK-b78146783f0378c4
summary: Warn becomes ambiguous,.
digest: 3dce23ad3981cfc04041f726019b5abfbb845db555f239491a2e07a443a30f37
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Warn becomes ambiguous,..
vector_summary: Warn becomes ambiguous,.
chapter: CH-05
:::
warn becomes ambiguous,
:::

::: concept
id: BLK-0677b2d89a2bb634
summary: Tests start failing, or.
digest: 38424ec2c3d4e60d1e25eea8aef15958108c3f10d8c9a5bdc8add84798711708
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Tests start failing, or..
vector_summary: Tests start failing, or.
chapter: CH-05
:::
tests start failing, or
:::

::: concept
id: BLK-c93c5530af136464
summary: Count(tech_debt.warn) == 0.
digest: 21375de034bfc32cdd9a6c2b26c70a38af924d3139d599c144010f94e8df898f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count(tech_debt.warn) == 0..
vector_summary: Count(tech_debt.warn) == 0.
chapter: CH-05
:::
count(tech_debt.warn) == 0
:::

::: concept
id: BLK-d0196af4f922ba99
summary: ‚úîÔ∏è Even safer if using as.
digest: 77673db38f6e4c0b73096486ece4130ab1d508e01989444ad9fddbf6dfd3c4cf
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚úîÔ∏è Even safer if using as..
vector_summary: ‚úîÔ∏è Even safer if using as.
chapter: CH-05
:::
‚úîÔ∏è Even safer if using as
:::

::: concept
id: BLK-471eebb35854e544
summary: Import data.compliance.tech_debt as td.
digest: 8f20534809d47c9c8e1d50734293b660df0a7d250f0ac2005024ef8762cb14a8
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import data.compliance.tech_debt as td..
vector_summary: Import data.compliance.tech_debt as td.
chapter: CH-05
:::
import data.compliance.tech_debt as td
:::

::: concept
id: BLK-033ecc50bad86de4
summary: You removed it, and the tests still worked.
digest: bba23add2515489813fb6ec835f51f5f49b9b45cf092abf06e5243c3622887ca
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that You removed it, and the tests still worked..
vector_summary: You removed it, and the tests still worked.
chapter: CH-05
:::
You removed it, and the tests still worked.
:::

::: concept
id: BLK-56fc64cdaff7a3ab
summary: ‚úîÔ∏è Why tests still work.
digest: e0658add533a10ea9a2597d5ab8655b64e8d6f69be641f98c85f5d79e5d1bd30
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚úîÔ∏è Why tests still work..
vector_summary: ‚úîÔ∏è Why tests still work.
chapter: CH-05
:::
‚úîÔ∏è Why tests still work
:::

::: concept
id: BLK-2c1d51f4e5a960ff
summary: The tests reference warn without a package prefix:.
digest: 583de269a9259f9ab93ccc685ef52ddff36c19b68d9666782d9b3c300995d039
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The tests reference warn without a package prefix:..
vector_summary: The tests reference warn without a package prefix:.
chapter: CH-05
:::
The tests reference warn without a package prefix:
:::

::: concept
id: BLK-c332a68f35c8a3ec
summary: data.compliance.tech_debt.warn
digest: 381079c58d59529311201c9324d821b7f98bb07eca26c132fdc4e49fcdf835f9
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that data.compliance.tech_debt.warn.
vector_summary: data.compliance.tech_debt.warn
chapter: CH-05
:::
data.compliance.tech_debt.warn
:::

::: concept
id: BLK-1601cc39b76cae1a
summary: So the import is indeed unused, and removing it does not break the test in the current setup.
digest: 5861eed5e2f075a9dffb01e360ca379999a3999785fd7c2ddc7a0404c8b0b121
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that So the import is indeed unused, and removing it does not break the test in the current setup..
vector_summary: So the import is indeed unused, and removing it does not break the test in the current setup.
chapter: CH-05
:::
So the import is indeed unused, and removing it does not break the test in the current setup.
:::

::: concept
id: BLK-2c388bc6691a4f51
summary: ‚ö†Ô∏è But removing it is NOT the best practice.
digest: b75275091703a15efd9ee17cd65f03a78ca72d216b1bd28404d5ead6491723e8
symbol_refs: []
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚ö†Ô∏è But removing it is NOT the best practice..
vector_summary: ‚ö†Ô∏è But removing it is NOT the best practice.
chapter: CH-05
:::
‚ö†Ô∏è But removing it is NOT the best practice
:::

::: concept
id: BLK-dead8fc635007af0
summary: Even though the import is unused now, this approach is fragile.
digest: 1bcd6a1450d9a7d3f9dca09ca03533381303213c592fbd7feed618b34e4ac60d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Even though the import is unused now, this approach is fragile..
vector_summary: Even though the import is unused now, this approach is fragile.
chapter: CH-05
:::
Even though the import is unused now, this approach is fragile.
:::

::: concept
id: BLK-b0975f5a5f83bad3
summary: Example: If another policy someday adds:.
digest: 3a953ba8439564ab53d7ff4729296a01725d960ee9ddeaf752764f54d0ab1ad2
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Example: If another policy someday adds:..
vector_summary: Example: If another policy someday adds:.
chapter: CH-05
:::
Example: If another policy someday adds:
:::

::: concept
id: BLK-98a5e27b479b7275
summary: Package compliance.security warn { ..
digest: 70492af4f601752d521fb93bffd05f12a5d4fa36549bb1240f2637945e84e4dc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Package compliance.security warn { ...
vector_summary: Package compliance.security warn { ..
chapter: CH-05
:::
package compliance.security warn { ... }
:::

::: concept
id: BLK-c16b774f244e504a
summary: Give unpredictable results.
digest: 5dc304509268cf0ccd78ff45a454d2519e275d572e4a5930edf850f3c31b6745
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Give unpredictable results..
vector_summary: Give unpredictable results.
chapter: CH-05
:::
give unpredictable results
:::

::: concept
id: BLK-cf07614973daa160
summary: Tests become context‚Äêdependent.
digest: 1071cae6b0f1f6377d9ee61176cfe077d5e503649c1662e7c3f7c9d062c1a43b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Tests become context‚Äêdependent..
vector_summary: Tests become context‚Äêdependent.
chapter: CH-05
:::
2. Tests become context‚Äêdependent
:::

::: concept
id: BLK-f3ae62e558c8b1ba
summary: Not explicit ‚Üí Not safe in enterprise systems.
digest: 796b07bdbd3d2e93d6fde9233423447770c1577a798be18f19497bf60801971b
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Not explicit ‚Üí Not safe in enterprise systems..
vector_summary: Not explicit ‚Üí Not safe in enterprise systems.
chapter: CH-05
:::
3. Not explicit ‚Üí Not safe in enterprise systems
:::

::: concept
id: BLK-ab7e5a89ec7dec84
summary: Count(tech_debt.warn) == 0.
digest: abced29da1da5d911a5a774ce8da129ff2470bd57c6d5d00fb8bb830839c6077
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count(tech_debt.warn) == 0..
vector_summary: Count(tech_debt.warn) == 0.
chapter: CH-05
:::
count(tech_debt.warn) == 0
:::

::: concept
id: BLK-1e9f46006e81b12b
summary: Instead: Use explicit, namespaced references in all tests.
digest: f9ab630f9664483d9eaa25771e43a26b32d5166c9f61dedfceecbbda12871a97
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Instead: Use explicit, namespaced references in all tests..
vector_summary: Instead: Use explicit, namespaced references in all tests.
chapter: CH-05
:::
Instead: Use explicit, namespaced references in all tests.
:::

::: concept
id: BLK-6f8c40f9057e8541
summary: Formal Recommendation (Chapter 7.2.1):.
digest: 2d74bf6a47ca1ddb792b801920d9912e16791aeb5df48e117ed8831c69f2552b
symbol_refs: [Formal Recommendation (Chapter 7.2.1):]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Formal Recommendation (Chapter 7.2.1):..
vector_summary: Formal Recommendation (Chapter 7.2.1):.
chapter: CH-05
:::
**Formal Recommendation (Chapter 7.2.1):**
:::

::: concept
id: BLK-065b5e4f94f9236b
summary: üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test.
digest: b09e9b494404eb1d15b4d5a0860b4b29200522d16772698925e2b26ca7b37c3d
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test..
vector_summary: üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test.
chapter: CH-05
:::
üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test
:::

::: concept
id: BLK-970b9d75dc34a42c
summary: Count(tech_debt.warn) == 0 with input as mock_input.
digest: 9af1d005423da101b1c980814b5e7f3643f83490fa718cf6abd90b5fe327ebbd
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Count(tech_debt.warn) == 0 with input as mock_input..
vector_summary: Count(tech_debt.warn) == 0 with input as mock_input.
chapter: CH-05
:::
count(tech_debt.warn) == 0 with input as mock_input
:::

::: concept
id: BLK-18bcb7950f8dcf72
summary: Does not produce a newline.
digest: a4a1ea296cb01b19e600da876c6fbfb33be3528ccd8983949ed33267693eb6ed
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Does not produce a newline..
vector_summary: Does not produce a newline.
chapter: CH-05
:::
does not produce a newline.
:::

::: concept
id: BLK-a75307e7442dd9e9
summary: \n is literal backslash + ‚Äún‚Äù.
digest: a54fa6ad40d0d8c1349fc9a0175da67a71045e12bc27795d0dd1fdcc204c461d
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that \n is literal backslash + ‚Äún‚Äù..
vector_summary: \n is literal backslash + ‚Äún‚Äù.
chapter: CH-05
:::
\n is literal backslash + ‚Äún‚Äù
:::

::: concept
id: BLK-c91a17469e570904
summary: NOT matched by regex patterns expecting real newlines or multi-line content.
digest: 4613249a8c32494b12bc759d0c2a94a823930e80c0362b33fefabf98322f0531
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that NOT matched by regex patterns expecting real newlines or multi-line content..
vector_summary: NOT matched by regex patterns expecting real newlines or multi-line content.
chapter: CH-05
:::
NOT matched by regex patterns expecting real newlines or multi-line content
:::

::: concept
id: BLK-2a6fca36dc1d9152
summary: NOT iterated the same way.
digest: 92bbf29816eb6d26da379fa21052f007770a920eae1fea2fdea741d9f9309024
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that NOT iterated the same way..
vector_summary: NOT iterated the same way.
chapter: CH-05
:::
NOT iterated the same way
:::

::: concept
id: BLK-db4ad97b2c59bf89
summary: So your regex patterns such as:.
digest: e6dcf869197e70d4abe513332c9b4310f0914b3120425a60c3571cd688aea2d7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that So your regex patterns such as:..
vector_summary: So your regex patterns such as:.
chapter: CH-05
:::
So your regex patterns such as:
:::

::: concept
id: BLK-533b2ce56a96a5b1
summary: Regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff).
digest: 30eaa4e13653d001f25baaf893f56cddc99b761d4fd7a29cbb97dd5e16c90584
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff)..
vector_summary: Regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff).
chapter: CH-05
:::
regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff)
:::

::: concept
id: BLK-6b3973c5adc77112
summary: This perfectly explains your trace output:
digest: 6ba3d57b375fe805b47bfe09cf5100be698559c137999fafbd0429b4e3ecec24
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This perfectly explains your trace output:.
vector_summary: This perfectly explains your trace output:
chapter: CH-05
:::
This perfectly explains your trace output:
:::

::: concept
id: BLK-83a2499bac0ee44d
summary: üî• Proof: Why the three affected tests fail 1.
digest: 588b194792dc2379d5cf750bfa8337f0084c074d750a505f24bf14a5c5aab991
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üî• Proof: Why the three affected tests fail 1..
vector_summary: üî• Proof: Why the three affected tests fail 1.
chapter: CH-05
:::
üî• Proof: Why the three affected tests fail 1. test_todo_without_clear_action
:::

::: concept
id: BLK-6143e7b8d21b076b
summary: TODO: <newline> function().
digest: e24eb2ad15aae2e37a2a6ff7ac49883fd67f67189ed82f2c0f554c37817df424
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that TODO: <newline> function()..
vector_summary: TODO: <newline> function().
chapter: CH-05
:::
TODO: <newline> function()
:::

::: concept
id: BLK-8124b98cebb7344a
summary: "T O D O : \ n f u n c t i o n".
digest: 13ee0c46755b0b3f116f1aea3f1b08e0d29319b1be52a7caf7f2ac0097f4bd5f
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "T O D O : \ n f u n c t i o n"..
vector_summary: "T O D O : \ n f u n c t i o n".
chapter: CH-05
:::
"T O D O : \ n f u n c t i o n"
:::

::: concept
id: BLK-1c354b57ee22967c
summary: ‚Ä¶but the newline is missing ‚Üí FAIL.
digest: 779db94fe142d17277cf2724bda41dc845a93e2d5e6b96168fd09c4e6e8b5457
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚Ä¶but the newline is missing ‚Üí FAIL..
vector_summary: ‚Ä¶but the newline is missing ‚Üí FAIL.
chapter: CH-05
:::
‚Ä¶but the newline is missing ‚Üí FAIL.
:::

::: concept
id: BLK-365b36bfe5904699
summary: test_fixme_added_without_reference
digest: 2390c8457cf3df1fd7334c0b6955c7194214d5c200457d361ec75454c4d468f5
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that test_fixme_added_without_reference.
vector_summary: test_fixme_added_without_reference
chapter: CH-05
:::
2. test_fixme_added_without_reference
:::

::: concept
id: BLK-9cb0813090319e09
summary: "+ // FIXME: Temporary hack...".
digest: 1653000801f34a28ff11eac98f230608a71c33f8f627186c5f6c7f84b03ad755
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "+ // FIXME: Temporary hack..."..
vector_summary: "+ // FIXME: Temporary hack...".
chapter: CH-05
:::
"+ // FIXME: Temporary hack..."
:::

::: concept
id: BLK-ae9cdf2a87e2849e
summary: Contains(diff, "FIXME:").
digest: d4c91ff5c5df7d2424c38b2804e9474ee1c80ec62fdcf79d7f8969c158f79f50
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Contains(diff, "FIXME:")..
vector_summary: Contains(diff, "FIXME:").
chapter: CH-05
:::
contains(diff, "FIXME:")
:::

::: concept
id: BLK-63c154a8c410ed16
summary: "+ // FIXME: Temporary...".
digest: 9b3edff243ce6080efd3c47f5b83a6101aaa0e75ebcd65458fa3b47c2fe1134e
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "+ // FIXME: Temporary..."..
vector_summary: "+ // FIXME: Temporary...".
chapter: CH-05
:::
"+ // FIXME: Temporary..."
:::

::: concept
id: BLK-930cbcf639591aef
summary: Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g.
digest: 1860345ca2b75aa20d9de38b9e20c8ad2e5b599ed802dada4f1f725daae9dc87
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g..
vector_summary: Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g.
chapter: CH-05
:::
Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g.
:::

::: concept
id: BLK-b5f2b2e0022c070b
summary: "+ // FIXME: Temporary hack for authentication".
digest: 64b87f85f2aa688cc528d276c92787be7ab24316d0f09219c722e49445774cea
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "+ // FIXME: Temporary hack for authentication"..
vector_summary: "+ // FIXME: Temporary hack for authentication".
chapter: CH-05
:::
"+ // FIXME: Temporary hack for authentication"
:::

::: concept
id: BLK-a994f5dd4573c580
summary: "+ // FIXME: Temporary hack for authentication".
digest: abc80637d1000e87ca676ff6093a8a8f1d6ef4d574a60fcea8afba2b73d03265
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "+ // FIXME: Temporary hack for authentication"..
vector_summary: "+ // FIXME: Temporary hack for authentication".
chapter: CH-05
:::
"+ // FIXME: Temporary hack for authentication"
:::

::: concept
id: BLK-8c1f028fe1d5059b
summary: test_meaningful_todo_not_logged
digest: ad1c01366ce3358dd0b2df568a41bf637589dbf4f267ca489fb751cf12d020a0
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that test_meaningful_todo_not_logged.
vector_summary: test_meaningful_todo_not_logged
chapter: CH-05
:::
3. test_meaningful_todo_not_logged
:::

::: concept
id: BLK-de1b194932f56032
summary: TODO: Fix N+1 query (workaround).
digest: cf657088fbdded1a1a6f47fb11e7e6bdafca1c71824854df566c4fa5b20fd6de
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that TODO: Fix N+1 query (workaround)..
vector_summary: TODO: Fix N+1 query (workaround).
chapter: CH-05
:::
TODO: Fix N+1 query (workaround)
:::

::: concept
id: BLK-b8e54938be458fcb
summary: T O D O : \ s F i x ...
digest: 2f5302e295bb43897fb15ee46f001478e1a1b1ca8542b1470c612be51232faa7
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that T O D O : \ s F i x ....
vector_summary: T O D O : \ s F i x ...
chapter: CH-05
:::
T O D O : \ s F i x ...
:::

::: concept
id: BLK-661d723e70c87b2f
summary: Diff := + // TODO: + function getUsers() {.
digest: 9e50fac696b42308feb82c27615cd03bb7b3c1bc00e6888b58fc5d895921c8f1
symbol_refs: [+ // TODO: + function getUsers() {]
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Diff := + // TODO: + function getUsers() {..
vector_summary: Diff := + // TODO: + function getUsers() {.
chapter: CH-05
:::
diff := `+ // TODO: + function getUsers() {`
:::

::: concept
id: BLK-3018dbc1695a1713
summary: Update all test inputs to use multi-line raw strings.
digest: 10e5f7abb8b49293abbc21419282c407b5f6f0099430c94a613a07584a0ad459
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Update all test inputs to use multi-line raw strings..
vector_summary: Update all test inputs to use multi-line raw strings.
chapter: CH-05
:::
Update all test inputs to use multi-line raw strings.
:::

::: concept
id: BLK-54e698b7ae1d69f6
summary: "diff": "+ // TODO:\n+ function getUsers() {".
digest: 67f15a4a20cd7e7945296cde23b8281855e140f0599d294392a168ebb1706956
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "diff": "+ // TODO:\n+ function getUsers() {"..
vector_summary: "diff": "+ // TODO:\n+ function getUsers() {".
chapter: CH-05
:::
"diff": "+ // TODO:\n+ function getUsers() {"
:::

::: concept
id: BLK-62b84bd110ac2fbb
summary: "diff": "+ // TODO: + function getUsers() {".
digest: cdb892c4b04106a0501d6cc9f0027857aa4a9457eb57f24481da16f5030efbe4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that "diff": "+ // TODO: + function getUsers() {"..
vector_summary: "diff": "+ // TODO: + function getUsers() {".
chapter: CH-05
:::
"diff": "+ // TODO: + function getUsers() {"
:::

::: concept
id: BLK-0906546a75dd84e2
summary: This is the simplest solution.
digest: 54a14aca19baa1d2e47924126cd931893d745e6e7d9567f2462cd2c0f4b354bc
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is the simplest solution..
vector_summary: This is the simplest solution.
chapter: CH-05
:::
This is the simplest solution.
:::

::: concept
id: BLK-694a2f9470d0042f
summary: ‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n".
digest: c0066eaeb7237197a0fffcd1e4b935a3f1677bd517e208d82a7d0fdacd5736c7
symbol_refs: []
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n"..
vector_summary: ‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n".
chapter: CH-05
:::
‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n"
:::

::: concept
id: BLK-22ef61310b55ff98
summary: Regex.match("TODO:(\n|\\\\n)", diff).
digest: 078001c5120edb4fbe77949f371477ef8b721dc9245135258353183b15169f5a
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Regex.match("TODO:(\n|\\\\n)", diff)..
vector_summary: Regex.match("TODO:(\n|\\\\n)", diff).
chapter: CH-05
:::
regex.match("TODO:(\n|\\\\n)", diff)
:::

::: concept
id: BLK-42ef9188bb22552f
summary: But this becomes ugly and error-prone.
digest: 11b98fa02c718668d305698b5083c175d4d1dd6bd634025a12b612756fc02e03
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that But this becomes ugly and error-prone..
vector_summary: But this becomes ugly and error-prone.
chapter: CH-05
:::
But this becomes ugly and error-prone.
:::

::: concept
id: BLK-23099cfd845b535f
summary: Diff_unescaped := string.replace(file.diff, "\\n", "\n").
digest: 61cce5435bfe4a7de6c598add7fb5a1c63ec69a2d7a0bb0b62b1bf5dc7e210c4
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Diff_unescaped := string.replace(file.diff, "\\n", "\n")..
vector_summary: Diff_unescaped := string.replace(file.diff, "\\n", "\n").
chapter: CH-05
:::
diff_unescaped := string.replace(file.diff, "\\n", "\n")
:::

::: concept
id: BLK-c511802d86d94661
summary: Because you‚Äôre building an enterprise system:.
digest: b0bf45bef9953f68184fc039cd1ccb106adbe13fb31b57006437ecf868b0f779
symbol_refs: []
semantic_role: concept
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Because you‚Äôre building an enterprise system:..
vector_summary: Because you‚Äôre building an enterprise system:.
chapter: CH-05
:::
Because you‚Äôre building an enterprise system:
:::

::: fact
id: BLK-c179f5c2a30f1d7c
summary: Metadata & Introspection: rego.metadata.rule, rego.metadata.chain.
digest: ca79be9c91dd2137daf102b8b68ec3b613ba982e9f9ab992facb6fb3eb0eeb9e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Metadata & Introspection: rego.metadata.rule, rego.metadata.chain..
vector_summary: Metadata & Introspection: rego.metadata.rule, rego.metadata.chain.
chapter: CH-05
:::
Metadata & Introspection: rego.metadata.rule, rego.metadata.chain
:::

::: fact
id: BLK-eb3d6c96d1f72a4a
summary: # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }.
digest: 870e4061440b77ce9994524726a36455cdc16f9a9f4dfeaf027a4519f3852268
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }..
vector_summary: # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }.
chapter: CH-05
:::
# All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }
:::

::: fact
id: BLK-0c491778be16cb9f
summary: OPA has no direct a[1:3] slicing syntax; use array.slice.
digest: 7d22386abefbcfb7b17f8541ab9f7d368809371857a18232f461e16b9f5ca99d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA has no direct a[1:3] slicing syntax; use array.slice..
vector_summary: OPA has no direct a[1:3] slicing syntax; use array.slice.
chapter: CH-05
:::
OPA has no direct a[1:3] slicing syntax; use array.slice.
:::

::: fact
id: BLK-f73cb48d2abbbafb
summary: Rego sets are unordered, unique collections.
digest: 0a798700bce70820c8528de13a1d20ab01f05d36640dda7d023ce390ca64d74a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego sets are unordered, unique collections..
vector_summary: Rego sets are unordered, unique collections.
chapter: CH-05
:::
Rego sets are unordered, unique collections.
:::

::: fact
id: BLK-b6de378fb521f3e5
summary: Rego strings are Unicode text; built-ins operate on code points (not bytes).
digest: 430d5f4f3af9209f004e112b59e43d1098f1de9574c598b255c1673f6fed68b7
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego strings are Unicode text; built-ins operate on code points (not bytes)..
vector_summary: Rego strings are Unicode text; built-ins operate on code points (not bytes).
chapter: CH-05
:::
Rego strings are Unicode text; built-ins operate on code points (not bytes).
:::

::: fact
id: BLK-9c591fac4dfe8baf
summary: # May not work in all OPA versions is_hex if regex.match(^[0-9a-fA-F]+$, input.value).
digest: 74fdc9b324c7f7d0a14af20f4bbc508799c53fcbff3e24609162fdba8bcbe27e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # May not work in all OPA versions is_hex if regex.match(^[0-9a-fA-F]+$, input.value)..
vector_summary: # May not work in all OPA versions is_hex if regex.match(^[0-9a-fA-F]+$, input.value).
chapter: CH-05
:::
# May not work in all OPA versions is_hex if regex.match(`^[0-9a-fA-F]+$`, input.value)
:::

::: fact
id: BLK-154238569cc2d740
summary: Best Practice: Always use double-quoted strings with escaped backslashes for regex patterns.
digest: ab0c7e2d43f36e80cd070c0d936876b528d5f03902197185ce9312a2d9dd65fc
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Best Practice: Always use double-quoted strings with escaped backslashes for regex patterns..
vector_summary: Best Practice: Always use double-quoted strings with escaped backslashes for regex patterns.
chapter: CH-05
:::
**Best Practice:** Always use double-quoted strings with escaped backslashes for regex patterns. Test with `opa check` to verify compatibility with your OPA version.
:::

::: fact
id: BLK-a3e1adeda4bf400c
summary: When to Use Raw Strings: - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline c...
digest: ae2cf4b28183f8c65e6e105d3c588d591e24bfc8719fe82d67aa26e6150edb14
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When to Use Raw Strings: - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline c....
vector_summary: When to Use Raw Strings: - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline c...
chapter: CH-05
:::
**When to Use Raw Strings:** - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline characters - Content that must preserve line breaks exactly as written
:::

::: fact
id: BLK-faa6749892163657
summary: Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target...
digest: 2f583727d16f7b0b33726b1c95837627c4e2433c94baad47f559cdc275735ce6
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target....
vector_summary: Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target...
chapter: CH-05
:::
Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target OPA).
:::

::: fact
id: BLK-539d7bec736ce9fa
summary: Always guard access to optional or potentially missing input fields:.
digest: 19a68fba6376f5b5e9e207b6427896670cb63f8f0896ea42518d095ad4f33665
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Always guard access to optional or potentially missing input fields:..
vector_summary: Always guard access to optional or potentially missing input fields:.
chapter: CH-05
:::
Always guard access to optional or potentially missing input fields:
:::

::: fact
id: BLK-f1a5006e2f61d559
summary: Common Patterns: - Check is_string() before contains(), startswith(), endswith() - Check is_array() before iteration with some ..
digest: e67ab670a44c56e520ce2d3ce93ac27722238972b6aff04ac06be8d026dd4e41
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Common Patterns: - Check is_string() before contains(), startswith(), endswith() - Check is_array() before iteration with some ...
vector_summary: Common Patterns: - Check is_string() before contains(), startswith(), endswith() - Check is_array() before iteration with some ..
chapter: CH-05
:::
**Common Patterns:** - Check `is_string()` before `contains()`, `startswith()`, `endswith()` - Check `is_array()` before iteration with `some ... in` - Check `is_object()` before property access - Check `is_number()` before arithmetic operations - Create a top-level `input_valid` guard and use it in all rules that access input
:::

::: fact
id: BLK-5c33fbfabf3e6fb4
summary: Never bake secrets into Rego source; pass via data or environment.
digest: f6d14efc4ce76fe14ec85ae8e3df67c24a52268a5f79c7ff59c2c5a50972e614
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Never bake secrets into Rego source; pass via data or environment..
vector_summary: Never bake secrets into Rego source; pass via data or environment.
chapter: CH-05
:::
Never bake secrets into Rego source; pass via data or environment.
:::

::: fact
id: BLK-c09ef369e7bd778c
summary: 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs).
digest: a6d774331d07641a91f59ba500d1539f5f217493b6f8236aad1a34cd4b6760e4
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs)..
vector_summary: 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs).
chapter: CH-05
:::
6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs).
:::

::: fact
id: BLK-01f8eba873aaef46
summary: Both arguments must be arrays.
digest: b6c896578175dd1312368c816c624684fd5da324449d2ab07bc2140966dbdb77
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Both arguments must be arrays..
vector_summary: Both arguments must be arrays.
chapter: CH-05
:::
Both arguments must be arrays.
:::

::: fact
id: BLK-c93efe6db0a5e1b6
summary: If either argument is null (or not an array), OPA raises a type error.
digest: ff4a54e3fc324b5d2e39cd6c9073a7276737f42257d6f3033332c73a02a87978
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If either argument is null (or not an array), OPA raises a type error..
vector_summary: If either argument is null (or not an array), OPA raises a type error.
chapter: CH-05
:::
If either argument is null (or not an array), OPA raises a type error.
:::

::: fact
id: BLK-f1886568bc74ebd4
summary: Important corrections:.
digest: 005ac5270ad6c878576cdeaadfc410af4102731f7cab63496693dc9c2300669a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Important corrections:..
vector_summary: Important corrections:.
chapter: CH-05
:::
Important corrections:
:::

::: fact
id: BLK-1f946628820928af
summary: There is no standard time.diff builtin in OPA.
digest: 097dab5ae3864a349ce714129f2e4a912d0c64594d5e09f11d5dd9e57eb833fe
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that There is no standard time.diff builtin in OPA..
vector_summary: There is no standard time.diff builtin in OPA.
chapter: CH-05
:::
There is no standard time.diff builtin in OPA.
:::

::: fact
id: BLK-f214eb556e8a953e
summary: Test_http_policy if { result := policy.check with http.send as mock_http_send }.
digest: da7b8debc7e5abe84813c156a3e6dba24c971309c0a7c25e9f365ec2fdac6d48
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_http_policy if { result := policy.check with http.send as mock_http_send }..
vector_summary: Test_http_policy if { result := policy.check with http.send as mock_http_send }.
chapter: CH-05
:::
test_http_policy if { result := policy.check with http.send as mock_http_send }
:::

::: fact
id: BLK-0df20cfb2ff67a77
summary: Rego exposes rule metadata at evaluation time:.
digest: 3159c92b078db6010d1d60106749c3f192b235eb2eb2cc382f16a87bd764bbcf
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego exposes rule metadata at evaluation time:..
vector_summary: Rego exposes rule metadata at evaluation time:.
chapter: CH-05
:::
Rego exposes rule metadata at evaluation time:
:::

::: fact
id: BLK-22d542254fb4e430
summary: Rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain.
digest: 9929626a3d309f7163a3152091eccecaf305bdc8e9a47685ad134d2f7688ecd3
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain..
vector_summary: Rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain.
chapter: CH-05
:::
rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain
:::

::: fact
id: BLK-75f34843f2caa056
summary: Enrich decision logs with rule IDs, owners, severity.
digest: a6165474e27f0dcb8574970b056f6d70cfb54a25ff5aef5b8cb6dfdb3640a792
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Enrich decision logs with rule IDs, owners, severity..
semantic_categories: [observability]
vector_summary: Enrich decision logs with rule IDs, owners, severity.
chapter: CH-05
:::
Enrich decision logs with rule IDs, owners, severity.
:::

::: fact
id: BLK-2a123209b43ae5ad
summary: Deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }.
digest: 981715640d0c553dd113c0423be2bdcf81732e21daf397525fb8f47edee54b30
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }..
vector_summary: Deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }.
chapter: CH-05
:::
deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }
:::

::: fact
id: BLK-d9889415e47b56cf
summary: Print is the primary debugging tool for Rego:.
digest: 1ace847a500453e95d80516bee412fab1f8d47fce6110bb850deb131e0410b0f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Print is the primary debugging tool for Rego:..
vector_summary: Print is the primary debugging tool for Rego:.
chapter: CH-05
:::
print is the primary debugging tool for Rego:
:::

::: fact
id: BLK-1095ee34dfae7aed
summary: Debug_rule if { x := input.value print("The value of x is:", x) x > 10 }.
digest: 38aea5f00d479d1fdefb56e65a765e5db8dce82a5fea65d7d26a541e759bd43f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Debug_rule if { x := input.value print("The value of x is:", x) x > 10 }..
vector_summary: Debug_rule if { x := input.value print("The value of x is:", x) x > 10 }.
chapter: CH-05
:::
debug_rule if { x := input.value print("The value of x is:", x) x > 10 }
:::

::: fact
id: BLK-0d4a08a0bff4d6d5
summary: Output appears in OPA logs or opa eval --explain trace output depending on environment.
digest: 672a32fe340e715dc78763e3649faafb5c50a0ac6e288602f6ed5859bafff46c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Output appears in OPA logs or opa eval --explain trace output depending on environment..
vector_summary: Output appears in OPA logs or opa eval --explain trace output depending on environment.
chapter: CH-05
:::
Output appears in OPA logs or opa eval --explain trace output depending on environment.
:::

::: fact
id: BLK-36aac4923d6e8a11
summary: # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }.
digest: 8136b327183cf18a0e05d40f87f0f9bf4cb2d1efabee2d9614e83c12bc8f9063
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }..
vector_summary: # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }.
chapter: CH-05
:::
# If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }
:::

::: fact
id: BLK-7723dfb7493646b4
summary: Opa eval --strict-builtin-errors ...
digest: 33b79c10e4039c92372721cea467d0822edd8e3eb0198573ac3ba6941f86ebf4
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa eval --strict-builtin-errors ....
vector_summary: Opa eval --strict-builtin-errors ...
chapter: CH-05
:::
opa eval --strict-builtin-errors ...
:::

::: fact
id: BLK-721972a19dbe3e46
summary: Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere.
digest: b7fc57702066d573fad9daae65d14ae19f807ab11b7d01747a08b73be779c126
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere..
vector_summary: Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere.
chapter: CH-05
:::
Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere.
:::

::: fact
id: BLK-2105253d138563cb
summary: Canonicalization: Always lowercase/trim user-identifiers before comparison.
digest: a5ddb3d6d3defb25fbd7aa9916a721f264f59120f89833f2f16ebba75327eaee
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Canonicalization: Always lowercase/trim user-identifiers before comparison..
vector_summary: Canonicalization: Always lowercase/trim user-identifiers before comparison.
chapter: CH-05
:::
Canonicalization: Always lowercase/trim user-identifiers before comparison.
:::

::: fact
id: BLK-7b0b481d4c3ce520
summary: Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ...
digest: 59c03799b6afa44be32437ccf65ae541a952e269ea18ae634920123a6ba9bf3d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ....
vector_summary: Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ...
chapter: CH-05
:::
Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ...
:::

::: fact
id: BLK-da85b2ab78e71372
summary: Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which...
digest: b7ea3a8246b13e3f6fc54c5a613d82f00b61a7c08a7c68d807dea87f4db0dca3
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which....
semantic_categories: [testing]
vector_summary: Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which...
chapter: CH-05
:::
Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which you prove that your policies are correct, stable, and maintainable. This chapter builds from basic _test rules up to full-blown policy test architectures, fuzzing, and debugging strategies. ________________________________________ 7.1 Testing Fundamentals Where tests live Tests are Rego modules whose package names end in _test. Convention: Production package: package authz.api Test package: package authz.api_test Naming rules Test rules must start with test_. A test passes if its body can be satisfied (i.e., is true); it fails otherwise. package authz.api_test
:::

::: fact
id: BLK-f1a56ec6ccdf9d8f
summary: # All tests in current tree opa test .
digest: 632c10049f6a3904945a85393f562a38db02f752610582d01a65643b53a8713f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # All tests in current tree opa test ..
vector_summary: # All tests in current tree opa test .
chapter: CH-05
:::
# All tests in current tree opa test .
:::

::: fact
id: BLK-537801bd1cd367b5
summary: # Verbose (see individual test names) opa test.
digest: f781a423932b0556d803d6973aaf06169f72efa047b308946d2a131bd03269d9
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Verbose (see individual test names) opa test..
vector_summary: # Verbose (see individual test names) opa test.
chapter: CH-05
:::
# Verbose (see individual test names) opa test . -v
:::

::: fact
id: BLK-fa854a9140894ca2
summary: # Specific path or file opa test policies/ authz_test.rego.
digest: 96bf309d4c8f8564e092522be764148ffbdf6c3c4468e7c5aa121f1787725373
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Specific path or file opa test policies/ authz_test.rego..
vector_summary: # Specific path or file opa test policies/ authz_test.rego.
chapter: CH-05
:::
# Specific path or file opa test policies/ authz_test.rego
:::

::: fact
id: BLK-a57fac63b249febb
summary: Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"i...
digest: e985127304e6c58277288011a71e179f29f5f50eb058932e7daaf9c667b13172
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"i....
semantic_categories: [testing]
vector_summary: Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"i...
chapter: CH-05
:::
# With coverage reporting opa test . --coverage --format=json > coverage.json ________________________________________ 7.2 The with Keyword for Mocking with is the cornerstone of Rego testing. It temporarily overrides input, data, or even built-ins for a single evaluation. Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"id": "123"} } } Override data test_role_from_data if { authz.allow with input as {"user": "alice", "action": "read"} with data.roles as {"alice": ["admin"]} } Override built-ins (time, http, etc.)
:::

::: fact
id: BLK-b3c956e83dd2d9b9
summary: # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }.
digest: 4ed501019572266144e6ab14f882953ac90fbc4bee0b583a8b4ae72697b99329
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }..
vector_summary: # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }.
chapter: CH-05
:::
# in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }
:::

::: fact
id: BLK-f2f11d384f628fdd
summary: 7.3 Golden Tests & File I/O (Corrected).
digest: 40b140c842521cc18eef2f3233df321e16fd6d9d5e8963637abb414cfa213781
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.3 Golden Tests & File I/O (Corrected)..
vector_summary: 7.3 Golden Tests & File I/O (Corrected).
chapter: CH-05
:::
7.3 Golden Tests & File I/O (Corrected)
:::

::: fact
id: BLK-7834e0c249b42a27
summary: Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.).
digest: 693a84b8548504f32be805e71118d686e571e30d21d00172b7597e11ba5d3131
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.)..
vector_summary: Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.).
chapter: CH-05
:::
Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.).
:::

::: fact
id: BLK-f8692f6179728f8b
summary: Populate data.tests["pr_large"] before invoking opa test or the OPA SDK.
digest: d268a639a5d8277269849980b5e4554e261657a85485450695108ed92c6d9957
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Populate data.tests["pr_large"] before invoking opa test or the OPA SDK..
vector_summary: Populate data.tests["pr_large"] before invoking opa test or the OPA SDK.
chapter: CH-05
:::
Populate data.tests["pr_large"] before invoking opa test or the OPA SDK.
:::

::: fact
id: BLK-00e38f5a2f7efa75
summary: Rego: pure data and rules; no file system.
digest: 713066482991a232858a5e502d8700b2aefdf885267a5eb02319c6ceddd20f80
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego: pure data and rules; no file system..
vector_summary: Rego: pure data and rules; no file system.
chapter: CH-05
:::
Rego: pure data and rules; no file system.
:::

::: fact
id: BLK-a8d9de9cf30c1fc4
summary: A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files.
digest: 3ee2352c0d14c210c8647d528b204ce5c4aabef0045fae48a594d8708d704d4e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files..
vector_summary: A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files.
chapter: CH-05
:::
A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files. This difference frequently causes test failures that are difficult to diagnose.
:::

::: fact
id: BLK-cb3db7a529ef9313
summary: JSON Input (via opa eval --input):.
digest: e3aef5ef974d787208caf539561a59b06cb3f2e85ee21a332bb76eda00a5b873
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that JSON Input (via opa eval --input):..
vector_summary: JSON Input (via opa eval --input):.
chapter: CH-05
:::
**JSON Input (via `opa eval --input`):**
:::

::: fact
id: BLK-1b920d632bac61fa
summary: In JSON, \n is interpreted as an actual newline character during JSON parsing.
digest: 7a181a2817461b6ec3fc0b72d2a798982ee3ea200ebc12aeb2808959f85df989
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In JSON, \n is interpreted as an actual newline character during JSON parsing..
vector_summary: In JSON, \n is interpreted as an actual newline character during JSON parsing.
chapter: CH-05
:::
In JSON, `\n` is interpreted as an actual newline character during JSON parsing. The policy receives a string containing a real line break.
:::

::: fact
id: BLK-8c6da53a0dea320a
summary: Rego Test File (inline string literal):.
digest: fab20ad7a3ba79c49bb5c2d636c77f9bd6c9551b0338908aac5d582eedfa665b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego Test File (inline string literal):..
vector_summary: Rego Test File (inline string literal):.
chapter: CH-05
:::
**Rego Test File (inline string literal):**
:::

::: fact
id: BLK-1a8bc26591bda96c
summary: In Rego test files, \n within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'.
digest: 73f0a239924a3cb7e9ae56fbcdd1cc7efee5b45e7cd7c63e5436a0d99e5f9550
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In Rego test files, \n within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'..
vector_summary: In Rego test files, \n within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'.
chapter: CH-05
:::
In Rego test files, `\n` within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'. It is not decoded to an actual newline.
:::

::: fact
id: BLK-ded8c7f03a6d2763
summary: Symptoms: - Tests fail with opa test but pass with opa eval --input <json-file> - Regex patterns that work with JSON inputs fail in test files - Mu...
digest: ddfe4b908af3745bdf8b9bd8a21deddd7c5796b4b099c0c03a06bdf80ca2729c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Symptoms: - Tests fail with opa test but pass with opa eval --input <json-file> - Regex patterns that work with JSON inputs fail in test files - Mu....
vector_summary: Symptoms: - Tests fail with opa test but pass with opa eval --input <json-file> - Regex patterns that work with JSON inputs fail in test files - Mu...
chapter: CH-05
:::
**Symptoms:** - Tests fail with `opa test` but pass with `opa eval --input <json-file>` - Regex patterns that work with JSON inputs fail in test files - Multi-line matching fails unexpectedly
:::

::: fact
id: BLK-e47c0f553000bb39
summary: Best Practice: When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavio...
digest: 38947f701e8c7607a7b7eab8530abfe52df15258567ac03e297ef7a42e3e3789
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Best Practice: When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavio....
semantic_categories: [testing]
vector_summary: Best Practice: When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavio...
chapter: CH-05
:::
**Best Practice:** When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavior of JSON inputs.
:::

::: fact
id: BLK-6f609bd8fd8f15c6
summary: The evaluation context of with clauses in tests can affect how rule results are accessed.
digest: 047fde531ac8c78c52273737dd14da8555909619b32c07f698a1b1977288ee6c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The evaluation context of with clauses in tests can affect how rule results are accessed..
vector_summary: The evaluation context of with clauses in tests can affect how rule results are accessed.
chapter: CH-05
:::
The evaluation context of `with` clauses in tests can affect how rule results are accessed. Understanding these patterns prevents subtle test failures.
:::

::: fact
id: BLK-8329ea621be0fbe8
summary: When a rule returns a set (partial rule with contains), accessing elements requires proper iteration:.
digest: 45ce7e2e9e446585c94b9adf064df9e77179191472b2120dfe1651b44b7f34ee
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When a rule returns a set (partial rule with contains), accessing elements requires proper iteration:..
vector_summary: When a rule returns a set (partial rule with contains), accessing elements requires proper iteration:.
chapter: CH-05
:::
When a rule returns a set (partial rule with `contains`), accessing elements requires proper iteration:
:::

::: fact
id: BLK-eb983ec34e7f2afd
summary: 7.8.3 Rule Precedence and Overlapping Conditions.
digest: 48fad5fee72883b10affa5489143b9557089b7623693eaa89014b16b9139efa5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 7.8.3 Rule Precedence and Overlapping Conditions..
vector_summary: 7.8.3 Rule Precedence and Overlapping Conditions.
chapter: CH-05
:::
7.8.3 Rule Precedence and Overlapping Conditions
:::

::: fact
id: BLK-87dcc1797078ce96
summary: When multiple rules can match the same input, understanding evaluation order is critical for test design.
digest: 4f52d5edd989c7e78bb18c91ea78972d9f615b65b24fb908513e625b8f0e1803
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that When multiple rules can match the same input, understanding evaluation order is critical for test design..
vector_summary: When multiple rules can match the same input, understanding evaluation order is critical for test design.
chapter: CH-05
:::
When multiple rules can match the same input, understanding evaluation order is critical for test design.
:::

::: fact
id: BLK-38a3d8f94378e0d5
summary: Problem: Overlapping Rule Conditions.
digest: b3acf89998ee538360b1b282d3660ea8eb87869046f8d1c005f32d33ab94a1fc
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Problem: Overlapping Rule Conditions..
vector_summary: Problem: Overlapping Rule Conditions.
chapter: CH-05
:::
**Problem: Overlapping Rule Conditions**
:::

::: fact
id: BLK-716c7db7881919b2
summary: Best Practice: Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered).
digest: c65752d09f20213ffa8613137a27ac41cfe4eb1223b5d0807ec7295ea010c50f
symbol_refs: []
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Best Practice: Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered)..
vector_summary: Best Practice: Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered).
chapter: CH-05
:::
**Best Practice:** Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered). This makes tests more resilient to policy refactoring.
:::

::: fact
id: BLK-be379cbe8b085069
summary: String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations.
digest: 547561564b516f7193acd60ead3ff4dd604be642e4c14170edc7b3f3add5a661
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations..
vector_summary: String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations.
chapter: CH-05
:::
String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations.
:::

::: fact
id: BLK-4976548b8700b298
summary: Option 2: Policy-Level Normalization (Recommended for Production).
digest: e88c54742ebb790812ccf0ef566a049b00e1e2ef1c144ac946668f48a6d79b8a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Option 2: Policy-Level Normalization (Recommended for Production)..
vector_summary: Option 2: Policy-Level Normalization (Recommended for Production).
chapter: CH-05
:::
**Option 2: Policy-Level Normalization (Recommended for Production)**
:::

::: fact
id: BLK-815e807463d05340
summary: Option 3: Explicit Case Variants in Policy.
digest: cd4b343538634d500d83909756dde91fd6013f8aaf0cf5016252860be7714a42
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Option 3: Explicit Case Variants in Policy..
vector_summary: Option 3: Explicit Case Variants in Policy.
chapter: CH-05
:::
**Option 3: Explicit Case Variants in Policy**
:::

::: fact
id: BLK-e18f935c97d3ec3d
summary: Best Practice: For production policies, prefer normalization (Option 2) to handle case variations gracefully.
digest: a68f6059fb72e6cbb9f964deefcd7c939ddf99c07bbad5e260916b1d58e7a907
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Best Practice: For production policies, prefer normalization (Option 2) to handle case variations gracefully..
vector_summary: Best Practice: For production policies, prefer normalization (Option 2) to handle case variations gracefully.
chapter: CH-05
:::
**Best Practice:** For production policies, prefer normalization (Option 2) to handle case variations gracefully. For tests, ensure inputs match policy expectations exactly, or document case sensitivity requirements clearly.
:::

::: fact
id: BLK-2a66a03314f167f4
summary: Decision rule: data.envoy.authz.allow.
digest: 57fd402da7468ee3ca8935812f34582949e96a6442b0790fd40d76c529eadcc0
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Decision rule: data.envoy.authz.allow..
semantic_categories: [authz]
vector_summary: Decision rule: data.envoy.authz.allow.
chapter: CH-05
:::
deny[msg] if { input.request.kind.kind == "Pod" some c in input.request.object.spec.containers c.image == "latest" msg := "Images must not use :latest tag" } Envoy / API Gateway Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP. Decision rule: data.envoy.authz.allow. Example: package envoy.authz
:::

::: fact
id: BLK-ff682021c825f473
summary: Bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundl...
digest: 3ff632583c325e2e70da2bccde7bccea5928e5f79757010c43ff6726ed4d37de
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundl....
semantic_categories: [distribution]
vector_summary: Bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundl...
chapter: CH-05
:::
bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundles, verifies them, and updates its data and policy set. ________________________________________ 9.2 Bundle Layering & Tenancy You can have multiple bundles: global-baseline.tar.gz ‚Üí data.global org-security.tar.gz ‚Üí data.org crm-team.tar.gz ‚Üí data.crm tenant-123.tar.gz ‚Üí data.tenants["123"] OPA merges them in the data document. Patterns: Tenant-specific overrides are just data: package authz
:::

::: fact
id: BLK-fc4d408a0b120c15
summary: Allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset...
digest: b44ee95a2cfce097f83265724e65b0e57a38da8283c5ee02dd30406ce216d0cb
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset....
semantic_categories: [distribution]
vector_summary: Allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset...
chapter: CH-05
:::
allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset of OPAs. Compare decisions vs stable. ________________________________________ 9.3 Release Engineering & Versioning Use semantic versioning for bundles: vMAJOR.MINOR.PATCH. Track: Git commit SHA. Build ID. CI pipeline run. Typical pipeline: opa fmt + lint + opa test + opa check --strict. opa build / custom bundler to produce bundle.tar.gz. Sign bundle (e.g., Sigstore, GPG). Upload to bundle server / CDN. Tag release in Git. ________________________________________ Chapter 10 ‚Äì Linting, Style & CI Even perfect policies are useless if they‚Äôre unreadable or unmaintainable. This chapter merges style guides, linting, and CI patterns into an enforceable system. ________________________________________ 10.1 Style Principles (Based on Styra + Enterprise Practice) Readability first Prefer clear, small rules over clever one-liners. Use opa fmt always Standardizes indentation, spacing, and layout. Enforce via CI. Use modern syntax (Rego v1) if, contains, every, some ... in .... Import rego.v1 or future.keywords when needed. Naming conventions Packages: domain.service.component crm.authz.http, infra.k8s.admission. Rules & functions: snake_case. Helper rules: prefix with _ (convention). package crm.authz.http
:::

::: fact
id: BLK-452d175adcd847c7
summary: Allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package.
digest: 10ec83097c1743291659efdca0d60a05cc03f6f9348c1273ae2443b5a89b0bca
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package..
semantic_categories: [negation]
vector_summary: Allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package.
chapter: CH-05
:::
allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package. Imports. Constants/defaults. Then: Helper rules (unexported). Public rules (allow, deny, violation, etc.). ________________________________________ 10.2 Regal (Linter) & Custom Lint Rules Regal is a dedicated Rego linter. Example config (.regal/config.yaml): rules: naming-convention: snake_case: true unused-decls: error no-var-shadowing: error require-some: error no-ambiguous-negation: warn max-rule-size: severity: warn limit: 10 avoid-inline-comprehensions: warn package-path-alignment: error no-import-input: error Typical checks: Snake_case for everything. No unused variables (except _). No variable shadowing. Explicit some declarations. Package name alignment with file path. Metadata required on certain rules (e.g., deny rules). ________________________________________ 10.3 CI Pipeline: From Formatting to Enforcement Lint & format stage ‚Äì GitHub Actions example name: Rego Linting on: [push, pull_request]
:::

::: fact
id: BLK-24debc49b4b7f143
summary: Name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa.
digest: eb4957efba28088062e024fabc1c06963142a6080aaa1fceaa4f385673e46789
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa..
vector_summary: Name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa.
chapter: CH-05
:::
- name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa
:::

::: fact
id: BLK-cc6f290305561e56
summary: Name: Check formatting run: opa fmt --fail .
digest: bb205e01aa1001015a2ab47afbf00bf4bb2fcbf74d67b3fcb8a8ab4aa1279810
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Name: Check formatting run: opa fmt --fail ..
vector_summary: Name: Check formatting run: opa fmt --fail .
chapter: CH-05
:::
- name: Check formatting run: opa fmt --fail .
:::

::: fact
id: BLK-d5f021f01e8b32e6
summary: Name: Lint (Regal) run: regal lint --format=github.
digest: f30861ea8d6b7edcb027d05978f974675674e80ab5fe6d25ed87bf26e21c37ce
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Name: Lint (Regal) run: regal lint --format=github..
vector_summary: Name: Lint (Regal) run: regal lint --format=github.
chapter: CH-05
:::
- name: Lint (Regal) run: regal lint --format=github . Test stage name: Rego Tests on: [push, pull_request]
:::

::: fact
id: BLK-545646192799e4a9
summary: Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system.
digest: b31ecb7fcdde5a7149b501dfa8f48e7709cbd4c68ae4299754fe9c59346d816a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system..
vector_summary: Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system.
chapter: CH-05
:::
jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa - name: Run tests run: opa test policies/ tests/ --verbose --timeout 30s Compliance evaluation stage (optional) Run opa eval with CI inputs (like PR diffs) to enforce policy gates. ________________________________________ 10.4 Editor & Developer Experience .editorconfig: [*.rego] indent_style = tab indent_size = 4 Editor extensions: Syntax highlighting, opa fmt on save. Regal integration where possible. For Cursor / custom AI agents: Auto-run opa fmt in pre-commit hooks. Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system. ________________________________________ Chapter 11 ‚Äì Performance Engineering (From Heuristics to Formal Bounds) OPA is fast, but bad policies can be slow. This chapter formalizes the performance story. ________________________________________ 11.1 Complexity Mental Model Roughly: Lookup in objects/sets: ~O(1) Array iteration: O(n) Nested iteration: O(n¬≤) or worse Graph-like recursion: O(depth √ó fan-out), potentially exponential without care Your goal: rewrite policies such that most operations become hash lookups, not brute-force scans. ________________________________________ 11.2 Expression Ordering OPA evaluates rule bodies top to bottom, left to right within that body. Rearranging expressions can dramatically change performance.
:::

::: fact
id: BLK-4ae88044f166e17a
summary: # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as ...
digest: 3d1ad8ab54e06a428d7de35590de4c66066c7d3b6a3b5cb5df7f7a1b7f4210bf
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as ....
vector_summary: # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as ...
chapter: CH-05
:::
# Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as a map keyed by ID: { "users": { "alice": {"id": "alice", "active": true}, "bob": {"id": "bob", "active": false} } } Then: user := data.users[input.user_id] deny[msg] if { user.active == false msg := "User is inactive" } OPA can automatically index these object lookups, giving near O(1) access. ________________________________________ 11.4 Avoiding Redundant Computation Bad: inefficient if { sum(numbers) > 100 sum(numbers) < 1000 result := sum(numbers) } Good: efficient if { total := sum(numbers) total > 100 total < 1000 result := total } OPA memoizes built-ins within a query, but you still pay the call overhead and it hurts readability. ________________________________________ 11.5 Comprehension Patterns Prefer existential patterns over building large intermediate sets:
:::

::: fact
id: BLK-bebdc8068b9afba0
summary: # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/.
digest: f80cd61503e05f4cdf26e5cad1a8921d378a6cdef29988ea90c2b9807c475ee6
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/..
vector_summary: # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/.
chapter: CH-05
:::
# Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/
:::

::: fact
id: BLK-fd34e8211928ad97
summary: # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/.
digest: 3e0f9d8a0278f4c951f57c572d5d2cc302feb58cb909cf88c43491f4c06998ff
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/..
semantic_categories: [distribution]
vector_summary: # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/.
chapter: CH-05
:::
# Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/
:::

::: fact
id: BLK-504b0b84d9f07aaf
summary: An optimized bundle (policy + data),.
digest: b1ac40efd62b8666b28a6cc82dff445ab6ca6b0b720234c2d1d20a9751b4cf6d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that An optimized bundle (policy + data),..
semantic_categories: [distribution]
vector_summary: An optimized bundle (policy + data),.
chapter: CH-05
:::
An optimized bundle (policy + data),
:::

::: fact
id: BLK-79a5d70928584f27
summary: Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint.
digest: 117b270b66a0be1336f518e9ba9c25e5cb7f207ce61d7de2c54c687dc5649800
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint..
vector_summary: Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint.
chapter: CH-05
:::
Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint.
:::

::: fact
id: BLK-139c3fe74060a52b
summary: Opa eval --partial \ -d policies/ \ 'data.authz.allow'.
digest: 9a153c71c926f071a775260f7474898254b5766a042f04682fdfa7265688bf5e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa eval --partial \ -d policies/ \ 'data.authz.allow'..
vector_summary: Opa eval --partial \ -d policies/ \ 'data.authz.allow'.
chapter: CH-05
:::
opa eval --partial \ -d policies/ \ 'data.authz.allow'
:::

::: fact
id: BLK-cbf7f28fee540782
summary: Returns residual policy expressions capturing unknowns,.
digest: 7e0682fe70f7b85e98bf7b06fcb048fe11bf8592793533e3b4dcdd8d93acd27d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Returns residual policy expressions capturing unknowns,..
vector_summary: Returns residual policy expressions capturing unknowns,.
chapter: CH-05
:::
Returns residual policy expressions capturing unknowns,
:::

::: fact
id: BLK-5769859e9bd59db9
summary: Opa build -t wasm ..
digest: 018bb154559ebb406ea3acbc4354cb0adad3b308e61cd51cd5490299fa8fd11c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa build -t wasm ...
vector_summary: Opa build -t wasm ..
chapter: CH-05
:::
opa build -t wasm ... ‚Üí WASM module for embedded/edge.
:::

::: fact
id: BLK-061653364bae9a32
summary: Opa build ..
digest: 154a02c5cedeeebc3499d4826f1434dc9e230f1b7fe32a36986c08833cc9bd72
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa build ...
semantic_categories: [distribution]
vector_summary: Opa build ..
chapter: CH-05
:::
opa build ... ‚Üí optimized bundle for standard OPA.
:::

::: fact
id: BLK-2f18848e7865b628
summary: Opa eval --partial ..
digest: 7f585895c832409a2ea0ec02af3e21b910099fe4cbf589064f545c6633f2098a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa eval --partial ...
vector_summary: Opa eval --partial ..
chapter: CH-05
:::
opa eval --partial ... ‚Üí interactive partial eval for debugging and design. ________________________________________ Chapter 12 ‚Äì Formal Semantics (Doctorate-Level View) Now we go under the hood. You don‚Äôt need this to use Rego, but you do need it to design new policy frameworks, reason about correctness, or write academic work. ________________________________________ 12.1 Rego as a Datalog Variant At its core, a Rego program is a set of Horn clauses (rules) over a Herbrand universe of JSON-like terms. A rule: h(tÃÑ) if { b‚ÇÅ ... b‚Çô } corresponds to: b_1‚àß‚ãØ‚àßb_n‚áíh(t Àâ)
:::

::: fact
id: BLK-f0e250b1b329925b
summary: Require that cycles with negation are disallowed or handled carefully.
digest: 207f1ce8885c4529456976767102df4d298e297b9555f5f413bfc935f1d1044c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Require that cycles with negation are disallowed or handled carefully..
semantic_categories: [negation]
vector_summary: Require that cycles with negation are disallowed or handled carefully.
chapter: CH-05
:::
To avoid paradoxes (like p :- not p), Rego effectively works in the space of stratified programs (or well-founded semantics): Build a dependency graph between predicates (rules). Require that cycles with negation are disallowed or handled carefully. This is why variables in negated expressions must be grounded elsewhere; otherwise, the semantics become ill-defined. ________________________________________ 12.5 Partial vs Complete Rules: Semantic Interpretation Complete rule (one final value): max_memory := 4 if ... max_memory := 8 if ... default max_memory := 1 Interpreted as a function max_memory : Input ‚Üí Scalar such that: If multiple definitions apply and yield same value ‚Üí OK. If they yield different values ‚Üí conflict (no model). Partial rules (sets/objects): deny[msg] if ... deny[msg] if ... Interpreted as: deny={msg‚à£‚àÉ" body s.t." body‚áímsg}
:::

::: fact
id: BLK-21f4fa8659b7887a
summary: Key points: P^'is smaller and more specialized.
digest: e512bfb7a5d64114555acb95a50c11c29ffe6148c626205589ab226c4163bee7
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Key points: P^'is smaller and more specialized..
vector_summary: Key points: P^'is smaller and more specialized.
chapter: CH-05
:::
Key points: P^'is smaller and more specialized. OPA uses this to generate WASM or pre-compiled forms that execute efficiently for fixed queries.
:::

::: fact
id: BLK-1a2433cf2e7dd787
summary: Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owner...
digest: 60c9572589a100b73ab7e7ed53e7f509096a231240c7b82313d13a8b6fa5fc59
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owner....
semantic_categories: [distribution]
vector_summary: Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owner...
chapter: CH-05
:::
Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owners, bundles, and tenants without descending into chaos. At scale, you need: ‚Ä¢ Layers: global ‚Üí domain ‚Üí team ‚Üí tenant. ‚Ä¢ Ownership metadata: who owns what, and how severe is it. ‚Ä¢ Override semantics: how do layers combine, and who wins on conflict. ________________________________________ 13.1 Layer Model: Global ‚Üí Domain ‚Üí Team ‚Üí Tenant Think of policies as a stack of overlays: 1. Global Baseline (Organization Level) o Owned by: security/compliance. o Guarantees non-negotiable invariants: ÔÇß ‚ÄúNo public S3 buckets‚Äù ÔÇß ‚ÄúAll admin actions must be audited‚Äù o Usually has the highest precedence for denies (security wins). 2. Domain Policies (Product / Platform Level) o Example domains: ÔÇß crm.*, billing.*, identity.*. o Define domain-specific invariants: ÔÇß ‚ÄúAn Opportunity must have an associated Account‚Äù ÔÇß ‚ÄúA Subscription must have a plan and billing cycle‚Äù 3. Team / Service Policies o Local teams add guardrails and UX-level rules: ÔÇß ‚ÄúThis API must include X-Request-Id‚Äù ÔÇß ‚ÄúThis microservice cannot call that microservice directly‚Äù 4. Tenant Overlays (Customer-Specific) o Per-tenant exceptions and configuration: ÔÇß ‚ÄúTenant A enforces stricter password rules‚Äù ÔÇß ‚ÄúTenant B has a special approval workflow‚Äù OPA sees all of these as data + Rego modules merged into a single virtual data tree. ________________________________________ 13.2 Encoding Layers in Data and Packages One robust pattern: ‚Ä¢ Global policies: package global.* ‚Ä¢ Domains: package domain.<name>.* ‚Ä¢ Teams/services: package svc.<service_name>.* ‚Ä¢ Tenant overlays: data.tenants[tenant_id].* Example structure: policies/ global/ baseline.rego # package global.baseline crm/ authz.rego # package domain.crm.authz schema.rego # package domain.crm.schema svc/ accounts.rego # package svc.accounts.rules tenants/ 123/ overrides.json # data.tenants["123"] 456/ overrides.json ________________________________________ 13.3 Policy Ownership Metadata Every rule that matters should be self-describing. You can store metadata as: ‚Ä¢ A dedicated rule (__meta__) ‚Ä¢ Rego annotations (via rego.metadata.rule()) ‚Ä¢ Comments (less machine-friendly) Example: package crm.policies.account_lifecycle
:::

::: fact
id: BLK-ffa5f256037b8448
summary: __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVE...
digest: d1e93a894127fd56f732e34e932e094a8399ef7e5fbbeac8622c54898387b664
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVE....
vector_summary: __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVE...
chapter: CH-05
:::
__meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVERRIDE | WARN | INFO "version": "1.0.0", "tags": ["lifecycle", "compliance"] }
:::

::: fact
id: BLK-af753aeced1226aa
summary: Deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Clo...
digest: 5e67af4148923b8482b9158b4b7944e1572225e542293f96f9956dd409f1cdb4
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Clo....
vector_summary: Deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Clo...
chapter: CH-05
:::
deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Closed accounts cannot be reopened", } } For global policies: package global.network
:::

::: fact
id: BLK-9917457deaa0fcf0
summary: __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }.
digest: bd2cb430d9efdfadd982163903683d32f305f760356e2518a71bb263d600f5e9
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }..
vector_summary: __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }.
chapter: CH-05
:::
__meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }
:::

::: fact
id: BLK-eccf109bc4dfb522
summary: Effects[eff] if { eff := data.svc.accounts.rules.effects[_] }.
digest: f1d1d87a52369a0d8398a07b14dff0df892a371512f14c3780b8679e25627976
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Effects[eff] if { eff := data.svc.accounts.rules.effects[_] }..
vector_summary: Effects[eff] if { eff := data.svc.accounts.rules.effects[_] }.
chapter: CH-05
:::
effects[eff] if { eff := data.svc.accounts.rules.effects[_] }
:::

::: fact
id: BLK-c10db066c498a48d
summary: Result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]].
digest: cb81451c81ec5b562bfadd4887deb024940e40e12db26534a9fcddd7df91995c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]]..
vector_summary: Result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]].
chapter: CH-05
:::
effects[eff] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] } Each eff looks like: { "effect": "deny", "layer": "global", "rule_id": "NET_001", "severity": "BLOCK", "msg": "Public S3 bucket forbidden" } Now: compute final decision. result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]]
:::

::: fact
id: BLK-af46131c6bb3a8ce
summary: # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so.
digest: fd0c39f68a2f97eba0d820631a5b6a8e4196380599d466792fc3d0f854243b41
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so..
vector_summary: # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so.
chapter: CH-05
:::
# Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so. result := { "allow": allow_flag, "effects": all_effects, } if { all_effects := [e | e := effects[_]] not some e in all_effects { e.effect == "deny"; e.severity == "BLOCK" }
:::

::: fact
id: BLK-3fe483d8d3a22e99
summary: Allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank.
digest: 2dd891decc3aa2b7cc31eb7bca2ae2ecc34bbfce4a4e2710308a22a0d89df16e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank..
vector_summary: Allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank.
chapter: CH-05
:::
allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank. ‚Ä¢ Allowing tenant to tighten, but never to weaken global invariants. ________________________________________ 13.5 Tenant Overlays and Safe Customization Tenant-specific rules should be additive and tightening, not weakening: ‚Ä¢ Allowed: o Tenant can restrict their own behavior further. ‚Ä¢ Forbidden: o Tenant cannot bypass global security invariants. Pattern: package authz
:::

::: fact
id: BLK-1a8da57b7485efda
summary: Allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________...
digest: be8372d2eb294efefbb175c2938510c486d5065801fbf16f2432482f17f4122b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________....
semantic_categories: [distribution, observability]
vector_summary: Allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________...
chapter: CH-05
:::
allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________________________________ Chapter 14 ‚Äì Observability & Audit OPA is not only a decision engine; it‚Äôs an evidence generator. Observability and audit are how you prove that decisions are: ‚Ä¢ Correct ‚Ä¢ Consistent ‚Ä¢ Explainable ‚Ä¢ Compliant with regulation ________________________________________ 14.1 Decision Logs Every OPA decision should be treatable as a replayable event: Minimum recommended fields: ‚Ä¢ decision_id (UUID) ‚Ä¢ timestamp ‚Ä¢ path (e.g., data.authz.allow) ‚Ä¢ input_hash or input (with PII scrubbing) ‚Ä¢ result (decision doc: allow/deny/effects) ‚Ä¢ bundle_revision ‚Ä¢ metrics (evaluation time, rule count) ‚Ä¢ correlation_id (to tie into tracing) Conceptual log: { "decision_id": "3f7b9b1a-0ee2-4e52-9f39-4edb8b6a3a01", "timestamp": "2025-11-25T10:02:45Z", "path": "data.authz.allow", "input_hash": "sha256:abcd...", "result": { "allow": false, "effects": [ { "effect": "deny", "rule_id": "ACCT_001", "layer": "domain", "msg": "Closed accounts cannot be reopened" } ] }, "bundle_revision": "git:1234abcd", "metrics": { "eval_time_ns": 45321, "num_rules_evaluated": 37 }, "correlation_id": "trace-xyz-123" } OPA supports decision logs via configuration; your host system should stream them to: ‚Ä¢ Kafka / Kinesis ‚Ä¢ ELK / Loki ‚Ä¢ Datadog / Prometheus / Grafana ________________________________________ 14.2 Metrics and SLOs To treat OPA like a production service, track at least: ‚Ä¢ Latency: o p50 / p95 / p99 evaluation time. ‚Ä¢ Throughput: o decisions per second. ‚Ä¢ Decision deltas: o How often outcomes change after a new bundle. ‚Ä¢ Error rate: o Number of evaluation failures (e.g., built-in errors in strict mode). Define SLOs like: ‚Ä¢ 99.9% of policy decisions complete in < 10 ms. ‚Ä¢ < 0.1% of decisions result in evaluation error. ‚Ä¢ Decision delta after bundle rollout < 1% for stable inputs (in shadow mode). ________________________________________ 14.3 Correlation IDs and Tracing Policy evaluations rarely stand alone; they‚Äôre part of a larger request trace: ‚Ä¢ HTTP header: o X-Request-Id o traceparent (W3C Trace Context) ‚Ä¢ PEP should pass correlation ID in: o input.trace_id o or embed as part of input.request.headers. Then decision logs include correlation_id, which lets you: ‚Ä¢ Trace a single user‚Äôs journey across services. ‚Ä¢ Root-cause analyze unauthorized/denied requests quickly. Example pattern: package authz
:::

::: fact
id: BLK-28e58a316e04a314
summary: # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden...
digest: a1d59c7b409c593324d72e15e37d41355ec3b9a9bcb30eb34868512ea94786a6
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden....
semantic_categories: [distribution, observability]
vector_summary: # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden...
chapter: CH-05
:::
# decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden rule: logs must not become a data breach. ‚Ä¢ Do not log entire input if it contains PII. ‚Ä¢ Instead: o Log hashed fields (hash(email)) o Log ids / foreign keys o Redact sensitive values (e.g., use "redacted") Pattern: safe_input := { "user_id": input.user.id, "tenant_id": input.tenant_id, "resource_id": input.resource.id, "action": input.action, } Your decision logger uses safe_input rather than raw input. ________________________________________ 14.5 Reproducibility & Auditability A compliant audit story usually needs: ‚Ä¢ Given: o bundle_revision o policy_version o input (or hash + associated fixture) ‚Ä¢ You can re-evaluate the decision and get the same result. To achieve this: ‚Ä¢ Store: o Bundle artifacts (bundle.tar.gz) o Manifest metadata (revision, version) o Decision logs + input fixtures (or deterministic reconstruction) ‚Ä¢ Avoid: o Non-deterministic calls in Rego (e.g., random, uncontrolled http.send) When you must use time.now_ns or external data: ‚Ä¢ Either: o Snapshot it in the input used to evaluate. o Or store enough context to reconstruct. ________________________________________ Chapter 15 ‚Äì Stateful & Temporal Extensions OPA itself is stateless: each query sees input and data as immutable snapshots. Yet many policies are stateful or temporal: ‚Ä¢ Rate limits (N requests per unit time) ‚Ä¢ ‚ÄúNo more than 5 failed logins in 10 minutes‚Äù ‚Ä¢ ‚ÄúThis migration must be rolled out only after all canaries pass‚Äù The trick: Move state and time into data + input, not inside Rego. ________________________________________ Stateful & Temporal Extensions
:::

::: fact
id: BLK-20e31440afe0e8ca
summary: OPA is logically stateless: every evaluation sees a snapshot of policy + data.
digest: 8b4d598e26c1c3496a715ac8ae81ad01402c926b0f7c4524723556cbb204b336
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA is logically stateless: every evaluation sees a snapshot of policy + data..
vector_summary: OPA is logically stateless: every evaluation sees a snapshot of policy + data.
chapter: CH-05
:::
OPA is logically stateless: every evaluation sees a snapshot of policy + data. Stateful or temporal behaviors must be modeled via external systems that write to data or pass state through input.
:::

::: fact
id: BLK-8a79fd9ce8c38157
summary: OPA never mutates data.state.login_counts.
digest: 054787df486a86010171840e840723c81c36c164eab11423eecdcf5cfffb4a5a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA never mutates data.state.login_counts..
vector_summary: OPA never mutates data.state.login_counts.
chapter: CH-05
:::
OPA never mutates data.state.login_counts.
:::

::: fact
id: BLK-bbdc4627b644d8c5
summary: Or an in-memory structure via the OPA Go SDK,.
digest: c9486134cb3ed8c27b91dcb086d67ef4429848eb2dd49f3796750d0d8e3503b1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Or an in-memory structure via the OPA Go SDK,..
vector_summary: Or an in-memory structure via the OPA Go SDK,.
chapter: CH-05
:::
or an in-memory structure via the OPA Go SDK,
:::

::: fact
id: BLK-7b4eb1a9e305379f
summary: Or a shared cache that OPA reads from.
digest: eb0ce55423bd34dd124cfed4a8bbd612c614835dabe1f57707da0553b51a8ce5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Or a shared cache that OPA reads from..
vector_summary: Or a shared cache that OPA reads from.
chapter: CH-05
:::
or a shared cache that OPA reads from.
:::

::: fact
id: BLK-1cb53c48958ecdaa
summary: OPA Policy ‚Üí reads data.state.* as a pure input.
digest: f970dc0f9ad4b0c317b1830bbc9b40ed69f36020f29369c82ed4226e91290c3d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA Policy ‚Üí reads data.state.* as a pure input..
vector_summary: OPA Policy ‚Üí reads data.state.* as a pure input.
chapter: CH-05
:::
OPA Policy ‚Üí reads data.state.* as a pure input.
:::

::: fact
id: BLK-97da80a1bfbb763f
summary: OPA remains a pure decision engine; all state transitions happen outside.
digest: aac700f26f9933c7d517a7693ad0cab9f5905a7855c4933fa1ef88af47e01fd1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA remains a pure decision engine; all state transitions happen outside..
vector_summary: OPA remains a pure decision engine; all state transitions happen outside.
chapter: CH-05
:::
OPA remains a pure decision engine; all state transitions happen outside. ________________________________________ 15.2 Temporal Logic Using time.* OPA has: ‚Ä¢ time.now_ns() ‚Ä¢ time.parse_ns(layout, string) ‚Ä¢ time.clock(ns) and time.date(ns) ‚Ä¢ time.weekday(ns) Patterns: 1. Business hours 2. package business 3. 4. within_business_hours if { 5. now := time.now_ns() 6. [hour, _, _] := time.clock(now) 7. hour >= 9 8. hour < 17 9. } 10. Sliding window from event log in input Suppose input.events contains last 1 hour of events (pre-filtered by upstream system): package limits
:::

::: fact
id: BLK-ddb2b91d0cd87295
summary: OPA uses that state to decide: o Allow or deny new events.
digest: 670e1badeab48c6816b448b593d4a6c23bec815ef7835a98fcfc497515f36e68
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA uses that state to decide: o Allow or deny new events..
semantic_categories: [distribution]
vector_summary: OPA uses that state to decide: o Allow or deny new events.
chapter: CH-05
:::
count(recent_failures) > 5 msg := "Too many recent login failures" } OPA sees only a subset; the window is curated by your stateful event pipeline. ________________________________________ 15.3 Event-Driven Architectures with OPA Typical pattern: 1. Events flow into Kafka / Kinesis. 2. A stream processor: o Maintains aggregates: ÔÇß counts, sums, last-seen times, sliding windows. o Writes materialized state to: ÔÇß Redis, DB, or data-bundles for OPA. 3. OPA uses that state to decide: o Allow or deny new events. o Trigger downstream actions/alerts. OPA remains pure ‚Äî no long-lived state, no hidden mutable variables. ________________________________________ 15.4 Time-Scoped Exceptions Sometimes you want: ‚Ä¢ ‚ÄúAllow this temporary override until 2025-12-31.‚Äù Pattern: package overrides
:::

::: fact
id: BLK-239395e2f35c1d1c
summary: Allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing.
digest: b965e5ca38509dce23b24d3774cfeaa819553640411e8f264ee5ba5a590ba94d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing..
vector_summary: Allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing.
chapter: CH-05
:::
allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing
:::

::: fact
id: BLK-780f6a8ebb08e0bf
summary: 16.2 Field Cost Calculation (Corrected array.concat).
digest: 5332e984600a050c4586a23c3908b5084a216fa12b9b99860bfc92d048de301b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 16.2 Field Cost Calculation (Corrected array.concat)..
vector_summary: 16.2 Field Cost Calculation (Corrected array.concat).
chapter: CH-05
:::
16.2 Field Cost Calculation (Corrected array.concat)
:::

::: fact
id: BLK-07f8a2771f295779
summary: Corrections and nuances:.
digest: b01ba3743cd626967bd113e26801c5e7272ef84cc94c62ba73d0e3c2c4cd9397
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Corrections and nuances:..
vector_summary: Corrections and nuances:.
chapter: CH-05
:::
Corrections and nuances:
:::

::: fact
id: BLK-1606d5d3769853a7
summary: If either argument is null or non-array, OPA throws a type error, so in more defensive code:.
digest: d725fbecf51830efb17364bca108b7e7fcf608e85c1d5e8ff32e3108f14966f5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If either argument is null or non-array, OPA throws a type error, so in more defensive code:..
vector_summary: If either argument is null or non-array, OPA throws a type error, so in more defensive code:.
chapter: CH-05
:::
If either argument is null or non-array, OPA throws a type error, so in more defensive code:
:::

::: fact
id: BLK-c191fd1bb522212a
summary: ‚Ä¢ Allows multiple services to enforce the same logic.
digest: 08b853ab68fa3dbde69f0a05e01f0fea3be0c16e733b69eea01a7c850e578983
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚Ä¢ Allows multiple services to enforce the same logic..
semantic_categories: [distribution, unification]
vector_summary: ‚Ä¢ Allows multiple services to enforce the same logic.
chapter: CH-05
:::
statuses_for(user) := {"active"} if { not "admin" in user.roles } This pattern: ‚Ä¢ Keeps data access rules central. ‚Ä¢ Allows multiple services to enforce the same logic. ________________________________________ Chapter 17 ‚Äì LLM & Agentic Integration with OPA LLMs are good at generating Rego, OPA is good at executing and verifying Rego. Together they form: ‚ÄúAI drafts policy, OPA and tests keep it safe.‚Äù ________________________________________ 17.1 The Agentic Workflow Canonical pipeline: 1. Requirements in natural language: o ‚ÄúAPI keys must not be visible in logs‚Äù o ‚ÄúAdmin role modifications require approval‚Äù 2. LLM drafts: o Rego module. o Test suite (_test.rego). o Metadata (owner, rule_id). 3. Static checks: o opa fmt o Regal lint o opa check --strict 4. Dynamic checks: o opa test (unit + integration tests). o Fuzz/Golden tests for critical policies. 5. Human review: o Security / Policy engineers review diff, semantics. 6. Bundle build & rollout: o Standard policy SDLC. OPA becomes the execution and verification back-end for LLM-authored policy. ________________________________________ 17.2 Guardrails for LLM-Generated Rego When you let an LLM write Rego, you must: ‚Ä¢ Enforce style & safety: o Modern syntax only (import rego.v1 or future.keywords). o No http.send in production rules (unless explicitly allowed). o No secrets in code. o Type guards for all input.* references. ‚Ä¢ Require tests: o At least one positive and one negative case. o Use with overrides instead of real network/time. You can encode this as Rego that reviews Rego: ‚Ä¢ Use rego.metadata.chain() and AST analysis to enforce rules. ‚Ä¢ Or use external tools (Regal) plus your own AST/grep rules. ________________________________________ 17.3 ‚ÄúPolicy Copilot‚Äù Pattern A typical agentic stack: 1. Authoring agent: o Generates initial Rego module + tests from description and examples. 2. Critic agent: o Reads module, runs static analysis (Regal messages, opa check). o Suggests improvements and simplifications. 3. Tester agent: o Proposes additional tests (edge cases, negative paths). o Extends _test.rego. 4. Reviewer agent: o Summarizes behavior in human language. o Flags risky constructs, ambiguous cases. 5. Bundle builder: o Once human approves, compiles into bundle artifact. OPA is the deterministic core all these agents orbit around. ________________________________________ 17.4 LLM Self-Checking with Rego LLMs can call OPA during prompt execution: ‚Ä¢ Use examples like: o ‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù ‚Ä¢ LLM loops: 1. Generate candidate Rego. 2. Invoke opa test programmatically. 3. If tests fail, update policy and try again (up to N iterations). 4. Present final Rego + test report. This turns Rego into a ground truth oracle inside an agentic system. ________________________________________ Chapter 18 ‚Äì Rego Cheat Sheet (Condensed) This chapter is intentionally tight ‚Äì it‚Äôs the 2-page desk reference. ________________________________________ 18.1 Core Rule Types Type Syntax Example Boolean name if { ... } allow if { is_admin } Complete name := value if { ... } max_conns := 10 if is_admin Partial Set name contains x if { ... } deny contains msg if { ... } Partial Obj name[key] := value if { ... } roles[user] := role if { ... } Function f(x) := y if { ... } double(x) := x * 2 Default default name = value default allow = false ________________________________________ 18.2 Assignments & Comparisons ‚Ä¢ := ‚Äì assignment (one-way) ‚Ä¢ == ‚Äì equality (no binding) ‚Ä¢ = ‚Äì unification (binds if unbound, else compares) Examples: x := 10 # assignment ok if x == 10 # comparison
:::

::: fact
id: BLK-b1c0d736416df0fe
summary: Test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test .
digest: 4697f441aa914d829310f71452b5c403d63591a28de5c725a7e496eba2fd5240
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test ..
semantic_categories: [authz, distribution, negation, observability, performance, testing, theory]
vector_summary: Test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test .
chapter: CH-05
:::
**Important:** `set()` is a type conversion function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` directly. Using `set()` without arguments will cause a runtime error. ________________________________________ 18.4 Iteration Implicit: arr[_] # all values obj[k] # binds k to each key set[v] # binds v to each member Explicit with some ... in: some x in arr # values some i, x in arr # index, value some k, v in obj # key, value some v in set # members ________________________________________ 18.5 Quantifiers ‚Ä¢ Existential: some x in xs { ... } ‚Ä¢ Universal: o Using every: o all_valid if { o every x in xs { o x.valid == true o } o } o Or via negation: o all_valid if not any_invalid o any_invalid if { o some x in xs o not x.valid o } ________________________________________ 18.6 Negation not cond = ‚Äúcannot prove cond.‚Äù Safety: variables in cond must be bound beforehand. deny if { user := input.user not blacklisted[user] } ________________________________________ 18.7 Built-in Highlights ‚Ä¢ Aggregates: count, sum, max, min ‚Ä¢ Strings: concat, contains, startswith, endswith, split, replace ‚Ä¢ Regex: regex.match, regex.split ‚Ä¢ JSON: json.marshal, json.unmarshal ‚Ä¢ Time: time.now_ns, time.parse_rfc3339_ns, time.clock ‚Ä¢ Crypto: crypto.sha256, io.jwt.* ________________________________________ 18.8 Testing ‚Ä¢ Tests: package ending in _test, rules starting with test_. ‚Ä¢ Use with to override input, data, or built-ins. test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test . ________________________________________ 18.9 Best Practices (Ultra Condensed) ‚Ä¢ Always opa fmt and lint. ‚Ä¢ Use modern syntax (import rego.v1 or future.keywords). ‚Ä¢ Prefer sets/objects for membership tests. ‚Ä¢ Avoid inline comprehensions in complex allow/deny. ‚Ä¢ Use helper rules with clear names. ‚Ä¢ Always have tests for deny/allow semantics. ________________________________________ Chapter 19 ‚Äì Glossary (Rigorous) Alphabetical list of core terms. ________________________________________ ABAC (Attribute-Based Access Control) Access model where decisions are based on attributes of subject, resource, action, and environment, not just roles. Allow / Deny (Effects) Canonical authorization decision outcomes. Frequently modeled via Rego rules like allow and deny or decision documents with effects. AST (Abstract Syntax Tree) Tree representation of parsed input (e.g., GraphQL query), often passed to OPA as input for fine-grained policies. Baseline Policy (Global Baseline) Organization-wide invariant policy layer that lower layers cannot override or weaken (e.g., ‚ÄúNo public S3 buckets‚Äù). Bundle A versioned tarball containing Rego policies, data, and a .manifest file. Used by OPA to load and update policies in production. Complete Rule A Rego rule that defines a single final value (e.g., max_conns := 10 or allow := true). Multiple definitions that produce different values for the same input cause conflicts. ConstraintTemplate (Gatekeeper) Kubernetes CRD that defines reusable OPA policies for Gatekeeper. Users instantiate constraints based on templates. Correlation ID Identifier used to tie together logs and traces across systems, included in OPA decision logs for observability. Data (in OPA) Persistent, relatively static information (loaded from bundles or in-memory), accessed as data.*. May mirror configuration, schemas, user roles, etc. Decision Document The JSON result of an OPA query (e.g., data.authz.allow or a more complex document with allow, deny, effects, risk_score). Decision Log Structured record of each OPA evaluation: includes path, input (or hash), result, metrics, and bundle revision, used for audit and observability. Datalog A subset of Prolog used for declarative logic programming, without complex function symbols. Rego is inspired by Datalog and extends it with JSON-like structures. Deny Rule A partial rule (often deny[msg] or deny contains msg) that accumulates violation messages, typically used in compliance and validation policies. Effect The semantic outcome of a policy evaluation (e.g., "allow", "deny", "warn", "override"), often encoded in decision documents. Fixpoint A stable interpretation of a logic program where applying the immediate consequence operator (deriving new facts) produces no new facts. Rego‚Äôs semantics can be described via least fixpoints. Future Keywords The future.keywords import (Rego v0.x) that enables newer language constructs like if, in, contains, every. In OPA 1.0+ this is replaced by import rego.v1. Global Baseline See Baseline Policy: global layer of policies applied to all services/tenants, usually with highest precedence for security. GraphQL Policy Policy that operates on GraphQL queries represented as AST; can enforce field-level auth, query depth, or cost. HTTP Sidecar Deployment pattern where OPA runs as a sidecar container next to a service, receiving authorization queries over localhost. Input (in OPA) Per-request JSON document provided by the caller to OPA, containing details like user, action, resource, HTTP request, etc. Accessed as input.*. LLM (Large Language Model) Neural network model (like ChatGPT) used to generate or refactor Rego; OPA then validates and executes resulting policies. NAF (Negation-as-Failure) Logic programming semantics where not p(X) means ‚Äúp(X) cannot be proven.‚Äù Used in Rego for negation. OPA (Open Policy Agent) General-purpose policy decision engine that evaluates Rego policies against JSON inputs and data. PDP (Policy Decision Point) Component that computes policy decisions (e.g., OPA). PEP (Policy Enforcement Point) Component that enforces decisions (e.g., API gateway, Kubernetes admission controller). Partial Evaluation (PE) Technique where OPA specializes policies with respect to known input and data, producing an optimized, often smaller program or WASM artifact. Partial Rule A Rego rule that defines members of a virtual set or object incrementally (e.g., deny[msg] or roles[user] := role). Rego OPA‚Äôs declarative policy language, inspired by Datalog and designed for reasoning over JSON-like documents. Regal A dedicated linter for Rego, enforcing style and correctness rules beyond opa fmt. Rule Conflict Runtime error when multiple complete rules or function rules with the same name and arguments produce different values. Schema (JSON Schema) Formal type definition for JSON documents. OPA can use schemas to perform type checking on input or data. Sidecar Deployment pattern where OPA runs alongside an application in the same Pod/host, reducing network latency for policy queries. Stateful Policy Policy whose decision depends on past events or accumulated state. Implemented in OPA by passing state snapshots as data or input, not by mutability in Rego. Stratification Property of a logic program whereby cycles through negation are avoided, enabling well-defined semantics for negation-as-failure. Temporal Policy Policy that involves time (e.g., deadlines, windows, schedules), typically implemented with time.* built-ins and time-stamped state. Tenant Overlay Per-tenant policy or configuration that tightens (but does not weaken) global/domain rules, often stored under data.tenants[tenant_id]. Virtual Document A Rego rule or package that behaves like a JSON document when queried (e.g., data.authz.allow), although it is computed on demand rather than stored. WASM (WebAssembly) Portable binary format that can run Rego policies compiled from OPA in multiple environments (browsers, proxies, services). With (Keyword) Rego keyword that allows overriding input, data, or built-ins for the scope of an expression; heavily used in testing and mocking. Zero-Trust Architecture Security model where no implicit trust is granted to assets or user accounts based solely on network location; OPA policies often implement zero-trust authorization logic.
:::

::: fact
id: BLK-a6843e981cac13eb
summary: The full decision path for a typical OPA evaluation looks like this:.
digest: ac187abb001917df73da6e38931b144bad4522b20bffea1a6d7e184ac7e22d78
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The full decision path for a typical OPA evaluation looks like this:..
vector_summary: The full decision path for a typical OPA evaluation looks like this:.
chapter: CH-05
:::
The full decision path for a typical OPA evaluation looks like this:
:::

::: fact
id: BLK-a81ca863b9a3b7d5
summary: Flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[...
digest: 195e5dcbe49cd67bc4887479f5a981f363e6a9a5b4db21ac766dbc192e6af54e
symbol_refs: []
semantic_role: decision-flow
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[....
semantic_categories: [distribution]
vector_summary: Flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[...
chapter: CH-05
:::
flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[Decision Document]
:::

::: fact
id: BLK-75ee5ef88004b802
summary: Flowchart TD R[Request: input] --> OPA[OPA Engine].
digest: ad4f13027aa76b5a3a227477990ea35157134531195579f67adc0b778bb3ef49
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Flowchart TD R[Request: input] --> OPA[OPA Engine]..
vector_summary: Flowchart TD R[Request: input] --> OPA[OPA Engine].
chapter: CH-05
:::
flowchart TD R[Request: input] --> OPA[OPA Engine]
:::

::: fact
id: BLK-3a12d7c2cc6d03a1
summary: Subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end.
digest: 6647fad3434cca2f54f686be98f38f3477fcfbe6a8aacd6f442c4850517d0ae1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end..
vector_summary: Subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end.
chapter: CH-05
:::
subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end
:::

::: fact
id: BLK-bfc749d64868bc9b
summary: OPA --> P PE --> D1[Optimized Policy Set].
digest: 2613f11f4a1489984642a66971c6e474ab9396755ccc4ad5bde2c8d535e9f896
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA --> P PE --> D1[Optimized Policy Set]..
vector_summary: OPA --> P PE --> D1[Optimized Policy Set].
chapter: CH-05
:::
OPA --> P PE --> D1[Optimized Policy Set]
:::

::: fact
id: BLK-6a5cb055b34e7cb6
summary: OPA can be deployed in three canonical modes: sidecar, central service, and embedded.
digest: f85bdd3fbd63dfcb175411575f5066dfd49b00120b9ec836a0678a1240e9a714
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA can be deployed in three canonical modes: sidecar, central service, and embedded..
vector_summary: OPA can be deployed in three canonical modes: sidecar, central service, and embedded.
chapter: CH-05
:::
OPA can be deployed in three canonical modes: sidecar, central service, and embedded.
:::

::: fact
id: BLK-5be303f8619ebc37
summary: Flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end.
digest: f4c0bd4c951ae3c4245876c267e50d3524a55227fde30de281ca4bfd1fc78ca1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end..
vector_summary: Flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end.
chapter: CH-05
:::
flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end
:::

::: fact
id: BLK-f3d455506a6b7cc8
summary: Subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end.
digest: 8bcf6e2fde2d1f05c4c402e4d6e1603b491e0898bfd0b32593807e7d41c63183
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end..
vector_summary: Subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end.
chapter: CH-05
:::
subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end
:::

::: fact
id: BLK-a164ce803bbdb95f
summary: Subgraph Embedded Library A3[App Process with OPA SDK] end.
digest: d0839eb5ccc9da1e0e5257e70f69cf3a1bb017516c744b63352b47242e45a9b7
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Subgraph Embedded Library A3[App Process with OPA SDK] end..
vector_summary: Subgraph Embedded Library A3[App Process with OPA SDK] end.
chapter: CH-05
:::
subgraph Embedded Library A3[App Process with OPA SDK] end
:::

::: fact
id: BLK-0917a2a8dc7a41ce
summary: 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar].
digest: a647ab4714e3a37c5a92192a5ede75076109fe5f51f88dacf2ef5d6286ed2636
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar]..
vector_summary: 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar].
chapter: CH-05
:::
8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar]
:::

::: fact
id: BLK-b08121aaef4efdfc
summary: B[BUNDLE Server] --> OPA.
digest: 0e3f4c9a306576a1214ae7ff3d9c59b199ad4f937895391c718e056ec6f28f5d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that B[BUNDLE Server] --> OPA..
semantic_categories: [distribution]
vector_summary: B[BUNDLE Server] --> OPA.
chapter: CH-05
:::
B[BUNDLE Server] --> OPA
:::

::: fact
id: BLK-f133e19232661cc2
summary: Each app pod has its own OPA.
digest: 43a00173c975a9600351bccfa0fa216ad70c572991f45191a05d63b9723640ff
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Each app pod has its own OPA..
vector_summary: Each app pod has its own OPA.
chapter: CH-05
:::
Each app pod has its own OPA.
:::

::: fact
id: BLK-bf480b6db9e70e26
summary: 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE S...
digest: 0cc45123385a5717dc95bf1346fb43a0f9808a74e2593d0c6472b395be0d45c1
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE S....
semantic_categories: [distribution]
vector_summary: 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE S...
chapter: CH-05
:::
8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE Server] --> OPA_CLUSTER
:::

::: fact
id: BLK-e3c06649001ac7cb
summary: One or a few OPA instances serve many clients.
digest: ae3b98f428abcf9b850fa492a1c04afc60a79edac5de68c52175dab738f79968
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that One or a few OPA instances serve many clients..
vector_summary: One or a few OPA instances serve many clients.
chapter: CH-05
:::
One or a few OPA instances serve many clients.
:::

::: fact
id: BLK-d17bf7dff7e2687d
summary: 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP.
digest: 268b2ecb8b47b34d386b452dc3ea796b481d0f1119fc30c4e9f50b1e580c0029
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP..
semantic_categories: [distribution]
vector_summary: 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP.
chapter: CH-05
:::
8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP
:::

::: fact
id: BLK-00aae760c3f524cb
summary: OPA compiled to WASM or linked via Go library.
digest: a14c0464103a842b5fb73cedf19a190c81c6f895cec89393ae0237dad45de4d3
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA compiled to WASM or linked via Go library..
vector_summary: OPA compiled to WASM or linked via Go library.
chapter: CH-05
:::
OPA compiled to WASM or linked via Go library.
:::

::: fact
id: BLK-88897c889d38315b
summary: Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[D...
digest: cd7eb6dd68f9099838f9c9efc3dd16539b1fb95baf0e6d77d4cdd93b5a7b3a07
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[D....
vector_summary: Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[D...
chapter: CH-05
:::
Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[Domain Layer\n(product / region)] D --> T[Team Layer\nservice / app] T --> N[Tenant Layer\ncustomer-specific]
:::

::: fact
id: BLK-5051a10ae5706b97
summary: Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds).
digest: f33ef6b17dafa56197b4b1f6148afb7f5ee56d295f1861887713d09aa216f911
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds)..
vector_summary: Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds).
chapter: CH-05
:::
Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds).
:::

::: fact
id: BLK-24e160a1846f69ab
summary: # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent requ...
digest: 43912b51b670fa9b7987025f6bfe3971d38dd0462758c56cc9c7db5094b7e208
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent requ....
vector_summary: # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent requ...
chapter: CH-05
:::
# Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent required" }
:::

::: fact
id: BLK-05d76e22769680a5
summary: # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billin...
digest: 96e02623aadcae203edd2d07ec489046b7bf8e390d5b847a4e30f9277e6f700b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billin....
vector_summary: # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billin...
chapter: CH-05
:::
# Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billing): admin role required" }
:::

::: fact
id: BLK-3797e2670efc01ec
summary: Deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }.
digest: d1c98374374f9b3c5a8988793ad20b07ceb4d7e8533878493c20cfd923a7f9f8
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }..
vector_summary: Deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }.
chapter: CH-05
:::
deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }
:::

::: fact
id: BLK-c90e38cedbdc43d1
summary: Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OP...
digest: 7bb235482dc1de968cefa477f791278fcb392670fe119cdfdc58d057a7247efa
symbol_refs: []
semantic_role: decision-flow
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OP....
semantic_categories: [observability]
vector_summary: Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OP...
chapter: CH-05
:::
Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OPA --> LOG[Decision Log JSON]
:::

::: fact
id: BLK-04f8b905633b2c5f
summary: Metrics (eval time, number of rules evaluated).
digest: d44445d77cdeb17d8556448273022bf3070bf5740d6af4c1bea2ead1281b9ae2
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Metrics (eval time, number of rules evaluated)..
semantic_categories: [observability]
vector_summary: Metrics (eval time, number of rules evaluated).
chapter: CH-05
:::
metrics (eval time, number of rules evaluated)
:::

::: fact
id: BLK-5bbfded757016e50
summary: Bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî...
digest: 2b17bae1cc3a7ab3ace332a808bee7fd9c1ec6dc5c3f18868f2065483b802581
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî....
semantic_categories: [distribution]
vector_summary: Bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî...
chapter: CH-05
:::
bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî‚îÄ‚îÄ tenant-2.json
:::

::: fact
id: BLK-faf25efc6ab6024c
summary: Revision is an opaque version string for debugging/rollback.
digest: e517d007142ef3e834ae793bb4156c1393ed3910d36191b103689e850e90d2e6
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Revision is an opaque version string for debugging/rollback..
vector_summary: Revision is an opaque version string for debugging/rollback.
chapter: CH-05
:::
revision is an opaque version string for debugging/rollback.
:::

::: fact
id: BLK-cc9220c066084a66
summary: Roots tell OPA which prefixes in data this bundle owns:.
digest: 022eeb108c58c3146eb725e9ddc69b8b390e0f0fbd0a17a1677e49378d27f68a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Roots tell OPA which prefixes in data this bundle owns:..
semantic_categories: [distribution]
vector_summary: Roots tell OPA which prefixes in data this bundle owns:.
chapter: CH-05
:::
roots tell OPA which prefixes in data this bundle owns:
:::

::: fact
id: BLK-ae2f270b91be8579
summary: Authz ‚Üí data.authz.* (from authz.rego).
digest: 48bb9322cf0f8703d1f3b11072131da193626a8dc3e3fe7496cf1cb72e078fa5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Authz ‚Üí data.authz.* (from authz.rego)..
vector_summary: Authz ‚Üí data.authz.* (from authz.rego).
chapter: CH-05
:::
authz ‚Üí data.authz.* (from authz.rego)
:::

::: fact
id: BLK-561e364c0bc56c05
summary: # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := gl...
digest: 091b6c50352eccc50c86a53c564f2e98967d54216f03e9496263a7d5ef987798
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := gl....
vector_summary: # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := gl...
chapter: CH-05
:::
# Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := global_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 }
:::

::: fact
id: BLK-42ff1a2ed90a4135
summary: # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.g...
digest: 9dec2ca99903fb39971914d37a70082255e244b5edbc5824aaa717043545bd07
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.g....
vector_summary: # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.g...
chapter: CH-05
:::
# Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.gql.roles[full] some r in user_roles r in required }
:::

::: fact
id: BLK-f234f625c8beddfc
summary: Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot]...
digest: 8129f5fd7830d1da077eb7a83e1539406e312ca8d34bca9bdf92ba43caa1a087
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot]....
semantic_categories: [distribution]
vector_summary: Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot]...
chapter: CH-05
:::
Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot] LLM --> CAND[Candidate Rego Policy] CAND --> PIPE[Validation Pipeline] PIPE -->|fail| FEEDBACK[Errors / Suggestions] PIPE -->|pass| BUNDLE[Signed Policy Bundle] BUNDLE --> OPA[OPA Deployments]
:::

::: fact
id: BLK-21b409432e66beb2
summary: Syntactic checks: opa fmt, opa check.
digest: f68aa4fcfbdb616b87ebbf9d6e91017e6fcfcc45e02e1ea114b1e820fc5660b2
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Syntactic checks: opa fmt, opa check..
vector_summary: Syntactic checks: opa fmt, opa check.
chapter: CH-05
:::
Syntactic checks: opa fmt, opa check.
:::

::: fact
id: BLK-97ebf04ed742eadc
summary: Unit tests: opa test.
digest: 5fe0ccad684f88d385f0358b21a7bbc7b57df82112927ad8e750119be8aad1e0
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Unit tests: opa test..
vector_summary: Unit tests: opa test.
chapter: CH-05
:::
Unit tests: opa test.
:::

::: fact
id: BLK-56ab8a64b9bbcf14
summary: Static analysis: internal style & safety rules.
digest: b9ec29522f586072c845e7016c184153a8800d3212b7b1e131846466b3cede37
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Static analysis: internal style & safety rules..
vector_summary: Static analysis: internal style & safety rules.
chapter: CH-05
:::
Static analysis: internal style & safety rules.
:::

::: fact
id: BLK-980f1c312cf40eb8
summary: Staging OPA: run candidate policy against recorded traffic (shadow mode).
digest: 0a797c5102f9f6e4c0b3bf8998dd440e4e3b1aa991fe250bcb0884675e6e1853
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Staging OPA: run candidate policy against recorded traffic (shadow mode)..
vector_summary: Staging OPA: run candidate policy against recorded traffic (shadow mode).
chapter: CH-05
:::
Staging OPA: run candidate policy against recorded traffic (shadow mode).
:::

::: fact
id: BLK-b808b17ee8a689c6
summary: Candidate Rego (generated by LLM):.
digest: ade293245e9ff13b109fa15c9b2e4beadedca8e5e66780b0e26995ee3918b3db
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Candidate Rego (generated by LLM):..
vector_summary: Candidate Rego (generated by LLM):.
chapter: CH-05
:::
Candidate Rego (generated by LLM):
:::

::: fact
id: BLK-0b9f5a2396b4bc82
summary: Run opa fmt ‚Üí ensure style.
digest: d126d8cb920871f32be8453d6588e44532793837121d6132b55e923190f4818e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Run opa fmt ‚Üí ensure style..
vector_summary: Run opa fmt ‚Üí ensure style.
chapter: CH-05
:::
Run opa fmt ‚Üí ensure style.
:::

::: fact
id: BLK-b23aa9257026f9c0
summary: Run opa check ‚Üí catch unknown refs, unsafe vars.
digest: 536e997aa5250b1325486fdb708620be8214f4c8a5cbe9954db9a662787b3ef0
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Run opa check ‚Üí catch unknown refs, unsafe vars..
vector_summary: Run opa check ‚Üí catch unknown refs, unsafe vars.
chapter: CH-05
:::
Run opa check ‚Üí catch unknown refs, unsafe vars.
:::

::: fact
id: BLK-8b09faf1219c8625
summary: Run opa test ‚Üí ensure behavior matches expectations.
digest: 378bf7343c14ce75ab8bef15556022cbe1e14e37a0fd19609ba53305c6e9e9cd
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Run opa test ‚Üí ensure behavior matches expectations..
vector_summary: Run opa test ‚Üí ensure behavior matches expectations.
chapter: CH-05
:::
Run opa test ‚Üí ensure behavior matches expectations.
:::

::: fact
id: BLK-2757c170b17bf0a0
summary: Rego‚Äôs scoping rules are simple but unforgiving.
digest: 455c19138323cae810663d70cca73e6c94c4318fe1da419843bb6fd5129a8a1f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego‚Äôs scoping rules are simple but unforgiving..
vector_summary: Rego‚Äôs scoping rules are simple but unforgiving.
chapter: CH-05
:::
Rego‚Äôs scoping rules are simple but unforgiving. Most ‚Äúmysterious‚Äù bugs in policies stem from variable scope and safety issues.
:::

::: fact
id: BLK-3062214c3efb9bc9
summary: # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }.
digest: b7e6e6cbe55806a7b23797d743c863722cc75dfe5a982e7d1e38f3cc485b8fec
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }..
vector_summary: # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }.
chapter: CH-05
:::
# ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }
:::

::: fact
id: BLK-01dc213f722cd9db
summary: Use opa check to detect this and refactor to ensure all head variables are always bound:.
digest: cd1dd7a7617cf53b823b4516f008470d5028281c8b9d12b27b2042922039fba8
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use opa check to detect this and refactor to ensure all head variables are always bound:..
vector_summary: Use opa check to detect this and refactor to ensure all head variables are always bound:.
chapter: CH-05
:::
Use opa check to detect this and refactor to ensure all head variables are always bound:
:::

::: fact
id: BLK-7e368e0110cc4ce5
summary: # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }.
digest: d228ed0aed5ef52ecc2d5839f6d3a1a8e8f553eff5abe03799328b18acb378e7
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }..
vector_summary: # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }.
chapter: CH-05
:::
# ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }
:::

::: fact
id: BLK-bd9cc15be97aaac3
summary: Some x introduces a new variable local to the current expression.
digest: df70b71dc0ef38505f600f3f441c1f18961e95873a6444230beabda9e9be4704
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some x introduces a new variable local to the current expression..
vector_summary: Some x introduces a new variable local to the current expression.
chapter: CH-05
:::
some x introduces a new variable local to the current expression. Using it incorrectly can over-constrain or under-constrain rules.
:::

::: fact
id: BLK-d72d3ae58221ff67
summary: # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }.
digest: 1f72c331100e845339403d84e6f1346a3d3b68fb76b060215724f56a8d13dfa8
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }..
vector_summary: # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }.
chapter: CH-05
:::
# ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }
:::

::: fact
id: BLK-47e95b45cc5edf3c
summary: Each rule evaluation is pure and has no hidden global state.
digest: 116cc3cb4a3bb72c39c3ab525b1dd7c18802ca3519c017c22a4771b69a79f89c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Each rule evaluation is pure and has no hidden global state..
vector_summary: Each rule evaluation is pure and has no hidden global state.
chapter: CH-05
:::
Each rule evaluation is pure and has no hidden global state. Avoid writing rules as if they ‚Äúaccumulate‚Äù across calls:
:::

::: fact
id: BLK-36c3bcd5e1134f4f
summary: Rego is strict about types, but JSON inputs are often messy.
digest: 39fa819c9147aa39ba77c12606b797bf43f0f6435d39fb512ca9398a72774e73
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego is strict about types, but JSON inputs are often messy..
vector_summary: Rego is strict about types, but JSON inputs are often messy.
chapter: CH-05
:::
Rego is strict about types, but JSON inputs are often messy. Nulls and missing fields are a frequent source of runtime errors.
:::

::: fact
id: BLK-b7d90967e18de369
summary: Always guard when reading from untrusted inputs:.
digest: 6ca517fe19a45c9db2c1996bcdd4441f9aaa2a3e678294fcd3a1cf27af2c4ad5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Always guard when reading from untrusted inputs:..
vector_summary: Always guard when reading from untrusted inputs:.
chapter: CH-05
:::
Always guard when reading from untrusted inputs:
:::

::: fact
id: BLK-e35261e5caf2b447
summary: # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }.
digest: 98b24cedeaa8c019fd96f852797cc9ed54406a103517da263e30c3b97eebf57a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }..
vector_summary: # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }.
chapter: CH-05
:::
# ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }
:::

::: fact
id: BLK-67a3905c24c8c0ec
summary: If input.user.id is a number and data.allowed_ids are strings, this will never match.
digest: 713c3eb78b07a91bcbdb3f91dfd45242465f1ad825b99f764163ee597466e69e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If input.user.id is a number and data.allowed_ids are strings, this will never match..
vector_summary: If input.user.id is a number and data.allowed_ids are strings, this will never match.
chapter: CH-05
:::
If input.user.id is a number and data.allowed_ids are strings, this will never match. Normalize types first:
:::

::: fact
id: BLK-05f8217e07cce144
summary: Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins.
digest: 1e69c65f8fd9a39600f35d77dc7958f96a30c03b6f27de6fed8be02eb12e5dbc
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins..
vector_summary: Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins.
chapter: CH-05
:::
Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins.
:::

::: fact
id: BLK-322b0467c2590b89
summary: # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/.
digest: d5a75e1279066484d911a32d164c84f953c7e6f113ce3b2e5e386ec3920c7805
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/..
semantic_categories: [distribution]
vector_summary: # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/.
chapter: CH-05
:::
# ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/
:::

::: fact
id: BLK-dc6be62dc0d450eb
summary: # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }.
digest: 298d2176652a32cf29ccb844a98732e2e96f0c80f71cb7f15ad31cfb8340b6ce
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }..
vector_summary: # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }.
chapter: CH-05
:::
# ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }
:::

::: fact
id: BLK-84a9bbab21a7036f
summary: Use opa fmt --skip-constraints (most reliable built-in).
digest: 31f649fd58e848a89efc7cbe492a72685b5efbc6716806835679f74ccb0fc00a
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use opa fmt --skip-constraints (most reliable built-in)..
vector_summary: Use opa fmt --skip-constraints (most reliable built-in).
chapter: CH-05
:::
1. Use opa fmt --skip-constraints (most reliable built-in)
:::

::: fact
id: BLK-de4bad29442a85ab
summary: Opa fmt removes unused aliases but NOT unused imports.
digest: f5ec60fb3de94cfd7a94c494ec93c17b4ac5d5fb74fcd532ba6bdc652b373f50
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa fmt removes unused aliases but NOT unused imports..
vector_summary: Opa fmt removes unused aliases but NOT unused imports.
chapter: CH-05
:::
opa fmt removes unused aliases but NOT unused imports.
:::

::: fact
id: BLK-9124fbb631e1cbb3
summary: If u is never referenced, opa fmt will not remove it.
digest: 0179787b0c2a6931b4e23b8a51cc307ffceb5251e24e7ecb749e404140be8ea8
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that If u is never referenced, opa fmt will not remove it..
vector_summary: If u is never referenced, opa fmt will not remove it.
chapter: CH-05
:::
If u is never referenced, opa fmt will not remove it.
:::

::: fact
id: BLK-d0f4b36469b3fdf9
summary: Some versions of opa fmt will rewrite it to:.
digest: 13987489a3420ae7245166ce0173d438afe28ce2e87219bbf1b6a211e47b663d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Some versions of opa fmt will rewrite it to:..
vector_summary: Some versions of opa fmt will rewrite it to:.
chapter: CH-05
:::
Some versions of opa fmt will rewrite it to:
:::

::: fact
id: BLK-a51da1defba3faaf
summary: ‚Ä¶and will not remove it.
digest: 090a47fa457984d936fe537757797c03251e8252314fe6602e1cbc7bee9fc9ed
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚Ä¶and will not remove it..
vector_summary: ‚Ä¶and will not remove it.
chapter: CH-05
:::
‚Ä¶and will not remove it. Bottom line: opa fmt alone cannot solve unused imports reliably, but helps a bit with alias trimming.
:::

::: fact
id: BLK-5a847029cb16e01b
summary: Use opa check --strict.
digest: 57e036759b828eb851be114e82c6ed8bcc2b60f52446a7bddcdef8ab09e9915e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use opa check --strict..
vector_summary: Use opa check --strict.
chapter: CH-05
:::
‚úÖ 2. Use opa check --strict
:::

::: fact
id: BLK-05e28689781336be
summary: Opa check --strict .
digest: 04308296f68ee10c8f2004f283f53757d30404570bf54140f0a5e10fde6e8e99
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa check --strict ..
vector_summary: Opa check --strict .
chapter: CH-05
:::
opa check --strict .
:::

::: fact
id: BLK-93ffa0f5a38427e7
summary: Use Rego Linter Plugins (best solution).
digest: 89330481986a2b78365f0b04579126685ed632968b809adb71d0c27e2a833154
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use Rego Linter Plugins (best solution)..
vector_summary: Use Rego Linter Plugins (best solution).
chapter: CH-05
:::
‚úÖ 3. Use Rego Linter Plugins (best solution)
:::

::: fact
id: BLK-a18f52daf68b5951
summary: This is the closest to ESLint/flake8 for Rego.
digest: be2edaae7e4c251ee49224f23f06af9693452901dadecce97b6ad331856a0f74
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is the closest to ESLint/flake8 for Rego..
vector_summary: This is the closest to ESLint/flake8 for Rego.
chapter: CH-05
:::
This is the closest to ESLint/flake8 for Rego.
:::

::: fact
id: BLK-d1deb4055bd6abbf
summary: Use Styra DAS Rego Analyzer (if enterprise budget exists).
digest: 5e77bde43e344f03b1d5075d87828a8f920864cf62dcc4d2e2f4f5441e9f8c08
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use Styra DAS Rego Analyzer (if enterprise budget exists)..
vector_summary: Use Styra DAS Rego Analyzer (if enterprise budget exists).
chapter: CH-05
:::
‚úÖ 4. Use Styra DAS Rego Analyzer (if enterprise budget exists)
:::

::: fact
id: BLK-ea1b59903a6ee23e
summary: Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:.
digest: 8ca2ecc5f36ff10f8e970e65a17e162900110c9d12e6f184913444ed7a35cd8b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:..
vector_summary: Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:.
chapter: CH-05
:::
Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:
:::

::: fact
id: BLK-ff117af14d974338
summary: Policy design smells.
digest: 90611d322efdca9eabf4dbe1c4d9afecc904cdff792bea813a5b6ef2f4f0d478
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Policy design smells..
vector_summary: Policy design smells.
chapter: CH-05
:::
policy design smells
:::

::: fact
id: BLK-288854f032dcf91b
summary: Use editor extensions (Cursor, VSCode, JetBrains).
digest: 5aa9888cf5356834a0430deef7cb0649281c8995fb3a684693f074b9640d7e7f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Use editor extensions (Cursor, VSCode, JetBrains)..
vector_summary: Use editor extensions (Cursor, VSCode, JetBrains).
chapter: CH-05
:::
‚úÖ 5. Use editor extensions (Cursor, VSCode, JetBrains)
:::

::: fact
id: BLK-1a1e1d4534d9231d
summary: Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }.
digest: 74fb7b21fb5182e41b0dc6445615ad5b33af27fc57c74f56a78e5b655117ed19
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }..
vector_summary: Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }.
chapter: CH-05
:::
Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }
:::

::: fact
id: BLK-0700523bfa0d00a5
summary: Then configure a custom linter rule using a regex:.
digest: 32d557e30c8007847f87d8ba430b17d0a4c0b82b1e6698b3f3f4f014073d3012
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Then configure a custom linter rule using a regex:..
vector_summary: Then configure a custom linter rule using a regex:.
chapter: CH-05
:::
Then configure a custom linter rule using a regex:
:::

::: fact
id: BLK-05bf15ca8721ad44
summary: Organizational best practice: Avoid wildcard imports.
digest: 9af95062611b758eef7eec605683ece00d3c96130dec684daaa11deedb46986f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Organizational best practice: Avoid wildcard imports..
vector_summary: Organizational best practice: Avoid wildcard imports.
chapter: CH-05
:::
‚úÖ 6. Organizational best practice: Avoid wildcard imports
:::

::: fact
id: BLK-1d0b9f66d47eaeaf
summary: Always prefer small, explicit imports:.
digest: 0a6a8df429f6595dbc297c843ac9082f97fe45b960117fdd9b2cc4ef7e56f771
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Always prefer small, explicit imports:..
vector_summary: Always prefer small, explicit imports:.
chapter: CH-05
:::
Always prefer small, explicit imports:
:::

::: fact
id: BLK-ad7f2ed6a6987d63
summary: Recommended CI rule: Reject files containing unused imports.
digest: 4aee7f3a647c900ce5091b98311b4552c7614f63fd9412101a1521f7c468316e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Recommended CI rule: Reject files containing unused imports..
vector_summary: Recommended CI rule: Reject files containing unused imports.
chapter: CH-05
:::
‚úÖ 7. Recommended CI rule: Reject files containing unused imports
:::

::: fact
id: BLK-b24e880e43548028
summary: --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path').
digest: 96c0ebc57e66bcfa7e8ecf806ee2947bb6ff4bdb4c662d95171968bd993881ba
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path')..
vector_summary: --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path').
chapter: CH-05
:::
unused=$(opa inspect . --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path')
:::

::: fact
id: BLK-3364104f50f32b25
summary: Opa inspect (which parses import graph).
digest: e6a61da3af8fe1ab03a0559efbbe72e2056079af413ce3ad0938f210b0859734
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa inspect (which parses import graph)..
vector_summary: Opa inspect (which parses import graph).
chapter: CH-05
:::
opa inspect (which parses import graph)
:::

::: fact
id: BLK-916a2b733c75da32
summary: üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough...
digest: 7887893ac6db46b8438aee40d2bebc8fbda97814bc5c6e0da59be4941bc51a01
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough....
vector_summary: üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough...
chapter: CH-05
:::
üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough opa check --strict üî∂ Detects unused variables, not imports Use always rgl (Rego Lint) ‚úÖ Detects unused imports Best open-source option Styra DAS üî• Enterprise-grade policy analyzer Best paid option CI + opa inspect + jq üî• Fully reliable in CI Recommended Cursor/VSCode rules üî∂ Helps devs during coding Recommended
:::

::: fact
id: BLK-055762078b24cd0d
summary: Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional).
digest: 69950ba95eeaab46d3ab9779416144c7b096b8f72cc3c1bb1c4216ba2f7f6a50
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional)..
vector_summary: Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional).
chapter: CH-05
:::
Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional)
:::

::: fact
id: BLK-1e753a25a214b3ee
summary: ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search.
digest: 0fc20bfa7a758e8856f5cd97983e97265a87a83c73468692cfb4c3b2a3596b63
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search..
vector_summary: ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search.
chapter: CH-05
:::
‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search.
:::

::: fact
id: BLK-91376980b3497347
summary: Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:.
digest: 761922e6309e38bc9d930161279653a949bdd6437b938e511c5dc9745f426b95
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:..
vector_summary: Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:.
chapter: CH-05
:::
Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:
:::

::: fact
id: BLK-de0aa65f66c9c2e5
summary: Conflicting when multiple packages define the same rule.
digest: c44ea71caf0c4c45698a4b83eac0cc892f365dae5a4130fefe9b0719e90d6ed6
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Conflicting when multiple packages define the same rule..
vector_summary: Conflicting when multiple packages define the same rule.
chapter: CH-05
:::
conflicting when multiple packages define the same rule
:::

::: fact
id: BLK-4bbc8cdf4775092d
summary: Answer: The warn reference comes from the data tree, not from the import.
digest: 167cd5220fb43ebb61317fcf5de414d8c858ee0c99501390fab1bd774fd28fba
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Answer: The warn reference comes from the data tree, not from the import..
vector_summary: Answer: The warn reference comes from the data tree, not from the import.
chapter: CH-05
:::
Answer: The warn reference comes from the data tree, not from the import. During opa test, OPA loads all policies under services/opa/policies/ into the data namespace. When the test references warn, OPA resolves it by searching all packages for a rule named warn, which finds data.compliance.tech_debt.warn. Because the test never uses tech_debt.warn, the import data.compliance.tech_debt is unused and can be removed.
:::

::: fact
id: BLK-904181a17b9dcc04
summary: üîç Full Explanation (What‚Äôs Happening Under the Hood) 1.
digest: 44b88cfe853df2713821fd7758191423859b4969911c1dede35c487784df3834
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üîç Full Explanation (What‚Äôs Happening Under the Hood) 1..
vector_summary: üîç Full Explanation (What‚Äôs Happening Under the Hood) 1.
chapter: CH-05
:::
üîç Full Explanation (What‚Äôs Happening Under the Hood) 1. How OPA loads data during tests
:::

::: fact
id: BLK-8e593dfe4228799c
summary: Opa test services/opa/policies/ services/opa/tests/.
digest: d1e98a0829c43aba40f49a566204cff8570b8e3ce7da9a0744fe1d93c5475438
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Opa test services/opa/policies/ services/opa/tests/..
vector_summary: Opa test services/opa/policies/ services/opa/tests/.
chapter: CH-05
:::
opa test services/opa/policies/ services/opa/tests/
:::

::: fact
id: BLK-cf1cf42e9d5ccf61
summary: Every .rego file from policies/ ‚Üí into the data tree.
digest: 5572207edd7bb2d422ca4b95cca78b3c6bc2f66d3979dc320d03585102fdea5e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Every .rego file from policies/ ‚Üí into the data tree..
vector_summary: Every .rego file from policies/ ‚Üí into the data tree.
chapter: CH-05
:::
every .rego file from policies/ ‚Üí into the data tree
:::

::: fact
id: BLK-a3d9d649abe9ea27
summary: This means all rule names become visible under data.*.
digest: 9b990d8b74985b01c2cd6fa05c2f8e6320205bc1d89a5c41a4c64c50eda35486
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This means all rule names become visible under data.*..
vector_summary: This means all rule names become visible under data.*.
chapter: CH-05
:::
This means all rule names become visible under data.*.
:::

::: fact
id: BLK-b34b8dd3cc79096e
summary: OPA resolves warn like this:.
digest: 2eec3086a5c80964b2d7163ae9f68b3c40c1c619a2d9b88e3e1892c673068dc2
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA resolves warn like this:..
vector_summary: OPA resolves warn like this:.
chapter: CH-05
:::
OPA resolves warn like this:
:::

::: fact
id: BLK-66c781d55a92faaf
summary: Search the global data tree for any rule named warn.
digest: 252c4ebe6a76bf5d1c9a6770d87681e7fd044780ed9bb1c5a9dad0f19fa978c5
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Search the global data tree for any rule named warn..
vector_summary: Search the global data tree for any rule named warn.
chapter: CH-05
:::
Search the global data tree for any rule named warn. Finds: data.compliance.tech_debt.warn
:::

::: fact
id: BLK-95ca2e72cd741b4e
summary: The import is unused because OPA never needs the alias tech_debt to find the rule.
digest: 94826253a4f81ec1be4c716e1ce9793b2dcbb6802c47175fa857fb2dbc1afc88
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The import is unused because OPA never needs the alias tech_debt to find the rule..
vector_summary: The import is unused because OPA never needs the alias tech_debt to find the rule.
chapter: CH-05
:::
The import is unused because OPA never needs the alias tech_debt to find the rule.
:::

::: fact
id: BLK-0f7eb6e9110cfd7d
summary: This is how critical bugs enter policy codebases.
digest: f1d99094dd60b532bff5bbfbce76a95f64e54eb7414be84e93b0b7a24a71c924
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This is how critical bugs enter policy codebases..
vector_summary: This is how critical bugs enter policy codebases.
chapter: CH-05
:::
This is how critical bugs enter policy codebases.
:::

::: fact
id: BLK-dc195421896fae6e
summary: üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports.
digest: 3a39793f318e25b9cd5e3d77b792302e41cdb7e08008f4a47219b0dd4ec665ec
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports..
vector_summary: üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports.
chapter: CH-05
:::
üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports
:::

::: fact
id: BLK-c769e5e37ddda8d1
summary: Never rely on bare rule names:.
digest: 7ecbac30f7ba5d52f57c5ca58b89908f0085dbe01c4cc56b204e13b721277a37
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Never rely on bare rule names:..
vector_summary: Never rely on bare rule names:.
chapter: CH-05
:::
Never rely on bare rule names:
:::

::: fact
id: BLK-f2d6de3be5108863
summary: The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused.
digest: 72d7836f5a6d55bcd3a4367f4b1e97fc5be09c2a3b6f1d859aafdaf1e0f5d2cd
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused..
vector_summary: The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused.
chapter: CH-05
:::
The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused.
:::

::: fact
id: BLK-2602fdd8c51b5938
summary: OPA loads all policy packages in /policies/**.
digest: e2b3be11ebc08d09a5e2e4b3714cb1774fc48e843df5ad386ba969e38b45839d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA loads all policy packages in /policies/**..
vector_summary: OPA loads all policy packages in /policies/**.
chapter: CH-05
:::
OPA loads all policy packages in /policies/**
:::

::: fact
id: BLK-440f2e7d6df53450
summary: So the rule warn is available at:.
digest: ed37336eb6114f0b81292b2dc1d66b8e8e05648a67553b1536aa627a958b4440
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that So the rule warn is available at:..
vector_summary: So the rule warn is available at:.
chapter: CH-05
:::
So the rule warn is available at:
:::

::: fact
id: BLK-146721aedc728fd8
summary: OPA resolves bare rule names by doing a global search in data.
digest: 81aa7cb8b46461cb7342d113af1f48737db5d3df92843aae91e26d1300e1a23b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA resolves bare rule names by doing a global search in data..
vector_summary: OPA resolves bare rule names by doing a global search in data.
chapter: CH-05
:::
OPA resolves bare rule names by doing a global search in data.
:::

::: fact
id: BLK-1896739847a942b1
summary: Bare rule names (warn) are ambiguous.
digest: 9ee14a45400bcb86a7f98bbe5219385f11e21663cb8e75f0a138f684953d060c
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Bare rule names (warn) are ambiguous..
vector_summary: Bare rule names (warn) are ambiguous.
chapter: CH-05
:::
Why? 1. Bare rule names (warn) are ambiguous
:::

::: fact
id: BLK-4cf1d9d3379ed5ab
summary: Becomes ambiguous and OPA may:.
digest: c55f1a0c8bb93d3e85b429ee648f7056c12d4e0cd4c1228264a6ee891be7463d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Becomes ambiguous and OPA may:..
vector_summary: Becomes ambiguous and OPA may:.
chapter: CH-05
:::
becomes ambiguous and OPA may:
:::

::: fact
id: BLK-ee4b87e1821ec277
summary: OPA test behavior depends on all loaded policies.
digest: 1fe9279495b05b09a40807fd75fb26761eafa8a9ef907795dae4876f3c692d9b
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA test behavior depends on all loaded policies..
vector_summary: OPA test behavior depends on all loaded policies.
chapter: CH-05
:::
OPA test behavior depends on all loaded policies. If someone changes folder structure or adds a new rule, this test may start failing.
:::

::: fact
id: BLK-d0319c48162006d3
summary: Implicit resolution is one of the most common sources of bugs in OPA deployments.
digest: 20d4c41da5c0bdc24e25a99c41ba8a4e92c2d8dcba5dcb2b8ca69c41d491b39f
symbol_refs: []
semantic_role: architecture
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Implicit resolution is one of the most common sources of bugs in OPA deployments..
vector_summary: Implicit resolution is one of the most common sources of bugs in OPA deployments.
chapter: CH-05
:::
Implicit resolution is one of the most common sources of bugs in OPA deployments.
:::

::: fact
id: BLK-40bec3306bf43c74
summary: This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct...
digest: f860ce545b7cf1ea5693481c859610d5851eaceb7b416d1d3f60385acb2efa40
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct....
vector_summary: This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct...
chapter: CH-05
:::
This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct pattern for all enterprise-grade policy suites.
:::

::: fact
id: BLK-ddd5bab848658cd1
summary: üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate.
digest: 78c779040c4618c026ac7b21bf1c3495bb91b8331f472317ba92a01225e62139
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate..
vector_summary: üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate.
chapter: CH-05
:::
üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate
:::

::: fact
id: BLK-4a3213cba6c14203
summary: ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly.
digest: 000fb51d074c876d0a127d4eec4eac5cb5fae6104bc6147af8cd9417023d79d7
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly..
vector_summary: ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly.
chapter: CH-05
:::
‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly.
:::

::: fact
id: BLK-5fe7ad67431a1a6b
summary: In test files, always use explicit package-qualified rule references:.
digest: 45e44bf835702e8b9dbec5420bede5913c7f3c8618118024f75200d5468dbeb8
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that In test files, always use explicit package-qualified rule references:..
vector_summary: In test files, always use explicit package-qualified rule references:.
chapter: CH-05
:::
In test files, always use explicit package-qualified rule references:
:::

::: fact
id: BLK-5a5fb3b6a6feb291
summary: Ambiguity Prevention: Multiple packages may define rules with common names (warn, deny, allow).
digest: 31f0aecfc94244a23f9da0fcfa226aecaff1b6b13b6940b07f23f27330244898
symbol_refs: []
semantic_role: reference
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Ambiguity Prevention: Multiple packages may define rules with common names (warn, deny, allow)..
vector_summary: Ambiguity Prevention: Multiple packages may define rules with common names (warn, deny, allow).
chapter: CH-05
:::
**Rationale:** 1. **Ambiguity Prevention**: Multiple packages may define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity. 2. **Maintainability**: Tests remain stable when new policies are added that might introduce naming conflicts. 3. **Clarity**: Explicit references make test intent clear and reduce cognitive load during code review. 4. **Refactoring Safety**: Policy package reorganization doesn't break tests that use explicit references.
:::

::: fact
id: BLK-7eb95260235a09c0
summary: Import rego.v1 import data.compliance.tech_debt # ‚Üê keep this.
digest: 2ad74df3c8f0472e00655f36c4d6f404080fd0678dafcae51fefb20768f7670f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Import rego.v1 import data.compliance.tech_debt # ‚Üê keep this..
vector_summary: Import rego.v1 import data.compliance.tech_debt # ‚Üê keep this.
chapter: CH-05
:::
import rego.v1 import data.compliance.tech_debt # ‚Üê keep this
:::

::: fact
id: BLK-94b0c6d4242ec932
summary: How your test diff strings are represented inside Rego test files.
digest: a33d7eff217e1f8411b162bc2084a6aff4742643cdcef7e7c12b49c714f3048e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that How your test diff strings are represented inside Rego test files..
vector_summary: How your test diff strings are represented inside Rego test files.
chapter: CH-05
:::
how your test diff strings are represented inside Rego test files.
:::

::: fact
id: BLK-2692a565a55bc811
summary: ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {".
digest: 9dfeec344651b358596a2dc33379b3dde1673f1ff8a91fa7af307c924d8a73f2
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {"..
vector_summary: ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {".
chapter: CH-05
:::
‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {"
:::

::: fact
id: BLK-4b75100e9c1723da
summary: ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character.
digest: 49363a677d21f592973744b2d22f6f9729678352b52fc04c84dd5f3e5bdd9bcc
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character..
vector_summary: ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character.
chapter: CH-05
:::
‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character.
:::

::: fact
id: BLK-5034a2914309672a
summary: Never see the newline, so they fail.
digest: 4d97bdef2128d6eec6e89ae268bec68f98109f6d3701707d6029560f78fba250
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Never see the newline, so they fail..
vector_summary: Never see the newline, so they fail.
chapter: CH-05
:::
never see the newline, so they fail.
:::

::: fact
id: BLK-d61d9d1a25742a7b
summary: __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context.
digest: 72c829827d13e2848586a7c72b8c9f2023eedbe6faf639d6e5289b32cd6fbb4d
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context..
vector_summary: __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context.
chapter: CH-05
:::
__local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context.
:::

::: fact
id: BLK-bf4723cba99361ab
summary: They are being accessed ‚Äî the content is just different from what your rules assume.
digest: ffc1c9561773b65a44ae0805eda733fbfcf70599dc73fc9ae0a1fefa91f54ad3
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that They are being accessed ‚Äî the content is just different from what your rules assume..
vector_summary: They are being accessed ‚Äî the content is just different from what your rules assume.
chapter: CH-05
:::
They are being accessed ‚Äî the content is just different from what your rules assume.
:::

::: fact
id: BLK-b2462fef40f9e1a3
summary: But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context.
digest: c34980609a223a014ffea10644dfb6f8c75a72f9d562d334b5bc9d514d04df97
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context..
vector_summary: But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context.
chapter: CH-05
:::
But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context.
:::

::: fact
id: BLK-7224d1b50de33c99
summary: Same issue: Your rule expects:.
digest: 32f186ea2b355c5073c645e1e429987c8b0d9c1a9d22fa272f9ec68672de7694
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Same issue: Your rule expects:..
vector_summary: Same issue: Your rule expects:.
chapter: CH-05
:::
Same issue: Your rule expects:
:::

::: fact
id: BLK-9ab409739c58aced
summary: OPA evaluates the Rego test literal as:.
digest: d3bbfce6b558775d16fa8e20b3f4696cf1b436b6f1dbf155a847ec06b0b5c1cd
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that OPA evaluates the Rego test literal as:..
vector_summary: OPA evaluates the Rego test literal as:.
chapter: CH-05
:::
OPA evaluates the Rego test literal as:
:::

::: fact
id: BLK-475ae3ca4b662fcb
summary: The pattern never matches because whitespace escaping does NOT behave like in JSON.
digest: 7512dee00aa2450d32cd4550d5ffa1f76d33ba0a41f3b9cc6fc5451bd4d4e550
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that The pattern never matches because whitespace escaping does NOT behave like in JSON..
vector_summary: The pattern never matches because whitespace escaping does NOT behave like in JSON.
chapter: CH-05
:::
The pattern never matches because whitespace escaping does NOT behave like in JSON.
:::

::: fact
id: BLK-ec33c76e3eda42a5
summary: üß† Why direct opa eval --input JSON works.
digest: c8567072c83b2ce7faa90eda34443eb6460c1c56190c396432b762e287c2902e
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üß† Why direct opa eval --input JSON works..
vector_summary: üß† Why direct opa eval --input JSON works.
chapter: CH-05
:::
üß† Why direct opa eval --input JSON works
:::

::: fact
id: BLK-fe580d36f95ecec0
summary: Because JSON ‚Üí OPA decoding translates \n into real newlines.
digest: 9a2e06315ec416bed350674611e5285c2b918bc95ae866875894c31075813ebf
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Because JSON ‚Üí OPA decoding translates \n into real newlines..
vector_summary: Because JSON ‚Üí OPA decoding translates \n into real newlines.
chapter: CH-05
:::
Because JSON ‚Üí OPA decoding translates \n into real newlines.
:::

::: fact
id: BLK-914d3ab30c1cbcd0
summary: Rego test files do NOT.
digest: 12b1484fb1ba6f242e5b124abe4c1874fcd367ea688f6345c826cc54d3efdf55
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego test files do NOT..
vector_summary: Rego test files do NOT.
chapter: CH-05
:::
Rego test files do NOT.
:::

::: fact
id: BLK-91b98d897aa10bbe
summary: üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings.
digest: 5a5a5bebbd0edeedaaf428ded81ffaef5b593bba7c8b9db19a8275e14c768538
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings..
vector_summary: üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings.
chapter: CH-05
:::
üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings
:::

::: fact
id: BLK-f190297a6c64fecc
summary: Rego supports multi-line raw strings:.
digest: d337c6b01d20cb05cc3e4d5d2bebe644e5e8bdcd5d883029bb99035a044e2141
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that Rego supports multi-line raw strings:..
vector_summary: Rego supports multi-line raw strings:.
chapter: CH-05
:::
Rego supports multi-line raw strings:
:::

::: fact
id: BLK-a9c05c7f62d3cb54
summary: This will perfectly match the policy expectations.
digest: b32ed641dc19d34e572b3877673d28616a49e09aa168558953ba52e33cb4762f
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that This will perfectly match the policy expectations..
vector_summary: This will perfectly match the policy expectations.
chapter: CH-05
:::
This will perfectly match the policy expectations.
:::

::: fact
id: BLK-99ded45841e99ee9
summary: ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file.
digest: eefa733fa817716bb142498d6bbb1ca4fc4f953a5f6c6a4219323451383aa447
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file..
vector_summary: ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file.
chapter: CH-05
:::
‚úÖ Second Best Fix: Convert \n to actual newline inside the test file
:::

::: fact
id: BLK-bf3d83b7e8b7048b
summary: ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy.
digest: 587a7495e2be928c04a13bac337e98e5490414bb1abc908455a8ddf86c5bd037
symbol_refs: []
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy..
vector_summary: ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy.
chapter: CH-05
:::
‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy
:::

::: fact
id: BLK-44a8a9caa5e043ee
summary: But this will add noise to all rules.
digest: 3f06f0025f1b0fa5632a3069f1f0bb4fcc642a22fcad5ed1c22bcedd0ab7d6a0
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that But this will add noise to all rules..
vector_summary: But this will add noise to all rules.
chapter: CH-05
:::
But this will add noise to all rules.
:::

::: fact
id: BLK-f707e7c8060ca885
summary: ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs.
digest: 9486c28f54cbaada448a80525aef8ef345104176b49758774f39f22ec0f00c87
symbol_refs: []
semantic_role: assertion
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
intuition: This explains that ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs..
vector_summary: ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs.
chapter: CH-05
:::
‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs
:::

::: example
id: CODE-66aab2e8459d4f6c
language: rego
chapter: CH-05
source: term:Negation-as-Failure Semantics
purpose: definition-example
digest: c633f9658b70eb3aaea8b16029ed12285e7bed2c718a98a0e0369f8e806d6e23
symbol_refs: [startswith]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation]
:::
# Simple negation
unauthorized if not authorized

# Negation with expressions
invalid if not startswith(input.name, "valid_")

# Check non-membership
not_admin if not "admin" in input.user.roles
:::

::: example
id: CODE-fafaf716cd6b4cab
language: rego
chapter: CH-05
source: term:Safety Requirements
purpose: definition-example
digest: 92b37a1f2ad42f55af21a74cf795dd7836e0f5ee56cc483b2bd91c43f6e82ed6
symbol_refs: [user]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
code_smell_probability: 0.7
:::
# ‚ùå Unsafe: user not grounded
unsafe if {
    not blacklisted[user]
}

# ‚úÖ Safe: user grounded first
safe if {
    user := input.user.id
    not blacklisted[user]
}
:::

::: example
id: CODE-b684bf6989cea9a6
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: 169416aa65c12214f4e412d7ed2d17342e31aaaa3af16d45c2e03116264de36e
symbol_refs: [implementation, diff_content, mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Raw string for multi-line test data
test_diff_parsing if {
    diff_content := `+ // TODO: Fix issue
+ function implementation() {`
    # Contains actual newline between lines
    
    mock_input := {"diff": diff_content}
    # Policy regex patterns can now match newlines correctly
}

# ‚ùå PROBLEMATIC: Double-quoted string with \n literal
test_diff_parsing if {
    diff_content := "+ // TODO: Fix issue\n+ function implementation() {"
    # \n is literal backslash + 'n', NOT a newline
    # Regex patterns expecting newlines will fail
}
:::

::: example
id: CODE-c32ae32281054ef6
language: json
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: 37bd43e430b16f58696e00fa5b2dfdce3c10109aeb40aac5e77e1ba51dc26d88
symbol_refs: [getUsers]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
{
  "diff": "+ // TODO:\n+ function getUsers() {"
}
:::

::: example
id: CODE-dc69b72659931d14
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: dc608789ef0070c36ca965169effe067dbde1d338e223daa2c297101f79b1853
symbol_refs: [getUsers, literal, mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_example if {
    mock_input := {"diff": "+ // TODO:\n+ function getUsers() {"}
    # \n here is literal: backslash + 'n', NOT a newline
}
:::

::: example
id: CODE-b8169cb998dc89c3
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: 24d1165c6b6e286ccb9b5559c944ef86c5c58f4e814db2537ddb8c049366bccb
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy expects actual newline
regex.match("TODO:\\s*\\n", file.diff)  # Fails in tests with \n literal

# Test input with \n literal
"diff": "+ // TODO:\n+ function()"  # Contains literal "\n", not newline
:::

::: example
id: CODE-85bb3e27a6049cb8
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: dc67bc2d4bda5f155b9d6aa734866f978c2885e6caea83c5443c5f8e31106e7b
symbol_refs: [contains, diff, count, newline]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_debug if {
       diff := "+ // TODO:\n+ function()"
       print("Length:", count(diff))  # Check if \n is one char or two
       print("Contains newline:", contains(diff, "\n"))  # May fail if literal
   }
:::

::: example
id: CODE-fae08d2b1cea57f4
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: 99794f263851531840e3d8c83148297f8b75379f6e73ee9e6b53f67ae5315dfe
symbol_refs: [check, checks, match]
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy has two rules that can both match:
# R15-W02: Meaningful TODO not logged (general check)
# R15-W03: TODO added without reference (specific check for +.*TODO:)

# Both rules check:
# - has_meaningful_todo_keywords(file)
# - not has_tech_debt_reference(file)
# R15-W03 also checks: regex.match("\\+.*TODO:", file.diff)
:::

::: example
id: CODE-17a287dc7511837c
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: 0408cf686a7ffa118b96aada14b30d67fe7104f79ccea87edd6d2a6b98e723db
symbol_refs: [contains, mock_input]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy checks for lowercase "temporary"
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")  # Lowercase required
}

# ‚ùå TEST FAILS: Test uses "Temporary" (capital T)
test_example if {
    mock_input := {"diff": "+ // FIXME: Temporary hack"}
    # Policy doesn't match "Temporary" (capital T)
    # Test expects warning but gets none
}

# ‚úÖ TEST PASSES: Test uses "temporary" (lowercase)
test_example if {
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # Policy matches "temporary" correctly
}
:::

::: example
id: CODE-0f5614d39d1277bb
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: c039af2051e6fe8f2c1322a84d8ab9524c4b75fafe6028eeb9879addfbb60b21
symbol_refs: [mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Normalize keywords in test inputs to match policy expectations
test_example if {
    # Use lowercase to match policy checks
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # ...
}
:::

::: example
id: CODE-4332090fdd6f776f
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: 8cbedc3fbe112e7524c029cedfc5ea53796ffbb9d51db67d466e930123cf381a
symbol_refs: [diff_lower, contains]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy normalizes input before checking
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    diff_lower := lower(file.diff)
    contains(diff_lower, "temporary")  # Case-insensitive check
}
:::

::: example
id: CODE-4786957d3260209a
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
digest: e02082de3584f3b2a4a8f8fa7bf16ed99f7468cbd68079ec39ac8e44f60ba4b8
symbol_refs: [contains]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy checks multiple case variants
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")
}

has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "Temporary")
}
:::

::: example
id: CODE-1ff94d92ec772887
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Format: [ <term> | <query> ]
confidence: 0.9
digest: e5a2d3a8605d2b742c29e2dc511d52e764c6ef4fb0ddf066bd00cb09a5895823
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: example
id: CODE-7253f980452b3d90
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Simple transformation
confidence: 0.9
digest: 624bc0da84a13eb996b55dd52676eea0767d0ea1632da36a562076349c5b7ebb
symbol_refs: [squares]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
squares := [x * x | some x in numbers]

:::

::: example
id: CODE-075e6d66583c29fd
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: With filtering
confidence: 0.9
digest: 3dbcad787d1357393fb9d861c57596ee20f8441d10eb9bbb3f5b2d959ddc0253
symbol_refs: [evens]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
evens := [x | some x in numbers; x % 2 == 0]

:::

::: example
id: CODE-027f30f7323719cb
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Nested iteration
confidence: 0.9
digest: a5919068b44999f886bc68e63df7d088c2ec2e0f2c5c7f6dd1c961b219d7ff33
symbol_refs: [pairs]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
pairs := [[x, y] |
    some x in [1, 2, 3]
    some y in ["a", "b", "c"]
]
:::

::: example
id: CODE-3131b517c2f01166
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Format: { <term> | <query> }
confidence: 0.9
digest: 5d0d287a6e0139268225ad7722a7d26edc33eeaebd791fb169e202d4123858bc
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: example
id: CODE-d3df87bc2896f26f
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Remove duplicates
confidence: 0.9
digest: aee4ae932f306f1c1a9031265f9c59006a396727fb20b9ff9cf9b74ff2fc3efb
symbol_refs: [unique]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
unique := {x | some x in items}

:::

::: example
id: CODE-c00ff67815d07c70
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Extract unique properties
confidence: 0.9
digest: 62ea6841e1f582adfeff9d16cfae3f0628ef744174483a7b5b0db471cb79c0a0
symbol_refs: [departments]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
departments := {user.dept | some user in users}

:::

::: example
id: CODE-5671717cd1450737
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Format: { <key>: <value> | <query> }
confidence: 0.9
digest: 7a6fcb98570eb3a5a0a020d3471057bc3ea95407c7903a33cb548898fa6db954
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: example
id: CODE-67adfcbe8b718b84
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Create mapping
confidence: 0.9
digest: 99f76db46f63c3adf37ca878bde919ff96874530d65b6182fbafed5975ae4644
symbol_refs: [name, name_to_age]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
name_to_age := {person.name: person.age |
    some person in people
}

:::

::: example
id: CODE-9eb004b39032d0fd
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: With transformation
confidence: 0.9
digest: c44393cafe3b331e39b302dc56e458612d1402472b2bdea0680a4097769cdea7
symbol_refs: [doubled, k]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
doubled := {k: v * 2 |
    some k, v in original
}

:::

::: example
id: CODE-ebc014a7b8a1a105
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Aggregation
confidence: 0.9
digest: c3bd05aa3df18915f081bd64261086530fa7373ffc061dba8c90f55808e1b79b
symbol_refs: [user_counts, users_in_dept, count, dept]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
user_counts := {dept: count |
    some dept in departments
    users_in_dept := [u | some u in users; u.dept == dept]
    count := array.length(users_in_dept)
}
:::

::: example
id: CODE-58dccd21760016f7
chapter: CH-05
language: rego
role: code-pattern:quantification:every-loop
tags: [quantification, every-loop]
explanation: All items must satisfy condition
confidence: 0.9
digest: d5ec31fcb621ba7307a07a7e91925768548ea6bd5aee640f90b19ef38cc016bb
symbol_refs: [status]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
all_approved if {
    every item in items {
        item.status == "approved"
    }
}

:::

::: example
id: CODE-e301f61ef709e3ed
chapter: CH-05
language: rego
role: code-pattern:quantification:every-loop
tags: [quantification, every-loop]
explanation: With index
confidence: 0.9
digest: 80c6977c72f644aca77a498228f328f4f9da064b11f84c3454d4d9a3698f91ee
symbol_refs: [id, valid]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
all_valid if {
    every i, item in items {
        item.id == i
        item.valid == true
    }
}

:::

::: example
id: CODE-3ca99b7af209eabd
chapter: CH-05
language: rego
role: code-pattern:quantification:every-loop
tags: [quantification, every-loop]
explanation: Multiple conditions
confidence: 0.9
digest: 0547722e1c8893992de772e7cb9eb7751a7e372f4d4dfa7bb933f02bc8314d9f
symbol_refs: [status]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
all_healthy if {
    every server in servers {
        server.status == "up"
        server.cpu < 80
        server.memory < 90
    }
}
:::

::: example
id: CODE-e1d030959c9b4c69
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Simple negation
confidence: 0.9
digest: a55c58fe83634b7321ed3cfe1f28ec5045c2621101b53bc26245224cefbf3101
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation]
:::
unauthorized if not authorized

:::

::: example
id: CODE-0e097b308f02ae50
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: This is true if ANY element is not "foo"
confidence: 0.9
digest: be757475deef2ee23ff193f20602dbd4a99a6685fb5ba7e216cc90541d35d052
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
has_non_foo if {
    items[_] != "foo"  # Existential quantification
}

:::

::: example
id: CODE-4d54dbe1e7b7ea19
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚úÖ CORRECT: "Is 'foo' not in array?"
confidence: 0.9
digest: 3e4de0b5124f4ca9e4c20e6843f2d136154604793e177fd754ed5a9ad0e3a7e9
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
foo_not_present if {
    not "foo" in items
}

:::

::: example
id: CODE-80484760297e8033
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚úÖ CORRECT: "Are all elements not foo?"
confidence: 0.9
digest: 7ad8b19e7ebf43f99021784b6c34d837d1f5f7c5500db1afb9370abbf612e920
symbol_refs: [item]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
all_non_foo if not any_foo

any_foo if {
    some item in items
    item == "foo"
}
:::

::: example
id: CODE-19e8ca92363c99b4
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚úÖ CORRECT: Raw string for multi-line test data
confidence: 0.9
digest: 1da74c9139739bff97bfbca12d5f0470559f5e88f2dd65564a96dea0d3106cbe
symbol_refs: [implementation, diff_content]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_diff_parsing if {
    diff_content := `+ // TODO: Fix issue
+ function implementation() {`
:::

::: example
id: CODE-a69cd2a181869da7
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Contains actual newline between lines
confidence: 0.9
digest: faae1aaa2b5dbce922a6469a5e0315797b9ad7af333098750c3ab74fbd169153
symbol_refs: [mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
    
    mock_input := {"diff": diff_content}
:::

::: example
id: CODE-0163524bc818bbf6
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Policy regex patterns can now match newlines correctly
confidence: 0.9
digest: 82b87122368277d7b16b47363cab8661760fe449416a0c18c4d4570f58271dc3
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
}

:::

::: example
id: CODE-6341a88e54c5ab2c
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚ùå PROBLEMATIC: Double-quoted string with \n literal
confidence: 0.9
digest: f56fd8095489b58c7399ad94fdf55e4049a78b54f8fa941b47ef271fba418a92
symbol_refs: [implementation, diff_content]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_diff_parsing if {
    diff_content := "+ // TODO: Fix issue\n+ function implementation() {"
:::

::: example
id: CODE-7a9ffe200163068e
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Regex patterns expecting newlines will fail
confidence: 0.9
digest: 8d428ef6ff40dce879027235a9d9be0956b8a755738d3e23c14485022306e20f
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
}
:::

::: example
id: CODE-1487e9480c88c3d8
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ... rest of logic
confidence: 0.9
digest: a4301c7bfcda131b5897802d067848c3ee3e7dab6ec99b7a96d348dced5430b8
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
}
:::

::: example
id: CODE-312bd4c16a500759
chapter: CH-05
language: json
role: example
tags: []
digest: 78da9c163e1e8741ce14e8ff85f72c3ab614f702546276688f7dd7ec2ce0536c
symbol_refs: [getUsers]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
{
  "diff": "+ // TODO:\n+ function getUsers() {"
}
:::

::: example
id: CODE-3cedc546c93f6d04
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Policy expects actual newline
confidence: 0.9
digest: 529d3c8cd36ae8fb90ca1dcefbc228d8b31451f83f180cd122e56f35b93b905b
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
regex.match("TODO:\\s*\\n", file.diff)  # Fails in tests with \n literal

:::

::: example
id: CODE-f2c6e10d8a9dfbd4
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Test input with \n literal
confidence: 0.9
digest: 12e96a69205253477e10e3141745f2e1486f614e31d5e245a26077046d63e3cd
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
"diff": "+ // TODO:\n+ function()"  # Contains literal "\n", not newline
:::

::: example
id: CODE-cdfe82df6bf4edc7
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: ‚úÖ CORRECT: Iterate set to get first element
confidence: 0.9
digest: f13046136f13d81a0501c760e60faaf9ef4337dcc146d8779503a57ca58880df
symbol_refs: [warnings, count, mock_input]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
test_get_warning_message if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
:::

::: example
id: CODE-b0f12fe1d633b3bd
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: Get first warning message
confidence: 0.9
digest: f9b7dc6131174f2f2f9637fe668aab085756323a068808022e19e257d9012b34
symbol_refs: [msg, contains, warning]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
    warning := [msg | msg := warnings[_]][0]
    contains(warning, "expected text")
}

:::

::: example
id: CODE-6402f67efd628235
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: ‚ùå WRONG: Sets don't support index access
confidence: 0.9
digest: 130d44cf011709b0de3c34248e16f01861566a3f8f2c7b5eaab9e4436f95f302
symbol_refs: [warning]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
code_smell_probability: 0.3
semantic_categories: [testing]
:::
warning := warnings[0]  # Error: sets don't have indices
:::

::: example
id: CODE-f662804cf33dcb67
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: Check all warnings
confidence: 0.9
digest: d207c9e1343e9d45fa430e910da4fdcb6cf836927fabc70119d5fdc7afd3481c
symbol_refs: [warnings, count]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
test_multiple_assertions if {
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
:::

::: example
id: CODE-0b2590a50bc33a47
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: Check all warnings
confidence: 0.9
digest: 3a55c39b7d1d841ec2f4fbe179a1b3b03cad312e267a17320cda64c89ff5c7b8
symbol_refs: [contains]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
    some warning in warnings
    contains(warning, "pattern1")
    
:::

::: example
id: CODE-9a1a759e4ddf610a
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: Or check specific warning
confidence: 0.9
digest: 3b3f4f049ff2e31725d283c0b068edb8ce5eb4b7a52874afb665d5fb2b05d274
symbol_refs: [msg, specific_warning, contains]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
    specific_warning := [msg | msg := warnings[_]; contains(msg, "pattern2")][0]
    contains(specific_warning, "pattern2")
}
:::

::: example
id: CODE-81597c2a6c7d76f5
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: ‚úÖ CORRECT: Test for either rule, or check for common message pattern
confidence: 0.9
digest: 898a292e570fbe656d51104ab7c8165b98feb8db63290fee0b917c96a537b819
symbol_refs: [warnings, count, mock_input]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
test_meaningful_todo_not_logged if {
    mock_input := {"changed_files": [{
        "diff": "+ // TODO: Fix issue (workaround)"
    }]}
    
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
:::

::: example
id: CODE-1ad5dbfa9ab9da67
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: Check for message pattern common to both rules
confidence: 0.9
digest: 58dfee96f77de9c1162037bca46ffbdc0984846c2f788e4dda61db14e079e904
symbol_refs: [contains]
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
    some warning in warnings
    contains(warning, "meaningful TODO/FIXME")
    contains(warning, "tech-debt.md")
}

:::

::: example
id: CODE-b3b44232df7d7ede
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: ‚ùå FRAGILE: Testing for specific rule ID
confidence: 0.9
digest: 28a0784a4c875695834352e4e95909b19e7fbcbd7e4541cd31f6a567caba7d69
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
test_specific_rule if {
:::

::: example
id: CODE-e26d68bd54e07f63
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
explanation: or if a more specific rule triggers first
confidence: 0.9
digest: a0381027fef1d284e5fb9e3c5adad7c2221f03c77da5047b5cf7e0d0255fbd66
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
}
:::

::: example
id: CODE-8425d8ead18f3dfd
chapter: CH-05
language: rego
role: example
tags: []
explanation: Policy checks for lowercase "temporary"
confidence: 0.9
digest: 820207f17a390bb4666f0d353d1248b3b5c6d6b91dc4245084c5737257191369
symbol_refs: [contains]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")  # Lowercase required
}

:::

::: example
id: CODE-323d21f08df10217
chapter: CH-05
language: rego
role: example
tags: []
explanation: ‚ùå TEST FAILS: Test uses "Temporary" (capital T)
confidence: 0.9
digest: 85bc526189a98bcd8e9f73941188160d592fe1b0965c0864521b55e606382ddc
symbol_refs: [mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_example if {
    mock_input := {"diff": "+ // FIXME: Temporary hack"}
:::

::: example
id: CODE-eb583a8ac1fc2fe2
chapter: CH-05
language: rego
role: example
tags: []
explanation: Test expects warning but gets none
confidence: 0.9
digest: 29b7645cb89a1b18ad320323e834026f1e0ee00add944128704694805b372fa1
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
}

:::

::: example
id: CODE-323d21f08df10217
chapter: CH-05
language: rego
role: example
tags: []
explanation: ‚úÖ TEST PASSES: Test uses "temporary" (lowercase)
confidence: 0.9
digest: 5da76a81915224c719af3aa4a700bb0b64a246268b3daa49c4d49bbee73b7dd9
symbol_refs: [mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_example if {
    mock_input := {"diff": "+ // FIXME: temporary hack"}
:::

::: example
id: CODE-5932a57f7be30923
chapter: CH-05
language: rego
role: example
tags: []
explanation: Policy matches "temporary" correctly
confidence: 0.9
digest: 54795e677cd9669576a2d17076b704fb958adfc489e5283673928a53813efc7b
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
}
:::

::: example
id: CODE-f8d70d047eae7fcc
chapter: CH-05
language: rego
role: example
tags: []
explanation: Normalize keywords in test inputs to match policy expectations
confidence: 0.9
digest: b81484486e76ee620807cd81e97514e2f1a90734ccfb88e58a03fe373d063ef9
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_example if {
:::

::: example
id: CODE-90bf9a86fe5a6225
chapter: CH-05
language: rego
role: example
tags: []
explanation: Use lowercase to match policy checks
confidence: 0.9
digest: 0bf2ed59abf06287751a54f331e0d53cf5d8705eb53cdb99cbb3b81e03c7d55e
symbol_refs: [mock_input]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
    mock_input := {"diff": "+ // FIXME: temporary hack"}
:::

::: example
id: CODE-67ba69db5fb83d8d
chapter: CH-05
language: rego
role: example
tags: []
explanation: ...
confidence: 0.9
digest: ad48430a8ffc944b5fa3f98f233b7f17e35d50cea6a7ddfeed3fdd68acf84f85
symbol_refs: []
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
}
:::

::: example
id: CODE-9fadd7b71e061542
chapter: CH-05
language: rego
role: example
tags: []
digest: 687814369780869f6034dd1c552bc94c71450c18512f0d14834182f9cd433449
symbol_refs: [diff_lower, contains]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy normalizes input before checking
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    diff_lower := lower(file.diff)
    contains(diff_lower, "temporary")  # Case-insensitive check
}
:::

::: example
id: CODE-b420ffe7aa405556
chapter: CH-05
language: rego
role: example
tags: []
digest: 7cbf61421a1cf3a11086e3ba929857e7ceb53960ce45013102b61fae894d5fdb
symbol_refs: [contains]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy checks multiple case variants
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")
}

has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "Temporary")
}
:::

::: example
id: BLK-5e2db20e80752257
summary: Diagnostic Steps: 1.
digest: 9fbb350918dc84c58ef1e9b5b8ea623b03fbf238692db7c616a862fdd1545770
symbol_refs: [count, diff, newline, contains, content]
semantic_role: example
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
chapter: CH-05
:::
**Diagnostic Steps:** 1. Compare test input structure with working JSON input 2. Check if regex patterns expect actual newlines vs `\n` literals 3. Use `print()` to inspect actual string content: ```rego test_debug if { diff := "+ // TODO:\n+ function()" print("Length:", count(diff)) # Check if \n is one char or two print("Contains newline:", contains(diff, "\n")) # May fail if literal } ``` 4. Convert test strings to raw strings (backticks) if multi-line content is needed
:::

::: code-pattern
id: CODE-a23e9086072f5ce3
language: rego
chapter: CH-05
source: term:Multiple expressions in a rule body
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: 7fac9cef4333057328160a595f5b529d50e97479be92f5ccba3c6d8246539ad6
symbol_refs: [sensitive, active, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    input.user.role == "admin"       # Must be true AND
    input.user.active == true         # Must be true AND
    input.resource.sensitive == false # Must be true
}
:::

::: code-pattern
id: CODE-ab9dfd453065e279
language: rego
chapter: CH-05
source: term:Multiple rule bodies
purpose: definition-example
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
pattern_metadata: {'rule_type': 'allow'}
digest: b28ffd2e541747302095a595a0002ccb6ad85efea5957fcf7a25ccdc6eca09d0
symbol_refs: [action, public, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    input.user.role == "admin"
}

allow if {
    input.action == "read"
    input.resource.public == true
}
:::

::: code-pattern
id: CODE-d5560fa7f4081a20
language: rego
chapter: CH-05
source: term:Array Comprehensions
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 01b57b177f383b4f1b8e77b76533760a00c1cbea039ddde5816d913a7f9a4db4
symbol_refs: [active, squares, evens, admin_emails, pairs]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Format: [ <term> | <query> ]

# Simple transformation
squares := [x * x | some x in numbers]

# With filtering
evens := [x | some x in numbers; x % 2 == 0]

# Complex example
admin_emails := [user.email |
    some user in data.users
    "admin" in user.roles
    user.active == true
]

# Nested iteration
pairs := [[x, y] |
    some x in [1, 2, 3]
    some y in ["a", "b", "c"]
]
# Result: [[1, "a"], [1, "b"], [1, "c"], [2, "a"], ...]
:::

::: code-pattern
id: CODE-d4b2dcce40fd1ab3
language: rego
chapter: CH-05
source: term:Set Comprehensions
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 658c0a282052e383a03c3c7aae371773dacad12e845548019400ad86e96d2772
symbol_refs: [valid_ips, departments, unique]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Format: { <term> | <query> }

# Remove duplicates
unique := {x | some x in items}

# Extract unique properties
departments := {user.dept | some user in users}

# Complex filtering
valid_ips := {addr |
    some addr in input.addresses
    net.cidr_contains("10.0.0.0/8", addr)
}
:::

::: code-pattern
id: CODE-0b9eaa6e4b63cd31
language: rego
chapter: CH-05
source: term:Object Comprehensions
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 8e03128d1783a065fb0c1f2d62b1693341b7ef23ed512e43f7bf1f8254cb500e
symbol_refs: [count, name_to_age, user_counts, users_in_dept, dept, doubled, k, name]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Format: { <key>: <value> | <query> }

# Create mapping
name_to_age := {person.name: person.age |
    some person in people
}

# With transformation
doubled := {k: v * 2 |
    some k, v in original
}

# Aggregation
user_counts := {dept: count |
    some dept in departments
    users_in_dept := [u | some u in users; u.dept == dept]
    count := array.length(users_in_dept)
}
:::

::: code-pattern
id: CODE-2548413c59110b36
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 8219ad3f7b83545f73a4d9775158c80cd44c26d9204def753d70ff8e7b99136c
symbol_refs: [item]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚ùå WRONG: "Is there any element != 'foo'?"
# This is true if ANY element is not "foo"
has_non_foo if {
    items[_] != "foo"  # Existential quantification
}

# ‚úÖ CORRECT: "Is 'foo' not in array?"
foo_not_present if {
    not "foo" in items
}

# ‚úÖ CORRECT: "Are all elements not foo?"
all_non_foo if not any_foo

any_foo if {
    some item in items
    item == "foo"
}
:::

::: code-pattern
id: CODE-0d18d72d3e70f617
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 7d718ab330d3b8801048ad262329acc201dc022242ff66d63ade8e8ebd8a7758
symbol_refs: [contains]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.7
:::
# ‚ùå UNSAFE: May error if input.pr_body is missing or not a string
has_override(marker) if {
    contains(input.pr_body, marker)  # Type error if pr_body missing
}

# ‚úÖ SAFE: Type guard before access
has_override(marker) if {
    is_string(input.pr_body)
    contains(input.pr_body, marker)
}

# ‚úÖ SAFE: Guard array access
input_valid if {
    is_array(input.changed_files)
}

# Then use guard in all rules
deny[msg] if {
    input_valid
    some file in input.changed_files
    # ... rest of logic
}
:::

::: code-pattern
id: CODE-1b4cef265aa6f5e3
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
pattern_metadata: {'function': 'count'}
digest: 4b49955727b1a453ac52d631f09d416a11c3e370f50603409593c74dc2efa0e7
symbol_refs: [warnings, count, diff_content, getUsers, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Raw string preserves actual newlines
test_todo_with_newline if {
    diff_content := `+ // TODO:
+ function getUsers() {`
    
    mock_input := {"changed_files": [{
        "path": "file.ts",
        "diff": diff_content
    }]}
    
    # Policy regex now matches correctly
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODE-8cd9f756e7ad785f
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
pattern_metadata: {'function': 'count'}
digest: b3f9811874345a85d6b026e14963f6c3c0ecc2f341f34e00b7b935f681ddb305
symbol_refs: [count, mock_input]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚ùå PROBLEMATIC: Direct count() with with clause
test_example if {
    mock_input := {"changed_files": [...]}
    count(policy.warn) >= 1 with input as mock_input
}
:::

::: code-pattern
id: CODE-55a5cc5eed674559
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
pattern_metadata: {'function': 'count'}
digest: 9242f78711f4feeb2239a3e692ddf3afa68f366a1932ddb5186f669048bdbb7a
symbol_refs: [warnings, count, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Bind result to variable first
test_example if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODE-6fd3a2913e47883e
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
pattern_metadata: {'function': 'count'}
digest: 0e8171a1399323381ecc9e06dbc83db8a49abfa3799ca29e7852a49fb3afa3e4
symbol_refs: [warnings, count, msg, warning, contains, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚úÖ CORRECT: Iterate set to get first element
test_get_warning_message if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Get first warning message
    warning := [msg | msg := warnings[_]][0]
    contains(warning, "expected text")
}

# ‚ùå WRONG: Sets don't support index access
warning := warnings[0]  # Error: sets don't have indices
:::

::: code-pattern
id: CODE-51be79b1bf6bc8cb
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 21e5ada939a1cf5636cc6b8834bf63489b5d7b1e44b3986080a379a5cc110d0d
symbol_refs: [warnings, count, msg, specific_warning, contains]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
test_multiple_assertions if {
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check all warnings
    some warning in warnings
    contains(warning, "pattern1")
    
    # Or check specific warning
    specific_warning := [msg | msg := warnings[_]; contains(msg, "pattern2")][0]
    contains(specific_warning, "pattern2")
}
:::

::: code-pattern
id: CODE-0fd84a9d259091b1
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
pattern_metadata: {'quantifier': 'some'}
digest: 729bf8901665794cbbed1820d820a9fe8068851079d78d636036cfb38703b08f
symbol_refs: [count, warnings, ID, precedence, contains, triggers, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Test for either rule, or check for common message pattern
test_meaningful_todo_not_logged if {
    mock_input := {"changed_files": [{
        "diff": "+ // TODO: Fix issue (workaround)"
    }]}
    
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check for message pattern common to both rules
    some warning in warnings
    contains(warning, "meaningful TODO/FIXME")
    contains(warning, "tech-debt.md")
}

# ‚ùå FRAGILE: Testing for specific rule ID
test_specific_rule if {
    # This may fail if rule precedence changes
    # or if a more specific rule triggers first
}
:::

::: code-pattern
id: CODE-704f6e731c295b92
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
pattern_metadata: {'function': 'count'}
digest: 5f4c36bce22679fd54648cdf31640f15a92be21180f4498abc377f45876b53c2
symbol_refs: [compliance.tech_debt_test, count, warnings, data.compliance.tech_debt, and, mock_input, rego.v1]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Explicit import and qualified reference
package compliance.tech_debt_test

import data.compliance.tech_debt
import rego.v1

test_example if {
    mock_input := {...}
    warnings := tech_debt.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODE-4522197481045bd4
language: rego
chapter: CH-05
source: term:Common Pitfall ‚Äî Existential vs Universal
purpose: definition-example
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
pattern_metadata: {'function': 'count'}
digest: b4a119667d20463a0bbe5d223e0832c86e65ba24ac839c17a373cc99c560374b
symbol_refs: [name, count]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚ùå AVOID: Bare rule name resolution
test_example if {
    count(warn) >= 1 with input as mock_input
    # Relies on global data tree search - fragile and ambiguous
}
:::

::: code-pattern
id: CODE-3152b6a89a146d23
chapter: CH-05
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: 1a8c1dab37b4a155e4b24623e7b1607188a7cd447ebad944933454c0d7b053cf
symbol_refs: [sensitive, active, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
semantic_categories: [authz]
:::
allow if {
    input.user.role == "admin"       # Must be true AND
    input.user.active == true         # Must be true AND
    input.resource.sensitive == false # Must be true
}
:::

::: code-pattern
id: CODE-ff0c5e5c7e41a636
chapter: CH-05
language: rego
role: code-pattern:authorization:allow-rule
tags: [authorization, allow-rule]
pattern_type: authorization
pattern_subtype: allow-rule
digest: 38ed9e4f8f91553bf7441fe9b7277ed63d78e0f707213928ad9ee32d490f0c59
symbol_refs: [action, public, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz]
:::
allow if {
    input.user.role == "admin"
}

allow if {
    input.action == "read"
    input.resource.public == true
}
:::

::: code-pattern
id: CODE-2cbe0767daa4b7a0
chapter: CH-05
language: rego
role: code-pattern:comprehension:array
tags: [comprehension, array]
explanation: Complex example
confidence: 0.9
pattern_type: comprehension
pattern_subtype: array
digest: d7e5bf0be390a9f5260879cb368bde9c966164b0bbcc2fba97fcdf71d676aac6
symbol_refs: [admin_emails, active]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
admin_emails := [user.email |
    some user in data.users
    "admin" in user.roles
    user.active == true
]

:::

::: code-pattern
id: CODE-189eb42d4e1567c5
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Complex filtering
confidence: 0.9
pattern_type: generic
digest: f432fc30d55e9ea5cb7cc5d0847fa3b0c5dfcbfa294586ead99fb84e75ecab89
symbol_refs: [valid_ips]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
valid_ips := {addr |
    some addr in input.addresses
    net.cidr_contains("10.0.0.0/8", addr)
}
:::

::: code-pattern
id: CODE-b26cad8701529876
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic, quantifier, existential]
pattern_type: quantifier
pattern_subtype: existential
pattern_metadata: {'quantifier': 'some'}
digest: ab57310f72d6215d82789b2103fa034ce910cdb103f0eeaef24d843c3a435e1b
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
all_valid if not any_invalid

any_invalid if {
    some item in items
    item.status != "approved"
}
:::

::: code-pattern
id: CODE-86b8ff6d6c92f117
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic, quantifier, existential]
pattern_type: quantifier
pattern_subtype: existential
pattern_metadata: {'quantifier': 'some'}
digest: 7dd31133e5d3f997c82c5cee8c26f9e689db217bd22580f0336d31150ff91609
symbol_refs: [approved, count, status, violations]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
all_approved if {
    approved := {i | some i in items; i.status == "approved"}
    count(approved) == count(items)
}

# Or check for violations
all_valid if {
    violations := {i | some i in items; i.status != "valid"}
    count(violations) == 0
}
:::

::: code-pattern
id: CODE-b916c9b490f90d5d
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Negation with expressions
confidence: 0.9
pattern_type: generic
digest: 69ab4d80d0347e9c9932106d4d681d3a5f7789aabaca7f36e04cdaa8a55b2c42
symbol_refs: [startswith]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [authz, negation]
:::
invalid if not startswith(input.name, "valid_")

:::

::: code-pattern
id: CODE-4a2be09c33beac7b
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Check non-membership
confidence: 0.9
pattern_type: generic
digest: e538fccebf0aa342de570b059bea91199f82069fcf68937b3be2546b972c5757
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
not_admin if not "admin" in input.user.roles
:::

::: code-pattern
id: CODE-62ae1147b658428b
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: 3e494e88f016d6e51c1f0695d400fe6c80c592a61bf92728741e276a06e0f979
symbol_refs: [user]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.7
:::
# ‚ùå Unsafe: user not grounded
unsafe if {
    not blacklisted[user]
}

# ‚úÖ Safe: user grounded first
safe if {
    user := input.user.id
    not blacklisted[user]
}
:::

::: code-pattern
id: CODE-ee17c3fb697fd027
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚ùå UNSAFE: May error if input.pr_body is missing or not a string
confidence: 0.9
pattern_type: generic
digest: ff1112ca70da49012a25305b760f6c380642f1ffb71eddc5add0ad38cf99703a
symbol_refs: [contains]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.7
:::
has_override(marker) if {
    contains(input.pr_body, marker)  # Type error if pr_body missing
}

:::

::: code-pattern
id: CODE-0dde4ffacad2f8a3
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚úÖ SAFE: Type guard before access
confidence: 0.9
pattern_type: generic
digest: 23de84d422214257a44870b53079941a8290cd8afdf464368a49b285a30c9fe5
symbol_refs: [contains]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
has_override(marker) if {
    is_string(input.pr_body)
    contains(input.pr_body, marker)
}

:::

::: code-pattern
id: CODE-a0d0469e0feedab3
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: ‚úÖ SAFE: Guard array access
confidence: 0.9
pattern_type: generic
digest: 228577b7185208bf72fea54903f8aaca3710abf9937bd55de9a3e2c023a0dc40
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
input_valid if {
    is_array(input.changed_files)
}

:::

::: code-pattern
id: CODE-6f138445d33c3682
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
explanation: Then use guard in all rules
confidence: 0.9
pattern_type: generic
digest: 9957d1b6bb05bfc668195cf6ccf47f9b5ff5209afe66b829db5dad7e450a02ab
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
deny[msg] if {
    input_valid
    some file in input.changed_files
:::

::: code-pattern
id: CODE-c0b73abf2e85dc27
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: d53f0e39607380d4d34d37cbd17ee172943ef363133cf47ee7d022cb24268c2d
symbol_refs: [getUsers, literal, mock_input]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
test_example if {
    mock_input := {"diff": "+ // TODO:\n+ function getUsers() {"}
    # \n here is literal: backslash + 'n', NOT a newline
}
:::

::: code-pattern
id: CODE-efd78ba9916ca447
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
pattern_type: testing
pattern_subtype: mock-input
digest: 681a18e34c55cb7eab1d7236262870c97383840ac79b9c8f860e1151f8f2a159
symbol_refs: [warnings, count, diff_content, getUsers, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Raw string preserves actual newlines
test_todo_with_newline if {
    diff_content := `+ // TODO:
+ function getUsers() {`
    
    mock_input := {"changed_files": [{
        "path": "file.ts",
        "diff": diff_content
    }]}
    
    # Policy regex now matches correctly
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODE-8ac93f8eb365af28
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
pattern_type: testing
pattern_subtype: mock-input
digest: 8297c2b7758d5302213f4f72fe8df87a96a029a2309623b8db7c376b6066accd
symbol_refs: [count, mock_input]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚ùå PROBLEMATIC: Direct count() with with clause
test_example if {
    mock_input := {"changed_files": [...]}
    count(policy.warn) >= 1 with input as mock_input
}
:::

::: code-pattern
id: CODE-213aa0a6ee07643a
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
pattern_type: testing
pattern_subtype: mock-input
digest: d09e4fb92da3dbfdc1963c2a8b397cb698ac351856fa9dfdec21bb3ac06d8509
symbol_refs: [warnings, count, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Bind result to variable first
test_example if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODE-bff1347a219a35b9
chapter: CH-05
language: rego
role: code-pattern:generic
tags: [generic]
pattern_type: generic
digest: f967e9fde4f8eeccedce4441797c30ecaeb21802240e8b00a1b5b7e94ce68d22
symbol_refs: [check, checks, match]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Policy has two rules that can both match:
# R15-W02: Meaningful TODO not logged (general check)
# R15-W03: TODO added without reference (specific check for +.*TODO:)

# Both rules check:
# - has_meaningful_todo_keywords(file)
# - not has_tech_debt_reference(file)
# R15-W03 also checks: regex.match("\\+.*TODO:", file.diff)
:::

::: code-pattern
id: CODE-141a39bba2be1ded
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
pattern_type: testing
pattern_subtype: mock-input
digest: 93f30a0f2bdf8316d657ea85ef3d7ee1a3489eb27712f7d468215b050a2d12a0
symbol_refs: [compliance.tech_debt_test, count, warnings, data.compliance.tech_debt, and, mock_input, rego.v1]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Explicit import and qualified reference
package compliance.tech_debt_test

import data.compliance.tech_debt
import rego.v1

test_example if {
    mock_input := {...}
    warnings := tech_debt.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODE-031e381b7120fc25
chapter: CH-05
language: rego
role: code-pattern:testing:mock-input
tags: [testing, mock-input]
pattern_type: testing
pattern_subtype: mock-input
digest: 0e5ebd24ae7a83d7a175a674321b79dfdbda3b58b3ad81259338d0b6fca21de9
symbol_refs: [name, count]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚ùå AVOID: Bare rule name resolution
test_example if {
    count(warn) >= 1 with input as mock_input
    # Relies on global data tree search - fragile and ambiguous
}
:::

::: code-pattern
id: CODEPAT-30265d67b6856971
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-05
metadata: {'rule_type': 'allow'}
digest: 6067d065eb8e0b54683de900885e82c37d732998298c967a01128a90229ea13c
symbol_refs: [sensitive, active, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    input.user.role == "admin"       # Must be true AND
    input.user.active == true         # Must be true AND
    input.resource.sensitive == false # Must be true
}
:::

::: code-pattern
id: CODEPAT-305b334dae7a01bb
language: rego
pattern_type: rule_head
pattern_subtype: allow
tags: [rule_head, allow]
chapter: CH-05
metadata: {'rule_type': 'allow'}
digest: 63b0809f13952ec216c3292c5c9fa5b5a2cee18521c40a875abbd0ebe69ba4d4
symbol_refs: [action, public, role]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
allow if {
    input.user.role == "admin"
}

allow if {
    input.action == "read"
    input.resource.public == true
}
:::

::: code-pattern
id: CODEPAT-ac8a1c146ff00cb4
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: 040aea8536eec2a18abc37055c0547332a1c0adde7f36cbf3e64feb761dace70
symbol_refs: [active, squares, evens, admin_emails, pairs]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Format: [ <term> | <query> ]

# Simple transformation
squares := [x * x | some x in numbers]

# With filtering
evens := [x | some x in numbers; x % 2 == 0]

# Complex example
admin_emails := [user.email |
    some user in data.users
    "admin" in user.roles
    user.active == true
]

# Nested iteration
pairs := [[x, y] |
    some x in [1, 2, 3]
    some y in ["a", "b", "c"]
]
# Result: [[1, "a"], [1, "b"], [1, "c"], [2, "a"], ...]
:::

::: code-pattern
id: CODEPAT-f5d7f842be805668
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: 6686e812830918a87f55aab7cccb4c65f1862491aa9142cf0663b23af6eeee1d
symbol_refs: [valid_ips, departments, unique]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Format: { <term> | <query> }

# Remove duplicates
unique := {x | some x in items}

# Extract unique properties
departments := {user.dept | some user in users}

# Complex filtering
valid_ips := {addr |
    some addr in input.addresses
    net.cidr_contains("10.0.0.0/8", addr)
}
:::

::: code-pattern
id: CODEPAT-55d865248cc0a0a4
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: 5818d10cce64819ed3ad0a81539b8da412d5c1fd6b9ad1a1200f02e5513fff60
symbol_refs: [count, name_to_age, user_counts, users_in_dept, dept, doubled, k, name]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# Format: { <key>: <value> | <query> }

# Create mapping
name_to_age := {person.name: person.age |
    some person in people
}

# With transformation
doubled := {k: v * 2 |
    some k, v in original
}

# Aggregation
user_counts := {dept: count |
    some dept in departments
    users_in_dept := [u | some u in users; u.dept == dept]
    count := array.length(users_in_dept)
}
:::

::: code-pattern
id: CODEPAT-ce265669a80bad75
language: rego
pattern_type: quantifier
pattern_subtype: universal
tags: [quantifier, universal, quantifier, universal]
chapter: CH-05
metadata: {'quantifier': 'every'}
pattern_metadata: {'quantifier': 'every'}
digest: 23960f798f56d1af5d48eb118692655645ef38306f04fae96ba591713c99ace4
symbol_refs: [id, valid, status]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# All items must satisfy condition
all_approved if {
    every item in items {
        item.status == "approved"
    }
}

# With index
all_valid if {
    every i, item in items {
        item.id == i
        item.valid == true
    }
}

# Multiple conditions
all_healthy if {
    every server in servers {
        server.status == "up"
        server.cpu < 80
        server.memory < 90
    }
}
:::

::: code-pattern
id: CODEPAT-78182840e229b0f2
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: a981e750ae5d91beaee6ed639139579ded33212ddf362f10b5fe49c05b77898d
symbol_refs: []
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
all_valid if not any_invalid

any_invalid if {
    some item in items
    item.status != "approved"
}
:::

::: code-pattern
id: CODEPAT-7564a3f4b38f9d8a
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: a6aba303fdecc820aa4e930896769f4b79da10533a9be09b76d47589278d903f
symbol_refs: [approved, count, status, violations]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
all_approved if {
    approved := {i | some i in items; i.status == "approved"}
    count(approved) == count(items)
}

# Or check for violations
all_valid if {
    violations := {i | some i in items; i.status != "valid"}
    count(violations) == 0
}
:::

::: code-pattern
id: CODEPAT-c4c47ef6c7df1e75
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: 2c2a44aad46e7826ca60c886dc3623d047638ff50b93bd1acad21d936bb1072e
symbol_refs: [approved, count, status, violations]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
all_approved if {
    approved := {i | some i in items; i.status == "approved"}
    count(approved) == count(items)
}

# Or check for violations
all_valid if {
    violations := {i | some i in items; i.status != "valid"}
    count(violations) == 0
}
:::

::: code-pattern
id: CODEPAT-fb0946dc48a099bd
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: 1090b72d12a65148befc0b3c24ae8681b6b1c642438600c5b5a45d3a2077d5b1
symbol_refs: [item]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚ùå WRONG: "Is there any element != 'foo'?"
# This is true if ANY element is not "foo"
has_non_foo if {
    items[_] != "foo"  # Existential quantification
}

# ‚úÖ CORRECT: "Is 'foo' not in array?"
foo_not_present if {
    not "foo" in items
}

# ‚úÖ CORRECT: "Are all elements not foo?"
all_non_foo if not any_foo

any_foo if {
    some item in items
    item == "foo"
}
:::

::: code-pattern
id: CODEPAT-dd2907d7692be834
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: 4a50b24144dd7f284e39956d0d021b7be4a4bebee4c1bd4fbb3b3fc39de6e118
symbol_refs: [contains]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.7
:::
# ‚ùå UNSAFE: May error if input.pr_body is missing or not a string
has_override(marker) if {
    contains(input.pr_body, marker)  # Type error if pr_body missing
}

# ‚úÖ SAFE: Type guard before access
has_override(marker) if {
    is_string(input.pr_body)
    contains(input.pr_body, marker)
}

# ‚úÖ SAFE: Guard array access
input_valid if {
    is_array(input.changed_files)
}

# Then use guard in all rules
deny[msg] if {
    input_valid
    some file in input.changed_files
    # ... rest of logic
}
:::

::: code-pattern
id: CODEPAT-fbd2aab3751da520
language: rego
pattern_type: rule_head
pattern_subtype: deny
tags: [rule_head, deny]
chapter: CH-05
metadata: {'rule_type': 'deny'}
digest: 792772c34b392010555a22c3201c8c75184643866396d9c36fd3604f80e38930
symbol_refs: [contains]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.7
:::
# ‚ùå UNSAFE: May error if input.pr_body is missing or not a string
has_override(marker) if {
    contains(input.pr_body, marker)  # Type error if pr_body missing
}

# ‚úÖ SAFE: Type guard before access
has_override(marker) if {
    is_string(input.pr_body)
    contains(input.pr_body, marker)
}

# ‚úÖ SAFE: Guard array access
input_valid if {
    is_array(input.changed_files)
}

# Then use guard in all rules
deny[msg] if {
    input_valid
    some file in input.changed_files
    # ... rest of logic
}
:::

::: code-pattern
id: CODEPAT-67fa0ef89ef6b03c
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: a34a05740799f6c8f1534a64324a81bb9e5b8438f0dd1b738f666e1773c56184
symbol_refs: [warnings, count, diff_content, getUsers, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Raw string preserves actual newlines
test_todo_with_newline if {
    diff_content := `+ // TODO:
+ function getUsers() {`
    
    mock_input := {"changed_files": [{
        "path": "file.ts",
        "diff": diff_content
    }]}
    
    # Policy regex now matches correctly
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODEPAT-190e5fc8d209ddec
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: 3f280f4d40071b00a2e863bf6b3291cf26599e262a8e742e468edc52c3905be8
symbol_refs: [count, mock_input]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚ùå PROBLEMATIC: Direct count() with with clause
test_example if {
    mock_input := {"changed_files": [...]}
    count(policy.warn) >= 1 with input as mock_input
}
:::

::: code-pattern
id: CODEPAT-a00d797a81733169
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: 874aa952ae45fcce036fcb93894a87010eddde6aca73e0dd6b6254937611dbe2
symbol_refs: [warnings, count, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Bind result to variable first
test_example if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODEPAT-f8e30e7deeeb39fa
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: eb6d095732aa42d9e13ef686fceb270da6b64650460a9c49b5263ce0d40a2856
symbol_refs: [warnings, count, msg, warning, contains, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.3
:::
# ‚úÖ CORRECT: Iterate set to get first element
test_get_warning_message if {
    mock_input := {"changed_files": [...]}
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Get first warning message
    warning := [msg | msg := warnings[_]][0]
    contains(warning, "expected text")
}

# ‚ùå WRONG: Sets don't support index access
warning := warnings[0]  # Error: sets don't have indices
:::

::: code-pattern
id: CODEPAT-cefe29b2044e16b1
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: 2789dbb0ef84fac3c6990032dc5725f8067efd7b065a9571840f988dda12f83c
symbol_refs: [warnings, count, msg, specific_warning, contains]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
test_multiple_assertions if {
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check all warnings
    some warning in warnings
    contains(warning, "pattern1")
    
    # Or check specific warning
    specific_warning := [msg | msg := warnings[_]; contains(msg, "pattern2")][0]
    contains(specific_warning, "pattern2")
}
:::

::: code-pattern
id: CODEPAT-90bf40e525478abf
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: 3466c201bcaf7191360dee8e21581ebe8789a07c355e26026eebb9144bb5bfab
symbol_refs: [warnings, count, msg, specific_warning, contains]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
test_multiple_assertions if {
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check all warnings
    some warning in warnings
    contains(warning, "pattern1")
    
    # Or check specific warning
    specific_warning := [msg | msg := warnings[_]; contains(msg, "pattern2")][0]
    contains(specific_warning, "pattern2")
}
:::

::: code-pattern
id: CODEPAT-162b968425fbee79
language: rego
pattern_type: quantifier
pattern_subtype: existential
tags: [quantifier, existential]
chapter: CH-05
metadata: {'quantifier': 'some'}
digest: e111e11912599072bca96cf16af99fbf78e6b312088da97b8ec2f18acc696c4b
symbol_refs: [count, warnings, ID, precedence, contains, triggers, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Test for either rule, or check for common message pattern
test_meaningful_todo_not_logged if {
    mock_input := {"changed_files": [{
        "diff": "+ // TODO: Fix issue (workaround)"
    }]}
    
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check for message pattern common to both rules
    some warning in warnings
    contains(warning, "meaningful TODO/FIXME")
    contains(warning, "tech-debt.md")
}

# ‚ùå FRAGILE: Testing for specific rule ID
test_specific_rule if {
    # This may fail if rule precedence changes
    # or if a more specific rule triggers first
}
:::

::: code-pattern
id: CODEPAT-e3a1766e8b78df14
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: a030be22d68e390f752ee3521b265fe431aaf49ecc51b42817679c886a909a81
symbol_refs: [count, warnings, ID, precedence, contains, triggers, mock_input]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Test for either rule, or check for common message pattern
test_meaningful_todo_not_logged if {
    mock_input := {"changed_files": [{
        "diff": "+ // TODO: Fix issue (workaround)"
    }]}
    
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check for message pattern common to both rules
    some warning in warnings
    contains(warning, "meaningful TODO/FIXME")
    contains(warning, "tech-debt.md")
}

# ‚ùå FRAGILE: Testing for specific rule ID
test_specific_rule if {
    # This may fail if rule precedence changes
    # or if a more specific rule triggers first
}
:::

::: code-pattern
id: CODEPAT-3f603bb00d12d7e6
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: b579aeb8a28bf98deb43d713858ea3681f30331b1074699b6c2183673d5d3ae4
symbol_refs: [compliance.tech_debt_test, count, warnings, data.compliance.tech_debt, and, mock_input, rego.v1]
semantic_role: warning
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Explicit import and qualified reference
package compliance.tech_debt_test

import data.compliance.tech_debt
import rego.v1

test_example if {
    mock_input := {...}
    warnings := tech_debt.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: code-pattern
id: CODEPAT-ce3111aa333c1369
language: rego
pattern_type: aggregation
pattern_subtype: count
tags: [aggregation, count]
chapter: CH-05
metadata: {'function': 'count'}
digest: 1caaac178304faaa65ed4ae4cb7bfb1933ea1815a0d14b9ebbcdb2ddf19b33c4
symbol_refs: [name, count]
semantic_role: pattern
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
:::
# ‚ùå AVOID: Bare rule name resolution
test_example if {
    count(warn) >= 1 with input as mock_input
    # Relies on global data tree search - fragile and ambiguous
}
:::

::: common-mistake
id: BLK-dddf66d1e26e2d28
summary: Pitfall: contains is substring, not set membership (for that use in).
digest: 4a364ce197bf5e7f244d710ee685b2d36baa211977f5477237e59190cfe185df
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall: contains is substring, not set membership (for that use in).
:::

::: common-mistake
id: BLK-4381bc060dd7cf78
summary: 6.24 Design Patterns & Anti-Patterns.
digest: 56b13bfeccc6cb28493782760185cc284afde4785307428ccc3c589406bf53fc
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
6.24 Design Patterns & Anti-Patterns
:::

::: common-mistake
id: BLK-85303cba34b3037c
summary: Explain modes opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow' opa eval --explain=full ...
digest: ea753c0d15a967c7e298b22e0ffdb11d4d7310811dc37c714e99da0c46781093
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 1.0
pattern_role: anti-pattern
severity: high
semantic_categories: [negation, performance]
chapter: CH-05
:::
Harness: performs all file I/O and passes JSON into Rego as input or data. ________________________________________ 7.4 Debugging with print and opa eval print is your printf. Signature: print(x1, x2, ...) Always returns true, so you can drop it directly inside rule bodies. debug_threshold if { t := input.threshold print("Threshold is:", t) t > 10 } Where output appears opa eval ‚Üí printed to stderr / logs. Embedded OPA ‚Üí appears in OPA logs; your host system should capture these. Key points print doesn‚Äôt alter semantics (just like adding true). Good for: Inspecting variable bindings. Confirming which rule body is being hit. Bad for: Production policies with PII. Flooding logs; use sparingly or behind a debug flag. ________________________________________ 7.5 opa eval Explain & Profile Modes opa eval is both a REPL and microscope. Explain modes opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow' opa eval --explain=full ... notes = high-level reasoning (rule success/failure). full = full derivation tree; great for debugging, painful for huge queries. Profile mode opa eval --profile -d . -i input.json 'data.compliance' You get: Per-rule evaluation counts and cumulative time. A ranking of ‚Äúhot‚Äù rules (the ones to optimize or refactor). Typical workflow Problem: ‚ÄúPolicy is slow for large PRs / big cluster.‚Äù Run: opa eval --profile ... Identify rules with: Many evaluations (thousands or millions). High total time. Refactor: Use sets/objects instead of scanning arrays. Add guard conditions (cheap predicates before expensive ones). Use partial evaluation (¬ß11). ________________________________________ 7.6 Common Errors and How to Diagnose Them rego_unsafe_var_error ‚Äì unsafe variables # ‚ùå Unsafe: user appears only under negation deny if { not blacklisted[user] } Fix: Bind user outside negation. deny if { user := input.user not blacklisted[user] } rego_type_error ‚Äì type mismatch Example: using to_number on an object, or sum over [1, "two"]. Fix: Guard with is_* built-ins (is_number(x), is_array(x)). Normalize incoming data. Rule conflict errors Multiple complete rules with same name produce different values for same input. f(1) := 2 f(1) := 3 # conflict For sets/partial objects this is okay (results are merged); for complete rules & functions it‚Äôs an error. Infinite or pathological recursion Patterns that refer back to themselves without a base case. OPA has guardrails, but logic errors can still create huge evaluation trees. Mitigate with: Explicit depth counters. Clear base rules. ________________________________________ 7.7 String Literal Handling in Tests: JSON vs Rego String Semantics
:::

::: common-mistake
id: BLK-698947aa7bfd5b86
summary: 7.9.1 The Case Sensitivity Trap.
digest: 8e9b5fd9f2cd2558a1b37b98a92f4332111710b07e8563a8b5e56e5aefd1988b
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
7.9.1 The Case Sensitivity Trap
:::

::: common-mistake
id: BLK-12c670283b218471
summary: Common Pitfalls: Variable Scoping & Safety 4.X Common Pitfalls: Variable Scoping & Safety.
digest: 7dfe5c7fd390b5024e8c39262af42a3ed37bc383ca54858c9a8d057f8fb889ac
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Common Pitfalls: Variable Scoping & Safety 4.X Common Pitfalls: Variable Scoping & Safety
:::

::: common-mistake
id: BLK-dd2368c95d175c31
summary: Pitfall 1: Accidental Variable Shadowing.
digest: a2d3ff21eb411a35df4c8d9405db921db04bb2ce42bf98305cbfdcc4378bdf69
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 1: Accidental Variable Shadowing
:::

::: common-mistake
id: BLK-ba9a0ebe18957928
summary: Pitfall 2: Unsafe Variables in Rules.
digest: f63aab2fcce6645d74a1dc3e006d980f7a8f7226f61fdb11ed3460e8380a2e04
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 2: Unsafe Variables in Rules
:::

::: common-mistake
id: BLK-09947c35894f257f
summary: A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body.
digest: 0df172f31b355620d4fe16fd88a770fff83fa6e1f652a372de7d773d25e295fd
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body.
:::

::: common-mistake
id: BLK-d98f97c6793e5ee8
summary: Pitfall 3: Misusing some in Comprehensions.
digest: cd1ce7fe1fbbd078a936096a24f9ed0672c5cafb42cdf3906d2fce948b5e0776
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 3: Misusing some in Comprehensions
:::

::: common-mistake
id: BLK-0462888a4dbfb353
summary: # ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices bad if { some i arr[i] == "a" some i arr[i] == "b" }.
digest: 1f525f06a8232825809110a9c8879a22a15c4a82d076dce0e182d4b5f79f991e
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices bad if { some i arr[i] == "a" some i arr[i] == "b" }
:::

::: common-mistake
id: BLK-1040e7752fd74e64
summary: Pitfall 4: Assuming Global State in Rules.
digest: 6a6249086769b0b91c56102e77e970a981c0a340ad19d238f44a5796a696105e
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 4: Assuming Global State in Rules
:::

::: common-mistake
id: BLK-1eebddc2ae2256d2
summary: # ‚ùå Misleading mental model: this does not "increment" anything counter := counter + 1 if { ..
digest: 0102c967a849e92a6c48e9bcc05b0ae28bb851dde0cd88e86b2d7c3bbed044aa
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Misleading mental model: this does not "increment" anything counter := counter + 1 if { ... } # invalid and unsafe
:::

::: common-mistake
id: BLK-729a9fcd5572a97e
summary: Chapter 6 ‚Äì Common Pitfalls: Nulls, Missing Fields, and Type Guards 6.X Common Pitfalls: Nulls, Missing Fields, and Type Guards.
digest: 022163f168cdfd98c7052023eeace96f8ab26f79c4ad8d42088dfef6e234a724
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Chapter 6 ‚Äì Common Pitfalls: Nulls, Missing Fields, and Type Guards 6.X Common Pitfalls: Nulls, Missing Fields, and Type Guards
:::

::: common-mistake
id: BLK-8f3c429e92d14caa
summary: Pitfall 1: Accessing Missing Fields Directly.
digest: 25145834f3cc5d374e91bbf7c4ac39657628686a17d40b2cee06f91a0c79b6a0
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 1: Accessing Missing Fields Directly
:::

::: common-mistake
id: BLK-8d49bd98cea35156
summary: # ‚ùå Panics if input.user is null or missing email := input.user.email.
digest: 1dedf7af7c0197dd7e1bcd8677606876db045630f19b87d9910a871768271566
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Panics if input.user is null or missing email := input.user.email
:::

::: common-mistake
id: BLK-c8f90fb1fd5c7a7c
summary: Pitfall 2: Null vs Missing vs Falsy.
digest: 6d12260b1d7e6df044f6fcea70260ae2c662092f4184cc49e416582a2f224c85
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 2: Null vs Missing vs Falsy
:::

::: common-mistake
id: BLK-f8ec56bf27309156
summary: Pitfall 3: Using array.concat on Non-Arrays.
digest: 53207b88093a3bd8d0b7566bb9d0bb87acc091cdfb68c1274ab0f8cf0df53d12
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 3: Using array.concat on Non-Arrays
:::

::: common-mistake
id: BLK-bb3e0508397aa2ad
summary: # ‚ùå Panics if path is null or not an array full := concat(".", array.concat(path, [field])).
digest: 329a7d2cb13a0668052a2bd4a25c0b9b764cd758cb0672e217bc6d3602981f8a
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Panics if path is null or not an array full := concat(".", array.concat(path, [field]))
:::

::: common-mistake
id: BLK-0f33462feb34e48a
summary: Pitfall 4: Equality Checks with Mixed Types.
digest: 6463d0f4a93d113ebbbc2e1a0ae0ef5b47787fea35ca737bd8a1c92963cddadf
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 4: Equality Checks with Mixed Types
:::

::: common-mistake
id: BLK-330f79b92b8aba7c
summary: # ‚ùå May silently fail if left/right have different types allowed if input.user.id == data.allowed_ids[_].
digest: 5443af728d68cfb5fd37f6124097fe6b5fa0e8d9435cf1155712b811017bdae3
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå May silently fail if left/right have different types allowed if input.user.id == data.allowed_ids[_]
:::

::: common-mistake
id: BLK-5ed33926d8aec1d7
summary: Pitfall 5: Assuming in Works Like SQL for All Types.
digest: 1da396d0ec9a3dfa3f69a9707988f4847104cfa83de3cd3eeb7625f903f8a7f4
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 5: Assuming in Works Like SQL for All Types
:::

::: common-mistake
id: BLK-76c27d5ad47d6dd3
summary: Chapter 11 ‚Äì Common Pitfalls: Performance Anti-Patterns 11.X Common Pitfalls: Performance Anti-Patterns.
digest: e10b8c1f4f69f121a72168e68b052ba776e8c604f0b3c139906d2fdf1b7472f1
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Chapter 11 ‚Äì Common Pitfalls: Performance Anti-Patterns 11.X Common Pitfalls: Performance Anti-Patterns
:::

::: common-mistake
id: BLK-d4c141e7faf930a8
summary: Pitfall 1: Unbounded Linear Scans on Huge Collections.
digest: 3cd0e0a78abd3b5d1d75bc073f89c4b9adcecca3d26dfe94c929ad6e91551911
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 1: Unbounded Linear Scans on Huge Collections
:::

::: common-mistake
id: BLK-69f70113ccbfdbaf
summary: # ‚ùå Potentially O(N) scan on large data set every request deny if { some i data.events[i].ip == input.client_ip }.
digest: 83b9ef5a06e9e889a9d7617641fea5ca14344744f2c344fc41e34ecc4fd07be9
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Potentially O(N) scan on large data set every request deny if { some i data.events[i].ip == input.client_ip }
:::

::: common-mistake
id: BLK-56eee991d49f2f74
summary: Pitfall 2: Heavy Regex in Hot Paths.
digest: 48dee515485bf35d901c8f3c577fa98c66af41c88af75806ee1b244a30600ae2
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 2: Heavy Regex in Hot Paths
:::

::: common-mistake
id: BLK-71badd79374ac20d
summary: # ‚ùå Expensive regex on every request deny if re_match(".*(admin|root).*", input.user.name).
digest: 4ae07157c1d694b741958ba5bbd9b45bc71222a5574ff31728001f852fc23d34
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Expensive regex on every request deny if re_match(".*(admin|root).*", input.user.name)
:::

::: common-mistake
id: BLK-5cf9708436f56691
summary: Pitfall 3: Recomputing the Same Expression Repeatedly.
digest: a4f30604de3a4a55822b67d9369faff69f700d691bd6a1244acc8e2c5a6b0ecf
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 3: Recomputing the Same Expression Repeatedly
:::

::: common-mistake
id: BLK-8c26af7bbbb8934f
summary: # ‚ùå Recomputes parse for each use deny if { re_match("admin", input.user.name) some p in data.profiles re_match("admin", input.user.name) # repeate...
digest: da45824d995a80dc3b26f89cea8222cea462160e84dd602a867e3f0e4f1677fc
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå Recomputes parse for each use deny if { re_match("admin", input.user.name) some p in data.profiles re_match("admin", input.user.name) # repeated }
:::

::: common-mistake
id: BLK-ee24a61881531dd4
summary: Pitfall 4: Ignoring Partial Evaluation Opportunities.
digest: 08e800336c564e123d6e4d16f3b1c9c03554a0bbb3c1f87e679f0b0e6167dc27
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
semantic_categories: [performance]
chapter: CH-05
:::
Pitfall 4: Ignoring Partial Evaluation Opportunities
:::

::: common-mistake
id: BLK-a93ea38f3eeb27c0
summary: # ‚ùå CLI call with huge static config in input opa eval -d policies/ -i big_config.json 'data.authz.allow'.
digest: f1cf291cd1d34e524ea6d289de139604a5c77cfaecb511da731bc83ee59bcd25
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå CLI call with huge static config in input opa eval -d policies/ -i big_config.json 'data.authz.allow'
:::

::: common-mistake
id: BLK-d8b81e49338056c4
summary: Pitfall 5: Overusing walk on Large Trees.
digest: 09b2a0473233b33fd8c6635dab416c014fe0239499493d902c0c27657ab5041d
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
Pitfall 5: Overusing walk on Large Trees
:::

::: common-mistake
id: BLK-f730628e59f13a75
summary: # ‚ùå walk(data) over a huge universe deny if { some path, value walk(data, [path, value]) value == "secret" }.
digest: b117bb7c913497d9fb15f1a5878e12a91d39437d95d96c6e4312f94598d90bcd
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
# ‚ùå walk(data) over a huge universe deny if { some path, value walk(data, [path, value]) value == "secret" }
:::

::: common-mistake
id: BLK-afce364a62b525b6
summary: If [ -n "$unused" ]; then echo "‚ùå Unused imports detected:" echo "$unused" exit 1 fi.
digest: 1ce9fd8c91df104acfe7447abcf054cfe83dbcc5b9663caee4cd5fc0615a3fd4
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
if [ -n "$unused" ]; then echo "‚ùå Unused imports detected:" echo "$unused" exit 1 fi
:::

::: common-mistake
id: BLK-1e1f5439ddf1252a
summary: And the moment two rule names collide, OPA will throw a conflict or silently evaluate the wrong rule ‚Äî both are terrible in production policy systems.
digest: 3c9893c379e9b5aba5de5dc8148b3c03547ab2a612a9567686f8c40847f76a07
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
And the moment two rule names collide, OPA will throw a conflict or silently evaluate the wrong rule ‚Äî both are terrible in production policy systems.
:::

::: common-mistake
id: BLK-be2d957171219dc8
summary: Worse: OPA selects the wrong one depending on rule type.
digest: 4491e4de16a41bd32f0e3ee082dffccb7a068e416238f06ed320c59e0a02ac43
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
worse: OPA selects the wrong one depending on rule type.
:::

::: common-mistake
id: BLK-3ddf8d1dfd449b3b
summary: üß† The Better Fix (What I Would Do) ‚ùå Instead of removing the import ‚úîÔ∏è Fix the test to use the import explicitly import data.compliance.tech_debt.
digest: 7b3eba79b0bcfcf5f7561365edd904348310f0b72c911da5900bf133eed58347
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
üß† The Better Fix (What I Would Do) ‚ùå Instead of removing the import ‚úîÔ∏è Fix the test to use the import explicitly import data.compliance.tech_debt
:::

::: common-mistake
id: BLK-e5a06967afb6c7a8
summary: ‚ùå But in Rego test files, a string such as: "diff": "+ // TODO:\n+ function getUsers() {".
digest: af524623e8718e26567ee8d03e8f9abe79f3f56a88ce8719235d3111666c4421
symbol_refs: []
semantic_role: content
embedding_hint_importance: high
embedding_hint_scope: section
embedding_hint_chunk: auto
code_smell_probability: 0.8
pattern_role: anti-pattern
severity: high
chapter: CH-05
:::
‚ùå But in Rego test files, a string such as: "diff": "+ // TODO:\n+ function getUsers() {"
:::

::: constraint
id: CONSTR-d28f2f165c62dac0
chapter: CH-05
source_id: TERM-61b8c1a83d1cdbdd
type: forbidden
digest: e168f29f55b62a0a99532bc004791ab66517457d63888366194329aa7ad65e58
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-d3f8623f7a28f38e
chapter: CH-05
source_id: PATTERN-eeb5c30a9b540572
type: forbidden
digest: f8168d429eb1717f357036059967eabd8be76593a9cf45eafca0706e6cc36e01
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-2c48fa71a14ef31b
chapter: CH-05
source_id: PATTERN-e80876fd79a2e88f
type: forbidden
digest: f0a3f2a77bf3c684aee19ada7e8b9f8d33c4fba730d7b174a4e08bfc9c6e7cfe
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-095d64f1e1b5277a
chapter: CH-05
source_id: PATTERN-7bab973cb8c529c8
type: forbidden
digest: be025c9f8b3e338d2cd19b4a12137b41c68424e6de41a7dff70f88ceff556d23
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-2ddb8f1b6f4813c3
chapter: CH-05
source_id: BLK-5c33fbfabf3e6fb4
type: forbidden
digest: 249ad52b6ea34ac86164350fa4ac08c38b597fae66b7a99b7c54a66a9748a46d
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-528dae81753118e8
chapter: CH-05
source_id: BLK-2a66a03314f167f4
type: forbidden
digest: 7f8534ee9284d898b5295303a958376cc365954959da6f61c344e43031141d4f
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-38ec50606b0147ea
chapter: CH-05
source_id: BLK-f0e250b1b329925b
type: forbidden
digest: 80196492d011b1795654336093b6db2c6deb4ff57f99538bd759e581acfebfc6
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-179efde805c30df0
chapter: CH-05
source_id: BLK-91f4730964a13670
type: forbidden
digest: 05d71e8e458088ac1d7b1efa02e88f0939d942ea467f67ddb531ea5e12f8ee1a
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-06109ba82f1d392a
chapter: CH-05
source_id: BLK-c10db066c498a48d
type: forbidden
digest: 436ec0f5e7254324e74124064b10a8f853177fb59f81499a1255c7853f13610f
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-54983b265a2a5d71
chapter: CH-05
source_id: BLK-3fe483d8d3a22e99
type: forbidden
digest: 6974755cedf10182a1c0675627440e2835fe490a136b7e604bf56f415b52a9c9
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-0172ffc24e0dc4fe
chapter: CH-05
source_id: BLK-28e58a316e04a314
type: forbidden
digest: fc10db32093ec412ee0e8f5774e78435cd6df8e4f137f5d735b7c2ccd4ac378c
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-c09635ff7ee4cbcf
chapter: CH-05
source_id: BLK-8a79fd9ce8c38157
type: forbidden
digest: b201e962a97927f19f78e3e8db7b8b4f86ba0255c55163b6186fda05b885881d
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-ba76a2525da5cc61
chapter: CH-05
source_id: BLK-c191fd1bb522212a
type: forbidden
digest: 6ba1ffe2571de85f8783fc403edf0d6c7a255b465ef25f736df9e2fda7659017
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-d53e8db5772a5db4
chapter: CH-05
source_id: BLK-a6ad7c1547585e40
type: forbidden
digest: 8b435ac53351320166e34fc2df4ba826d1bc3a21ba7452c015e390cdadad6599
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-7227e864d86f47b6
chapter: CH-05
source_id: BLK-67a3905c24c8c0ec
type: forbidden
digest: 6d26a267c562f99dfc25df9126811082b8458c63b58410a46edb4e880c5cc814
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-e8f43931bf392f66
chapter: CH-05
source_id: BLK-9124fbb631e1cbb3
type: forbidden
digest: 9291c0e5df58add497ff747fba070af3bb86a90c35c820a01c90800e96676bab
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-3cb74601340be819
chapter: CH-05
source_id: BLK-4bbc8cdf4775092d
type: forbidden
digest: cae119e7453e65c979343d9fee921cd8d6ab8d4429c3040c72b2091501205746
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-0e3318e4c2d54309
chapter: CH-05
source_id: BLK-95ca2e72cd741b4e
type: forbidden
digest: 891e8ff9384d166541b26db68357490e7d395adb8091b3aad0cf062b63db67d8
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-9c5ac45fb0e767db
chapter: CH-05
source_id: BLK-c769e5e37ddda8d1
type: forbidden
digest: 4b583f63e7dd02c8feba647c8db6fdf31602b5fca702147b7d6fe42d9ddba3de
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-b6f9242cd0d05d4c
chapter: CH-05
source_id: BLK-4a3213cba6c14203
type: forbidden
digest: 58359f3a8ce25c114da2b11766edba9d8cace62fa5915e4ccf305809285d9303
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-e78205c86f837e3d
chapter: CH-05
source_id: BLK-5034a2914309672a
type: forbidden
digest: e013c1ae4df5b325240c69903ac3203866648e01e4a7d685e2a87e6b32006560
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-13d33766e0c80d9e
chapter: CH-05
source_id: BLK-475ae3ca4b662fcb
type: forbidden
digest: 7e2a6cd105209c64870c1f6590512978afa733e55950eb20abe721e4196fdca6
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-967d5bbadc820b53
chapter: CH-05
source_id: TABLE-f3829f7c85d60ef1
type: forbidden
digest: d1f86c75c910888cc30885d996d2fa71dd8c0ee51761fe6fedb6bbbc9ec5bf4a
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-03983ac6752e2997
chapter: CH-05
source_id: QA-737bdab9db1fb017
type: forbidden
digest: 6b6ea360f283e2e97024e215b5fea2b62e98845a420c7d31be979f1f4ebb372e
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-86bcb8e51c5f3625
chapter: CH-05
source_id: QA-abf515b8767b21fc
type: forbidden
digest: 9b9a649e58df2098d792702dd591cd27d1cca421c56db1f301988c6c419e574d
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-6971c8785f91db52
chapter: CH-05
source_id: QA-186a9be56ef551d7
type: forbidden
digest: b9293bcc94b3e871e35880f5de1e09aa84c49dd6621e3c3f1d2f836d62a5e077
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-09dba331014ca5d5
chapter: CH-05
source_id: QA-e5935045148c7443
type: forbidden
digest: 6a8232fdbf13d13a0f19b26210942acefbba137d102a40a859f802fa6b862d09
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-3b26d5538aa09837
chapter: CH-05
source_id: QA-59efe2f2581bd89e
type: forbidden
digest: d1b04fa8a8c2ceafa7d7711b8ec971d597696df7ceb31885f742609f058ca090
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-560ca0a0e6617f19
chapter: CH-05
source_id: QA-c764d1f8949edff9
type: forbidden
digest: 3eb727f658cc9df67d6dc591e4007d84c4ba955218fa9376b9a51b33286e797f
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-bf2afc4283d50321
chapter: CH-05
source_id: QA-848846e3f2787351
type: forbidden
digest: 91bfd51e344ed149866bb3f5344e6eb4855a9f4f382990f6943890b600ab4dff
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-22a8807f141e4127
chapter: CH-05
source_id: QA-dc163354f44c10a4
type: forbidden
digest: 20ce78bc187a7066baa376c52ca8017a9ae2b3e000da2d8ac5e803ffe60eff85
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-28699f8fe034ee6d
chapter: CH-05
source_id: QA-38d7ac0e2f05e9dd
type: forbidden
digest: 333d862258c458bbea68575f495fda6adf2491a0d9cfa8e4273dbbf97ffed4b2
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-3edec3de3f27d583
chapter: CH-05
source_id: QA-c2838838731185f3
type: forbidden
digest: fbf17e1be6e70b7744d77e2f1046484d1bcf0febd8aa1ebb8cabcc30d78052df
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-0c70c6ecf60540d9
chapter: CH-05
source_id: QA-10ab36e82365fc36
type: forbidden
digest: c1f733ffd2d4844590ad7804807a5ed5dcfc1295a221b4e529e9584ab5143b8d
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-64a399b8d94aeb9f
chapter: CH-05
source_id: QA-6272ccb95212f2be
type: forbidden
digest: b27d9d0cfe78e3fadf4a63fe8185cfcb68687c81bd0b08fe0b2f1a082aee7836
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-f5d1ca9a2c04ca85
chapter: CH-05
source_id: QA-f7db536897806d0b
type: forbidden
digest: 1bf9747ac01bee36283eb93dd22fbacf0431fe8fd5bbe040eaa44049a22f866f
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-25a25cef2aa4df37
chapter: CH-05
source_id: QA-1e74e8a490a8466c
type: forbidden
digest: 60af726526eb2042632bbf7da8a521a0bf3fab767f393f4fe6567479ceda0126
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-e43a05336e78a5fe
chapter: CH-05
source_id: QA-14a094962c22fad3
type: forbidden
digest: 82c07faf872ecb6ed1a90ae9811f6e13b8ad6a9fd53cbb8ed3e15c9ed35428e6
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-33d882a7b0de95e1
chapter: CH-05
source_id: QA-cb98d63feb21da33
type: forbidden
digest: af1987d3b7dc25eb15d4292167a729dcc3ef69ae6802e5ce9913cb02d19b5941
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-4beaccd319eb3038
chapter: CH-05
source_id: QA-5df89b9fa75533d3
type: forbidden
digest: 18002dab32dfbf7544fcbd16035837b1bcff1ec1f82fa6b3ed1c7166cdff4ebc
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: constraint
id: CONSTR-dc3fdd02e167249f
chapter: CH-05
source_id: QA-e6b81a0c8ee06356
type: forbidden
digest: 2103a9ffa00582b5c8de1ddd10945c54c9cf15c521d1cbe6c8039f08f97e03c3
symbol_refs: []
semantic_role: content
:::
This block describes a forbidden or disallowed behavior.
:::

::: table
id: TABLE-f3829f7c85d60ef1
chapter: CH-05
type: dos-donts
headers: [Do, Don't]
rows: [['Metadata & Introspection: rego.metadata.rule, rego.metadata.chain.', 'Pitfall: contains is substring, not set membership (for that use in).'], ['# All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }.', '6.24 Design Patterns & Anti-Patterns.'], ['OPA has no direct a[1:3] slicing syntax; use array.slice.', "Explain modes opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow' opa eval --explain=full ..."], ['Rego sets are unordered, unique collections.', '7.9.1 The Case Sensitivity Trap.'], ['Rego strings are Unicode text; built-ins operate on code points (not bytes).', 'Common Pitfalls: Variable Scoping & Safety 4.X Common Pitfalls: Variable Scoping & Safety.'], ['# May not work in all OPA versions is_hex if regex.match(^[0-9a-fA-F]+$, input.value).', 'Pitfall 1: Accidental Variable Shadowing.'], ['Best Practice: Always use double-quoted strings with escaped backslashes for regex patterns.', 'Pitfall 2: Unsafe Variables in Rules.'], ['When to Use Raw Strings: - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline c...', 'A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body.'], ['Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target...', 'Pitfall 3: Misusing some in Comprehensions.'], ['Always guard access to optional or potentially missing input fields:.', '# ‚ùå Over-constrained: \'some i\' appears twice, but you really wanted two different indices bad if { some i arr[i] == "a" some i arr[i] == "b" }.'], ['Common Patterns: - Check is_string() before contains(), startswith(), endswith() - Check is_array() before iteration with some ..', 'Pitfall 4: Assuming Global State in Rules.'], ['Never bake secrets into Rego source; pass via data or environment.', '# ‚ùå Misleading mental model: this does not "increment" anything counter := counter + 1 if { ..'], ['6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs).', 'Chapter 6 ‚Äì Common Pitfalls: Nulls, Missing Fields, and Type Guards 6.X Common Pitfalls: Nulls, Missing Fields, and Type Guards.'], ['Both arguments must be arrays.', 'Pitfall 1: Accessing Missing Fields Directly.'], ['If either argument is null (or not an array), OPA raises a type error.', '# ‚ùå Panics if input.user is null or missing email := input.user.email.'], ['Important corrections:.', 'Pitfall 2: Null vs Missing vs Falsy.'], ['There is no standard time.diff builtin in OPA.', 'Pitfall 3: Using array.concat on Non-Arrays.'], ['Test_http_policy if { result := policy.check with http.send as mock_http_send }.', '# ‚ùå Panics if path is null or not an array full := concat(".", array.concat(path, [field])).'], ['Rego exposes rule metadata at evaluation time:.', 'Pitfall 4: Equality Checks with Mixed Types.'], ['Rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain.', '# ‚ùå May silently fail if left/right have different types allowed if input.user.id == data.allowed_ids[_].'], ['Enrich decision logs with rule IDs, owners, severity.', 'Pitfall 5: Assuming in Works Like SQL for All Types.'], ['Deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }.', 'Chapter 11 ‚Äì Common Pitfalls: Performance Anti-Patterns 11.X Common Pitfalls: Performance Anti-Patterns.'], ['Print is the primary debugging tool for Rego:.', 'Pitfall 1: Unbounded Linear Scans on Huge Collections.'], ['Debug_rule if { x := input.value print("The value of x is:", x) x > 10 }.', '# ‚ùå Potentially O(N) scan on large data set every request deny if { some i data.events[i].ip == input.client_ip }.'], ['Output appears in OPA logs or opa eval --explain trace output depending on environment.', 'Pitfall 2: Heavy Regex in Hot Paths.'], ['# If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }.', '# ‚ùå Expensive regex on every request deny if re_match(".*(admin|root).*", input.user.name).'], ['Opa eval --strict-builtin-errors ...', 'Pitfall 3: Recomputing the Same Expression Repeatedly.'], ['Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere.', '# ‚ùå Recomputes parse for each use deny if { re_match("admin", input.user.name) some p in data.profiles re_match("admin", input.user.name) # repeate...'], ['Canonicalization: Always lowercase/trim user-identifiers before comparison.', 'Pitfall 4: Ignoring Partial Evaluation Opportunities.'], ['Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ...', "# ‚ùå CLI call with huge static config in input opa eval -d policies/ -i big_config.json 'data.authz.allow'."], ['Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which...', 'Pitfall 5: Overusing walk on Large Trees.'], ['# All tests in current tree opa test .', '# ‚ùå walk(data) over a huge universe deny if { some path, value walk(data, [path, value]) value == "secret" }.'], ['# Verbose (see individual test names) opa test.', 'If [ -n "$unused" ]; then echo "‚ùå Unused imports detected:" echo "$unused" exit 1 fi.'], ['# Specific path or file opa test policies/ authz_test.rego.', 'And the moment two rule names collide, OPA will throw a conflict or silently evaluate the wrong rule ‚Äî both are terrible in production policy systems.'], ['Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"i...', 'Worse: OPA selects the wrong one depending on rule type.'], ['# in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }.', 'üß† The Better Fix (What I Would Do) ‚ùå Instead of removing the import ‚úîÔ∏è Fix the test to use the import explicitly import data.compliance.tech_debt.'], ['7.3 Golden Tests & File I/O (Corrected).', '‚ùå But in Rego test files, a string such as: "diff": "+ // TODO:\\n+ function getUsers() {".'], ['Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.).', ''], ['Populate data.tests["pr_large"] before invoking opa test or the OPA SDK.', ''], ['Rego: pure data and rules; no file system.', ''], ['A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files.', ''], ['JSON Input (via opa eval --input):.', ''], ['In JSON, \\n is interpreted as an actual newline character during JSON parsing.', ''], ['Rego Test File (inline string literal):.', ''], ["In Rego test files, \\n within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'.", ''], ['Symptoms: - Tests fail with opa test but pass with opa eval --input <json-file> - Regex patterns that work with JSON inputs fail in test files - Mu...', ''], ['Best Practice: When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavio...', ''], ['The evaluation context of with clauses in tests can affect how rule results are accessed.', ''], ['When a rule returns a set (partial rule with contains), accessing elements requires proper iteration:.', ''], ['7.8.3 Rule Precedence and Overlapping Conditions.', ''], ['When multiple rules can match the same input, understanding evaluation order is critical for test design.', ''], ['Problem: Overlapping Rule Conditions.', ''], ['Best Practice: Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered).', ''], ["String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations.", ''], ['Option 2: Policy-Level Normalization (Recommended for Production).', ''], ['Option 3: Explicit Case Variants in Policy.', ''], ['Best Practice: For production policies, prefer normalization (Option 2) to handle case variations gracefully.', ''], ['Decision rule: data.envoy.authz.allow.', ''], ['Bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundl...', ''], ['Allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset...', ''], ['Allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package.', ''], ['Name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa.', ''], ['Name: Check formatting run: opa fmt --fail .', ''], ['Name: Lint (Regal) run: regal lint --format=github.', ''], ['Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system.', ''], ['# Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as ...', ''], ["# Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/.", ''], ["# Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/.", ''], ['An optimized bundle (policy + data),.', ''], ['Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint.', ''], ["Opa eval --partial \\ -d policies/ \\ 'data.authz.allow'.", ''], ['Returns residual policy expressions capturing unknowns,.', ''], ['Opa build -t wasm ..', ''], ['Opa build ..', ''], ['Opa eval --partial ..', ''], ['Require that cycles with negation are disallowed or handled carefully.', ''], ["Key points: P^'is smaller and more specialized.", ''], ['Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owner...', ''], ['__meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVE...', ''], ['Deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Clo...', ''], ['__meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }.', ''], ['Effects[eff] if { eff := data.svc.accounts.rules.effects[_] }.', ''], ['Result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]].', ''], ['# Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so.', ''], ['Allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank.', ''], ['Allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________...', ''], ['# decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden...', ''], ['OPA is logically stateless: every evaluation sees a snapshot of policy + data.', ''], ['OPA never mutates data.state.login_counts.', ''], ['Or an in-memory structure via the OPA Go SDK,.', ''], ['Or a shared cache that OPA reads from.', ''], ['OPA Policy ‚Üí reads data.state.* as a pure input.', ''], ['OPA remains a pure decision engine; all state transitions happen outside.', ''], ['OPA uses that state to decide: o Allow or deny new events.', ''], ['Allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing.', ''], ['16.2 Field Cost Calculation (Corrected array.concat).', ''], ['Corrections and nuances:.', ''], ['If either argument is null or non-array, OPA throws a type error, so in more defensive code:.', ''], ['‚Ä¢ Allows multiple services to enforce the same logic.', ''], ['Test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test .', ''], ['The full decision path for a typical OPA evaluation looks like this:.', ''], ['Flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[...', ''], ['Flowchart TD R[Request: input] --> OPA[OPA Engine].', ''], ['Subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end.', ''], ['OPA --> P PE --> D1[Optimized Policy Set].', ''], ['OPA can be deployed in three canonical modes: sidecar, central service, and embedded.', ''], ['Flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end.', ''], ['Subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end.', ''], ['Subgraph Embedded Library A3[App Process with OPA SDK] end.', ''], ['8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar].', ''], ['B[BUNDLE Server] --> OPA.', ''], ['Each app pod has its own OPA.', ''], ['8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE S...', ''], ['One or a few OPA instances serve many clients.', ''], ['8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP.', ''], ['OPA compiled to WASM or linked via Go library.', ''], ['Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\\n(org-wide baselines)] --> D[D...', ''], ['Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds).', ''], ['# Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent requ...', ''], ['# Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billin...', ''], ['Deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }.', ''], ['Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OP...', ''], ['Metrics (eval time, number of rules evaluated).', ''], ['Bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî...', ''], ['Revision is an opaque version string for debugging/rollback.', ''], ['Roots tell OPA which prefixes in data this bundle owns:.', ''], ['Authz ‚Üí data.authz.* (from authz.rego).', ''], ['# Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := gl...', ''], ['# Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.g...', ''], ['Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot]...', ''], ['Syntactic checks: opa fmt, opa check.', ''], ['Unit tests: opa test.', ''], ['Static analysis: internal style & safety rules.', ''], ['Staging OPA: run candidate policy against recorded traffic (shadow mode).', ''], ['Candidate Rego (generated by LLM):.', ''], ['Run opa fmt ‚Üí ensure style.', ''], ['Run opa check ‚Üí catch unknown refs, unsafe vars.', ''], ['Run opa test ‚Üí ensure behavior matches expectations.', ''], ['Rego‚Äôs scoping rules are simple but unforgiving.', ''], ['# ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }.', ''], ['Use opa check to detect this and refactor to ensure all head variables are always bound:.', ''], ['# ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }.', ''], ['Some x introduces a new variable local to the current expression.', ''], ['# ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }.', ''], ['Each rule evaluation is pure and has no hidden global state.', ''], ['Rego is strict about types, but JSON inputs are often messy.', ''], ['Always guard when reading from untrusted inputs:.', ''], ['# ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }.', ''], ['If input.user.id is a number and data.allowed_ids are strings, this will never match.', ''], ['Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins.', ''], ["# ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/.", ''], ['# ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }.', ''], ['Use opa fmt --skip-constraints (most reliable built-in).', ''], ['Opa fmt removes unused aliases but NOT unused imports.', ''], ['If u is never referenced, opa fmt will not remove it.', ''], ['Some versions of opa fmt will rewrite it to:.', ''], ['‚Ä¶and will not remove it.', ''], ['Use opa check --strict.', ''], ['Opa check --strict .', ''], ['Use Rego Linter Plugins (best solution).', ''], ['This is the closest to ESLint/flake8 for Rego.', ''], ['Use Styra DAS Rego Analyzer (if enterprise budget exists).', ''], ['Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:.', ''], ['Policy design smells.', ''], ['Use editor extensions (Cursor, VSCode, JetBrains).', ''], ['Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }.', ''], ['Then configure a custom linter rule using a regex:.', ''], ['Organizational best practice: Avoid wildcard imports.', ''], ['Always prefer small, explicit imports:.', ''], ['Recommended CI rule: Reject files containing unused imports.', ''], ['--format json | \\ jq -r \'.imports[] | select(.used == false) | .file + ":" + .path\').', ''], ['Opa inspect (which parses import graph).', ''], ['üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough...', ''], ['Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional).', ''], ['‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search.', ''], ['Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:.', ''], ['Conflicting when multiple packages define the same rule.', ''], ['Answer: The warn reference comes from the data tree, not from the import.', ''], ['üîç Full Explanation (What‚Äôs Happening Under the Hood) 1.', ''], ['Opa test services/opa/policies/ services/opa/tests/.', ''], ['Every .rego file from policies/ ‚Üí into the data tree.', ''], ['This means all rule names become visible under data.*.', ''], ['OPA resolves warn like this:.', ''], ['Search the global data tree for any rule named warn.', ''], ['The import is unused because OPA never needs the alias tech_debt to find the rule.', ''], ['This is how critical bugs enter policy codebases.', ''], ['üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports.', ''], ['Never rely on bare rule names:.', ''], ['The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused.', ''], ['OPA loads all policy packages in /policies/**.', ''], ['So the rule warn is available at:.', ''], ['OPA resolves bare rule names by doing a global search in data.', ''], ['Bare rule names (warn) are ambiguous.', ''], ['Becomes ambiguous and OPA may:.', ''], ['OPA test behavior depends on all loaded policies.', ''], ['Implicit resolution is one of the most common sources of bugs in OPA deployments.', ''], ['This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct...', ''], ['üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate.', ''], ['‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly.', ''], ['In test files, always use explicit package-qualified rule references:.', ''], ['Ambiguity Prevention: Multiple packages may define rules with common names (warn, deny, allow).', ''], ['Import rego.v1 import data.compliance.tech_debt # ‚Üê keep this.', ''], ['How your test diff strings are represented inside Rego test files.', ''], ['‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\\n+ function getUsers() {".', ''], ['‚Ä¶and OPA treats \\n as an actual newline because JSON escapes it as a newline character.', ''], ['Never see the newline, so they fail.', ''], ['__local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context.', ''], ['They are being accessed ‚Äî the content is just different from what your rules assume.', ''], ['But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context.', ''], ['Same issue: Your rule expects:.', ''], ['OPA evaluates the Rego test literal as:.', ''], ['The pattern never matches because whitespace escaping does NOT behave like in JSON.', ''], ['üß† Why direct opa eval --input JSON works.', ''], ['Because JSON ‚Üí OPA decoding translates \\n into real newlines.', ''], ['Rego test files do NOT.', ''], ['üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings.', ''], ['Rego supports multi-line raw strings:.', ''], ['This will perfectly match the policy expectations.', ''], ['‚úÖ Second Best Fix: Convert \\n to actual newline inside the test file.', ''], ['‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy.', ''], ['But this will add noise to all rules.', ''], ['‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs.', '']]
semantic_categories: [distribution, negation, observability, performance, testing]
digest: b6433a0a16f08b71c79173c9f4feaf1d11dbe1ef8436631eee846958265750f3
symbol_refs: []
semantic_role: architecture
:::
| Do | Don't |
| --- | --- |
| Metadata & Introspection: rego.metadata.rule, rego.metadata.chain. | Pitfall: contains is substring, not set membership (for that use in). |
| # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }. | 6.24 Design Patterns & Anti-Patterns. |
| OPA has no direct a[1:3] slicing syntax; use array.slice. | Explain modes opa eval --explain=notes -d policy.rego -i input.json 'data.authz.allow' opa eval --explain=full ... |
| Rego sets are unordered, unique collections. | 7.9.1 The Case Sensitivity Trap. |
| Rego strings are Unicode text; built-ins operate on code points (not bytes). | Common Pitfalls: Variable Scoping & Safety 4.X Common Pitfalls: Variable Scoping & Safety. |
| # May not work in all OPA versions is_hex if regex.match(^[0-9a-fA-F]+$, input.value). | Pitfall 1: Accidental Variable Shadowing. |
| Best Practice: Always use double-quoted strings with escaped backslashes for regex patterns. | Pitfall 2: Unsafe Variables in Rules. |
| When to Use Raw Strings: - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline c... | A variable is unsafe if it‚Äôs used in a rule head or expression but not bound on all paths in the body. |
| Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target... | Pitfall 3: Misusing some in Comprehensions. |
| Always guard access to optional or potentially missing input fields:. | # ‚ùå Over-constrained: 'some i' appears twice, but you really wanted two different indices bad if { some i arr[i] == "a" some i arr[i] == "b" }. |
| Common Patterns: - Check is_string() before contains(), startswith(), endswith() - Check is_array() before iteration with some .. | Pitfall 4: Assuming Global State in Rules. |
| Never bake secrets into Rego source; pass via data or environment. | # ‚ùå Misleading mental model: this does not "increment" anything counter := counter + 1 if { .. |
| 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs). | Chapter 6 ‚Äì Common Pitfalls: Nulls, Missing Fields, and Type Guards 6.X Common Pitfalls: Nulls, Missing Fields, and Type Guards. |
| Both arguments must be arrays. | Pitfall 1: Accessing Missing Fields Directly. |
| If either argument is null (or not an array), OPA raises a type error. | # ‚ùå Panics if input.user is null or missing email := input.user.email. |
| Important corrections:. | Pitfall 2: Null vs Missing vs Falsy. |
| There is no standard time.diff builtin in OPA. | Pitfall 3: Using array.concat on Non-Arrays. |
| Test_http_policy if { result := policy.check with http.send as mock_http_send }. | # ‚ùå Panics if path is null or not an array full := concat(".", array.concat(path, [field])). |
| Rego exposes rule metadata at evaluation time:. | Pitfall 4: Equality Checks with Mixed Types. |
| Rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain. | # ‚ùå May silently fail if left/right have different types allowed if input.user.id == data.allowed_ids[_]. |
| Enrich decision logs with rule IDs, owners, severity. | Pitfall 5: Assuming in Works Like SQL for All Types. |
| Deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }. | Chapter 11 ‚Äì Common Pitfalls: Performance Anti-Patterns 11.X Common Pitfalls: Performance Anti-Patterns. |
| Print is the primary debugging tool for Rego:. | Pitfall 1: Unbounded Linear Scans on Huge Collections. |
| Debug_rule if { x := input.value print("The value of x is:", x) x > 10 }. | # ‚ùå Potentially O(N) scan on large data set every request deny if { some i data.events[i].ip == input.client_ip }. |
| Output appears in OPA logs or opa eval --explain trace output depending on environment. | Pitfall 2: Heavy Regex in Hot Paths. |
| # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }. | # ‚ùå Expensive regex on every request deny if re_match(".*(admin|root).*", input.user.name). |
| Opa eval --strict-builtin-errors ... | Pitfall 3: Recomputing the Same Expression Repeatedly. |
| Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere. | # ‚ùå Recomputes parse for each use deny if { re_match("admin", input.user.name) some p in data.profiles re_match("admin", input.user.name) # repeate... |
| Canonicalization: Always lowercase/trim user-identifiers before comparison. | Pitfall 4: Ignoring Partial Evaluation Opportunities. |
| Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ... | # ‚ùå CLI call with huge static config in input opa eval -d policies/ -i big_config.json 'data.authz.allow'. |
| Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which... | Pitfall 5: Overusing walk on Large Trees. |
| # All tests in current tree opa test . | # ‚ùå walk(data) over a huge universe deny if { some path, value walk(data, [path, value]) value == "secret" }. |
| # Verbose (see individual test names) opa test. | If [ -n "$unused" ]; then echo "‚ùå Unused imports detected:" echo "$unused" exit 1 fi. |
| # Specific path or file opa test policies/ authz_test.rego. | And the moment two rule names collide, OPA will throw a conflict or silently evaluate the wrong rule ‚Äî both are terrible in production policy systems. |
| Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"i... | Worse: OPA selects the wrong one depending on rule type. |
| # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }. | üß† The Better Fix (What I Would Do) ‚ùå Instead of removing the import ‚úîÔ∏è Fix the test to use the import explicitly import data.compliance.tech_debt. |
| 7.3 Golden Tests & File I/O (Corrected). | ‚ùå But in Rego test files, a string such as: "diff": "+ // TODO:\n+ function getUsers() {". |
| Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.). |  |
| Populate data.tests["pr_large"] before invoking opa test or the OPA SDK. |  |
| Rego: pure data and rules; no file system. |  |
| A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files. |  |
| JSON Input (via opa eval --input):. |  |
| In JSON, \n is interpreted as an actual newline character during JSON parsing. |  |
| Rego Test File (inline string literal):. |  |
| In Rego test files, \n within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'. |  |
| Symptoms: - Tests fail with opa test but pass with opa eval --input <json-file> - Regex patterns that work with JSON inputs fail in test files - Mu... |  |
| Best Practice: When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavio... |  |
| The evaluation context of with clauses in tests can affect how rule results are accessed. |  |
| When a rule returns a set (partial rule with contains), accessing elements requires proper iteration:. |  |
| 7.8.3 Rule Precedence and Overlapping Conditions. |  |
| When multiple rules can match the same input, understanding evaluation order is critical for test design. |  |
| Problem: Overlapping Rule Conditions. |  |
| Best Practice: Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered). |  |
| String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations. |  |
| Option 2: Policy-Level Normalization (Recommended for Production). |  |
| Option 3: Explicit Case Variants in Policy. |  |
| Best Practice: For production policies, prefer normalization (Option 2) to handle case variations gracefully. |  |
| Decision rule: data.envoy.authz.allow. |  |
| Bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundl... |  |
| Allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset... |  |
| Allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package. |  |
| Name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa. |  |
| Name: Check formatting run: opa fmt --fail . |  |
| Name: Lint (Regal) run: regal lint --format=github. |  |
| Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system. |  |
| # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as ... |  |
| # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/. |  |
| # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/. |  |
| An optimized bundle (policy + data),. |  |
| Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint. |  |
| Opa eval --partial \ -d policies/ \ 'data.authz.allow'. |  |
| Returns residual policy expressions capturing unknowns,. |  |
| Opa build -t wasm .. |  |
| Opa build .. |  |
| Opa eval --partial .. |  |
| Require that cycles with negation are disallowed or handled carefully. |  |
| Key points: P^'is smaller and more specialized. |  |
| Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owner... |  |
| __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVE... |  |
| Deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Clo... |  |
| __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }. |  |
| Effects[eff] if { eff := data.svc.accounts.rules.effects[_] }. |  |
| Result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]]. |  |
| # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so. |  |
| Allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank. |  |
| Allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________... |  |
| # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden... |  |
| OPA is logically stateless: every evaluation sees a snapshot of policy + data. |  |
| OPA never mutates data.state.login_counts. |  |
| Or an in-memory structure via the OPA Go SDK,. |  |
| Or a shared cache that OPA reads from. |  |
| OPA Policy ‚Üí reads data.state.* as a pure input. |  |
| OPA remains a pure decision engine; all state transitions happen outside. |  |
| OPA uses that state to decide: o Allow or deny new events. |  |
| Allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing. |  |
| 16.2 Field Cost Calculation (Corrected array.concat). |  |
| Corrections and nuances:. |  |
| If either argument is null or non-array, OPA throws a type error, so in more defensive code:. |  |
| ‚Ä¢ Allows multiple services to enforce the same logic. |  |
| Test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test . |  |
| The full decision path for a typical OPA evaluation looks like this:. |  |
| Flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[... |  |
| Flowchart TD R[Request: input] --> OPA[OPA Engine]. |  |
| Subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end. |  |
| OPA --> P PE --> D1[Optimized Policy Set]. |  |
| OPA can be deployed in three canonical modes: sidecar, central service, and embedded. |  |
| Flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end. |  |
| Subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end. |  |
| Subgraph Embedded Library A3[App Process with OPA SDK] end. |  |
| 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar]. |  |
| B[BUNDLE Server] --> OPA. |  |
| Each app pod has its own OPA. |  |
| 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE S... |  |
| One or a few OPA instances serve many clients. |  |
| 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP. |  |
| OPA compiled to WASM or linked via Go library. |  |
| Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[D... |  |
| Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds). |  |
| # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent requ... |  |
| # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billin... |  |
| Deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }. |  |
| Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OP... |  |
| Metrics (eval time, number of rules evaluated). |  |
| Bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî... |  |
| Revision is an opaque version string for debugging/rollback. |  |
| Roots tell OPA which prefixes in data this bundle owns:. |  |
| Authz ‚Üí data.authz.* (from authz.rego). |  |
| # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := gl... |  |
| # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.g... |  |
| Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot]... |  |
| Syntactic checks: opa fmt, opa check. |  |
| Unit tests: opa test. |  |
| Static analysis: internal style & safety rules. |  |
| Staging OPA: run candidate policy against recorded traffic (shadow mode). |  |
| Candidate Rego (generated by LLM):. |  |
| Run opa fmt ‚Üí ensure style. |  |
| Run opa check ‚Üí catch unknown refs, unsafe vars. |  |
| Run opa test ‚Üí ensure behavior matches expectations. |  |
| Rego‚Äôs scoping rules are simple but unforgiving. |  |
| # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }. |  |
| Use opa check to detect this and refactor to ensure all head variables are always bound:. |  |
| # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }. |  |
| Some x introduces a new variable local to the current expression. |  |
| # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }. |  |
| Each rule evaluation is pure and has no hidden global state. |  |
| Rego is strict about types, but JSON inputs are often messy. |  |
| Always guard when reading from untrusted inputs:. |  |
| # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }. |  |
| If input.user.id is a number and data.allowed_ids are strings, this will never match. |  |
| Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins. |  |
| # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/. |  |
| # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }. |  |
| Use opa fmt --skip-constraints (most reliable built-in). |  |
| Opa fmt removes unused aliases but NOT unused imports. |  |
| If u is never referenced, opa fmt will not remove it. |  |
| Some versions of opa fmt will rewrite it to:. |  |
| ‚Ä¶and will not remove it. |  |
| Use opa check --strict. |  |
| Opa check --strict . |  |
| Use Rego Linter Plugins (best solution). |  |
| This is the closest to ESLint/flake8 for Rego. |  |
| Use Styra DAS Rego Analyzer (if enterprise budget exists). |  |
| Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:. |  |
| Policy design smells. |  |
| Use editor extensions (Cursor, VSCode, JetBrains). |  |
| Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }. |  |
| Then configure a custom linter rule using a regex:. |  |
| Organizational best practice: Avoid wildcard imports. |  |
| Always prefer small, explicit imports:. |  |
| Recommended CI rule: Reject files containing unused imports. |  |
| --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path'). |  |
| Opa inspect (which parses import graph). |  |
| üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough... |  |
| Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional). |  |
| ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search. |  |
| Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:. |  |
| Conflicting when multiple packages define the same rule. |  |
| Answer: The warn reference comes from the data tree, not from the import. |  |
| üîç Full Explanation (What‚Äôs Happening Under the Hood) 1. |  |
| Opa test services/opa/policies/ services/opa/tests/. |  |
| Every .rego file from policies/ ‚Üí into the data tree. |  |
| This means all rule names become visible under data.*. |  |
| OPA resolves warn like this:. |  |
| Search the global data tree for any rule named warn. |  |
| The import is unused because OPA never needs the alias tech_debt to find the rule. |  |
| This is how critical bugs enter policy codebases. |  |
| üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports. |  |
| Never rely on bare rule names:. |  |
| The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused. |  |
| OPA loads all policy packages in /policies/**. |  |
| So the rule warn is available at:. |  |
| OPA resolves bare rule names by doing a global search in data. |  |
| Bare rule names (warn) are ambiguous. |  |
| Becomes ambiguous and OPA may:. |  |
| OPA test behavior depends on all loaded policies. |  |
| Implicit resolution is one of the most common sources of bugs in OPA deployments. |  |
| This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct... |  |
| üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate. |  |
| ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly. |  |
| In test files, always use explicit package-qualified rule references:. |  |
| Ambiguity Prevention: Multiple packages may define rules with common names (warn, deny, allow). |  |
| Import rego.v1 import data.compliance.tech_debt # ‚Üê keep this. |  |
| How your test diff strings are represented inside Rego test files. |  |
| ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {". |  |
| ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character. |  |
| Never see the newline, so they fail. |  |
| __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context. |  |
| They are being accessed ‚Äî the content is just different from what your rules assume. |  |
| But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context. |  |
| Same issue: Your rule expects:. |  |
| OPA evaluates the Rego test literal as:. |  |
| The pattern never matches because whitespace escaping does NOT behave like in JSON. |  |
| üß† Why direct opa eval --input JSON works. |  |
| Because JSON ‚Üí OPA decoding translates \n into real newlines. |  |
| Rego test files do NOT. |  |
| üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings. |  |
| Rego supports multi-line raw strings:. |  |
| This will perfectly match the policy expectations. |  |
| ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file. |  |
| ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy. |  |
| But this will add noise to all rules. |  |
| ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs. |  |
:::

::: qa
id: QA-6d360af85dc91dcf
chapter: CH-05
q: What is Multiple expressions in a rule body in the context of Rego/OPA?
a: ```rego
reference: TERM-b522fb509bee52d0
digest: 5378ba12945e5c21acec2ccd9ccc47d988331bd054ff0dbeb6e14abfb2790316
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e1b6b14138d6a153
chapter: CH-05
q: What is Evaluation in the context of Rego/OPA?
a: All expressions must evaluate to `true`.
reference: TERM-77eaf07b79028829
digest: b8195f5ea065ef49058145757ca4892af3575a523ce1237edf2747f84461bc34
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6dffea90674492aa
chapter: CH-05
q: What is Multiple rule bodies in the context of Rego/OPA?
a: ```rego
reference: TERM-765461e32a3f2ac4
digest: 7eed6e17a94f10c378e2d5c30dbb6a3a6c52acad86ba783cc605c2b72cba8618
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ea707f6dc4a5ebcc
chapter: CH-05
q: What is Evaluation in the context of Rego/OPA?
a: Any rule body can make `allow` true.
reference: TERM-2e68e77273483d64
digest: 8ab08e8c01a03ccf6944b493bb258113cb82aa702674b740d9b5c49d2a7c5df3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f19da1f7c3eb1112
chapter: CH-05
q: What is Array Comprehensions in the context of Rego/OPA?
a: ```rego
reference: TERM-f0f922c28fb58f42
digest: 216a0e6cf66153e63d44b6f2195275fb0e5dc41d28635b6f10227e33e97eaaa8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9c0314476e6109e4
chapter: CH-05
q: What is Set Comprehensions in the context of Rego/OPA?
a: ```rego
reference: TERM-08f1447eec4c64e2
digest: aee57d5c6bd18754254f3de219b0af1f2af6e5020c9e8f4670110263fbc241dd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4f586c50bb35a97c
chapter: CH-05
q: What is Object Comprehensions in the context of Rego/OPA?
a: ```rego
reference: TERM-37943d9555f9fb02
digest: c1a6d66c72a4781363654299f4f887b11265ae13e2424af3fe271aebc793d954
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8224e9bfc30df774
chapter: CH-05
q: What is Negation-as-Failure Semantics in the context of Rego/OPA?
a: ```rego
reference: TERM-4bf6ca2b25fb033e
semantic_categories: [negation]
digest: 1cfa8493652c54ddcaf05ec24fdc667f2379cc9e441684d9c65f8b3fdd7de59b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4ac97394f1220fab
chapter: CH-05
q: What is Safety Requirements in the context of Rego/OPA?
a: ```rego
reference: TERM-d3125a26b9e36f78
digest: d80f5bb982fae877b80a7a27a9a3162e4b4c616468e10d7f4230df15065f7afd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-17e0a17d4cfc10c1
chapter: CH-05
q: What is Common Pitfall ‚Äî Existential vs Universal in the context of Rego/OPA?
a: ```rego
reference: TERM-61b8c1a83d1cdbdd
digest: 82c96fa5055d1746d0435f6941f0ef5242a94337e8b083882427d97575cd19d9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f5cf7ef0c45b36b7
chapter: CH-05
q: What is 6.2 Built-in Function Categories (Overview). in the context of Rego/OPA?
a: 6.2 Built-in Function Categories (Overview)
reference: BLK-ef0eb00e6bda8ba3
digest: c773cd8df0c38273142395dbf049b80ba35c441078f96c5c950270efcc2c76e1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b7981dbed08bad18
chapter: CH-05
q: What is For orientation, here is the taxonomy we‚Äôll use in this chapter in the context of Rego/OPA?
a: For orientation, here is the taxonomy we‚Äôll use in this chapter:
reference: BLK-49055f6875f1cc73
digest: 80a77b23b2f1b402a9f14df02e4cf18bd32bbe6d6d6d3745819db527207ca572
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9afcacd1ed00a398
chapter: CH-05
q: What is Aggregates in the context of Rego/OPA?
a: Aggregates: count, sum, product, min, max, sort, all, any
reference: BLK-cf46e6696f6b22f0
digest: dddc9c6c0a5a80b1c69b28765cdc8d74d5e6f9bd627f43a4108dc94734988d38
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7c2c3dcce3115430
chapter: CH-05
q: What is Arrays in the context of Rego/OPA?
a: Arrays: array.concat, array.slice, array.reverse, array.sort, array.filter
reference: BLK-b772a28e5960357e
digest: e988972205ba50d4c69a248782afc855fccea8646d6fbfc25793d20397a309d0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-26ceca933715b525
chapter: CH-05
q: What is Sets & Set-like operations in the context of Rego/OPA?
a: Sets & Set-like operations: union, intersection, set_diff, minus, distinct, to_set
reference: BLK-6e16416ce945a0fe
digest: 04fc0704f612174d7c57e8e60781b5c9061908b56669d0b6b0486754a20a24ea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5c16c315ea85a723
chapter: CH-05
q: What is Objects & JSON paths in the context of Rego/OPA?
a: Objects & JSON paths: object.get, object.remove, object.union, object.filter, json.filter
reference: BLK-b6acfeb73ecfb3bd
digest: d125c17ce6f4e9d09a809c773c5299d3994801c555ed2e90924e87457f6ab0b2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b3eee0ceb13d0214
chapter: CH-05
q: What is Strings in the context of Rego/OPA?
a: Strings: concat, contains, startswith, endswith, indexof, lower, upper, replace, split, sprintf, substring, trim* family
reference: BLK-ffa6ad16a050d7d9
digest: 1925782b2bfd8569cdbd176d72320c3ab5c801ef17e8279bdf6424c9395312b9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-848bcc3ba54749b3
chapter: CH-05
q: What is Regular Expressions in the context of Rego/OPA?
a: Regular Expressions: regex.is_valid, regex.match, regex.find_n, regex.split
reference: BLK-3d88482e4061db9e
digest: d29dc1c3ae161c12cf28efe23c0604489d2a3c2f9be47cc33b109eb9f5ea145b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-70ed967bc56e59ed
chapter: CH-05
q: What is Numbers & Numeric Utilities in the context of Rego/OPA?
a: Numbers & Numeric Utilities: abs, ceil, floor, round, numbers.range, comparisons
reference: BLK-aad1a170dd666677
digest: e89ed788d3d2691e72cc6b532fc3af23f8d29b35e4da713741bd0a5191bc1226
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0b23e837b6b33196
chapter: CH-05
q: What is Type Conversion & Validation in the context of Rego/OPA?
a: Type Conversion & Validation: to_number, to_string, to_set, to_array, to_object, cast_*, json.is_valid, yaml.is_valid
reference: BLK-ccdb280747300dd7
digest: 14a09ace209f5062be2b6c6eb676ec8762d256c85058cdec77384ffa35d0fead
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0fc5522b563dc927
chapter: CH-05
q: What is Encoding/Decoding & Serialization in the context of Rego/OPA?
a: Encoding/Decoding & Serialization: base64.*, base64url.*, hex.*, json.marshal/unmarshal, yaml.marshal/unmarshal, urlquery.*
reference: BLK-6019bf75ef6624c0
digest: 8e2fac0ecb37be01c1363b4ee76a307b1650af1ca7edec52cec17b6a9ceaf3f5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4b18ecb21a93c1be
chapter: CH-05
q: What is Type Introspection in the context of Rego/OPA?
a: Type Introspection: is_array, is_boolean, is_null, is_number, is_object, is_set, is_string, type_name
reference: BLK-6b408802776a93cd
digest: 75af596e52b60e8c9f760d36683ad5ea48660e2b17ca8c98eb09e0c9d76b7445
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e773a1fa91cb51e6
chapter: CH-05
q: What is Cryptography & Security in the context of Rego/OPA?
a: Cryptography & Security: crypto.* hashes, HMAC, PBKDF, bcrypt, JWT (io.jwt.*), crypto.x509.*
reference: BLK-f4ead349338c8ef6
digest: 56ec5921c982ee17acf8d34bfd7e3f0b1352d7aed00727c483405ebd3cc80cb9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6c3015db9d5159fd
chapter: CH-05
q: What is Time & Temporal Logic in the context of Rego/OPA?
a: Time & Temporal Logic: time.now_ns, time.parse_*, time.date, time.clock, time.weekday, diffs
reference: BLK-54e2cf6d9a981dc3
digest: d5a19faf968e2f47e8dc051c5782680fd5ad2e82746fa45a53ac1b5988ddc053
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-aaa203e328c850f5
chapter: CH-05
q: What is HTTP & I/O in the context of Rego/OPA?
a: HTTP & I/O: http.send for outbound HTTP calls
reference: BLK-c595ba2ed67a0e45
digest: 01cebb50e80031550190f8b956d0db86500a476878590300aac3f8ce73044273
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-387c97b708f97780
chapter: CH-05
q: What is Network & CIDR in the context of Rego/OPA?
a: Network & CIDR: net.cidr_contains, net.cidr_expand, net.cidr_intersects, net.cidr_merge
reference: BLK-c7baced805939b57
digest: 18cf3e4d859f79151862e4936bac232f6c9a13f54fb42a9b7fda7790b32746a7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dd7c9d2c11814dc8
chapter: CH-05
q: What is UUID/ULID in the context of Rego/OPA?
a: UUID/ULID: uuid.*, ulid.generate
reference: BLK-82cc3ccae9f078e0
digest: f359c3367127d0bc4eff202877d26f999a49a46693ec3b438339735bc2662ecd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fc49602cc90e990b
chapter: CH-05
q: What is Graph & Structural Walks in the context of Rego/OPA?
a: Graph & Structural Walks: graph.reachable, walk
reference: BLK-cdbdae08e6768e75
digest: 8a04f5254b21ec07dd1f3de442173ba6160afa17e904f30cfbf40d8ddbc550e9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-81a387de8345c31f
chapter: CH-05
q: What is Units in the context of Rego/OPA?
a: Units: units.parse, units.parse_bytes
reference: BLK-872e72b8a1e0cda1
digest: 60549fed1ea0d27af4780f3ef24c1dd0e7fb9cdf9b6795a130138dea1f79e9a7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0f24718fc2eb1f00
chapter: CH-05
q: What is Metadata & Introspection in the context of Rego/OPA?
a: Metadata & Introspection: rego.metadata.rule, rego.metadata.chain
reference: BLK-c179f5c2a30f1d7c
digest: e010ca3ad7e8241b8509f1c4acda68f72c50eba0aea058bd0715b12d7a026dfb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4ae8445ec4a8411d
chapter: CH-05
q: What is Debugging in the context of Rego/OPA?
a: Debugging: print, trace
reference: BLK-00a76d3fd313f7d0
digest: 92f14cee0c9f242a20c7376976ef05e22532446eee53cbf85b6a884007928edb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-10b094b956cd7043
chapter: CH-05
q: What is Error Semantics in the context of Rego/OPA?
a: Error Semantics: Strict vs non-strict behavior
reference: BLK-2ef44c7e2eba38d6
digest: 0b756b77ea5b59424f333db0a013b3784bee6776107026dbd6294e93b98ee2eb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0374817e1a9cade2
chapter: CH-05
q: What is We‚Äôll now go category by category, with semantics, examples, and pitfalls. in the context of Rego/OPA?
a: We‚Äôll now go category by category, with semantics, examples, and pitfalls.
reference: BLK-962ae7799bfaea26
digest: c0f85078bb173782bb98b38359aee6968ce15a93dd3f6819ea80bec9e9a5ce96
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d29f1894b337fad5
chapter: CH-05
q: What is Purpose in the context of Rego/OPA?
a: Purpose: Reduce collections to scalars (counts, sums, min/max, logical AND/OR).
reference: BLK-596d0d11df0a2b34
digest: 2b0bdeede9e03262ff82f2df3394004b29e1df375883234a6d8af8d70b2e4bcd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e22ee2b56fd30589
chapter: CH-05
q: What is Count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element... in the context of Rego/OPA?
a: count(x) # length of array, set, or string sum(array) # numeric sum of array elements product(array) # numeric product max(array) # maximum element min(array) # minimum element sort(array) # sorted copy (ascending) all(array_bool) # AND over boolean array any(array_bool) # OR over boolean array
reference: BLK-7934af716417f7d8
digest: b6df7d1858eaf3cbc0e41320d9fbc9f5586df8ac69894e8962a4c70ea4afa8f8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3523833ddb6e257d
chapter: CH-05
q: What is # Count API keys api_key_count  in the context of Rego/OPA?
a: # Count API keys api_key_count := count(input.api_keys)
reference: BLK-791542a3ee72c589
digest: e0dc699d7234735ea7abe0313f8e1cddaa765a5d3bb86297f9148544f802e168
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-30e59fc70b3bcd95
chapter: CH-05
q: What is # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) }. in the context of Rego/OPA?
a: # Any admin users? has_admin if { any([role == "admin" | some role in input.user.roles]) }
reference: BLK-f48113faff5c16ae
digest: 0c234124353019df04f659072926d3fa7a0ad33c1a35ad360e5726d0a10202de
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-19bc8ae2a6fa3461
chapter: CH-05
q: What is # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }. in the context of Rego/OPA?
a: # All servers must be healthy all_healthy if { all([s.healthy | some s in input.servers]) }
reference: BLK-eb3d6c96d1f72a4a
digest: e95e6ce459c3cb800acb31a369b8a84a686e88c2cf57b0b40bdb8c79248274d1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c3ba087fe00bf1a6
chapter: CH-05
q: What is Sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined. in the context of Rego/OPA?
a: sum, product, max, min require arrays of numbers; mixing types ‚Üí expression undefined.
reference: BLK-74ff565e561f01ba
digest: f50eab26e814f58474c3c3f186e6e91bb5e327c323cb5f9ed29cefbea71ff276
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d035f0c5f6456fd9
chapter: CH-05
q: What is Count accepts arrays, sets, strings in the context of Rego/OPA?
a: count accepts arrays, sets, strings:
reference: BLK-2c081e539ff9ca26
digest: 458c892b9a418a97de60de85fad1d372724d4785b361d10bffc8343ad63d22fa
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-38915b5116cf041b
chapter: CH-05
q: What is Count("abc") # 3 count({"a", "b"}) # 2. in the context of Rego/OPA?
a: count("abc") # 3 count({"a", "b"}) # 2
reference: BLK-15482deb4216bdc0
digest: b31210becae0800e037dbcaf64eeb8d97ee261ab63fa161295a0afa7731638d0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-03d6842be110ec68
chapter: CH-05
q: What is Pattern in the context of Rego/OPA?
a: Pattern: Use count for guardrails:
reference: BLK-99bc66bd2d2d22ac
digest: bd130bc2f2c21e5d549a0edbfb23b0f2038b23e00c925006c2db11295b3b8039
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f6c851b854d87834
chapter: CH-05
q: What is Deny[msg] if { count(input.changed_files) > 100 msg  in the context of Rego/OPA?
a: deny[msg] if { count(input.changed_files) > 100 msg := "PR changes too many files" }
reference: BLK-bbc8d74e03606e88
digest: 2b9b3a6e5bb2613e96da5ba1f240bd771334e218f0ddcf6cee14814d47d51e97
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6060ad799721142d
chapter: CH-05
q: What is Arrays are ordered; built-ins treat them as such. in the context of Rego/OPA?
a: Arrays are ordered; built-ins treat them as such.
reference: BLK-63f3203792f6dd9a
digest: 38dfc0c6fc3f0ca4aa40ce426d08da6179bcdb8e179585331f429c3f626a1612
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4e2d8aaef6a7343a
chapter: CH-05
q: What is Array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start in the context of Rego/OPA?
a: array.concat(a, b) # [a..., b...] array.slice(a, start, end) # a[start:end], end-exclusive array.reverse(a) # reversed copy
reference: BLK-0170fbca460ac05f
digest: dd1311c013b304e7f361df5e041dc15b0b8536347b94dc60bd272e16ca590b26
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9bad293c7091e255
chapter: CH-05
q: What is # Pagination utilities page(slice_start, slice_len)  in the context of Rego/OPA?
a: # Pagination utilities page(slice_start, slice_len) := array.slice(input.results, slice_start, slice_start+slice_len)
reference: BLK-fe1ce0476ba80606
digest: 33abbea0f871f04f561e399df01bac6d6ed5790798f347313cda23a5bd094042
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8757f7b5f225e6c8
chapter: CH-05
q: What is # Compose routes full_path  in the context of Rego/OPA?
a: # Compose routes full_path := concat("/", ["api", input.version, "users", input.user_id]) reversed := array.reverse([1, 2, 3]) # [3, 2, 1]
reference: BLK-404c395d3ea15d7a
digest: 9140cc65852bbb15f77145cca5750ba540828ede7e5aafc3a7598f0c90a12d32
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d210151310e43858
chapter: CH-05
q: What is Indexing vs slicing in the context of Rego/OPA?
a: Indexing vs slicing:
reference: BLK-21aad7baea9ba2e2
digest: 0c36cfd1ce059681fef3e082ab61d2a3ce9f7e50263900aeceae85e77dc9f2bb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-674b48ccc6d775f6
chapter: CH-05
q: What is OPA has no direct a[1 in the context of Rego/OPA?
a: OPA has no direct a[1:3] slicing syntax; use array.slice.
reference: BLK-0c491778be16cb9f
digest: 9d5b3cb7dabcac0229682f7145e2f7149eb03e9c91245f8b5fdc6260e3597669
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6eda01b8d6d9090f
chapter: CH-05
q: What is Out-of-range indices ‚Üí expression undefined. in the context of Rego/OPA?
a: Out-of-range indices ‚Üí expression undefined.
reference: BLK-e94daebb356ba43f
digest: d07d2a25731e60480a6bc4634a54f6c6160e4271c364f71f34f731a6693bbaed
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e8d165609e493b88
chapter: CH-05
q: What is 6.5 Sets and Set-like Operations. in the context of Rego/OPA?
a: 6.5 Sets and Set-like Operations
reference: BLK-08cda054b5b03bbf
digest: cc37b9e68322f95df11207e3ebf462bcac02651984b51d5e09825852c67452ce
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-95534c53d589afed
chapter: CH-05
q: What is Rego sets are unordered, unique collections. in the context of Rego/OPA?
a: Rego sets are unordered, unique collections.
reference: BLK-f73cb48d2abbbafb
digest: 9559d4ff872d430902f4514553ed18ab528fb02afbc2a6569cf7aef958c0c1c6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8c1e5771712a12c9
chapter: CH-05
q: What is Intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # co... in the context of Rego/OPA?
a: intersection(s1, s2) # {x | x in s1 ‚àß x in s2} union(s1, s2) # {x | x in s1 ‚à® x in s2} set_diff(s1, s2) # {x | x in s1 ‚àß x ‚àâ s2} to_set(array) # convert array to set
reference: BLK-e37b22113d09ec95
digest: 8203f70a344d5094f2670d4fb308be54291ae4289efddb0585d0cbf7808da0a2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c38043398d2dffcb
chapter: CH-05
q: What is Allowed_regions  in the context of Rego/OPA?
a: allowed_regions := {"us-east-1", "us-west-2"} requested_regions := to_set(input.regions)
reference: BLK-12487ad1b10432e4
digest: d7ac694aa89147e418f9f2ac0f964286384020051d369a43b84324eb465a2fb0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e6c2a2a0a5fa438b
chapter: CH-05
q: What is Invalid_regions  in the context of Rego/OPA?
a: invalid_regions := set_diff(requested_regions, allowed_regions)
reference: BLK-3db95d70e67fc31e
digest: 9b3c8da04a60d5c843491ba86bd21f59e2a3efcb73eeb02d13a9fef8581750d7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fb5ec3ccc3ed2475
chapter: CH-05
q: What is Deny[msg] if { invalid_regions != set() msg  in the context of Rego/OPA?
a: deny[msg] if { invalid_regions != set() msg := sprintf("Invalid regions: %v", [invalid_regions]) }
reference: BLK-523debf78d115993
digest: ea7af6b6dd1dc63fef4aef94ed85a02885cf87dbc834914883070a2c906ceae6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-eb7ff490e3fbfb08
chapter: CH-05
q: What is Performance pattern in the context of Rego/OPA?
a: Performance pattern: Prefer sets for membership:
reference: BLK-d047ca3d47b07bab
digest: e1903524ad244a52abad6d5acc059b843644580bb21fb62574771445e56289c9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6d29e566b49e0dbe
chapter: CH-05
q: What is # Fast in the context of Rego/OPA?
a: # Fast: O(1) admin_users := {"alice", "bob"} allow if input.user in admin_users
reference: BLK-958bba1048ce58c0
digest: e75f85123aa94b66b32b03f10a6f8d981a66a8d1701acfc213e4df2bacb543f6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d89261e24af26ba7
chapter: CH-05
q: What is # Slower in the context of Rego/OPA?
a: # Slower: O(n) admin_list := ["alice", "bob"] allow if input.user in admin_list
reference: BLK-9936fd64e4071bcd
digest: 34b64dfb57e849e7531212cb5fc36590b7c498a119fcffe66ad1f6ff015d0321
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-922a84fd9dc2dab0
chapter: CH-05
q: What is 6.6 Objects & JSON Path Helpers. in the context of Rego/OPA?
a: 6.6 Objects & JSON Path Helpers
reference: BLK-b7a1e245e128d594
digest: f81fbd3ace469870e7d1203a0eb4b814a80e3c93ea2ad81d4239ba68ce85822c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-51672e9a39f08ae3
chapter: CH-05
q: What is Objects represent mappings from scalar keys to arbitrary values. in the context of Rego/OPA?
a: Objects represent mappings from scalar keys to arbitrary values.
reference: BLK-6896accc71c6a5e8
digest: 73fefe09b3eb90baf482311a1571fe7f9e7164b4f9b3245f0b7aa819777d8605
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0d2ebb487c9869df
chapter: CH-05
q: What is Object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on co... in the context of Rego/OPA?
a: object.get(obj, key, default) # obj[key] or default object.remove(obj, keys_array) # remove listed keys object.union(o1, o2) # merge, o2 wins on conflict object.filter(obj, keys_array) # keep only listed keys json.filter(obj, paths_array) # filter by JSON paths (e.g., "a/b/c")
reference: BLK-6809c3d7905f3972
digest: 3bc488aa2b801696d095d75daf4a7d512358d4622c38e532e6e933cf88baa65c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-49a80a7fab8d37f0
chapter: CH-05
q: What is # Defensive access with default timeout_ms  in the context of Rego/OPA?
a: # Defensive access with default timeout_ms := object.get(input.config, "timeout_ms", 1000)
reference: BLK-64caf7147f83da01
digest: ef359a9e6555e9cb8456dfe0fe8dce07be1754c1930b43a986076fcaa28f232c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-65abb7d5ea02a9a9
chapter: CH-05
q: What is # Drop sensitive keys before logging sanitized  in the context of Rego/OPA?
a: # Drop sensitive keys before logging sanitized := object.remove(input.request, ["password", "token", "secret"])
reference: BLK-966c15b0885f6587
digest: f2711c8efbfd20487b4143e662147d0d5273958a4fbea774d9d88ee80e677853
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-127b5de080bf4c7b
chapter: CH-05
q: What is # Only retain whitelisted fields log_payload  in the context of Rego/OPA?
a: # Only retain whitelisted fields log_payload := object.filter(input.request, ["method", "path", "user.id"])
reference: BLK-e6aca8c5011c2c92
digest: b3c5d0eade6e5a3c949b2e8a60d6c10f41bf7fd1cf41a85c933b618b3e980a9a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2ec68448a695a0f1
chapter: CH-05
q: What is # Filter by paths log_payload2  in the context of Rego/OPA?
a: # Filter by paths log_payload2 := json.filter(input.request, ["user/id", "request/path"])
reference: BLK-f16c75347a49cfc8
digest: cb458d9ca865186a589254dd17cbb1f98fab0522ff00ff2b9fa01fbd6dfb25d8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a7e529edd765eeeb
chapter: CH-05
q: What is Use object.get instead of chaining if input.config.timeout_ms checks everywhere. in the context of Rego/OPA?
a: Use object.get instead of chaining if input.config.timeout_ms checks everywhere.
reference: BLK-bc0e62af97ec9ecb
digest: 3117792715bc71385db19f2597704b3f52effe887c9654e14a8ab66eb39006f5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b222ac34358d6c48
chapter: CH-05
q: What is Use object.remove before logging to avoid PII leaks. in the context of Rego/OPA?
a: Use object.remove before logging to avoid PII leaks.
reference: BLK-8db7cb02fa0d8019
digest: bbeb89858dec8464541274150d383f094020d5ee261b632637933dd3d936ed05
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b29b5f2e46210dd3
chapter: CH-05
q: What is 6.6 JSON Filter (json.filter). in the context of Rego/OPA?
a: 6.6 JSON Filter (json.filter)
reference: BLK-7ff764ddb3c09d45
digest: 07fb2394d30189996cc3adb401640e5e3084696c5964fe5fac9a07120595d27d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6378425a6037371e
chapter: CH-05
q: What is Json.filter allows you to keep only selected fields from a JSON object. in the context of Rego/OPA?
a: json.filter allows you to keep only selected fields from a JSON object.
reference: BLK-560f57c44741f42a
digest: 67fe0a0f40cfbecdff33e6f4d126a30a092286dba42a37529707c679a548809f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d67b755dc698f521
chapter: CH-05
q: What is Signature (conceptual) in the context of Rego/OPA?
a: Signature (conceptual):
reference: BLK-5d036547953a8f35
digest: b77f68d1e0eede2552922d5603a8341f408ac44aa05cb6095cfe1df1325ef33d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-60535c69698f3241
chapter: CH-05
q: What is Json.filter(obj, paths_array) # paths_array in the context of Rego/OPA?
a: json.filter(obj, paths_array) # paths_array: array of slash-delimited strings
reference: BLK-aa4996164f00b4c3
digest: 598bc8d518d5730e3300111fdefd97299f651ee7e261fe261670dd044e4faa60
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-48b992e3bc82776f
chapter: CH-05
q: What is # Keep only user ID and requested path filtered  in the context of Rego/OPA?
a: # Keep only user ID and requested path filtered := json.filter(input.request, ["user/id", "request/path"])
reference: BLK-f8d1eedc439ab8ec
digest: 4d77c5a4a446b364a6faa961d946e7471170e521adebfd1dbd85236704a218ca
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d8be09957b0a0e3a
chapter: CH-05
q: What is Path strings are JSON Pointer‚Äìstyle in the context of Rego/OPA?
a: Path strings are JSON Pointer‚Äìstyle:
reference: BLK-f9b6faf28a2028a5
digest: 25812d2b3f5dca8ae5106cd7786dec8a63bb9fea56c149533296695ee1d026c3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1af12c7a6c71370a
chapter: CH-05
q: What is "user/id" corresponds to conceptual path segments ["user", "id"]. in the context of Rego/OPA?
a: "user/id" corresponds to conceptual path segments ["user", "id"].
reference: BLK-0bb7c9be9909cc35
digest: d006a919440f32a25e9bee500de9d98c329ffafb2920f2e51ebcf469d97b3d92
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e8ef28300ea3ae73
chapter: CH-05
q: What is "request/path" corresponds to ["request", "path"]. in the context of Rego/OPA?
a: "request/path" corresponds to ["request", "path"].
reference: BLK-a9fcb33c5ea171bc
digest: bb1e82a4cc8283a633bcc6f4b3f1219daa7ae25d19db9c48308bbf7e6fb37cc6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-119cfb6bc1af3ac9
chapter: CH-05
q: What is Think of each string as a slash-delimited path from the root of obj. in the context of Rego/OPA?
a: Think of each string as a slash-delimited path from the root of obj. The function returns a new object containing only the specified paths.
reference: BLK-5054224961c85436
digest: 89cae5b02492dd76d3ea9cf1964cf0ffd8973b48949e5ac2f617e8c556d5c926
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8e55ff9219f07414
chapter: CH-05
q: What is Rego strings are Unicode text; built-ins operate on code points (not bytes). in the context of Rego/OPA?
a: Rego strings are Unicode text; built-ins operate on code points (not bytes).
reference: BLK-b6de378fb521f3e5
digest: 489c96cea6cd4b9a9c0e42bdb6cc50ec0c14fa9e5e4e086db84e248ae13329f2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fd31d6d8e7f76dbf
chapter: CH-05
q: What is Concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, bas... in the context of Rego/OPA?
a: concat(sep, array) # join strings with separator contains(s, substr) # substring test startswith(s, prefix) endswith(s, suffix) format_int(int, base) # "2a" in base 16, etc. indexof(s, substr) # index or -1 lower(s) / upper(s) replace(s, old, new) # replace all occurrences split(s, sep) # split into array sprintf(format, args_array) # printf-style format substring(s, start, length) # slice of string trim(s, chars) # trim characters from both ends trim_space(s) # trim whitespace trim_prefix(s, prefix) trim_suffix(s, suffix)
reference: BLK-1827c164cec5cced
digest: a658daec6025d708e1865ea1bcd3a2dea56ff3304fe1e6bc13c07e7585aa64dd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7e523b3e81e3f693
chapter: CH-05
q: What is # Normalize emails norm_email  in the context of Rego/OPA?
a: # Normalize emails norm_email := lower(trim_space(input.user.email))
reference: BLK-d1f0e80b99a8855a
digest: 9131dbe993178ddcf339fc1606e50736f6aa395de14eef7623a2f167781925b0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-851183981785d0db
chapter: CH-05
q: What is # Path manipulation endpoint  in the context of Rego/OPA?
a: # Path manipulation endpoint := trim_prefix(input.path, "/api/v1/") segments := split(endpoint, "/")
reference: BLK-034df081487c6e14
digest: 35c7b076ae3bed6680aea2032462c7d20cb54fbda4bd9bde888c813d93df1a18
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8fa2fcda839d0e2f
chapter: CH-05
q: What is # Slugify a title (rough example) slug  in the context of Rego/OPA?
a: # Slugify a title (rough example) slug := lower(replace(input.title, " ", "-"))
reference: BLK-3d6a7a0519d02f65
digest: 0816c30c30b11906434ac3fea96e1d0e81adb3530753597b2fda2900efb4b242
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-18ff59fcb3db1246
chapter: CH-05
q: What is # Format numeric IDs hex_id  in the context of Rego/OPA?
a: # Format numeric IDs hex_id := format_int(input.id, 16) # hex
reference: BLK-5f55f27905af292b
digest: cdcd80056f27e82fb5c1acef8d3529e6106e72361d3e679e93f26b358a8479ab
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ec39246b6f3bb849
chapter: CH-05
q: What is # Human-readable messages msg  in the context of Rego/OPA?
a: # Human-readable messages msg := sprintf("User %s attempted %s on %s", [input.user.id, input.action, input.resource.id])
reference: BLK-99ce09c802bf60a2
digest: e275de93963b7eaebac19888483f22abf4a3d04ff72e633101a1ddfc67353794
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1182bb9ebf3ff2fc
chapter: CH-05
q: What is 6.8 Regular Expressions. in the context of Rego/OPA?
a: 6.8 Regular Expressions
reference: BLK-8d0cec0d56f71772
digest: 075bceb3c42562e2ca3112c2ae36e337bf49915ec6cad55da7e80b6c1a81e076
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ab4ce2bad9f1f3e3
chapter: CH-05
q: What is Regex built-ins are powerful but expensive; use carefully. in the context of Rego/OPA?
a: Regex built-ins are powerful but expensive; use carefully.
reference: BLK-c2126d6032b00de1
digest: f91bbaa134bb2e91f225ec430d5733baf0fd79cec421889e2e17bea0b1e47e20
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-29e872cd3e562bc0
chapter: CH-05
q: What is Regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(patter... in the context of Rego/OPA?
a: regex.is_valid(pattern) # sanity check regex.match(pattern, string) # boolean regex.find_n(pattern, string, n) # up to n matches regex.split(pattern, string) # array of splits
reference: BLK-d0a0341eae3035cf
digest: 3a7ae59599ffabacc1c2778981846806659c9002fc5327e57e530d8664d5e0d0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d778e6a911281a36
chapter: CH-05
q: What is Raw Strings (Backticks) - Implementation Note in the context of Rego/OPA?
a: **Raw Strings (Backticks) - Implementation Note:**
reference: BLK-19d08c340d427069
digest: 09cac90e60f350902e9da5b30187fc91483d03805985dfc00ffb221580fcc74c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-aae2f51c9db302f2
chapter: CH-05
q: What is However, raw strings may not be supported in all OPA versions or implementations. in the context of Rego/OPA?
a: The grammar defines raw strings with backticks (`raw-string ::= "`" { CHAR-"`" } "`"`), and examples in documentation may show them. However, **raw strings may not be supported in all OPA versions or implementations**. For maximum compatibility, prefer double-quoted strings with proper escaping:
reference: BLK-c2a495572332a234
digest: 4e2e703e24c45d4d1942540b409a22429a49f47aa207e3de9dd97efb09b4487d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2cbc3191c4ca90f6
chapter: CH-05
q: What is # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value). in the context of Rego/OPA?
a: # Compatible (recommended) is_hex if regex.match("^[0-9a-fA-F]+$", input.value)
reference: BLK-cea8ae8e888936e9
digest: 13d9d167f3e960cf39b316b09a240a40d3ef9ffe5646e34c91092f9c51f9d3c0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-93e5b16275e406fe
chapter: CH-05
q: What is # May not work in all OPA versions is_hex if regex.match(^[0-9a-fA-F]+$, input.value). in the context of Rego/OPA?
a: # May not work in all OPA versions is_hex if regex.match(`^[0-9a-fA-F]+$`, input.value)
reference: BLK-9c591fac4dfe8baf
digest: 13490fee2132f5f113810bc856d422a50bb8a1c4615c44e3c75a17648834a8e7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2b5a783755d6a8fe
chapter: CH-05
q: What is Best Practice in the context of Rego/OPA?
a: **Best Practice:** Always use double-quoted strings with escaped backslashes for regex patterns. Test with `opa check` to verify compatibility with your OPA version.
reference: BLK-154238569cc2d740
digest: 83f09499934e932f7084cbe161d3043fec51cc743a8ff7d88ef865d944cb2d85
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1a3a9e1d5cb031d3
chapter: CH-05
q: What is Exception in the context of Rego/OPA?
a: **Exception: Multi-Line Test Data**
reference: BLK-85c57404aa7470a5
digest: dd61f98f320a7370fa76c1a8d273c063011d50db05da60277bb62a6b9d8c5a87
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-030c453a260a7862
chapter: CH-05
q: What is For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve ac... in the context of Rego/OPA?
a: For test files containing multi-line content (diffs, code blocks, structured text), raw strings are the preferred approach because they preserve actual newline characters. Unlike double-quoted strings where `\n` is a literal two-character sequence, raw strings interpret newlines as actual line breaks:
reference: BLK-5653ea053fcd305c
digest: b795b1f97540350211edbc3da6b959018e726fc71754ba0f723f2d8e521b39b0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-83d210791307bb44
chapter: CH-05
q: What is When to Use Raw Strings in the context of Rego/OPA?
a: **When to Use Raw Strings:** - Test inputs containing multi-line content (file diffs, code blocks) - Regex patterns that need to match actual newline characters - Content that must preserve line breaks exactly as written
reference: BLK-a3e1adeda4bf400c
digest: fcbbeeee3875ea10b33263f2b98815a3a65c7b11121b1622e5058d95165cb63a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fd5b5b8e2b1e419d
chapter: CH-05
q: What is When to Use Double-Quoted Strings in the context of Rego/OPA?
a: **When to Use Double-Quoted Strings:** - Single-line strings - Regex patterns (for maximum compatibility) - Strings where escape sequences are acceptable
reference: BLK-5b85cd23416fe10a
digest: 12771c8b9dbe6043ee25510f16cef8c163401f74ea51ef33f3d6252172f311c0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bb973857aa10cf92
chapter: CH-05
q: What is Avoid regex in tight loops over large collections if possible. in the context of Rego/OPA?
a: Avoid regex in tight loops over large collections if possible.
reference: BLK-0aca188dad8fd4c4
digest: 5ee27ed51c8d813ee2c6fd7bedaaedcedb39d12178a0b9b820c6e1df707c81f5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0026ea86964e8830
chapter: CH-05
q: What is Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied). in the context of Rego/OPA?
a: Pre-validate patterns with regex.is_valid when patterns are dynamic (e.g., user-supplied).
reference: BLK-27494b43ea9a88cc
digest: d2df0bdd6b4424c8abe480082393c09ce3d0278dcacf05466aa4fbf20a974a0a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3c4638bdfe28f463
chapter: CH-05
q: What is 6.9 Numbers & Numeric Utilities. in the context of Rego/OPA?
a: 6.9 Numbers & Numeric Utilities
reference: BLK-bffd0561a132a3ee
digest: f9fb55463583691cf95d80d56dc648532e9f419b82336b3e19fdafb239227c77
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8d88a77df9629e53
chapter: CH-05
q: What is Basic numeric helpers in the context of Rego/OPA?
a: Basic numeric helpers:
reference: BLK-cfbd6b5720d1c8c4
digest: a0b36f758971156fa371b54f6d0b9bf44f272bcab7aaa968ffe6a26d0921ea02
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-285ebbf657e67390
chapter: CH-05
q: What is Abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start,... in the context of Rego/OPA?
a: abs(x) # absolute value ceil(x) # smallest integer ‚â• x floor(x) # greatest integer ‚â§ x round(x) # round half-up numbers.range(start, end) # [start, ..., end-1]
reference: BLK-dc5923a0cbbecea4
digest: 4739e8693e58e1be0e8ab20c9e426fbc254718457d00752b752e374e4224cdc4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d6f512a4bef3eabd
chapter: CH-05
q: What is # Generate ports 8000 to 8099 ports  in the context of Rego/OPA?
a: # Generate ports 8000 to 8099 ports := numbers.range(8000, 8100)
reference: BLK-389040bd2c4e208b
digest: 35e66b01d7257d88617032f41cef3690943f030c8805c0af2ce3914bfb651458
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6f4ce95753e94ca4
chapter: CH-05
q: What is # Check resource usage thresholds over_limit if { usage  in the context of Rego/OPA?
a: # Check resource usage thresholds over_limit if { usage := input.usage limit := input.limit usage > limit * 1.10 # 10% over limit }
reference: BLK-78c2cb371a96496e
digest: 84c816051f45389b13a9af2673cf71b1e452fc4c756f6a44aab74c037eac4ccc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-805d8805727b7790
chapter: CH-05
q: What is Combine with aggregates in the context of Rego/OPA?
a: Combine with aggregates:
reference: BLK-7a4ef4151bc05f13
digest: 1775f6dcc87891bc248ae0eb802ce8c8811822f5721368c73b9f004f9e095bf7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-21037e7ca274c65d
chapter: CH-05
q: What is # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 }. in the context of Rego/OPA?
a: # Ensure all latencies below 100ms all_fast if { not any_slow } any_slow if { some lat in input.latencies lat > 100 }
reference: BLK-a307644bd6c65dd0
digest: faabf25433a52e660aa13362cd038dd5b263b3fec6f7d85790c888e33a47f9a7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d3c52bc1b3e8b5b4
chapter: CH-05
q: What is 6.10 Type Conversion & Validation. in the context of Rego/OPA?
a: 6.10 Type Conversion & Validation
reference: BLK-da60e2ba3a9d9f8b
digest: 2f9bc920ce6bc45a308e14ae4deb0567e594006927ff3ec590bb293cf97db5fd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7cde3c68bfb993da
chapter: CH-05
q: What is Sometimes you ingest loosely typed JSON (forms, CSV turned JSON). in the context of Rego/OPA?
a: Sometimes you ingest loosely typed JSON (forms, CSV turned JSON). Use conversion and validation built-ins:
reference: BLK-92acd8f218475798
digest: 74379b1e8f246fd7271caac3262ee85a97c0799d6f2e143dff4525c6fd66a0ca
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a24a5ae5bd89c928
chapter: CH-05
q: What is To_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_... in the context of Rego/OPA?
a: to_number(x) # best-effort numeric conversion to_string(x) to_set(x) to_array(x) to_object(x) # shape-dependent cast_number(x) cast_string(x) cast_bool(x) json.is_valid(str) # syntactic JSON validation yaml.is_valid(str)
reference: BLK-7df6e314b23533aa
digest: d3aff163f09e77ab57b1e6bbb2ba885de1b0057667abc1679ece2bc83141dd36
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-91ebf9de2b454126
chapter: CH-05
q: What is # Robust score parsing score_is_valid if { json.is_valid(input.body) body  in the context of Rego/OPA?
a: # Robust score parsing score_is_valid if { json.is_valid(input.body) body := json.unmarshal(input.body) s := to_number(body.score) s >= 0 s <= 100 }
reference: BLK-d5763b6b5eb0bf7a
digest: 34d73cd72a4d5a5ca54f0a604c4285ffccd87fe5d0866e751d220555370cde84
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ecc788f37b50ea2c
chapter: CH-05
q: What is # Convert dynamic lists tags_set  in the context of Rego/OPA?
a: # Convert dynamic lists tags_set := to_set(input.tags)
reference: BLK-c7d5202b059d4f66
digest: e19e2122adfdc06e18ebae00349b9401f66ba9f381b48a3850d05392d39e4e91
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f9400ec542121a70
chapter: CH-05
q: What is Difference in the context of Rego/OPA?
a: Difference: to_* is generally more permissive; cast_* may be stricter (implementation details can vary by version‚Äîalways verify against your target OPA).
reference: BLK-faa6749892163657
digest: 2aeabc059b3fc220bedf2edec765590dd3d3acdc07c61c8f1d00d4f4a54f3cc3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-91cf5d90812b5554
chapter: CH-05
q: What is 6.11 Encoding, Decoding & Serialization. in the context of Rego/OPA?
a: 6.11 Encoding, Decoding & Serialization
reference: BLK-f103384b14a876e2
digest: 2a3ecafa627d3bca4ba5dcf1dc506276388b79aac53d0776e1bd25c3e8a499ba
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-80a9f5d256d21959
chapter: CH-05
q: What is Used to transform payloads between formats or safely embed them. in the context of Rego/OPA?
a: Used to transform payloads between formats or safely embed them.
reference: BLK-fb68755b272d7cd1
digest: 360d7fe6245a563fea23fee836fd2e421b02f057f4567a8fdb256706155955f8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7f2a35d12a495a20
chapter: CH-05
q: What is # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("..."). in the context of Rego/OPA?
a: # Base64 base64.encode("hello") # "aGVsbG8=" base64.decode("aGVsbG8=") # "hello" base64url.encode("hello") # URL-safe base64url.decode("...")
reference: BLK-c57d596903f7cb47
digest: dd27a4f0b26e4b0a774cc849e3c5a5c280f3fb36f700f7816af7a76fd20dfe42
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-59ca34c19d652935
chapter: CH-05
q: What is # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello". in the context of Rego/OPA?
a: # Hex hex.encode("hello") # "68656c6c6f" hex.decode("68656c6c6f") # "hello"
reference: BLK-e5d2cae50c0adf8e
digest: 1efa2de13458713f6f72dee8a23d3087c605b189605e149ef3dc92de85be2c3c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-29d16b7f9ae9dd52
chapter: CH-05
q: What is # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value. in the context of Rego/OPA?
a: # JSON json.marshal(x) # value ‚Üí JSON string json.unmarshal(json_str) # JSON string ‚Üí value
reference: BLK-773b97e3f4d9044f
digest: b68158559d40b4d0aafafd3833759947f6d2aa49e621c344533b293248e3aa9e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0a883d9b7a9d3485
chapter: CH-05
q: What is # YAML yaml.marshal(x) yaml.unmarshal(yaml_str). in the context of Rego/OPA?
a: # YAML yaml.marshal(x) yaml.unmarshal(yaml_str)
reference: BLK-7f1aa0c4b22de975
digest: a9b06da5b695f7e58651d26e280bab912c825472818192b37ec16c584d6e3647
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-698c9469bf54a826
chapter: CH-05
q: What is # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1". in the context of Rego/OPA?
a: # URL query urlquery.encode("a=1&b=2") # "a%3D1%26b%3D2" urlquery.decode("a%3D1") # "a=1"
reference: BLK-f25b0aaead0e1ce8
digest: a41e2295240c0a0b9334e0b6888467928c4f2c4bff50a670e754b99597d33961
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-edf32a464c1be746
chapter: CH-05
q: What is # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts  in the context of Rego/OPA?
a: # Parse JWT payload manually (not recommended vs io.jwt.* but illustrative) parts := split(input.token, ".") payload_b64 := parts[1] payload_json := base64url.decode(payload_b64) claims := json.unmarshal(payload_json)
reference: BLK-3bd110a004054aa9
digest: 6a7ad4fbabb9bc4fbbd5ad7eecbc530ba1be1bb9fcad46a57595908b3f50901d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e762d50c957fe0dd
chapter: CH-05
q: What is # Marshal deny messages for logs deny_json  in the context of Rego/OPA?
a: # Marshal deny messages for logs deny_json := json.marshal(deny_msgs)
reference: BLK-365175335364136d
digest: e71646547d6ef4d9329066a2456760e168c1272ef6fe6c19820ae332c5aff011
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b96bc83d400b73b5
chapter: CH-05
q: What is 6.12 Type Introspection. in the context of Rego/OPA?
a: 6.12 Type Introspection
reference: BLK-393080aa0cc18d4b
digest: e488ffd0693c73049b3d33b0d3d10c7c51b88bc1386d6b318791946ffe9069c2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-78ecd86443a2d2ce
chapter: CH-05
q: What is Type predicates and type_name are invaluable for robust policies in the context of Rego/OPA?
a: Type predicates and type_name are invaluable for robust policies:
reference: BLK-f590cb8820f569fa
digest: 43b991b69aeceafe7cfd352c2b178e09fcc93a9498c44757d4af6f094be87193
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f4d6f50121f626bc
chapter: CH-05
q: What is Is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", ... in the context of Rego/OPA?
a: is_array(x) is_boolean(x) is_null(x) is_number(x) is_object(x) is_set(x) is_string(x) type_name(x) # "array", "object", "set", "string", "number", "null", "boolean"
reference: BLK-74c7bb9f41c91813
digest: 4a3ea2361c1d380b6b557cc581cc73749211c737357f7921fd175074cc52a20c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3bbb772369b1b6ec
chapter: CH-05
q: What is Pattern in the context of Rego/OPA?
a: Pattern: Defensive guards before deeper logic:
reference: BLK-26988fbc99af1428
digest: 5b228ce9d09c52b5157081927067127a87eca1426a1ac24034863af21cd4f53a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3fd21d4fd9621d9a
chapter: CH-05
q: What is Valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) }. in the context of Rego/OPA?
a: valid_request if { is_object(input) is_object(input.user) is_string(input.user.id) is_string(input.action) }
reference: BLK-3e50cfb0dfea9e5b
digest: 6fdc3c37064458f817a27d5f62e6d0ff6824e654ac9efe872cb69fc880791f57
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-30e46d72ba8d9692
chapter: CH-05
q: What is Input Safety Best Practices in the context of Rego/OPA?
a: **Input Safety Best Practices:**
reference: BLK-fe1e428678f12304
digest: d924afa415cc82af1a0c0b1c61468428fe2da3b331e130009679dbae55e0fc33
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d5a4a6eab3a51274
chapter: CH-05
q: What is Always guard access to optional or potentially missing input fields in the context of Rego/OPA?
a: Always guard access to optional or potentially missing input fields:
reference: BLK-539d7bec736ce9fa
digest: 16a30f04eb4bbd26929be39f309f3d889dd3fda217bf0757217a7f31a1e72b00
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5bea6211b0274064
chapter: CH-05
q: What is Common Patterns in the context of Rego/OPA?
a: **Common Patterns:** - Check `is_string()` before `contains()`, `startswith()`, `endswith()` - Check `is_array()` before iteration with `some ... in` - Check `is_object()` before property access - Check `is_number()` before arithmetic operations - Create a top-level `input_valid` guard and use it in all rules that access input
reference: BLK-f1a5006e2f61d559
digest: 4938de90327a69185f261c0a6c285473529c37cab708c013e4b9dd352c0a0eba
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c83fb36e09fc37b6
chapter: CH-05
q: What is 6.13 Cryptography & Security Built-ins. in the context of Rego/OPA?
a: 6.13 Cryptography & Security Built-ins
reference: BLK-9931b529da7c6226
digest: 5a5259023e34ad13cf305dfb2be8b7d420b02d0999b1278d4a46d2156cbdbacb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6a4cbcd4798b765c
chapter: CH-05
q: What is Security-sensitive policies rely heavily on crypto built-ins. in the context of Rego/OPA?
a: Security-sensitive policies rely heavily on crypto built-ins.
reference: BLK-7ad70344cf0fd579
digest: ee9e1a4ad1c988ae96c81f2c3d68513ee5c90097ebce382e69d8fe7fb043ef17
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-070a0d54308b3d5e
chapter: CH-05
q: What is Hash functions & HMAC in the context of Rego/OPA?
a: Hash functions & HMAC:
reference: BLK-e82692da642da4e6
digest: a1e0e45959793c3725ce5fc8aad08beaf622f3162acb716deece7ae62cfe6a37
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e10259a427bdc845
chapter: CH-05
q: What is Crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data). in the context of Rego/OPA?
a: crypto.md5(data) crypto.sha1(data) crypto.sha256(data) crypto.sha3_256(data) crypto.hmac.sha256(key, data)
reference: BLK-07cc51248e326726
digest: 0d49302642752f763672ba6563554f751075579ab3aeccd103124f79a470feef
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8afd1d88c992b5fc
chapter: CH-05
q: What is Key-derivation & password hashing in the context of Rego/OPA?
a: Key-derivation & password hashing:
reference: BLK-0c4673919ffeab0f
digest: e13f24bec69ec47baa4d7e9b5ef93c942b16680ed9ed02ea30d0ca1167646da3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d0e542e9ddbbf865
chapter: CH-05
q: What is Crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password). in the context of Rego/OPA?
a: crypto.pbkdf2(hash_alg, password, salt, rounds) crypto.bcrypt.hash(password) crypto.bcrypt.compare(hash, password)
reference: BLK-760d822b72ca8385
digest: b8a96dcb6412a4a7aa1976cf38fa9d43504bdf6cad3b7d91b9523771c3a20198
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d148ee5198eea17a
chapter: CH-05
q: What is X.509 and certificates in the context of Rego/OPA?
a: X.509 and certificates:
reference: BLK-38e55e81ea44e29b
digest: 9d419c4a61c225e918209567cb634b1f75908cb1f6dfb73ce54d9129d98789f0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-59c97deaf3bcc165
chapter: CH-05
q: What is Crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs. in the context of Rego/OPA?
a: crypto.x509.parse_certificates(pem) # parse PEM bundle ‚Üí array of certs
reference: BLK-92df017ca6dd0a84
semantic_categories: [distribution]
digest: a1572ef202ad6ce19b0877b262af939097ec964d6a8465ce42bfc55e490ea7f6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4a4244bba5d8fa18
chapter: CH-05
q: What is JWT helpers (in io.jwt namespace) in the context of Rego/OPA?
a: JWT helpers (in io.jwt namespace):
reference: BLK-bca085b327a54593
digest: 7096e862d69fad5e8761bef824e8aa73a89494aa883b6d51fa23dd1bf5562d5e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e87d13b775b20f40
chapter: CH-05
q: What is Io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt.... in the context of Rego/OPA?
a: io.jwt.decode(token) # [header, payload, signature] or undefined io.jwt.verify_hs256(token, key) # boolean io.jwt.verify_rs256(token, cert) io.jwt.verify_es256(token, cert) io.jwt.verify_ps256(token, cert) io.jwt.encode_sign_raw(headers, payload, key)
reference: BLK-c51a72be2c4f7943
digest: c3df7d26a8580866cac65db74d9d4a703a8e38f13ff08cdf44c6637f7ea2b37e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4b77f3b6a3e733fd
chapter: CH-05
q: What is Valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) }. in the context of Rego/OPA?
a: valid_token if { io.jwt.verify_hs256(input.token, data.jwt_secret) }
reference: BLK-9c235109ac4fb55a
digest: 94fd621f89d50c4d56349b8b50b1b5492c1364d524eef3de0895df7bc0688932
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-37475d052deb8604
chapter: CH-05
q: What is Deny[msg] if { not valid_token msg  in the context of Rego/OPA?
a: deny[msg] if { not valid_token msg := "Invalid JWT" }
reference: BLK-79d62f89dc8c2bbe
digest: 1e3dc7e48fa6648815265be6020fcdcff4f4a455d6d24fc824ca9a280f9a0f4b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-737bdab9db1fb017
chapter: CH-05
q: What is Never bake secrets into Rego source; pass via data or environment. in the context of Rego/OPA?
a: Never bake secrets into Rego source; pass via data or environment.
reference: BLK-5c33fbfabf3e6fb4
digest: 2e0ba8e3014ab0ef60c3fc42c20de29491ebe2a5c97bfb31e5b315da2eaf966b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2781f38803eddc60
chapter: CH-05
q: What is Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints). in the context of Rego/OPA?
a: Use strong algorithms (avoid MD5/SHA1 except for legacy fingerprints).
reference: BLK-381855197c8a3986
digest: fcccc7eb0859522edc28246218699e595715a8bf0d91013516b0641a3d1f71b4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d03eb1366f811484
chapter: CH-05
q: What is 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs). in the context of Rego/OPA?
a: 6.14 This chapter catalogs core built-ins and corrects a few subtle points (arrays, JSON filtering, time, UUIDs/ULIDs).
reference: BLK-c09ef369e7bd778c
digest: a08e92282caebd4d67ae0bd69473e4cf678508bd42e316bfbee019cc9c497fa4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9f3a878afc07535f
chapter: CH-05
q: What is 6.4 Arrays & array.concat. in the context of Rego/OPA?
a: 6.4 Arrays & array.concat
reference: BLK-cb82c0a969ee513d
digest: 563a1cf1f3479f3e47ca7b73afbb2f34a36865430199922ab15d316ff9c553b3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-16f2e262883c81d8
chapter: CH-05
q: What is Arrays are ubiquitous in the context of Rego/OPA?
a: Arrays are ubiquitous: paths, lists of scopes, resource IDs, etc.
reference: BLK-492775404d6858a1
digest: 60bfd56e87fb8bdd9457cb6ccf67daaaf3f85b092cb473658f164173bc1c3a09
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c1b99f0c8fc071a2
chapter: CH-05
q: What is Count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays. in the context of Rego/OPA?
a: count(arr) # length arr[i] # index arr[_] # iterate concat(".", arr) # join into string array.concat(a, b) # concatenate arrays
reference: BLK-803815e4948a9134
digest: 40ff00f4dc1688f349e477ba552ce02022da79df08b134d79e9bed7b17925bd9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ca7d5ee1faf30986
chapter: CH-05
q: What is Array.concat([1, 2], [3]) # => [1, 2, 3]. in the context of Rego/OPA?
a: array.concat([1, 2], [3]) # => [1, 2, 3]
reference: BLK-6d905df2ae0be4ca
digest: 49fffa862f1ab580ac163e92219dedb8e3a25e58b70ad100c9849da7858a0e44
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c0347347b583b099
chapter: CH-05
q: What is Both arguments must be arrays. in the context of Rego/OPA?
a: Both arguments must be arrays.
reference: BLK-01f8eba873aaef46
digest: 9a943d76b194117f0d28ecd17a31653dada4ff71a49615eb5679b31097083db2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-199c65d056536938
chapter: CH-05
q: What is If either argument is null (or not an array), OPA raises a type error. in the context of Rego/OPA?
a: If either argument is null (or not an array), OPA raises a type error.
reference: BLK-c93efe6db0a5e1b6
digest: 2a7571ea78ec36eaf7bad89fb1c7fef740cd1adbdfc45d7f9e07cf0bdf880f22
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6cabddaf977c824e
chapter: CH-05
q: What is For defensive code, wrap it in the context of Rego/OPA?
a: For defensive code, wrap it:
reference: BLK-95bea7dff21c1179
digest: 8cd99207a5d044f23fc85bc5ac98ba3148c4818c0f5be44a3f47301d50df2397
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1a94d44b3ea7da36
chapter: CH-05
q: What is Safe_concat(a, b)  in the context of Rego/OPA?
a: safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }
reference: BLK-01eb9f65fbee8e12
digest: 1b1306cc0577416e9cd8165f1c7162ce09237db38ebeb13897e0430f22031e04
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6e0698928cbe2332
chapter: CH-05
q: What is Use safe_concat in paths or pipelines where inputs may be missing or partially null. in the context of Rego/OPA?
a: Use safe_concat in paths or pipelines where inputs may be missing or partially null.
reference: BLK-5970ca9ef37640be
digest: a97f0e251c16c7c4ff0e345b8d92175064d329726336623573a586fe60d9be68
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-efb3c991c7ae03e9
chapter: CH-05
q: What is Time Functions (No time.diff). in the context of Rego/OPA?
a: Time Functions (No time.diff)
reference: BLK-03437db7242e9e11
digest: 938e8ccb32405b904fc62646fa61577e0dc4ef6e76e38363b504021c8cd3e9fb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b1d9854b9a77bc6d
chapter: CH-05
q: What is Time built-ins revolve around in the context of Rego/OPA?
a: Time built-ins revolve around:
reference: BLK-323678c5fae3b216
digest: 40c08488aea1ca50d9dcdf1aaca23b889ab53c11724d3d7b2f07ad5d0c150d30
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c58ab67e7cf0e5d3
chapter: CH-05
q: What is Getting the current time (time.now_ns). in the context of Rego/OPA?
a: Getting the current time (time.now_ns)
reference: BLK-36093a3541d6fac4
digest: 957d4c0126fee66c9bf85669285e1bcdcbcc1658b28593e701c244a785ecadf6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ed8fe032e8731ada
chapter: CH-05
q: What is Parsing timestamps (time.parse_rfc3339_ns). in the context of Rego/OPA?
a: Parsing timestamps (time.parse_rfc3339_ns)
reference: BLK-9f58a11b445194e4
digest: 3e7784c54800c51226a3df4634450d47d12aaa5b79468570c82d8255885fd9da
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0e4b35e31727dddc
chapter: CH-05
q: What is Formatting (time.format, etc.). in the context of Rego/OPA?
a: Formatting (time.format, etc.)
reference: BLK-98d4acbef290299c
digest: 1c8e20ae96f976d0968d39027e61135506c74e65f477cd6a18d5863ebe3b3ca6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0022ddcf46b2e7c0
chapter: CH-05
q: What is Example of computing a duration in the context of Rego/OPA?
a: Example of computing a duration:
reference: BLK-4b147b9e016ab307
digest: e614d39a93dd4ab5083661e2ad8448284666d3d29898741456fd8ade26f341b1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-71c5bfffb7f698a4
chapter: CH-05
q: What is Now  in the context of Rego/OPA?
a: now := time.now_ns() start := time.parse_rfc3339_ns(input.window.start) end := time.parse_rfc3339_ns(input.window.end)
reference: BLK-5110d5b6e76c6c72
digest: ceec3d0c3a720cb49f4aab8642d2a600dfb16a4b12a3f43853e92db8d23ac72f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c94d95491d090d2b
chapter: CH-05
q: What is Duration_ns  in the context of Rego/OPA?
a: duration_ns := end - start
reference: BLK-4f8b95221334c8fd
digest: e1d0535408df6b071b222430fef7bb88efba4300a5b60dbeb48977c671fc82c3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-19f7f32da12b2aff
chapter: CH-05
q: What is Too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes }. in the context of Rego/OPA?
a: too_long if { duration_ns > 5 * 60 * 1e9 # > 5 minutes }
reference: BLK-b93a0cab2b781de4
digest: 9178f63544a6de6ecd589bc215a63ed5839b8d6096015b1f534d173e6d1ff433
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8f6a96c77fcb2c5a
chapter: CH-05
q: What is Important corrections in the context of Rego/OPA?
a: Important corrections:
reference: BLK-f1886568bc74ebd4
digest: 21893600d35d1aa888ccd9e6902dbb28b6e158e68267b2d09fcafe785830c915
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6d024eeec7f5595f
chapter: CH-05
q: What is There is no standard time.diff builtin in OPA. in the context of Rego/OPA?
a: There is no standard time.diff builtin in OPA.
reference: BLK-1f946628820928af
digest: 3e872fabe71ace8b652d499707b95b14e8ebe59aad73d3894c531eeb53deccf1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-51e540c00510b90e
chapter: CH-05
q: What is Differences are computed with normal arithmetic on integer nanosecond timestamps in the context of Rego/OPA?
a: Differences are computed with normal arithmetic on integer nanosecond timestamps:
reference: BLK-17b123b1fff6830e
digest: 74381f8352f068f909b9a73e742adbee4aaba8526bd7a718454628414c897bd9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-93744388b7a34b8a
chapter: CH-05
q: What is Duration_ns  in the context of Rego/OPA?
a: duration_ns := end_ns - start_ns.
reference: BLK-9f8bb9e36136d01a
digest: ad40c74b0a0bb43908c300c19679d3cc7b9b3a12c68a055a7c8223cf04c7e07e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-230c5b6e36990d45
chapter: CH-05
q: What is This approach works consistently across CLI, server, and WASM runtime. in the context of Rego/OPA?
a: This approach works consistently across CLI, server, and WASM runtime.
reference: BLK-91a7da1dc4599199
digest: e0332e685a2b49a0f8a52f4c3b77337a4d6a26bcb49f7b1839a6fde336891cd7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-83975613dc20ffb8
chapter: CH-05
q: What is Http.send allows policies to call external services. in the context of Rego/OPA?
a: http.send allows policies to call external services. Use with discipline.
reference: BLK-aced02aaabc583d3
digest: b62af45fbe9df70bad9ba768e998cf58bb3af5e72d5cb287d55114c42c33539a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-07ac391ab4c017af
chapter: CH-05
q: What is Resp  in the context of Rego/OPA?
a: resp := http.send({ "method": "GET", "url": "https://example.com/api/v1/status", "headers": {"Accept": "application/json"}, "timeout": "3s" # optional, string with units })
reference: BLK-7e8468a95010fff3
digest: 57fe44b388bc655f74f024573e4bc8e0774e4f354b7f10ec92fbeac6f0775374
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fe4cf1eb53910b75
chapter: CH-05
q: What is # resp = {"status" in the context of Rego/OPA?
a: # resp = {"status": 200, "body": ..., "headers": {...}}
reference: BLK-0c67765085ae094c
digest: bf0e74c1cb087cf41a5e8a499f39288b616aad66effa3fc77de2f162480049e4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-88db14d6e7edcb58
chapter: CH-05
q: What is Potentially slow and side-effectful. in the context of Rego/OPA?
a: Potentially slow and side-effectful.
reference: BLK-c7e05fd3fbe19ba7
digest: 452ef494f02e490eb5bdb78cdfcd3874d5115c421e9b5db90267e4047baf13f0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-23dd86419156f9bd
chapter: CH-05
q: What is Memoized in the context of Rego/OPA?
a: Memoized: same arguments ‚Üí single call per evaluation, cached for subsequent uses in the same query.
reference: BLK-1d62064b846fefe8
digest: d70dbef81a1821737dfabe7c3c816461a2347c161d082b14b5c234135121a0e6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2474f711f79e4e3d
chapter: CH-05
q: What is Prefer to fetch external data ahead of time and feed via data or input. in the context of Rego/OPA?
a: Prefer to fetch external data ahead of time and feed via data or input.
reference: BLK-1f0979248041848f
digest: 7aa16f6711d5b40b80dc7644c1139f05d971405d5d80ee915cd3bc7aef630fd6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-158a183c54e375cd
chapter: CH-05
q: What is In CI or admission controllers, avoid http.send altogether if possible. in the context of Rego/OPA?
a: In CI or admission controllers, avoid http.send altogether if possible.
reference: BLK-4f352c6a1c6b58e9
digest: b014c601340d1cc27b23aa8dedbca2db113123b59d8c9f124b75fcbaa8971d5a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-41e47f4d00915f5b
chapter: CH-05
q: What is Test_http_policy if { result  in the context of Rego/OPA?
a: test_http_policy if { result := policy.check with http.send as mock_http_send }
reference: BLK-f214eb556e8a953e
digest: a1b35e899b29cd0094f1fc19fab36e1e06dfa4600545650c0ec439bcf93c743f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-916225d51ea75cc7
chapter: CH-05
q: What is 6.16 Network & CIDR Built-ins. in the context of Rego/OPA?
a: 6.16 Network & CIDR Built-ins
reference: BLK-0275e80b2c04c6f4
digest: 2672071662813cbd425d34887e1a4fd9639b91db2c84c2b9f080e0ef6aa52bc1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9ee575202b331c74
chapter: CH-05
q: What is Networking helpers are invaluable for Kubernetes and cloud policies. in the context of Rego/OPA?
a: Networking helpers are invaluable for Kubernetes and cloud policies.
reference: BLK-52d1864741c9bdce
digest: d22f47d8b3a2a283b6e27b02381bfed40f86b362c6762bab12036a031acb4733
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-78354af1db10e924
chapter: CH-05
q: What is Net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_... in the context of Rego/OPA?
a: net.cidr_contains(cidr, ip) # true if ip ‚àà CIDR net.cidr_expand(cidr) # list of IPs in small range net.cidr_intersects(c1, c2) # overlap? net.cidr_merge(cidr_list) # merge overlapping ranges
reference: BLK-d809a65103391f7e
digest: 6a86670b84b741e1f628f218635a2827fdaa0ed6a38dec91fe5fc1af6ad7fb0c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-067e3656e0919977
chapter: CH-05
q: What is Deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg  in the context of Rego/OPA?
a: deny[msg] if { not net.cidr_contains("10.0.0.0/8", input.source_ip) msg := "Source IP outside corporate network" }
reference: BLK-44848643a647fa46
digest: 7e9f4714d384e546736d10ebb5cc43a413e016b92a45c6360ba9b0504b222e6c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d41cb063c3787ca1
chapter: CH-05
q: What is 6.17 UUID & ULID Generation. in the context of Rego/OPA?
a: 6.17 UUID & ULID Generation
reference: BLK-da20c90c9d182979
digest: de2493db5ddc84502f6df216b202e1eabe20b20e62f1e3a1ebdb7d7035f533b9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-54cc57d430fefcbc
chapter: CH-05
q: What is Some deployments expose helpers in the standard library or via plugins. in the context of Rego/OPA?
a: Some deployments expose helpers in the standard library or via plugins. Common patterns:
reference: BLK-fd859354759e8d82
digest: c666e52cf5ffda26a56fe3fb3f72591de130c1fb41abe7505a020aeb6da30d3b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-93ee953baa7b1e99
chapter: CH-05
q: What is Uuid  in the context of Rego/OPA?
a: uuid := uuid.rfc4122(seed) ulid := ulid.generate()
reference: BLK-eebd69b192e04b25
digest: 9ec139b31adf3cd569fcc6e54ae08b7f0fc07ba80c4381cf2391a9546ca73249
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d5b7edb3a6d5ca9e
chapter: CH-05
q: What is Deterministic for a given string seed. in the context of Rego/OPA?
a: Deterministic for a given string seed.
reference: BLK-22cafa7883ad8583
digest: 275205e17302f90c38493bb01ca786d052e782bfbcea82f6423a101f70a51381
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b53a2736a52126da
chapter: CH-05
q: What is Ideal for tests where you want stable IDs. in the context of Rego/OPA?
a: Ideal for tests where you want stable IDs.
reference: BLK-9e2b48aeaea0a3b0
digest: e70a0859560245a98f0e99dd0c6ac20df8b3ab0910258a93ea90afac8dea2b6f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7fc0f92a44aaee63
chapter: CH-05
q: What is Time-based and non-deterministic. in the context of Rego/OPA?
a: Time-based and non-deterministic.
reference: BLK-088670189c3d74cf
digest: eda1031e21748322ba1c57418bfcdfa2b31a0341d9a89258dc500fe1f1c10011
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-43d50476e05144ce
chapter: CH-05
q: What is Great for production identifiers, but brittle in tests. in the context of Rego/OPA?
a: Great for production identifiers, but brittle in tests.
reference: BLK-3bd9a709d1537f2e
digest: 417860bd5a904ce10e960efdd664362bb928d00e762b29bd6eae007bb891886e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1b4ac2f49d686140
chapter: CH-05
q: What is Testing recommendations in the context of Rego/OPA?
a: Testing recommendations:
reference: BLK-dabc7897b0693fc8
semantic_categories: [testing]
digest: 29780038d4bb67418f7f98e85316cde83f541b4b4056c7c758f3ef54182f1a84
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ba30bb10bd95dbd5
chapter: CH-05
q: What is # Stable UUID in tests test_id  in the context of Rego/OPA?
a: # Stable UUID in tests test_id := uuid.rfc4122("test-seed-123")
reference: BLK-170f2a1e591e04fa
digest: 7569229c2e7737bc3a26c42f9fad0fb4b8c316661c2320b49262b139d510a3a4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9d347474a348f726
chapter: CH-05
q: What is # - mock it with in the context of Rego/OPA?
a: # - mock it with: with ulid.generate as "fixed-ulid"
reference: BLK-a04d8dafcc0fa4ec
digest: f32943c9e017e890c74e60095525768feb7913613a81ba3fb27edf7b6b169469
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d755b798b89263dd
chapter: CH-05
q: What is # - or only check that a ULID exists / matches a regex, not its exact value. in the context of Rego/OPA?
a: # - or only check that a ULID exists / matches a regex, not its exact value
reference: BLK-8c0b2ddbd669fce8
digest: bc95cc0dfcacc8af6dd468d513f6091a0cfe84e4c9cb17be40c59e05903be1c7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ea828ab3f58ae86d
chapter: CH-05
q: What is 6.18 Graph & Structural Walks. in the context of Rego/OPA?
a: 6.18 Graph & Structural Walks
reference: BLK-25b1b7cd937cb1b3
digest: 1c1218f2a1889599770c5bd71cf725f07247849b4221b9e87222108d0fd0512a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8e500ccefa48d472
chapter: CH-05
q: What is Graph.* functions operate on graph structures (represented as adjacency lists). in the context of Rego/OPA?
a: graph.* functions operate on graph structures (represented as adjacency lists).
reference: BLK-5893372fbb305323
digest: 30cb79dd61d6c41f32ae8953ba0c88c7155d2a03feedac622ca8e3ed032d3821
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-56b14a67236e742d
chapter: CH-05
q: What is Graph.reachable(graph, ["start"]) # list of reachable nodes. in the context of Rego/OPA?
a: graph.reachable(graph, ["start"]) # list of reachable nodes
reference: BLK-40bcf556b793fb46
digest: ee6f6f571ab03a2153ec554e097afb4ab9d5537abf6346995cb86aed1b593525
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7ec26db0a90e58b1
chapter: CH-05
q: What is Walk(x) traverses nested structures and returns [path, value] pairs in the context of Rego/OPA?
a: walk(x) traverses nested structures and returns [path, value] pairs:
reference: BLK-a50a80fdc1c25566
digest: 49bf5496524e88cc16c664bbc18f32cc7bd6bbc5095f4909760eae232b287956
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6fb3dd48d7aa6fbb
chapter: CH-05
q: What is Pairs  in the context of Rego/OPA?
a: pairs := walk(input)
reference: BLK-92e3fc7d804a2808
digest: 1a5a1ac028996a944001840c36bd7460b9395c029ddfbbf2ed66bc6c80e07380
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-08a943a671307262
chapter: CH-05
q: What is # pairs is [[["path","to","value"], value], ...]. in the context of Rego/OPA?
a: # pairs is [[["path","to","value"], value], ...]
reference: BLK-7bf0cd27ee7a741b
digest: 8b2c0075da02cf8a2dba4638840d718d290599a4773bc03ccee3cc2f0b623000
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-aa958d1f4ad950ff
chapter: CH-05
q: What is # Find all values under keys called "id" ids  in the context of Rego/OPA?
a: # Find all values under keys called "id" ids := {v | [p, v] := walk(input) p[_] == "id" }
reference: BLK-bf0bc41d6b2d1316
digest: ffb796888791af321f05325eb1d4147b3fa30aad7c2bcbb951d63d278c7cf2ff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-310ab848a83e919c
chapter: CH-05
q: What is 6.19 Units & Parsing. in the context of Rego/OPA?
a: 6.19 Units & Parsing
reference: BLK-c8affe0478937bf0
digest: 0e9bd70118cfaa56e9cf7d57a1abb73fcfd1961c6cacd80ca727c60ba1cbc786
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-946afbaec3ac789e
chapter: CH-05
q: What is For human-friendly sizes or durations in the context of Rego/OPA?
a: For human-friendly sizes or durations:
reference: BLK-b205c1c7c5b4d6cf
digest: 74ebf21ee652380f39ebe7dae9f185983bde9d5311f6f368a8910f7aa25c1932
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8c901182c630c10d
chapter: CH-05
q: What is Units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant. in the context of Rego/OPA?
a: units.parse("10GB") # parse size with units ‚Üí numeric bytes units.parse_bytes("10MB") # synonym-focused variant
reference: BLK-6ff4f186b7b2630a
digest: bd7de4045bffeb50f6ed8794b3daae9342637ec4f74f5a8f14cd00dccceb0775
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4fddda21433e3be7
chapter: CH-05
q: What is Useful for policies over resource limits in the context of Rego/OPA?
a: Useful for policies over resource limits:
reference: BLK-af94401090888bac
digest: 6f24e2ab7392ed5f99f258184f906bd4d53aae21881a5223ce580f45ef0ccc7e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d0b72bd59e0f89fb
chapter: CH-05
q: What is Deny[msg] if { limit_bytes  in the context of Rego/OPA?
a: deny[msg] if { limit_bytes := units.parse(input.spec.resources.limits.memory) limit_bytes > units.parse("4Gi") msg := "Pod memory limit exceeds 4Gi" }
reference: BLK-3b7e4e77e5997407
digest: 36585ba7007ab73ee064c415c5e03316f84e9e7c119c07ec2c58b450b7cbc660
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8e0690562aa01940
chapter: CH-05
q: What is 6.20 Metadata & Annotations. in the context of Rego/OPA?
a: 6.20 Metadata & Annotations
reference: BLK-37ac9c46cd3b8691
digest: 2885401a7ec9a20544c22335f3b581e523938aa6907de7ee5e9bd7537f51aded
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2ddad2af5c0c8aeb
chapter: CH-05
q: What is Rego exposes rule metadata at evaluation time in the context of Rego/OPA?
a: Rego exposes rule metadata at evaluation time:
reference: BLK-0df20cfb2ff67a77
digest: bc1dee61682c826ebe62dcea65bb6a14dd0e07a91dafc46e63e56b3f751da409
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f331e67879837fdd
chapter: CH-05
q: What is Rule_meta  in the context of Rego/OPA?
a: rule_meta := rego.metadata.rule() # metadata of current rule chain_meta := rego.metadata.chain() # stack of rule metadata along evaluation chain
reference: BLK-22d542254fb4e430
digest: c15f2cf9266f517e3aab1ebf13d0b9d9d16d943dc7f3a0679222ab226d9b9ebd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2923bd67da16f2ee
chapter: CH-05
q: What is Enrich decision logs with rule IDs, owners, severity. in the context of Rego/OPA?
a: Enrich decision logs with rule IDs, owners, severity.
reference: BLK-75f34843f2caa056
semantic_categories: [observability]
digest: 852adc4d2ebe7d4bb81b20b822d3144151a3420795d9e42ff10d04073ff8a8c7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-13f6107062e3d0cb
chapter: CH-05
q: What is Drive governance features (e.g., map violations back to policy owners). in the context of Rego/OPA?
a: Drive governance features (e.g., map violations back to policy owners).
reference: BLK-42bca06a919a5ae8
digest: 79a20f20d0a746d0dacd0d44653a33b282bb9bfca5f29c8e5457e7f9fe26f299
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9ae9d0a155a32194
chapter: CH-05
q: What is Deny[msg] if { violation_condition m  in the context of Rego/OPA?
a: deny[msg] if { violation_condition m := rego.metadata.rule() msg := { "msg": "Violation detected", "rule_id": m.id, "owner": m.owner, } }
reference: BLK-2a123209b43ae5ad
digest: 45ed5026f7f4c0bdf5f8bd8a6bb9b99eb3e1c144e765baf98f57acb882ce8bcf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f7d651eb7449a443
chapter: CH-05
q: What is 6.21 Debugging Built-ins in the context of Rego/OPA?
a: 6.21 Debugging Built-ins: print and trace
reference: BLK-89b0fd99072a7ad9
digest: d0a4015f9f07a8ef779eb83bc471c35d767d3d625d6f9c5460b71fa74bcc5058
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-48dfe833809edf65
chapter: CH-05
q: What is Print is the primary debugging tool for Rego in the context of Rego/OPA?
a: print is the primary debugging tool for Rego:
reference: BLK-d9889415e47b56cf
digest: 6f227b2ebdc94ab13fb816745fdc403acf274d0bc6b654abfb809ae1947c79bc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-55c729936adfbae5
chapter: CH-05
q: What is Debug_rule if { x  in the context of Rego/OPA?
a: debug_rule if { x := input.value print("The value of x is:", x) x > 10 }
reference: BLK-1095ee34dfae7aed
digest: 7cecc681fbefdf82f20b7ed291bc178dffbef8bfe9caadf5eafabcc003f65ed5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-055c3ba144d88ff2
chapter: CH-05
q: What is Print(...) always returns true, so it does not change logical semantics. in the context of Rego/OPA?
a: print(...) always returns true, so it does not change logical semantics.
reference: BLK-fb39667760c12b4c
digest: c23a66ae073eb8f58f818f0b664da9ca3c5bdc2a05dccf8edff27648f338c6a8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7b367fe3adb925e7
chapter: CH-05
q: What is Output appears in OPA logs or opa eval --explain trace output depending on environment. in the context of Rego/OPA?
a: Output appears in OPA logs or opa eval --explain trace output depending on environment.
reference: BLK-0d4a08a0bff4d6d5
digest: 4f6c13c830ff2a816ad8be6094c02b5ad160b15f56cc34d7389c0f2409555412
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e7e4a1492e338518
chapter: CH-05
q: What is Trace may also be available as an alias in some environments; print is the standard. in the context of Rego/OPA?
a: trace may also be available as an alias in some environments; print is the standard.
reference: BLK-e1788d332fd4b6ad
digest: 898167a900176c999068e738d86477404580edcd8ce3e4f62cfc16e7d1c1e120
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5512c3dd4ce67432
chapter: CH-05
q: What is Use print liberally during development and experiments. in the context of Rego/OPA?
a: Use print liberally during development and experiments.
reference: BLK-abf7fb28b77ba86b
digest: 8628bc54d3b72299db7dcc7cbc7e3d4067b82d8e8bad6d951510dca484d9c9c8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-166efa817eec57b9
chapter: CH-05
q: What is Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod). in the context of Rego/OPA?
a: Remove or gate print statements in production policies to avoid log noise and PII leaks (many style guides enforce no print in prod).
reference: BLK-e61c1e6a7ef98607
digest: 9e473c440fe0577cd681775a6d751f15a5c9e4009c5f876d967f8e28afdc069e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-90fbeab18caeccd0
chapter: CH-05
q: What is 6.22 Error Semantics & Strict Mode. in the context of Rego/OPA?
a: 6.22 Error Semantics & Strict Mode
reference: BLK-9de1de98fdc727e3
digest: 7daa9db97d50400259308888d2ddb8e7c9a76d9c73501865216dceb46d9c6480
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-96a97622afaf7c7c
chapter: CH-05
q: What is By default, built-in errors make expressions undefined in the context of Rego/OPA?
a: By default, built-in errors make expressions undefined:
reference: BLK-98bcb77cc1ac5811
digest: 4df3c764336999ae87b07c2214556929fea12d6eb17ba4bc315b828b328b6496
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8da90b3ad2faba1f
chapter: CH-05
q: What is # If to_number fails, rule body is undefined is_valid if { n  in the context of Rego/OPA?
a: # If to_number fails, rule body is undefined is_valid if { n := to_number(input.score) n >= 0 }
reference: BLK-36aac4923d6e8a11
digest: da093be5a8dd3182d0fcabec566651c40d075f18f9e33c9da520732c775a9a20
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ce9f6c3e02e767e5
chapter: CH-05
q: What is For higher assurance, strict builtin errors convert such errors into hard failures in the context of Rego/OPA?
a: For higher assurance, strict builtin errors convert such errors into hard failures:
reference: BLK-8cc9eedcab25fd2b
digest: a76bcef03da62441b53a7fbb237888aa69aa4e7894012793cef60a165b0c81b8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9213fcfc7b78fa1d
chapter: CH-05
q: What is Opa eval --strict-builtin-errors ... in the context of Rego/OPA?
a: opa eval --strict-builtin-errors ...
reference: BLK-7723dfb7493646b4
digest: a4b5d5aed1a85b2d8b930b8f3f921940fe4d8f0dd73484083296aee7d9610605
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-12544b627abf7498
chapter: CH-05
q: What is HTTP API in the context of Rego/OPA?
a: HTTP API: strict-builtin-errors=true query parameter.
reference: BLK-629475ec5c0d3bfb
digest: 1b1ec09086e8fac491e3132f2062fa89ddb57d42458182a0b077f3bf89ceca11
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-37f1642e10b42144
chapter: CH-05
q: What is In CI to catch unexpected type mismatches and invalid data. in the context of Rego/OPA?
a: In CI to catch unexpected type mismatches and invalid data.
reference: BLK-93ad46a2fdd8ff11
digest: 25d4ab0c65382e4a9031d97ef6895c5136fb9ae7a75591603d84707d2c3db6d4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-453374693e02d4b9
chapter: CH-05
q: What is In critical policies where silent undefined behavior is unacceptable. in the context of Rego/OPA?
a: In critical policies where silent undefined behavior is unacceptable.
reference: BLK-557953aa35227612
digest: e8d113d45f6fc3ce0f35b6c0f3c374ca6e4b7f46d973bcbaec32056a6bc821cf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-31f8f023fd6cbf44
chapter: CH-05
q: What is Pattern in the context of Rego/OPA?
a: Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
reference: BLK-22b57961d600fe2f
digest: c72029ccf69a687c826bbcdfc9df7336878374cadf17b27d8521ba1f634ceb3e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d931696d3a84f564
chapter: CH-05
q: What is 6.23 Performance Patterns with Built-ins. in the context of Rego/OPA?
a: 6.23 Performance Patterns with Built-ins
reference: BLK-f3b1c72ce3eb55c9
digest: e6778da31eea602e249834ff2dc319ca43dd19ef850dd31a96a3e1f355b3d9e5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b7ee5539b0ffefe9
chapter: CH-05
q: What is Guard expensive built-ins with cheap checks. in the context of Rego/OPA?
a: Guard expensive built-ins with cheap checks
reference: BLK-52537d28f7f19d80
digest: 43639d424394d63e0f35fa9eebb118b548f2c9ff6fde7fc1b58329d02f555018
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-778bdc3950bf8adc
chapter: CH-05
q: What is # Good in the context of Rego/OPA?
a: # Good: fast predicate first deny if { input.method == "POST" regex.match(`(?i)password`, input.body) }
reference: BLK-2a74bde34951ff9b
digest: d65877ba79b8804c7e3d43c0d9ede478055c9d328aed40782b7b8478bdebab83
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f3bdffa65dd744b7
chapter: CH-05
q: What is Avoid large intermediate arrays via comprehensions if a boolean will do. in the context of Rego/OPA?
a: Avoid large intermediate arrays via comprehensions if a boolean will do
reference: BLK-85e73235529b5c88
digest: 681296e16df33d03b62c6fd8c5dc9f11d0e1e423d237e959d19ef6bb23b76413
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2a74715573c7cc8a
chapter: CH-05
q: What is # Bad admins  in the context of Rego/OPA?
a: # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0
reference: BLK-c6e81d159f73459d
digest: feef1f15e8a2ef4b1d8faaee1d501337d901c962110c0dc6e91014eacdc31535
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-eae047cf035f079d
chapter: CH-05
q: What is # Good has_admin if { some u in users "admin" in u.roles }. in the context of Rego/OPA?
a: # Good has_admin if { some u in users "admin" in u.roles }
reference: BLK-8237d2a05c87c232
digest: dcd81ae4b13fe8acfe3c868c3cea2b24dcae1773b17e1260b6aeab4a94bd98d6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4a08b656d33fe129
chapter: CH-05
q: What is Use sets for membership, arrays for ordered sequences. in the context of Rego/OPA?
a: Use sets for membership, arrays for ordered sequences
reference: BLK-c15df4c67851208d
digest: 22fc0b4fd12d9be99ddd32ca3903fcf93d14c43fbf969e730b8e21cd06d448ff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fa3c0a1efcab4769
chapter: CH-05
q: What is Memoization awareness. in the context of Rego/OPA?
a: Memoization awareness
reference: BLK-62c2e97c399eb38b
digest: 82d24ec047f7bb296e22320872f5bf0cc11bde00275e47c1b4d5c4ac38792f0e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ddbb48b91a695fbe
chapter: CH-05
q: What is Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached. in the context of Rego/OPA?
a: Expensive built-ins with same arguments (e.g., http.send, complex regex.match) will be evaluated once per query and cached.
reference: BLK-a6bde4c24ae6370c
digest: 7d1767f73943034063a486e875fce9684104daf51c002eb8c212efd350a325ed
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e383bc6221d4699c
chapter: CH-05
q: What is If inputs differ slightly each time, caching may not help; consider pre-processing. in the context of Rego/OPA?
a: If inputs differ slightly each time, caching may not help; consider pre-processing.
reference: BLK-25cc50c2bf8d6039
digest: d404d6f6a1772199666fcf1d297893f70b76c97073a2925351594255b3dda010
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1845a6ee4af41f90
chapter: CH-05
q: What is Validation helpers in the context of Rego/OPA?
a: Validation helpers: Make dedicated rules using type and conversion built-ins (is_valid_request, normalize_email) and reuse everywhere.
reference: BLK-721972a19dbe3e46
digest: 3ca649a41ff433a64a367cc5eb0e9e05ddfb367294f0871a6765bd6692b741c5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5c821a2a9880b0c3
chapter: CH-05
q: What is Canonicalization in the context of Rego/OPA?
a: Canonicalization: Always lowercase/trim user-identifiers before comparison.
reference: BLK-2105253d138563cb
digest: a722d880d7bd7f5f48433bd10539ebc969a75b4ff2b6d8b2d90b1496088081ec
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3b3ed9f767458ac2
chapter: CH-05
q: What is Safe logging in the context of Rego/OPA?
a: Safe logging: Use object.remove + json.marshal + trim* to avoid PII leaks.
reference: BLK-f78bd271000af25a
digest: 0e48c85f05881f1c9e7e001c6abb664e867ed538fc430c7ecb77973834020b64
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ec67cae083515342
chapter: CH-05
q: What is Overuse of regex in hot loops will tank performance. in the context of Rego/OPA?
a: Overuse of regex in hot loops will tank performance.
reference: BLK-6d542199f9475a27
digest: a8d03e7fbdf30ce49c22111a7aa8b32416edf5fa635e29a2f7da67a5f693a565
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4f3943416ee9fb86
chapter: CH-05
q: What is Prefer startswith, endswith, contains, or exact matches when sufficient. in the context of Rego/OPA?
a: Prefer startswith, endswith, contains, or exact matches when sufficient.
reference: BLK-5851e4a3db9f9ac3
digest: 5d911745375a37e01c27529e28c285561eec014dc80e8e032ccf62663865ba87
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7bc10090d2891abc
chapter: CH-05
q: What is Hidden type conversions in the context of Rego/OPA?
a: Hidden type conversions:
reference: BLK-2467bf0ffb43ccb1
digest: b9ab25c114ac5a6be39b5b7d6694b336924fb45cf77f17c7075452c80ff29b84
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-77d89648fb405055
chapter: CH-05
q: What is Relying on to_number implicitly instead of checking type leads to brittle policies. in the context of Rego/OPA?
a: Relying on to_number implicitly instead of checking type leads to brittle policies.
reference: BLK-e4f27c62a91903fd
digest: 5f1d8fb8e6e1b09a634992e6bd2f5d41381f4473fa5e9fc8254c918da717358e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f18e134d6c43fbb8
chapter: CH-05
q: What is Unbounded http.send usage in the context of Rego/OPA?
a: Unbounded http.send usage:
reference: BLK-4510e9e029402fb5
digest: 487d7d2eca6fabc3e1be873c984a4b26105468642b3be60c3446f48645c30720
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-164684966c3f77eb
chapter: CH-05
q: What is Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths. in the context of Rego/OPA?
a: Using HTTP calls per request is rarely acceptable in admission controllers or hot authorization paths.
reference: BLK-fe080225bb5195ba
semantic_categories: [authz]
digest: 3f159669a51aedd9a67030754d5c9d9444c192221b758f6b4ef16e24dfbbf9d2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-40771e275944511f
chapter: CH-05
q: What is Non-mocked time in tests in the context of Rego/OPA?
a: Non-mocked time in tests: Using time.now_ns() directly in tests causes flakiness; always with time.now_ns as ...
reference: BLK-7b0b481d4c3ce520
digest: d98ff27371c0da69c07e415a2efb5f16cc27c0ce15ef25e8bb26e27d0d2de708
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-708db86afd27a59a
chapter: CH-05
q: What is Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which... in the context of Rego/OPA?
a: Chapter 7 ‚Äì Testing, Debugging & Troubleshooting (From Hello-World to PhD) Testing is not an afterthought in Rego/OPA; it is the mechanism by which you prove that your policies are correct, stable, and maintainable. This chapter builds from basic _test rules up to full-blown policy test architectures, fuzzing, and debugging strategies. ________________________________________ 7.1 Testing Fundamentals Where tests live Tests are Rego modules whose package names end in _test. Convention: Production package: package authz.api Test package: package authz.api_test Naming rules Test rules must start with test_. A test passes if its body can be satisfied (i.e., is true); it fails otherwise. package authz.api_test
reference: BLK-da85b2ab78e71372
semantic_categories: [testing]
digest: 897a25d0063c8e36cd8779d8d4f44de831b77c50191c9654f48dd1e80a74a222
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-554398d9655e4fa5
chapter: CH-05
q: What is Import data.authz.api. in the context of Rego/OPA?
a: import data.authz.api
reference: BLK-980b341fb19bb54f
digest: 9f142236ef82ceb739b3c396105f003fb3a59479db42e389546391823b333202
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7e9be9e4acf051b2
chapter: CH-05
q: What is Test_admin_can_read if { api.allow with input as { "user" in the context of Rego/OPA?
a: test_admin_can_read if { api.allow with input as { "user": {"id": "alice", "roles": ["admin"]}, "action": "read", "resource": {"id": "123"} } }
reference: BLK-aee13c5bae097378
digest: 442f3d6e07fc29c29a49fded22a72c33854275b3574f9e96ac718e7ea1fbe94f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5059f2c560220895
chapter: CH-05
q: What is Test_guest_cannot_write if { not api.allow with input as { "user" in the context of Rego/OPA?
a: test_guest_cannot_write if { not api.allow with input as { "user": {"id": "guest", "roles": ["guest"]}, "action": "write", "resource": {"id": "123"} } } Running tests
reference: BLK-0b8df7beeb5c08e5
digest: e8bc1859a79e95a63da393566a0414d679f0cd01e13506f0949f07cf39ee495c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5df7f0fa020a3829
chapter: CH-05
q: What is # All tests in current tree opa test . in the context of Rego/OPA?
a: # All tests in current tree opa test .
reference: BLK-f1a56ec6ccdf9d8f
digest: f12169c30fb241a43a31d338d75a89764717ec0ab0b75b4f1090a773c6887796
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bb70e6c832065f7b
chapter: CH-05
q: What is # Verbose (see individual test names) opa test. in the context of Rego/OPA?
a: # Verbose (see individual test names) opa test . -v
reference: BLK-537801bd1cd367b5
digest: 96692a09197e8b62585863c788d2e83cd843ac0c56827530458e5345a70a711f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b401d77085f3dd31
chapter: CH-05
q: What is # Specific path or file opa test policies/ authz_test.rego. in the context of Rego/OPA?
a: # Specific path or file opa test policies/ authz_test.rego
reference: BLK-fa854a9140894ca2
digest: 31a8a2bd177eb3bab0053ac16e819d6bd72a0dfdf41eed95356ca6f4044376e4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2437a7e287c15f1e
chapter: CH-05
q: What is Override input test_non_admin_denied if { authz.allow with input as { "user" in the context of Rego/OPA?
a: # With coverage reporting opa test . --coverage --format=json > coverage.json ________________________________________ 7.2 The with Keyword for Mocking with is the cornerstone of Rego testing. It temporarily overrides input, data, or even built-ins for a single evaluation. Override input test_non_admin_denied if { authz.allow with input as { "user": {"id": "bob", "roles": ["user"]}, "action": "delete", "resource": {"id": "123"} } } Override data test_role_from_data if { authz.allow with input as {"user": "alice", "action": "read"} with data.roles as {"alice": ["admin"]} } Override built-ins (time, http, etc.)
reference: BLK-a57fac63b249febb
semantic_categories: [testing]
digest: 3d6640b79e7eee966c8acc95be72edce07cd13142e7432c3dcd46521fef72a99
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-36ba5d7ac8d87164
chapter: CH-05
q: What is # in policy in the context of Rego/OPA?
a: # in policy: within_business_hours if { now := time.now_ns() [hour, _, _] := time.clock(now) hour >= 9 hour < 17 }
reference: BLK-b3c956e83dd2d9b9
digest: 782459a4f649813161c0e32a77060f43f780cd1f832186cfc2052de5d38dd0c7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5103fc8bce6dcbc5
chapter: CH-05
q: What is # in test in the context of Rego/OPA?
a: # in test: test_within_business_hours_if_daytime if { within_business_hours with time.now_ns as 1700000000000000000 # some daytime timestamp } This makes your policies deterministic and testable, even when they rely on clocks, network calls, or external data. ________________________________________ 7.3 Unit Tests vs Integration Tests vs ‚ÄúGolden‚Äù Tests Testing & Tooling
reference: BLK-ed251b560e4430b0
semantic_categories: [testing]
digest: 1624cac0b92bbbc7e907c3e606f79deacc037e72c0b34cb28423d289744be01c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-35c7121e43ce570d
chapter: CH-05
q: What is This chapter describes patterns for unit tests, integration tests, and golden tests. in the context of Rego/OPA?
a: This chapter describes patterns for unit tests, integration tests, and golden tests.
reference: BLK-f47d37f0ebabc839
digest: c600624049abc8fe2c4d3e9d4fd818f3ab941b3b9e167a03043fe79ac38e547a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-39ab7d91c61359da
chapter: CH-05
q: What is 7.3 Golden Tests & File I/O (Corrected). in the context of Rego/OPA?
a: 7.3 Golden Tests & File I/O (Corrected)
reference: BLK-f2f11d384f628fdd
digest: 5072833a889ba3d348e771655e401092b46e341a7e9f6f4da8165c6bebb5c976
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6fde3da2415c360b
chapter: CH-05
q: What is Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file. in the context of Rego/OPA?
a: Golden tests compare the decision against a ‚Äúgolden‚Äù expected result stored in a file. Critically:
reference: BLK-2fb586d6bc481c5d
digest: dd4eae483b2d623f38696fc5589175a759e5308aab11577b4fc5c221ca965cac
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1a81b772abf82d43
chapter: CH-05
q: What is Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.). in the context of Rego/OPA?
a: Rego itself has no read_file builtin and cannot perform file I/O. All file reading is handled by the test harness (shell, Go, Python, etc.).
reference: BLK-7834e0c249b42a27
digest: 1ab0af5378048bcd5c3f1e86d88d0dbca695894c511b4b7514b56aa1744b79db
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-69a8da5a3c771184
chapter: CH-05
q: What is A realistic pattern in the context of Rego/OPA?
a: A realistic pattern:
reference: BLK-a43afad2bf2ed56f
digest: fae9e52525c4889cc60b4e0115bfda8f51197335e3dfd7f5fb689b09823dab78
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-db6e75ed8fbba5e8
chapter: CH-05
q: What is Package compliance_test. in the context of Rego/OPA?
a: package compliance_test
reference: BLK-12a6c33c25aad45a
digest: c27c22fb21a6b6d93de12285afbfeaf96bcb5394f5d466e3f6761e3d79df04fb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-01c264082973ac82
chapter: CH-05
q: What is Import data.compliance. in the context of Rego/OPA?
a: import data.compliance
reference: BLK-ee543555b43f4c19
digest: 8ac7ba8214cf8fd7876030e1a0d1105edac9a349fe5327b651170272e9929999
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3f96b592c409cc88
chapter: CH-05
q: What is Test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case  in the context of Rego/OPA?
a: test_large_pr_risk_profile if { # Harness loads JSON from disk into data.tests.* input_case := data.tests["pr_large"].input expected := data.tests["pr_large"].expected
reference: BLK-216d33dfeabb69f0
digest: 3b9acaf762963a9391c48941ae648f2b3a45748079b318143f3244ca381bdfbb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c0a6fe303f243f78
chapter: CH-05
q: What is Result  in the context of Rego/OPA?
a: result := compliance with input as input_case result == expected }
reference: BLK-72a460040bb5dc02
digest: 4bcbca9d77436c65bcfa029de1879cce346d9f647dfd8123b2060f2dd209bb4e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fa6eb603dd701397
chapter: CH-05
q: What is Typical harness responsibilities in the context of Rego/OPA?
a: Typical harness responsibilities:
reference: BLK-3418174c65cc2e6b
digest: df5e7ccc00e514716ed58f730c33114462e06a74684a176dbfd511a407ab036d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d1480a5987724f91
chapter: CH-05
q: What is Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk. in the context of Rego/OPA?
a: Read tests/inputs/pr_large.json and tests/expected/pr_large.json from disk.
reference: BLK-b114e264b1a95140
digest: 771e6bf6315fb72f268f935262124d94227247c60f738dee19c44ab26d397475
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b4901cefcbe24c7c
chapter: CH-05
q: What is Populate data.tests["pr_large"] before invoking opa test or the OPA SDK. in the context of Rego/OPA?
a: Populate data.tests["pr_large"] before invoking opa test or the OPA SDK.
reference: BLK-f8692f6179728f8b
digest: a789cbdd62bba7f2144c8ddf8a6aeadecadad83e34d78440f8d912e54beb35b0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-445a36b6e6adef8a
chapter: CH-05
q: What is Optionally parameterize tests via CLI flags or environment. in the context of Rego/OPA?
a: Optionally parameterize tests via CLI flags or environment.
reference: BLK-ae51cdad26736c7b
digest: 548ce4358023ee4d87dd6f3026ab97a09cd66fd5932ed0db0304d6c534358e26
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2a558e23be8fee91
chapter: CH-05
q: What is Rego in the context of Rego/OPA?
a: Rego: pure data and rules; no file system.
reference: BLK-00e38f5a2f7efa75
digest: a794fa3efea2975cd542f9bf1c3b5f91ba2d85c38fafc36edb09ef006ba1c214
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bbd2ef656f2bc24b
chapter: CH-05
q: What is A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files. in the context of Rego/OPA?
a: A critical distinction exists between how string literals are interpreted in JSON inputs versus Rego test files. This difference frequently causes test failures that are difficult to diagnose.
reference: BLK-a8d9de9cf30c1fc4
digest: 9189fc67e82df2f452630b9d876e8af0dbc4f3613fe0b137b2eb5686a631a990
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-88508d1807ae6b02
chapter: CH-05
q: What is 7.7.1 The Newline Escape Sequence Problem. in the context of Rego/OPA?
a: 7.7.1 The Newline Escape Sequence Problem
reference: BLK-b4984dc6c3976f8c
digest: 04d6065ef0952964e2011f9eda25acd8267fbed55db80c1049cafbd5d13e6e08
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c8c8f8ba5f8fd5ea
chapter: CH-05
q: What is When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but ... in the context of Rego/OPA?
a: When testing policies that operate on multi-line content (e.g., file diffs, code blocks, structured text), developers often encounter a subtle but critical difference:
reference: BLK-2fefd1ebc0822d3c
semantic_categories: [testing]
digest: fa259b9f3c386266983b6e40a7b414344e13aa5c5dfeee2f7e53d3f9db147fe3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bab4165ebc7dc5c6
chapter: CH-05
q: What is JSON Input (via opa eval --input) in the context of Rego/OPA?
a: **JSON Input (via `opa eval --input`):**
reference: BLK-cb3db7a529ef9313
digest: fb8f1cfc15b241dfbcf3568a18537970091847f5ae2f1bdd5f908e0d0125772e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cdb9d8b209d1bd04
chapter: CH-05
q: What is In JSON, \n is interpreted as an actual newline character during JSON parsing. in the context of Rego/OPA?
a: In JSON, `\n` is interpreted as an actual newline character during JSON parsing. The policy receives a string containing a real line break.
reference: BLK-1b920d632bac61fa
digest: fe7c860726769c68b510d64b24414853142d92b440269f7329aabc24ae50a0bf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dbd5fc01c7bf3f34
chapter: CH-05
q: What is Rego Test File (inline string literal) in the context of Rego/OPA?
a: **Rego Test File (inline string literal):**
reference: BLK-8c6da53a0dea320a
digest: 11d9d76c94a058a7b9c09d6a720c15696ed5ac0cdfc5fa407cfc5ee0cfac6741
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1202f8c725e05d97
chapter: CH-05
q: What is In Rego test files, \n within double-quoted strings is treated as a literal two-character sequence in the context of Rego/OPA?
a: In Rego test files, `\n` within double-quoted strings is treated as a literal two-character sequence: backslash followed by 'n'. It is not decoded to an actual newline.
reference: BLK-1a8bc26591bda96c
digest: 65ec0a28180c12f244ba3b1a1e3321374e88fcf4174308f1b9e48c934a081eaa
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c812281398113b5a
chapter: CH-05
q: What is Impact on Regex Patterns in the context of Rego/OPA?
a: **Impact on Regex Patterns:**
reference: BLK-bc9f823fd5cedebf
digest: 173ced91e2a09e5d165814e64133b1d7dc1978d82e1e9ad4d2861e33e641def7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4c303cc57dd371a9
chapter: CH-05
q: What is The regex pattern TODO in the context of Rego/OPA?
a: The regex pattern `TODO:\\s*\\n` expects an actual newline character, but receives the literal string "\n", causing the match to fail.
reference: BLK-e8ea5973a9c2c4fa
digest: 3da7e64c43c8e34d30c20978ce6a78723996e0143fc2c6466dee2c38a45bb3c0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4ef9b468885df972
chapter: CH-05
q: What is 7.7.2 Solution in the context of Rego/OPA?
a: 7.7.2 Solution: Raw Strings (Backticks) for Multi-Line Test Data
reference: BLK-d8d63540cecf04c9
digest: 58265f8286358e681902c8e9da4f672b5a9b1d73f9db125da7f9ce421aa8ac36
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c8037841ad5b387d
chapter: CH-05
q: What is For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines in the context of Rego/OPA?
a: For test inputs containing multi-line content, use raw strings (backticks) which preserve actual newlines:
reference: BLK-a733b1236eb837cb
digest: 0c0a78b67532604a110400cfa042136cfff210eb62a873d027c7bab0438d8a9a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cbc5d13ddf8ad0f6
chapter: CH-05
q: What is Raw String Properties in the context of Rego/OPA?
a: **Raw String Properties:** - Preserve actual newline characters (not `\n` literals) - Do not interpret escape sequences (`\n`, `\t`, etc.) - Ideal for multi-line test data (diffs, code blocks, structured text) - Compatible with regex patterns expecting real newlines
reference: BLK-3ab344a17a6684a1
digest: 7695c5080e7049efdbe15efe36b4aefcc84ce228d1ddd4a35e8145da4242889f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-959b13783d974315
chapter: CH-05
q: What is When to Use Raw Strings vs Double-Quoted in the context of Rego/OPA?
a: **When to Use Raw Strings vs Double-Quoted:** - **Raw strings (backticks)**: Multi-line content, actual newlines needed, regex patterns matching line breaks - **Double-quoted**: Single-line content, escape sequences acceptable, JSON-like strings
reference: BLK-82a0ab5d24aee213
digest: 5c24d976a3e054eeb5e68a9f6765b175c3d745e1306049fab3343a355c4cead6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c967827e07e94bab
chapter: CH-05
q: What is 7.7.3 Debugging String Literal Issues. in the context of Rego/OPA?
a: 7.7.3 Debugging String Literal Issues
reference: BLK-b18ce5c52c9d7ec8
digest: c2d226b4f43d0bda30ecb33ee1d4f39b81b1731eb7c99e3f84a1ca8cb25fef57
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-560eeee3d284f98b
chapter: CH-05
q: What is Symptoms in the context of Rego/OPA?
a: **Symptoms:** - Tests fail with `opa test` but pass with `opa eval --input <json-file>` - Regex patterns that work with JSON inputs fail in test files - Multi-line matching fails unexpectedly
reference: BLK-ded8c7f03a6d2763
digest: c02b3853b5f423b5fbd52e34519ee0cc44dda43746cf3b823d62fb4834e0a930
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-74ff7731ac646a64
chapter: CH-05
q: What is Best Practice in the context of Rego/OPA?
a: **Best Practice:** When testing policies that process multi-line content (diffs, code, logs), always use raw strings in test files to match the behavior of JSON inputs.
reference: BLK-e47c0f553000bb39
semantic_categories: [testing]
digest: 56e3896110bb010b18c0972169540aa69e7e42043de40908f68b1cb2f839f64a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d792811507566bf7
chapter: CH-05
q: What is ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns. in the context of Rego/OPA?
a: ________________________________________ 7.8 Test Evaluation Context and Variable Binding Patterns
reference: BLK-7c6331f584245e6f
digest: a23954fcf705698dfc685725abf99f0abcce8ee499bfefb2d5acfd754f60a976
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7e68a27a68c09d32
chapter: CH-05
q: What is The evaluation context of with clauses in tests can affect how rule results are accessed. in the context of Rego/OPA?
a: The evaluation context of `with` clauses in tests can affect how rule results are accessed. Understanding these patterns prevents subtle test failures.
reference: BLK-6f609bd8fd8f15c6
digest: 8736f2fe1a90335eaaee365b4ec62098023dc1beb27255626a56b368d9e5ff82
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-58102361b684397c
chapter: CH-05
q: What is 7.8.1 Direct Evaluation vs Variable Binding. in the context of Rego/OPA?
a: 7.8.1 Direct Evaluation vs Variable Binding
reference: BLK-86120ccbf9fd371f
digest: 86b094f6e26885c19b8512c12859d6591d112158bb88955dbfabb0a676aeb3f8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3d97495cc969fa0d
chapter: CH-05
q: What is When testing rules that return sets (e.g., warn, deny), the method of accessing results matters in the context of Rego/OPA?
a: When testing rules that return sets (e.g., `warn`, `deny`), the method of accessing results matters:
reference: BLK-df4e849b650f07a7
semantic_categories: [testing]
digest: 4a872177a3387fe80ec500a85eb0818588ac262198cabda8b66cc7276280c02d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-354fe350bcbba71d
chapter: CH-05
q: What is Pattern 1 in the context of Rego/OPA?
a: **Pattern 1: Direct Evaluation (May Fail)**
reference: BLK-0acff6661b16050d
digest: ad00dcc49f6edaabfc27245b8e942b0dab50c9b05ec885d2362e47af5b38b8e6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ae1793bca65e5ce0
chapter: CH-05
q: What is Pattern 2 in the context of Rego/OPA?
a: **Pattern 2: Variable Binding (Recommended)**
reference: BLK-7cbd323bc9f94955
digest: 79bcae0da1d61e36b7a9770b793f0265ced11a302292f50d766225a99bc038e9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-84fac227471a48b1
chapter: CH-05
q: What is Why Variable Binding is Preferred in the context of Rego/OPA?
a: **Why Variable Binding is Preferred:** - Explicit evaluation context: `with input as mock_input` applies to the rule evaluation, not the `count()` call - Clearer semantics: The rule is evaluated with mocked input, then the result is counted - More reliable: Avoids potential evaluation order issues in complex test expressions - Better debugging: Can inspect `warnings` set before counting
reference: BLK-cf01220d4f2b5562
digest: c8d52cc28cdafa2c0ac32daca6f752346b49bec4595104dcb5ebb26690837296
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-33748ee3d8d25fa0
chapter: CH-05
q: What is 7.8.2 Accessing Set Elements in Tests. in the context of Rego/OPA?
a: 7.8.2 Accessing Set Elements in Tests
reference: BLK-9bf695cdc0aa522c
digest: 23c9b469fcfc7a47e1dcaa502542455f949c6eb008d93d257e9ee7d2b82b54f4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7ec35a4780e41115
chapter: CH-05
q: What is When a rule returns a set (partial rule with contains), accessing elements requires proper iteration in the context of Rego/OPA?
a: When a rule returns a set (partial rule with `contains`), accessing elements requires proper iteration:
reference: BLK-8329ea621be0fbe8
digest: 636d60dd3532007359073b311113d0f69eb1069f909c66ddfc43b1023ba5cc99
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-836fd9e2415adb3f
chapter: CH-05
q: What is Pattern for Multiple Assertions in the context of Rego/OPA?
a: **Pattern for Multiple Assertions:**
reference: BLK-eab8babc80ad3a19
digest: 357dbfa375bcf6df85eaf800ef893eb872fda4b6cbcb77c7ebff2dcf4591b8c0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8724e0789f93bd89
chapter: CH-05
q: What is 7.8.3 Rule Precedence and Overlapping Conditions. in the context of Rego/OPA?
a: 7.8.3 Rule Precedence and Overlapping Conditions
reference: BLK-eb983ec34e7f2afd
digest: 88fa76f57d2ce9f257cc52f1aefef7e1c80f55829274b7b9596cdf438d6e54e1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b32593bef099acb3
chapter: CH-05
q: What is When multiple rules can match the same input, understanding evaluation order is critical for test design. in the context of Rego/OPA?
a: When multiple rules can match the same input, understanding evaluation order is critical for test design.
reference: BLK-87dcc1797078ce96
digest: c739d9fffd9b35e5ba1efc7c8fe6004d2f572a98a8eff3a6675b55c654bf17ee
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c7b00f1bb969d845
chapter: CH-05
q: What is Problem in the context of Rego/OPA?
a: **Problem: Overlapping Rule Conditions**
reference: BLK-38a3d8f94378e0d5
digest: 8dc4c84f90cd32a6fd4d342158f058f2bc0f75c8a566ea8e1f1c49987b0c03c4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-28a2de082c888619
chapter: CH-05
q: What is Test Design Strategy in the context of Rego/OPA?
a: **Test Design Strategy:**
reference: BLK-33daea6eded19bdb
digest: b1548944c87e3e4dbb5ef03af79a715e26b371a505680529265ea75b4fdf94bb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c55497c15d95e42b
chapter: CH-05
q: What is Best Practice in the context of Rego/OPA?
a: **Best Practice:** Design tests to verify policy behavior (what warnings are produced) rather than implementation details (which specific rule triggered). This makes tests more resilient to policy refactoring.
reference: BLK-716c7db7881919b2
digest: 93b5d70e93e081de560f670c6c9c3eea508c4357349e46f1a2734be32717d367
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3a87d7d23bf50a70
chapter: CH-05
q: What is ________________________________________ 7.9 Case Sensitivity and String Matching in Tests. in the context of Rego/OPA?
a: ________________________________________ 7.9 Case Sensitivity and String Matching in Tests
reference: BLK-3cce476e79eee5ee
digest: 70292461e22754167adccea17ce5859c71e5d8d68fd52806216b9a52cf25eba0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c3cb0387f29604f9
chapter: CH-05
q: What is String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations. in the context of Rego/OPA?
a: String matching functions in Rego are case-sensitive, which can cause test failures when test inputs don't match policy expectations.
reference: BLK-be379cbe8b085069
digest: 3f18620ce6791c9852e838141094dd9334865c52fa77009e15f2d8625ef31df7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e8b6bed4d5fc36ce
chapter: CH-05
q: What is The contains() function performs case-sensitive substring matching in the context of Rego/OPA?
a: The `contains()` function performs case-sensitive substring matching:
reference: BLK-8e340303a8cff7d0
digest: 06d31ccfca901a248552316c364bb95c60df1dea2ed809b7018f398615a8f16f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5b931ad1a2403573
chapter: CH-05
q: What is 7.9.2 Mitigation Strategies. in the context of Rego/OPA?
a: 7.9.2 Mitigation Strategies
reference: BLK-76ca8f44b0c02913
digest: 52f8b4978a908c6e78f8236580282e89472f6a43ae444e3bc14c9520d8b16ca4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-912981117f710622
chapter: CH-05
q: What is Option 1 in the context of Rego/OPA?
a: **Option 1: Normalize Test Inputs**
reference: BLK-67d5c6760b15e129
digest: 38d3c3912c896fe0547d6bec8b096ebcbeaaafbc8367f4b18cd26868d12254f3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8fc48a2aa92b868b
chapter: CH-05
q: What is Option 2 in the context of Rego/OPA?
a: **Option 2: Policy-Level Normalization (Recommended for Production)**
reference: BLK-4976548b8700b298
digest: 27d8248d794afea7586a9ca6b94761718011b6c7002e7f72f5f7e2e0cb2096bf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-408511080031f42f
chapter: CH-05
q: What is Option 3 in the context of Rego/OPA?
a: **Option 3: Explicit Case Variants in Policy**
reference: BLK-815e807463d05340
digest: 438befb1dfa34e42d1f0b5355680723a41bd4d2ed76f9991396ed4d80b11d861
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-db8e3ecd308e8dbd
chapter: CH-05
q: What is Best Practice in the context of Rego/OPA?
a: **Best Practice:** For production policies, prefer normalization (Option 2) to handle case variations gracefully. For tests, ensure inputs match policy expectations exactly, or document case sensitivity requirements clearly.
reference: BLK-e18f935c97d3ec3d
digest: 42007a4433ee9d3fda2e928a72361c4fe162b1d26e8e11a28d1999af54879cd9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2bc553d2bac93fb5
chapter: CH-05
q: What is Look for panics, regressions, or surprising allow/deny. in the context of Rego/OPA?
a: ________________________________________ 7.7 Advanced Testing: Fuzzing & Mutation For high-assurance policies (security, compliance): Fuzzing: Generate random or adversarial JSON inputs. Run opa eval or opa test against them. Look for panics, regressions, or surprising allow/deny. Mutation testing: Mutate policies (flip conditions, remove clauses). Check that test suite fails appropriately. Failing to detect "killed" mutants = missing tests. This is often orchestrated by external tooling (Python/Go harnesses that call OPA), but the principles are Rego-agnostic. ________________________________________ Chapter 8 ‚Äì OPA Architecture & Integration Patterns This chapter is about where and how you run OPA. ________________________________________ 8.1 The PDP / PEP Split PDP (Policy Decision Point): OPA, evaluating Rego. PEP (Policy Enforcement Point): Your app, proxy, or platform component that: Collects input (HTTP request, Kubernetes object, Terraform plan, CI metadata). Sends it to PDP. Enforces the decision (allow/deny/mutate/log). OPA is only the PDP. The PEP is your responsibility. ________________________________________ 8.2 Deployment Topologies Sidecar / local daemon OPA runs alongside your service, often in the same Pod. Low latency, no network hop beyond localhost. Typical: Envoy external authz ‚Üí OPA. Kubernetes admission controller ‚Üí OPA sidecar in same namespace. Central PDP service OPA (or OPA-based service) runs as a central API. Multiple services call it over the network. Tradeoffs: Pros: Single place to manage policies; simpler distribution. Cons: Latency, scalability, SPOF (unless HA), multi-tenant complexity. Library / SDK Embed OPA: Go: github.com/open-policy-agent/opa/rego WASM: compile Rego to WASM and embed in any WASM host (Node, Rust, etc.). Useful for: Client-side enforcement (e.g., in a browser or mobile app). Edge scenarios. ________________________________________ 8.3 Integration Examples Kubernetes (Gatekeeper & friends) Admission review ‚Üí OPA policy. Rego receives: input.request (raw AdmissionReview). data includes ConstraintTemplates, constraints, reference data. Typical structure: package kubernetes.admission
reference: BLK-2d0d11c237ce14cb
semantic_categories: [testing]
digest: 5685a1317f10349ce9d291110f6f52f6cc59e7d74eb51e46bb2d07379a34c62c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-abf515b8767b21fc
chapter: CH-05
q: What is Decision rule in the context of Rego/OPA?
a: deny[msg] if { input.request.kind.kind == "Pod" some c in input.request.object.spec.containers c.image == "latest" msg := "Images must not use :latest tag" } Envoy / API Gateway Envoy external authorization filter calls OPA with HTTP headers, method, path, source IP. Decision rule: data.envoy.authz.allow. Example: package envoy.authz
reference: BLK-2a66a03314f167f4
semantic_categories: [authz]
digest: 4c5e6f0df123605817e65fd95a211aaef65190c0faa501bc3b243c1ab902fd82
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-08cff67c1e046e95
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-94d881df8f040676
digest: 795a42f844dda970ce62ae89cc29b4bc52ae22a27446869e8e9f7a98f3c1c11e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a8f9d52630ceb217
chapter: CH-05
q: What is Allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc. in the context of Rego/OPA?
a: allow if { input.attributes.request.http.method == "GET" input.attributes.request.http.path == "/status" } CI/CD ‚Äì GitHub Actions, GitLab CI, etc. PR/diff metadata ‚Üí JSON (opa-input.json). OPA evaluates data.compliance. CI interprets deny, warn, override arrays and posts PR comments / fails build. IaC scanning (Terraform, Kubernetes YAML) Terraform plan JSON or Kubernetes manifests as input. Policies check: Public buckets. Unencrypted volumes. Exposed security groups. ________________________________________ 8.4 Multi-layer Policy Architecture on OPA Layers usually look like: Global baseline ‚Äì org-level security/compliance invariants. Domain policies ‚Äì per product or platform (e.g., CRM, billing). Team/service policies ‚Äì localized rules. Tenant overlays ‚Äì per customer/tenant customizations. Implement via: Multiple bundles merged in OPA. Data-driven toggles (e.g., data.tenants[tenant_id].overrides). Rego evaluation order (e.g., base allow, then deny overlays). ________________________________________ 8.5 OPA as a Policy Mesh In large environments, you might have: Many OPAs running across clusters/namespaces. A central bundle server pushing policies. Decision logs shipped to SIEM / data lake. Rego itself doesn‚Äôt change; the architecture around it does. ________________________________________ Chapter 9 ‚Äì Policy Bundling & Distribution OPA is not just an evaluator; it has a bundle system for shipping policies and data. ________________________________________ 9.1 Bundle Basics A bundle is: A .tar.gz containing: /policies/*.rego /data/*.json (or YAML, etc.) .manifest file with metadata. Example manifest (conceptual): { "revision": "git-sha-1234", "roots": ["authz", "compliance"], "metadata": { "version": "1.2.3", "built_at": "2025-11-25T12:00:00Z" } } OPA config: services: policy: url: https://opa-bundles.example.com
reference: BLK-226d4d54f908a22c
semantic_categories: [distribution, observability]
digest: d9cfdf31b7129552acf4d7055b94d6eba16ddea6d456303049f194723c8990cf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-70bb1f77016f0de7
chapter: CH-05
q: What is Bundles in the context of Rego/OPA?
a: bundles: main: service: policy resource: /bundles/crm-main.tar.gz polling: min_delay_seconds: 10 max_delay_seconds: 60 OPA periodically pulls bundles, verifies them, and updates its data and policy set. ________________________________________ 9.2 Bundle Layering & Tenancy You can have multiple bundles: global-baseline.tar.gz ‚Üí data.global org-security.tar.gz ‚Üí data.org crm-team.tar.gz ‚Üí data.crm tenant-123.tar.gz ‚Üí data.tenants["123"] OPA merges them in the data document. Patterns: Tenant-specific overrides are just data: package authz
reference: BLK-ff682021c825f473
semantic_categories: [distribution]
digest: 46d713e7dd80b26da07f399c275a8280283435493b78efc8424f83403751a726
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e3e9d94945d06dda
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-262b6cf7fecd7591
digest: 052be41cab5124f9245a46d3ca844b85af33ae7481fb0f28b7a82f0b38413bae
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8e63febeb9572bc3
chapter: CH-05
q: What is Allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout in the context of Rego/OPA?
a: allow if { base_allow not data.tenants[input.tenant_id].deny_all } Canary rollout: Serve new bundle under /bundles/crm-main-canary.tar.gz to subset of OPAs. Compare decisions vs stable. ________________________________________ 9.3 Release Engineering & Versioning Use semantic versioning for bundles: vMAJOR.MINOR.PATCH. Track: Git commit SHA. Build ID. CI pipeline run. Typical pipeline: opa fmt + lint + opa test + opa check --strict. opa build / custom bundler to produce bundle.tar.gz. Sign bundle (e.g., Sigstore, GPG). Upload to bundle server / CDN. Tag release in Git. ________________________________________ Chapter 10 ‚Äì Linting, Style & CI Even perfect policies are useless if they‚Äôre unreadable or unmaintainable. This chapter merges style guides, linting, and CI patterns into an enforceable system. ________________________________________ 10.1 Style Principles (Based on Styra + Enterprise Practice) Readability first Prefer clear, small rules over clever one-liners. Use opa fmt always Standardizes indentation, spacing, and layout. Enforce via CI. Use modern syntax (Rego v1) if, contains, every, some ... in .... Import rego.v1 or future.keywords when needed. Naming conventions Packages: domain.service.component crm.authz.http, infra.k8s.admission. Rules & functions: snake_case. Helper rules: prefix with _ (convention). package crm.authz.http
reference: BLK-fc4d408a0b120c15
semantic_categories: [distribution]
digest: 692ad575576129bc8f836adf2060586ae3cb917ee9278be610365b5b6a48c5ae
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-87b6d4ee26a7f2fd
chapter: CH-05
q: What is _is_admin(user) if "admin" in user.roles. in the context of Rego/OPA?
a: _is_admin(user) if "admin" in user.roles
reference: BLK-e5ca9a3a2bcfb757
digest: d6c1946976cc2f225046148332f97cc48170c1cc9f289f99d559d46b397f6904
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-23af767abd96eff8
chapter: CH-05
q: What is Allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file in the context of Rego/OPA?
a: allow if { _is_admin(input.user) input.request.method == "GET" } Rule organization Top of file: Package. Imports. Constants/defaults. Then: Helper rules (unexported). Public rules (allow, deny, violation, etc.). ________________________________________ 10.2 Regal (Linter) & Custom Lint Rules Regal is a dedicated Rego linter. Example config (.regal/config.yaml): rules: naming-convention: snake_case: true unused-decls: error no-var-shadowing: error require-some: error no-ambiguous-negation: warn max-rule-size: severity: warn limit: 10 avoid-inline-comprehensions: warn package-path-alignment: error no-import-input: error Typical checks: Snake_case for everything. No unused variables (except _). No variable shadowing. Explicit some declarations. Package name alignment with file path. Metadata required on certain rules (e.g., deny rules). ________________________________________ 10.3 CI Pipeline: From Formatting to Enforcement Lint & format stage ‚Äì GitHub Actions example name: Rego Linting on: [push, pull_request]
reference: BLK-452d175adcd847c7
semantic_categories: [negation]
digest: 52507a70c71de1429e1da7191d69fe402ec62e47ca00bd86915a40a670a1ccb9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ad52ae42981d7a51
chapter: CH-05
q: What is Jobs in the context of Rego/OPA?
a: jobs: lint: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4
reference: BLK-c25057b8a38b65d8
digest: f4fe7b98c0962b9478e5e9dfbe039ed24811f9ea6c71137db731b742c8564cae
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-63c573c31281ad5f
chapter: CH-05
q: What is Name in the context of Rego/OPA?
a: - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa
reference: BLK-24debc49b4b7f143
digest: 7d444eb28785798f545836f5a80fc9d3cc9d9aaf99331625f48b86859b487438
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-072ce3a48e3fb048
chapter: CH-05
q: What is Name in the context of Rego/OPA?
a: - name: Install Regal run: | curl -sSL https://raw.githubusercontent.com/styrainc/regal/main/install.sh | sh sudo mv regal /usr/local/bin/regal
reference: BLK-fb09f96c638665e9
digest: b40d19055d47eb32b57716bc9aa98f9f35fce95eded9bd54fdeb6d74ca6b8574
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0c5c6013769d55e5
chapter: CH-05
q: What is Name in the context of Rego/OPA?
a: - name: Check formatting run: opa fmt --fail .
reference: BLK-cc6f290305561e56
digest: 3fc2d5cf187e380f8059f39764dd08357d135977a3fe455cd7ae97e91e50a369
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5b542ce3ecb1baa8
chapter: CH-05
q: What is Name in the context of Rego/OPA?
a: - name: Lint (Regal) run: regal lint --format=github . Test stage name: Rego Tests on: [push, pull_request]
reference: BLK-d5f021f01e8b32e6
digest: a90f6f1c79d7e4be395d39c74d167e7e2f710d238de3011ade628b666f0ce297
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ae410ee5388ea368
chapter: CH-05
q: What is Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system. in the context of Rego/OPA?
a: jobs: test: runs-on: ubuntu-latest steps: - uses: actions/checkout@v4 - name: Install OPA run: | curl -L -o opa https://openpolicyagent.org/downloads/latest/opa_linux_amd64 chmod +x opa sudo mv opa /usr/local/bin/opa - name: Run tests run: opa test policies/ tests/ --verbose --timeout 30s Compliance evaluation stage (optional) Run opa eval with CI inputs (like PR diffs) to enforce policy gates. ________________________________________ 10.4 Editor & Developer Experience .editorconfig: [*.rego] indent_style = tab indent_size = 4 Editor extensions: Syntax highlighting, opa fmt on save. Regal integration where possible. For Cursor / custom AI agents: Auto-run opa fmt in pre-commit hooks. Use Rego-specific patterns (no inline comprehensions in allow/deny, etc.) in your rules system. ________________________________________ Chapter 11 ‚Äì Performance Engineering (From Heuristics to Formal Bounds) OPA is fast, but bad policies can be slow. This chapter formalizes the performance story. ________________________________________ 11.1 Complexity Mental Model Roughly: Lookup in objects/sets: ~O(1) Array iteration: O(n) Nested iteration: O(n¬≤) or worse Graph-like recursion: O(depth √ó fan-out), potentially exponential without care Your goal: rewrite policies such that most operations become hash lookups, not brute-force scans. ________________________________________ 11.2 Expression Ordering OPA evaluates rule bodies top to bottom, left to right within that body. Rearranging expressions can dramatically change performance.
reference: BLK-545646192799e4a9
digest: 2432c3fdf70932f72f3ff3d0267afbc1e7764c7ac2142414d3be5a036240f713
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4954e2b2aa7f5a76
chapter: CH-05
q: What is # Good in the context of Rego/OPA?
a: # Good: cheap, selective checks first deny[msg] if { input.method == "POST" # cheap size := input.body_size # cheap size > 1e6 # cheap expensive_regex_check() # expensive }
reference: BLK-2af9eec9bfb6a27e
digest: e7eb4df677e152d285ca34f8b723b619a120fcd40be0ba36fcbcf828d871592c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-678f13133f32eaae
chapter: CH-05
q: What is # Bad in the context of Rego/OPA?
a: # Bad: expensive runs for all inputs deny[msg] if { expensive_regex_check() input.method == "POST" } ________________________________________ 11.3 Index-friendly Data Modeling Given:
reference: BLK-a55ef7691563b3b5
digest: ecd7b2bc011741f496178b5ddc1612cbeb2ff392855a98c9919e87349ff80187
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-484a55ded6fb285a
chapter: CH-05
q: What is # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg  in the context of Rego/OPA?
a: # Slow pattern deny[msg] if { some u in data.users u.id == input.user_id not u.active msg := "User is inactive" } Instead, structure data.users as a map keyed by ID: { "users": { "alice": {"id": "alice", "active": true}, "bob": {"id": "bob", "active": false} } } Then: user := data.users[input.user_id] deny[msg] if { user.active == false msg := "User is inactive" } OPA can automatically index these object lookups, giving near O(1) access. ________________________________________ 11.4 Avoiding Redundant Computation Bad: inefficient if { sum(numbers) > 100 sum(numbers) < 1000 result := sum(numbers) } Good: efficient if { total := sum(numbers) total > 100 total < 1000 result := total } OPA memoizes built-ins within a query, but you still pay the call overhead and it hurts readability. ________________________________________ 11.5 Comprehension Patterns Prefer existential patterns over building large intermediate sets:
reference: BLK-4ae88044f166e17a
digest: 82d2d0fb4919d724ffc2ddc578d16e7b30af7731183087fba53a7a3968c31f54
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7d4606e3f58ce046
chapter: CH-05
q: What is # Good has_admin if { some u in users "admin" in u.roles }. in the context of Rego/OPA?
a: # Good has_admin if { some u in users "admin" in u.roles }
reference: BLK-99f7241a145fddb0
digest: fbcc38f42cd79876cd1bb14cb86c6d6e8ab8e7610aeb04968264300a5f7b9f2b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3a7f950ae0d8579a
chapter: CH-05
q: What is # Bad admins  in the context of Rego/OPA?
a: # Bad admins := {u | some u in users; "admin" in u.roles} has_admin if count(admins) > 0 ________________________________________ 11.6 Partial Evaluation & Compilation Partial evaluation is like compiling away some of your logic for known inputs. 11.6 Partial Evaluation & WASM Build Modes
reference: BLK-8ce4a80f2b54bd39
semantic_categories: [performance]
digest: 7bc1dc903053d4695b08138a2bfa068ed753c07b93f56bb1b55838e4a3c5e7a7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7ba8edff153b1153
chapter: CH-05
q: What is Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data). in the context of Rego/OPA?
a: Partial evaluation lets OPA pre-compute parts of a policy given known inputs (e.g., config, topology) and unknown inputs (e.g., request-time data).
reference: BLK-79fbf7e37836b953
semantic_categories: [performance]
digest: afa84bd426bd35f6151dd37e04032e0946c18aee65a0260d91489fc98e6d9e88
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b275e321717c42f8
chapter: CH-05
q: What is Two important workflows in the context of Rego/OPA?
a: Two important workflows:
reference: BLK-c4708b67898ef8d9
digest: 3ae29db0b98427db177ccaf787a5e9f8c00b28004e783a006f25ecba082bf3a1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f850fd496144e40c
chapter: CH-05
q: What is 11.6.1 WASM Compilation (Edge / Embedded). in the context of Rego/OPA?
a: 11.6.1 WASM Compilation (Edge / Embedded)
reference: BLK-30f8a1f3bad5f945
digest: 6f5bf6d272e19746c434b30ec0140e9f769eea50020e83e048a0e2df2cc9f7b0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-66a6c495339b7b7e
chapter: CH-05
q: What is # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/. in the context of Rego/OPA?
a: # Build a WebAssembly module for a specific entrypoint opa build -t wasm -e 'data.authz.allow' policies/
reference: BLK-bebdc8068b9afba0
digest: 98271c355e4283546809290b885456d4320d9308ded18f5d1385ef87545648a3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a5bbe3d890bd9385
chapter: CH-05
q: What is -t wasm ‚Üí produce a WebAssembly binary. in the context of Rego/OPA?
a: -t wasm ‚Üí produce a WebAssembly binary.
reference: BLK-94d092d110d895e4
digest: 39c358d2253200d74357fb60a52b1481601cdce6900169db6b0b275619d806da
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-eb86c1d8e6a98d80
chapter: CH-05
q: What is -e 'data.authz.allow' ‚Üí fix the entrypoint. in the context of Rego/OPA?
a: -e 'data.authz.allow' ‚Üí fix the entrypoint.
reference: BLK-c1e7ab5edbc34051
digest: b240d5f229fc595764fa37c26902b45930176efaf4ca59bfd27a27b0fb362332
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ea5af28e846b6356
chapter: CH-05
q: What is In-process SDKs (Go, Node, etc.). in the context of Rego/OPA?
a: In-process SDKs (Go, Node, etc.)
reference: BLK-da13a43f73416bc2
digest: 6b52c91c79686e9520fa84579cfb5eb6471586746564b78b5ba2c28a9df5b3ed
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-df98c10572037d86
chapter: CH-05
q: What is Edge runtimes or sidecars. in the context of Rego/OPA?
a: Edge runtimes or sidecars.
reference: BLK-23529cac1f63a029
digest: b66758a6f6a76973165eb67e74e245b9cd9d19b46f78388db1ea4cc8a6977205
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-575635d6427cb01c
chapter: CH-05
q: What is The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module. in the context of Rego/OPA?
a: The build process performs internal partial evaluation for the chosen entrypoint and emits an optimized WASM module.
reference: BLK-ad917938449c7e7e
semantic_categories: [performance]
digest: b07bf713e595085bf2071183e8bf9668b06838a721911ef4f1c38f91d829d413
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cc97c99c4ea05a2a
chapter: CH-05
q: What is 11.6.2 General Partial Evaluation (Bundles / CLI). in the context of Rego/OPA?
a: 11.6.2 General Partial Evaluation (Bundles / CLI)
reference: BLK-ba6adeec0ea6c0dd
semantic_categories: [distribution, performance]
digest: d313683b9143a2697818c721c1317c951b312aff5eb9d5b7810c18c4213ea4dd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ba5fc117d74105fc
chapter: CH-05
q: What is For non-WASM optimization in the context of Rego/OPA?
a: For non-WASM optimization:
reference: BLK-524a614cce84f31a
digest: a7801e7cdbe093ce956fc98375b7b355254a1a3f820ca4c4a61608ce03ed48b9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c4f4a4d9c293f88b
chapter: CH-05
q: What is # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/. in the context of Rego/OPA?
a: # Build a bundle for a specific entrypoint without WASM opa build -e 'data.authz.allow' policies/
reference: BLK-fd34e8211928ad97
semantic_categories: [distribution]
digest: ca3ec9b295f05f712e37971d742ad5b5581b2a0417608c13287da92c09c0fd00
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e1084c254f9c7d0a
chapter: CH-05
q: What is An optimized bundle (policy + data),. in the context of Rego/OPA?
a: An optimized bundle (policy + data),
reference: BLK-504b0b84d9f07aaf
semantic_categories: [distribution]
digest: abac27dcd6504c3ee8e6471c5ee72829523c4eaec728216d9094e640d14c5960
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dc29eff31ee01187
chapter: CH-05
q: What is Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint. in the context of Rego/OPA?
a: Suitable for the standard OPA runtime, with partial eval already applied for that entrypoint.
reference: BLK-79a5d70928584f27
digest: 0b7d524303763b52963dbcc7d5be266bff581731586d9bbf0f6b8138f2baa98e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6b651fa52f5b86a3
chapter: CH-05
q: What is Exploratory / ad-hoc partial evaluation in the context of Rego/OPA?
a: Exploratory / ad-hoc partial evaluation:
reference: BLK-923558ff279a8861
semantic_categories: [performance]
digest: e034ec0e12890fb337bc60a62e0ff4014634036fe0ffc02e212375faae2b1098
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b919e033a9831130
chapter: CH-05
q: What is Opa eval --partial \ -d policies/ \ 'data.authz.allow'. in the context of Rego/OPA?
a: opa eval --partial \ -d policies/ \ 'data.authz.allow'
reference: BLK-139c3fe74060a52b
digest: 1bb41e8acfa1e2445b0dff214fb12db62b9bf9546e922c5bef759d339e8dee85
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2a04512722f0f8d3
chapter: CH-05
q: What is Returns residual policy expressions capturing unknowns,. in the context of Rego/OPA?
a: Returns residual policy expressions capturing unknowns,
reference: BLK-cbf7f28fee540782
digest: fa7d4ea8c86b684d3c76620625d73a637af272790d59efd610b5063cc706aa0d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2996fa2fba50f488
chapter: CH-05
q: What is Lets you inspect how much work can be pre-computed,. in the context of Rego/OPA?
a: Lets you inspect how much work can be pre-computed,
reference: BLK-0d6e5a6876e52458
digest: 4517184ffd73c56363ea6143111e65d1516394172ec4b23c4bb1348dded4a733
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-30065734e9b92124
chapter: CH-05
q: What is Is useful for iterative tuning and performance analysis. in the context of Rego/OPA?
a: Is useful for iterative tuning and performance analysis.
reference: BLK-2f48550b2fa1529c
digest: 59afae6ad52f393cb3b3d50c13b47f0bd19bfe477edb0cd97ba50ede42998d1f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a4b634dd6bd01d82
chapter: CH-05
q: What is Opa build -t wasm .. in the context of Rego/OPA?
a: opa build -t wasm ... ‚Üí WASM module for embedded/edge.
reference: BLK-5769859e9bd59db9
digest: a508578717088bd3ef549e4fea602e44d8811fc906daa973e4dbd12f881aa351
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a9604be13c7c1064
chapter: CH-05
q: What is Opa build .. in the context of Rego/OPA?
a: opa build ... ‚Üí optimized bundle for standard OPA.
reference: BLK-061653364bae9a32
semantic_categories: [distribution]
digest: 464a7b988660b882ab7d5599b338cdfa20afa5fad152d2adc83051aa47de92cc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c11052f1186e6e9b
chapter: CH-05
q: What is Opa eval --partial .. in the context of Rego/OPA?
a: opa eval --partial ... ‚Üí interactive partial eval for debugging and design. ________________________________________ Chapter 12 ‚Äì Formal Semantics (Doctorate-Level View) Now we go under the hood. You don‚Äôt need this to use Rego, but you do need it to design new policy frameworks, reason about correctness, or write academic work. ________________________________________ 12.1 Rego as a Datalog Variant At its core, a Rego program is a set of Horn clauses (rules) over a Herbrand universe of JSON-like terms. A rule: h(tÃÑ) if { b‚ÇÅ ... b‚Çô } corresponds to: b_1‚àß‚ãØ‚àßb_n‚áíh(t Àâ)
reference: BLK-2f18848e7865b628
digest: 1ca41b516f8bcf7c3130c23cec46436fe5be25e31d007c45afef1d7cedeedb19
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0dbfb51d79fa1b8f
chapter: CH-05
q: What is Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms. in the context of Rego/OPA?
a: Some syntactic sugar (arrays, objects, comprehensions) desugar to relational forms. Interpretation: An interpretation Iassigns truth values to all ground atoms (e.g., p("alice", "admin")). The meaning of a program Pis the least fixed point of the immediate consequence operator T_P, analogous to classical Datalog. ________________________________________ 12.2 Immediate Consequence Operator & Fixpoint Define T_Pover interpretations: T_P (I)= set of all heads h(t Àâ)such that there exists a rule h(t Àâ)‚áêb_1,‚Ä¶,b_nand all b_iare satisfied under I. Iterative construction: I_0=‚àÖI_(k+1)=T_P (I_k)"Eval"(P)=‚ãÉ_(k=0)^‚àû I_k
reference: BLK-e3939d7108ad8277
semantic_categories: [theory]
digest: c9097de162c70ba1ce75dc01a105db7ade4b5cede2d61c0fd9be09dabcbb696b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ddb07d404697142d
chapter: CH-05
q: What is Because in the context of Rego/OPA?
a: Because: Herbrand base is finite for a given finite data and bounded terms. T_Pis monotonic for stratified, positive fragments. ‚Üí Fixpoint is reached in finite steps. ________________________________________ 12.3 Unification & =, :=, == Unification (=): find a most general unifier (MGU) that makes two terms equal. If both sides partially unbound, unify them structurally. Example: [x, "world"] = ["hello", y] MGU: {x‚Ü¶"hello",y‚Ü¶"world"}. Assignment (:=): one-way binding; fails if variable is already bound to a different value. Equality (==): no variable binding; pure comparison. In implementation, OPA uses a mixture of: Unification-like semantics to explore bindings. Assignments and comparisons for clarity and performance in v1 syntax. ________________________________________ 12.4 Negation-as-Failure & Stratification Rego uses NAF (Negation-as-Failure): not p(X) means: ‚Äúit is not provable that p(X) holds‚Äù. Formally: "Eval"(P)‚ä®"not " p(t)" "‚ü∫" Eval"(P)‚ä®Ã∏p(t)
reference: BLK-137908516f846d9b
semantic_categories: [negation, theory, unification]
digest: 061a6009983d9bd8ef573e0d1fec17155840adf6de1818e8cfc0821c0379b257
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-186a9be56ef551d7
chapter: CH-05
q: What is Require that cycles with negation are disallowed or handled carefully. in the context of Rego/OPA?
a: To avoid paradoxes (like p :- not p), Rego effectively works in the space of stratified programs (or well-founded semantics): Build a dependency graph between predicates (rules). Require that cycles with negation are disallowed or handled carefully. This is why variables in negated expressions must be grounded elsewhere; otherwise, the semantics become ill-defined. ________________________________________ 12.5 Partial vs Complete Rules: Semantic Interpretation Complete rule (one final value): max_memory := 4 if ... max_memory := 8 if ... default max_memory := 1 Interpreted as a function max_memory : Input ‚Üí Scalar such that: If multiple definitions apply and yield same value ‚Üí OK. If they yield different values ‚Üí conflict (no model). Partial rules (sets/objects): deny[msg] if ... deny[msg] if ... Interpreted as: deny={msg‚à£‚àÉ" body s.t." body‚áímsg}
reference: BLK-f0e250b1b329925b
semantic_categories: [negation]
digest: 6826ea37b3b9eee7dadb870c9fc4bdf0dd4aaf91a1db448dd2b09d3da1b8839f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-56375277f068ef49
chapter: CH-05
q: What is The semantics is set union of instances. in the context of Rego/OPA?
a: The semantics is set union of instances. ________________________________________ 12.6 Complexity of Evaluation Let: ‚à£D‚à£= size of data. ‚à£I‚à£= size of input. ‚à£P‚à£= size (number of rules/clauses) of program. Then: Basic evaluation (no recursion) is polynomial in ‚à£D‚à£+‚à£I‚à£. General Datalog with negation can be EXPTIME-complete in the worst case, but OPA: Forbids or discourages patterns that would lead to blow-ups. Optimizes with indexing, partial evaluation, grounding. Rule-of-thumb: Flattened, non-recursive Rego with bounded comprehensions behaves like complex SQL queries in terms of complexity. Recursive policies (e.g., graph reachability) behave like graph algorithms. ________________________________________ 12.7 Partial Evaluation Semantics Given: Program P. Known input fragment K‚äÜ(data,input). Define the partial evaluation operator: PE(P,K)‚ÜíP^'
reference: BLK-cc03bee3c83123fb
semantic_categories: [negation, performance]
digest: 10ac0b9aee3a6e4a7b889b08ab2b0c9b49f897463cdd903096b30047c7947fe3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f39cfc2f0902101c
chapter: CH-05
q: What is Such that for all remaining inputs U in the context of Rego/OPA?
a: such that for all remaining inputs U: "Eval"(P^',U)‚â°"Eval"(P,K‚à™U)
reference: BLK-c1c5efdfcf097b54
digest: ea739ad5e00874ab2a0cf2493f29c4402a5f869c2a159daf92592ea6759c8ae9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f242bfe8a0d415c2
chapter: CH-05
q: What is Key points in the context of Rego/OPA?
a: Key points: P^'is smaller and more specialized. OPA uses this to generate WASM or pre-compiled forms that execute efficiently for fixed queries.
reference: BLK-21f4fa8659b7887a
digest: 0436231354f7c22cd16998c66080ac65c99284fc544348d2451c918dc3fa9a32
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ac7f57de6c84e554
chapter: CH-05
q: What is Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owner... in the context of Rego/OPA?
a: Chapter 13 ‚Äì Multi-Layer Policy Architecture Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owners, bundles, and tenants without descending into chaos. At scale, you need: ‚Ä¢ Layers: global ‚Üí domain ‚Üí team ‚Üí tenant. ‚Ä¢ Ownership metadata: who owns what, and how severe is it. ‚Ä¢ Override semantics: how do layers combine, and who wins on conflict. ________________________________________ 13.1 Layer Model: Global ‚Üí Domain ‚Üí Team ‚Üí Tenant Think of policies as a stack of overlays: 1. Global Baseline (Organization Level) o Owned by: security/compliance. o Guarantees non-negotiable invariants: ÔÇß ‚ÄúNo public S3 buckets‚Äù ÔÇß ‚ÄúAll admin actions must be audited‚Äù o Usually has the highest precedence for denies (security wins). 2. Domain Policies (Product / Platform Level) o Example domains: ÔÇß crm.*, billing.*, identity.*. o Define domain-specific invariants: ÔÇß ‚ÄúAn Opportunity must have an associated Account‚Äù ÔÇß ‚ÄúA Subscription must have a plan and billing cycle‚Äù 3. Team / Service Policies o Local teams add guardrails and UX-level rules: ÔÇß ‚ÄúThis API must include X-Request-Id‚Äù ÔÇß ‚ÄúThis microservice cannot call that microservice directly‚Äù 4. Tenant Overlays (Customer-Specific) o Per-tenant exceptions and configuration: ÔÇß ‚ÄúTenant A enforces stricter password rules‚Äù ÔÇß ‚ÄúTenant B has a special approval workflow‚Äù OPA sees all of these as data + Rego modules merged into a single virtual data tree. ________________________________________ 13.2 Encoding Layers in Data and Packages One robust pattern: ‚Ä¢ Global policies: package global.* ‚Ä¢ Domains: package domain.<name>.* ‚Ä¢ Teams/services: package svc.<service_name>.* ‚Ä¢ Tenant overlays: data.tenants[tenant_id].* Example structure: policies/ global/ baseline.rego # package global.baseline crm/ authz.rego # package domain.crm.authz schema.rego # package domain.crm.schema svc/ accounts.rego # package svc.accounts.rules tenants/ 123/ overrides.json # data.tenants["123"] 456/ overrides.json ________________________________________ 13.3 Policy Ownership Metadata Every rule that matters should be self-describing. You can store metadata as: ‚Ä¢ A dedicated rule (__meta__) ‚Ä¢ Rego annotations (via rego.metadata.rule()) ‚Ä¢ Comments (less machine-friendly) Example: package crm.policies.account_lifecycle
reference: BLK-1a2433cf2e7dd787
semantic_categories: [distribution]
digest: ae06ed5ddbed2e996e27e3d467a350b86fc64fbdc7213c867ab0fadd1b4d1db3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0d0d8cc7a5a64230
chapter: CH-05
q: What is __meta__  in the context of Rego/OPA?
a: __meta__ := { "rule_id": "ACCT_001", "owner": "team-crm-platform", "service": "accounts-api", "layer": "domain", "severity": "BLOCK", # BLOCK | OVERRIDE | WARN | INFO "version": "1.0.0", "tags": ["lifecycle", "compliance"] }
reference: BLK-ffa5f256037b8448
digest: 7fc3f63eb95568812547f902b199c4bd16ad562b0d3aea0b337564fc6c146842
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e4a60e733e3b0354
chapter: CH-05
q: What is Deny[msg] if { input.account.status == "closed" input.action == "reopen" msg  in the context of Rego/OPA?
a: deny[msg] if { input.account.status == "closed" input.action == "reopen" msg := { "rule_id": __meta__.rule_id, "owner": __meta__.owner, "msg": "Closed accounts cannot be reopened", } } For global policies: package global.network
reference: BLK-af753aeced1226aa
digest: f033dcd60fe91b8b13e6dd5a87f7f0ce88276f28319be5b256b2e996e1de54ae
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-979bf31676349ede
chapter: CH-05
q: What is __meta__  in the context of Rego/OPA?
a: __meta__ := { "rule_id": "NET_001", "layer": "global", "severity": "BLOCK", "owner": "sec-net", }
reference: BLK-9917457deaa0fcf0
digest: 7e84754e1745596a74d5c055bd91e2ca641fa4ca694a6d8e039fcf57bc514532
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e5935045148c7443
chapter: CH-05
q: What is Deny[msg] if { resource  in the context of Rego/OPA?
a: deny[msg] if { resource := input.terraform.resources[_] resource.type == "aws_s3_bucket" resource.acl == "public-read" msg := {"rule_id": __meta__.rule_id, "msg": "Public S3 bucket forbidden"} } ________________________________________ 13.4 Override Precedence and Combining Layers You need a formal precedence model so people don‚Äôt guess. Think in terms of layer priority and decision semantics. 13.4.1 Priority Model Assign numeric ranks to layers: package policy.layers
reference: BLK-91f4730964a13670
digest: 6c258b74020ac3596290436d7e1f3618488f48406ebbe268847ef7f6f9f216a9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b90c5af9ddf8ae7b
chapter: CH-05
q: What is Layer_rank  in the context of Rego/OPA?
a: layer_rank := { "global": 100, "domain": 80, "team": 60, "tenant": 40, } Now, each decision includes: ‚Ä¢ effect: "allow" | "deny" | "override" | "warn" ‚Ä¢ layer: "global" | "domain" | "team" | "tenant" ________________________________________ 13.4.2 Decision Aggregation Pattern Define a canonical decision document: package decision
reference: BLK-4984619c0e0050a5
digest: 60161c7d158be7507a2a950aa69f19cdb9324e8fc6656ee7c2ba0a6284545961
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-18946c1e719a792d
chapter: CH-05
q: What is Default result  in the context of Rego/OPA?
a: default result := { "allow": false, "effects": [], # list of all hits from all layers }
reference: BLK-f7e87b62755ad0fa
digest: 4148cf6cba689003159b900607b93a454bf8a972dbc297dbd4074d4b3130500c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c98dc8875105277a
chapter: CH-05
q: What is # Collect all candidate effects from all packages effects[eff] if { eff  in the context of Rego/OPA?
a: # Collect all candidate effects from all packages effects[eff] if { eff := data.global.baseline.effects[_] }
reference: BLK-69c05c427b8cd3f3
digest: ede516695fe66be737239e5d1524c5e27205183590d8c06defac2063eadbff53
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-75eedbe248822c86
chapter: CH-05
q: What is Effects[eff] if { eff  in the context of Rego/OPA?
a: effects[eff] if { eff := data.domain.crm.authz.effects[_] }
reference: BLK-10a064964dd99bf1
digest: 163df107f5152803a703f90f81ca9cd329c4fdafb736a41fd4da015aebd252ff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5acfb87dd3f58d4f
chapter: CH-05
q: What is Effects[eff] if { eff  in the context of Rego/OPA?
a: effects[eff] if { eff := data.svc.accounts.rules.effects[_] }
reference: BLK-eccf109bc4dfb522
digest: 7ce5b29271f422720598521ec8837550c1fb5aad7d2d9e7cc473d9627885f238
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-59efe2f2581bd89e
chapter: CH-05
q: What is Result  in the context of Rego/OPA?
a: effects[eff] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] } Each eff looks like: { "effect": "deny", "layer": "global", "rule_id": "NET_001", "severity": "BLOCK", "msg": "Public S3 bucket forbidden" } Now: compute final decision. result := { "allow": allow, "effects": all_effects, } if { all_effects := [e | e := effects[_]]
reference: BLK-c10db066c498a48d
digest: fca1a3cca0983962f78152aabeac57568badcba619686b69fd9965252d50e97b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2df927565217b63e
chapter: CH-05
q: What is Some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow  in the context of Rego/OPA?
a: some deny in all_effects deny.effect == "deny" deny.severity == "BLOCK" allow := false }
reference: BLK-57b5b916a2a46835
digest: c5e0b47773f4064f9ea1865611a3999b02bff03f8645edff053d1db976a8f225
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4cdf79293b19212c
chapter: CH-05
q: What is # Fallback in the context of Rego/OPA?
a: # Fallback: if no BLOCK denies, then allow if explicit allow exists or default rules say so. result := { "allow": allow_flag, "effects": all_effects, } if { all_effects := [e | e := effects[_]] not some e in all_effects { e.effect == "deny"; e.severity == "BLOCK" }
reference: BLK-af46131c6bb3a8ce
digest: eb9f3001f06326e38c1f47f0cb88dfc6890592939e4036dea4122f4bbbfcc4a7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c764d1f8949edff9
chapter: CH-05
q: What is Allow_flag  in the context of Rego/OPA?
a: allow_flag := some e in all_effects { e.effect == "allow" } } You can refine this by: ‚Ä¢ Picking highest-ranked deny by layer rank. ‚Ä¢ Allowing tenant to tighten, but never to weaken global invariants. ________________________________________ 13.5 Tenant Overlays and Safe Customization Tenant-specific rules should be additive and tightening, not weakening: ‚Ä¢ Allowed: o Tenant can restrict their own behavior further. ‚Ä¢ Forbidden: o Tenant cannot bypass global security invariants. Pattern: package authz
reference: BLK-3fe483d8d3a22e99
digest: dd85404b6f96737e4f6da61f4433662576859bed59db7c1c294a76e1fc81c34d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bdaf3e10a817ce12
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-0e7a6c61b883e7e6
digest: d7e2a72dedb05596ff8f493108b5c1d0fa59870386be12e895f70b8b6ae6e5e1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b053389e22c41269
chapter: CH-05
q: What is Base_allow if { data.global.authz.allow }. in the context of Rego/OPA?
a: base_allow if { data.global.authz.allow }
reference: BLK-06a52347059013ef
digest: 9ff77ff2499b20bfbfe1653ea13d206bfbe2c4937386e7a16cd2e5e8ffa1911d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-353684ae33917110
chapter: CH-05
q: What is Base_allow if { data.domain.crm.authz.allow }. in the context of Rego/OPA?
a: base_allow if { data.domain.crm.authz.allow }
reference: BLK-8c1040019d74489c
digest: 952e73de4df38e35b7e504f7dbdd2f66da2122513a55a659240e66dbd0331794
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fe23909eaa96ad73
chapter: CH-05
q: What is Tenant_extra_deny[msg] if { tenant  in the context of Rego/OPA?
a: tenant_extra_deny[msg] if { tenant := input.tenant_id eff := data.tenants[tenant].overlays.effects[_] eff.effect == "deny" msg := eff.msg }
reference: BLK-b530a84aa5f3112f
digest: 9ed79cd23e570a9c1f79d8d101c7810cadaa859cd8a6b1d6ef62bf0ddafcee73
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ee6dd0aaf3eaed3e
chapter: CH-05
q: What is Allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________... in the context of Rego/OPA?
a: allow if { base_allow not tenant_extra_deny[_] } This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù ________________________________________ Chapter 14 ‚Äì Observability & Audit OPA is not only a decision engine; it‚Äôs an evidence generator. Observability and audit are how you prove that decisions are: ‚Ä¢ Correct ‚Ä¢ Consistent ‚Ä¢ Explainable ‚Ä¢ Compliant with regulation ________________________________________ 14.1 Decision Logs Every OPA decision should be treatable as a replayable event: Minimum recommended fields: ‚Ä¢ decision_id (UUID) ‚Ä¢ timestamp ‚Ä¢ path (e.g., data.authz.allow) ‚Ä¢ input_hash or input (with PII scrubbing) ‚Ä¢ result (decision doc: allow/deny/effects) ‚Ä¢ bundle_revision ‚Ä¢ metrics (evaluation time, rule count) ‚Ä¢ correlation_id (to tie into tracing) Conceptual log: { "decision_id": "3f7b9b1a-0ee2-4e52-9f39-4edb8b6a3a01", "timestamp": "2025-11-25T10:02:45Z", "path": "data.authz.allow", "input_hash": "sha256:abcd...", "result": { "allow": false, "effects": [ { "effect": "deny", "rule_id": "ACCT_001", "layer": "domain", "msg": "Closed accounts cannot be reopened" } ] }, "bundle_revision": "git:1234abcd", "metrics": { "eval_time_ns": 45321, "num_rules_evaluated": 37 }, "correlation_id": "trace-xyz-123" } OPA supports decision logs via configuration; your host system should stream them to: ‚Ä¢ Kafka / Kinesis ‚Ä¢ ELK / Loki ‚Ä¢ Datadog / Prometheus / Grafana ________________________________________ 14.2 Metrics and SLOs To treat OPA like a production service, track at least: ‚Ä¢ Latency: o p50 / p95 / p99 evaluation time. ‚Ä¢ Throughput: o decisions per second. ‚Ä¢ Decision deltas: o How often outcomes change after a new bundle. ‚Ä¢ Error rate: o Number of evaluation failures (e.g., built-in errors in strict mode). Define SLOs like: ‚Ä¢ 99.9% of policy decisions complete in < 10 ms. ‚Ä¢ < 0.1% of decisions result in evaluation error. ‚Ä¢ Decision delta after bundle rollout < 1% for stable inputs (in shadow mode). ________________________________________ 14.3 Correlation IDs and Tracing Policy evaluations rarely stand alone; they‚Äôre part of a larger request trace: ‚Ä¢ HTTP header: o X-Request-Id o traceparent (W3C Trace Context) ‚Ä¢ PEP should pass correlation ID in: o input.trace_id o or embed as part of input.request.headers. Then decision logs include correlation_id, which lets you: ‚Ä¢ Trace a single user‚Äôs journey across services. ‚Ä¢ Root-cause analyze unauthorized/denied requests quickly. Example pattern: package authz
reference: BLK-1a8da57b7485efda
semantic_categories: [distribution, observability]
digest: 151e0d5a9b45a0b9be1193bf450f16b666ff65199347986596ec01a3f3b90aa4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c832080f1044e6f4
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-b64bd35f4b861874
digest: d53ca2117da7c05a592a5aede7e0bcf564e6e131e398d3364d766b94c34e1572
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7396a05c4199fe84
chapter: CH-05
q: What is Trace_id  in the context of Rego/OPA?
a: trace_id := input.request.headers["x-request-id"]
reference: BLK-52900d5604afced9
digest: 2400e1c0b891ef28627ac0cee56f45a2964f6ac0999d0d1aec6f8f4e5507d4cc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7c0a79ff095f47b6
chapter: CH-05
q: What is Allow if { # ...logic... in the context of Rego/OPA?
a: allow if { # ...logic... }
reference: BLK-4eae47b5b88ac30b
digest: 6f932455f318093ac60044a4c96118812296ec15ac9942ed4d954ff229ff4a7e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-848846e3f2787351
chapter: CH-05
q: What is # decision doc decision  in the context of Rego/OPA?
a: # decision doc decision := { "allow": allow, "trace_id": trace_id, } ________________________________________ 14.4 PII and Redaction in Logs Golden rule: logs must not become a data breach. ‚Ä¢ Do not log entire input if it contains PII. ‚Ä¢ Instead: o Log hashed fields (hash(email)) o Log ids / foreign keys o Redact sensitive values (e.g., use "redacted") Pattern: safe_input := { "user_id": input.user.id, "tenant_id": input.tenant_id, "resource_id": input.resource.id, "action": input.action, } Your decision logger uses safe_input rather than raw input. ________________________________________ 14.5 Reproducibility & Auditability A compliant audit story usually needs: ‚Ä¢ Given: o bundle_revision o policy_version o input (or hash + associated fixture) ‚Ä¢ You can re-evaluate the decision and get the same result. To achieve this: ‚Ä¢ Store: o Bundle artifacts (bundle.tar.gz) o Manifest metadata (revision, version) o Decision logs + input fixtures (or deterministic reconstruction) ‚Ä¢ Avoid: o Non-deterministic calls in Rego (e.g., random, uncontrolled http.send) When you must use time.now_ns or external data: ‚Ä¢ Either: o Snapshot it in the input used to evaluate. o Or store enough context to reconstruct. ________________________________________ Chapter 15 ‚Äì Stateful & Temporal Extensions OPA itself is stateless: each query sees input and data as immutable snapshots. Yet many policies are stateful or temporal: ‚Ä¢ Rate limits (N requests per unit time) ‚Ä¢ ‚ÄúNo more than 5 failed logins in 10 minutes‚Äù ‚Ä¢ ‚ÄúThis migration must be rolled out only after all canaries pass‚Äù The trick: Move state and time into data + input, not inside Rego. ________________________________________ Stateful & Temporal Extensions
reference: BLK-28e58a316e04a314
semantic_categories: [distribution, observability]
digest: 789cc7e7dcc31a09ed08da48a0d2c81d62513fcc34e02ca543d6486fa91a14ee
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d276d4b407a7f4d5
chapter: CH-05
q: What is OPA is logically stateless in the context of Rego/OPA?
a: OPA is logically stateless: every evaluation sees a snapshot of policy + data. Stateful or temporal behaviors must be modeled via external systems that write to data or pass state through input.
reference: BLK-20e31440afe0e8ca
digest: 04eb6ad0338627355f02ade76fb642e11253ce955e200f5124dcae81c512bb47
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c6684df86b3412ec
chapter: CH-05
q: What is 15.1 External State for Rate-Limiting & Anomaly Detection. in the context of Rego/OPA?
a: 15.1 External State for Rate-Limiting & Anomaly Detection
reference: BLK-5d68765eb3fb6b23
digest: 0d28a4dbb1953368d618b2c37c9d1265fc464c19bb7780668bf345a8672ca0cc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ca8334885d7c637a
chapter: CH-05
q: What is Example of externally managed login counts in the context of Rego/OPA?
a: Example of externally managed login counts:
reference: BLK-602cdb4b50a087c9
digest: c0137574fd705a60f4e6063758f702e358b30250db68b499f3f0c2275cde55f6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d1272d58ea07fdd7
chapter: CH-05
q: What is # External system populates in the context of Rego/OPA?
a: # External system populates:
reference: BLK-d3b7e29e9b95c9dc
digest: 03ff573b8817e31610d16dc666c1c894ee31bb04491f5b4de7385efb3e2dff52
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-308c687156b7b5e7
chapter: CH-05
q: What is # data.state.login_counts = {. in the context of Rego/OPA?
a: # data.state.login_counts = {
reference: BLK-7c4c29ca27d52d01
digest: d1475e9478853ce50060ca54a369cae2b42649017ba5e4e8e9b64828ddba2ecc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c92ee3830540959f
chapter: CH-05
q: What is # "alice" in the context of Rego/OPA?
a: # "alice": {"last_5m": 12, "last_1h": 42},
reference: BLK-881ee9741315002c
digest: 6bba886f935e4bad83dca34b0454401bb6972c6cc216d12f40eaa4c90e2c13f8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-018052b77ac707ee
chapter: CH-05
q: What is # "bob" in the context of Rego/OPA?
a: # "bob": {"last_5m": 2, "last_1h": 8},
reference: BLK-0016265f5a3c2c5b
digest: 2c4b21f658a1b37e8f1935d321acb8b29f8edab0664d67ee55ffaf2a9695e4d1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c2f6157f7467db36
chapter: CH-05
q: What is Too_many_logins[user] if { counts  in the context of Rego/OPA?
a: too_many_logins[user] if { counts := data.state.login_counts[user] counts.last_5m > 10 }
reference: BLK-044c7de784844b9b
digest: 01c6ff6ee02f18e6db36632d0579ab7c069d05ae45e0b60eb192f11fa8b97bf4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dc163354f44c10a4
chapter: CH-05
q: What is OPA never mutates data.state.login_counts. in the context of Rego/OPA?
a: OPA never mutates data.state.login_counts.
reference: BLK-8a79fd9ce8c38157
digest: db00c5fb748be3d4c5de8366542d3682ccd50ef23a84060feb213b0897204e86
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e179b62b769641fe
chapter: CH-05
q: What is A separate component (stream processor, cron job, gateway) periodically in the context of Rego/OPA?
a: A separate component (stream processor, cron job, gateway) periodically:
reference: BLK-7fb970abfedb4ed3
digest: 96a02217ae0a025b3bf0fff92844f87bd7e970e4781fc7571763289216c693a0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5bdb84fcf5f1f173
chapter: CH-05
q: What is Reads raw events (e.g., login attempts),. in the context of Rego/OPA?
a: reads raw events (e.g., login attempts),
reference: BLK-301f517072826bc8
digest: 8fac5714a0782104ea1ccc4ee6ec3caae5d0bc871608176ffe315c0042d90630
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ecc99fc6c78df8a7
chapter: CH-05
q: What is Aggregates them (windowed counts),. in the context of Rego/OPA?
a: aggregates them (windowed counts),
reference: BLK-fa54db274a3f8d73
digest: 06c3e8d72656e8f7621efc84f7da78f51e734db9b1c6f285cee7ed5b1a26cbd5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1fadc331caf952a9
chapter: CH-05
q: What is Publishes a new snapshot to in the context of Rego/OPA?
a: publishes a new snapshot to:
reference: BLK-c0d4ff0c2c28803e
digest: 87553829a2b1487c6294009d136f80f709be2c012619f078f86f5ff83c0a1537
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-65813a3a4a5d7d63
chapter: CH-05
q: What is Or an in-memory structure via the OPA Go SDK,. in the context of Rego/OPA?
a: or an in-memory structure via the OPA Go SDK,
reference: BLK-bbdc4627b644d8c5
digest: f22ec88c21119e1389619174eae8c3618b5d0cf9e25720babb199a0b88785826
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-117f4505ddae3a96
chapter: CH-05
q: What is Or a shared cache that OPA reads from. in the context of Rego/OPA?
a: or a shared cache that OPA reads from.
reference: BLK-7b4eb1a9e305379f
digest: f7d2c92c54fdd9ee259179ab706e590b1cbbbcc66445728357359f880e4d4528
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-33ac9bc2adb30c55
chapter: CH-05
q: What is Think of the pattern in the context of Rego/OPA?
a: Think of the pattern:
reference: BLK-9b773aae56da6674
digest: a6911bd6c6935a966decb134f7bf6042b0dfe74faa9f535c793c40391e452745
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d0656e20a2b6c9e6
chapter: CH-05
q: What is Events ‚Üí (Kafka / Kinesis / PubSub / Logs). in the context of Rego/OPA?
a: Events ‚Üí (Kafka / Kinesis / PubSub / Logs)
reference: BLK-53fedeb32bc6499b
digest: 5f755d1b11d4709c6f98b15d38ddd4b52f1bfb55a92ca99755ac8bf22be6a2d8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-30cb89828d642907
chapter: CH-05
q: What is Aggregator ‚Üí (Flink / custom job / Lambda). in the context of Rego/OPA?
a: Aggregator ‚Üí (Flink / custom job / Lambda)
reference: BLK-a9c9f10372751d58
digest: ddb659162dd62a06d6ef0f0c07318ed847d54afbbb54637cb591f967800d6d10
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2a64aa45d3476315
chapter: CH-05
q: What is State Snapshot ‚Üí (bundle / data.state.*). in the context of Rego/OPA?
a: State Snapshot ‚Üí (bundle / data.state.*)
reference: BLK-79a22ef860c5e85f
semantic_categories: [distribution]
digest: 69f6198338c193037a069ed71fcb7625f432e887bde029083d8504b8091a4b0e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-effa6251ffd5f15c
chapter: CH-05
q: What is OPA Policy ‚Üí reads data.state.* as a pure input. in the context of Rego/OPA?
a: OPA Policy ‚Üí reads data.state.* as a pure input.
reference: BLK-1cb53c48958ecdaa
digest: 6018cc9401467d68716a79c9846ebcfec75fe4f9b0d2409df71e7bd56048f4d9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bf35fb2871153f0f
chapter: CH-05
q: What is OPA remains a pure decision engine; all state transitions happen outside. in the context of Rego/OPA?
a: OPA remains a pure decision engine; all state transitions happen outside. ________________________________________ 15.2 Temporal Logic Using time.* OPA has: ‚Ä¢ time.now_ns() ‚Ä¢ time.parse_ns(layout, string) ‚Ä¢ time.clock(ns) and time.date(ns) ‚Ä¢ time.weekday(ns) Patterns: 1. Business hours 2. package business 3. 4. within_business_hours if { 5. now := time.now_ns() 6. [hour, _, _] := time.clock(now) 7. hour >= 9 8. hour < 17 9. } 10. Sliding window from event log in input Suppose input.events contains last 1 hour of events (pre-filtered by upstream system): package limits
reference: BLK-97da80a1bfbb763f
digest: e6432e3be4ccbf562cfcc73d6259a458f51a572595f03a3218670a877b2bf392
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-73835b786ac46d22
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := true
reference: BLK-0765a0f81e468faa
digest: 4591e4b3dcc2a05767206bc52d179d7337b8ec6b0f758baa7e0b5b57ebc0cbb7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9f7b0003ddd76385
chapter: CH-05
q: What is Deny[msg] if { now  in the context of Rego/OPA?
a: deny[msg] if { now := input.now_ns cutoff := now - 5 * 60 * 1e9 # last 5 minutes in ns
reference: BLK-e89c971ac66c2591
digest: 4d0e6927832c934ac66a176e6f2d4c4c555a302a5b1c1357b707adbd68b0ac97
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-02a8c22a2719d2d1
chapter: CH-05
q: What is # events in the context of Rego/OPA?
a: # events: [{"ts": ..., "action": "login_failure", "user": "alice"}, ...] recent_failures := {e | some e in input.events e.user == input.user_id e.action == "login_failure" e.ts >= cutoff }
reference: BLK-3641c3e33c8e8566
digest: e944568e770d3f4a9ef1e4b59c682bde136196cba1c766df32bb026273e27e78
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3c6dad6c5b107758
chapter: CH-05
q: What is OPA uses that state to decide in the context of Rego/OPA?
a: count(recent_failures) > 5 msg := "Too many recent login failures" } OPA sees only a subset; the window is curated by your stateful event pipeline. ________________________________________ 15.3 Event-Driven Architectures with OPA Typical pattern: 1. Events flow into Kafka / Kinesis. 2. A stream processor: o Maintains aggregates: ÔÇß counts, sums, last-seen times, sliding windows. o Writes materialized state to: ÔÇß Redis, DB, or data-bundles for OPA. 3. OPA uses that state to decide: o Allow or deny new events. o Trigger downstream actions/alerts. OPA remains pure ‚Äî no long-lived state, no hidden mutable variables. ________________________________________ 15.4 Time-Scoped Exceptions Sometimes you want: ‚Ä¢ ‚ÄúAllow this temporary override until 2025-12-31.‚Äù Pattern: package overrides
reference: BLK-ddb2b91d0cd87295
semantic_categories: [distribution]
digest: 80b037e82b62b19e6bf4e86d1c2c6460329db467dd128c8f1ea0795bd6c7d8a2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8fd83da8a5534554
chapter: CH-05
q: What is Temporary_allow if { o  in the context of Rego/OPA?
a: temporary_allow if { o := data.overrides[input.resource_id] now := time.now_ns() expiry := time.parse_rfc3339_ns(o.expires_at) now < expiry } You encode exceptions in data.overrides, with explicit expiration timestamps. This keeps temporal logic in data, not code. ________________________________________ Chapter 16 ‚Äì Data Policy Models (GraphQL, APIs, Data Filtering) OPA is particularly strong for data access policies because Rego is JSON-native. This chapter focuses on query-shaped inputs like GraphQL and REST. ________________________________________ 16.1 GraphQL AST Policies When a GraphQL query enters your gateway, you can: 1. Parse it into an AST. 2. Send AST + user context to OPA. 3. Enforce: o Field-level authorization. o Query depth/width limits. o Allowed operations. Example input (simplified): { "user": {"id": "alice", "roles": ["user"]}, "operation": "query", "query": { "name": "GetCustomer", "fields": [ {"path": ["customer", "email"]}, {"path": ["customer", "creditCardNumber"]} ] } } Policy: package gql.authz
reference: BLK-22ea3c1f6e7bd5de
semantic_categories: [authz]
digest: 89fa67502c8cf558ee13c1784ef17188587aace49ec51162f3024c1e75b21fbd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3ced635218d54c8c
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false default violations := []
reference: BLK-eae51f08b14c25ab
digest: cdc9720a4e2db32a0adecc5cbb0cefbaaa3afe9f51d9671b098484c6da01e5ce
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-eab1d95e91087694
chapter: CH-05
q: What is # data.gql.allowed_fields = {. in the context of Rego/OPA?
a: # data.gql.allowed_fields = {
reference: BLK-96cfa439c2ca2a38
digest: dc94ae7c59c7d19fc9460b2bbb6ab584967df4b089f0ce950600cef601a18971
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8337410c8b93b26a
chapter: CH-05
q: What is # "customer" in the context of Rego/OPA?
a: # "customer": ["id", "name", "email"]
reference: BLK-8bb9ccc71d144b2c
digest: e1ccb2efa4e4d2f52722cce0a554a1e463b97b9a0d6c8d10bbd27ec36657d029
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-24e3b566daac3265
chapter: CH-05
q: What is # "customer" in the context of Rego/OPA?
a: # "customer": ["*", "creditCardNumber"]
reference: BLK-476ba186ec97144b
digest: e35b07de5bb1611e21ec677612aa02bb4a1b0a02eb8db774efa804c75ef20448
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4d81f456e32254d9
chapter: CH-05
q: What is Role  in the context of Rego/OPA?
a: role := r if { r := input.user.roles[_] }
reference: BLK-708c71e7c73e35f2
digest: 9281cea120beb5d447cf88454dc90e6139fdbc98e31b17e1ff662289ad402224
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bb83f0a9b579f7c2
chapter: CH-05
q: What is # Check each requested field violations contains v if { f  in the context of Rego/OPA?
a: # Check each requested field violations contains v if { f := input.query.fields[_] path := f.path # ["customer", "creditCardNumber"]
reference: BLK-b8ae9bf60f3a1989
digest: fa7c55331345e91242735cfb4c512e47ecc3a2781a379538eb5bd74b9f6c908d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d25e790c89eb60ed
chapter: CH-05
q: What is Resource  in the context of Rego/OPA?
a: resource := path[0] field := path[1]
reference: BLK-492bd318f6c337d0
digest: b28b331850c356ed0d9719d4b65432f79f5b9144e14c815d1d7573c0fa6b33ed
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-56061476ecfaf57e
chapter: CH-05
q: What is Not field_allowed(role, resource, field). in the context of Rego/OPA?
a: not field_allowed(role, resource, field)
reference: BLK-adc62466f65013a1
digest: e41a4699300e930460b258ee1587d328cb21dfb3421fd6526821af2f1d191fda
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9aa1d14dec585afe
chapter: CH-05
q: What is V  in the context of Rego/OPA?
a: v := { "path": path, "msg": sprintf("Field %v not allowed for role %v", [path, role]), } }
reference: BLK-6fd70c9d544e887a
digest: acca813d12644877cd17cfd05ae07eaa0b9d74bd9a47a37d3fa8669a5bee92e9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f6d69904dc9a19a4
chapter: CH-05
q: What is Field_allowed(role, resource, field) if { allowed  in the context of Rego/OPA?
a: field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] allowed[_] == "*" # wildcard }
reference: BLK-137c2fd546a4d073
digest: 92be58c5cbe9f15242e1c7119cc13d462b286c5e722f2fbd8e569cfd07291d61
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fccf2a1c264119bf
chapter: CH-05
q: What is Field_allowed(role, resource, field) if { allowed  in the context of Rego/OPA?
a: field_allowed(role, resource, field) if { allowed := data.gql.allowed_fields[role][resource] field in allowed }
reference: BLK-2c687b2f253cfbe4
digest: 7a6f7714c631ad6cbc4ac69b5cac08941d83ccaaa20b9b923fa61594a3fba1ed
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-62a16e79d7cfda16
chapter: CH-05
q: What is Allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing. in the context of Rego/OPA?
a: allow if { count(violations) == 0 } ________________________________________ Data Policy Models & GraphQL Costing
reference: BLK-239395e2f35c1d1c
digest: 1d1adc548a234f9a9676fa2ee1a846676a530f14ab294599ed7d14c1b279cadc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-35b951bc87d12608
chapter: CH-05
q: What is This chapter covers structural data policies and cost-based models, especially for GraphQL. in the context of Rego/OPA?
a: This chapter covers structural data policies and cost-based models, especially for GraphQL.
reference: BLK-d016298bd014580e
digest: a94f75a5b3f28106b4163d374c35cf462f840216e17c00c4c2373b0e2b488de3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e2788fde832194b0
chapter: CH-05
q: What is 16.2 Field Cost Calculation (Corrected array.concat). in the context of Rego/OPA?
a: 16.2 Field Cost Calculation (Corrected array.concat)
reference: BLK-780f6a8ebb08e0bf
digest: 002e9529bd09c1e471af56d568f98b234078cb931adc0353751d2007fad6f4a1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-28b0e1df2e828000
chapter: CH-05
q: What is Suppose you maintain per-field costs in data.gql.field_costs in the context of Rego/OPA?
a: Suppose you maintain per-field costs in data.gql.field_costs:
reference: BLK-e32fefe6aa6f262a
digest: f7d8b9054d819061bbcf29f027c0b34ef256741e76b228ec24d76e82262a3c5d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2bdb297e2b37f2d6
chapter: CH-05
q: What is # data.gql.field_costs = {. in the context of Rego/OPA?
a: # data.gql.field_costs = {
reference: BLK-e73b9199be66d077
digest: bd45a6aecb9587278d6a624aeb6883bd0609a867e20f23c2ac620e8022fdec80
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-80454161b202d450
chapter: CH-05
q: What is # "Query.users.email" in the context of Rego/OPA?
a: # "Query.users.email": 2,
reference: BLK-29afb65bc79a3e3b
digest: ee742cab46505904f1fe36bde667d446206c31e7b03d80cb76373c7a9b9163bb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e3bf44a5783b98ba
chapter: CH-05
q: What is # "Query.users.orders" in the context of Rego/OPA?
a: # "Query.users.orders": 3,
reference: BLK-da9d1cf4f0f47cfe
digest: 1def5922f783a6e78095b9eed74baab9ca56e312384e4638ac48e74344a3d5d6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f3b6aba4d221315b
chapter: CH-05
q: What is You want to compute a cost for each field given its path and leaf name. in the context of Rego/OPA?
a: You want to compute a cost for each field given its path and leaf name.
reference: BLK-6d1f67793e063be6
digest: ace81f655dc10079e084b7c9623a16a2ddd5ecdb6fae88d72ff4fe11b36f8a27
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-72c4588ef9b6055e
chapter: CH-05
q: What is # field_cost([path, field])  in the context of Rego/OPA?
a: # field_cost([path, field]) := c
reference: BLK-2e2e66e96d2b3f2e
digest: c75797c912191f9faffe01adbc1d287d72c12d4f269a8da7238977ccc789e4f4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5b99ff51d7a232b1
chapter: CH-05
q: What is # path = ["Query", "users"]. in the context of Rego/OPA?
a: # path = ["Query", "users"]
reference: BLK-96475ac62d55d092
digest: 47e6db2d2b9d69a5cc23935a49c08920f800c3122ae814741f34fd2c1a84e602
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-914b2675c2f581db
chapter: CH-05
q: What is # full = "Query.users.email". in the context of Rego/OPA?
a: # full = "Query.users.email"
reference: BLK-1d1bce0ed2b5d5f2
digest: 34a693043f335d91f3222504ecf6f1dd2c3ed9d0eee6ab9d4b7d8c77c636f11f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d6210c9ce59feef4
chapter: CH-05
q: What is Field_cost([path, field])  in the context of Rego/OPA?
a: field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }
reference: BLK-177acd5879ae1eb5
digest: 8b0a812d263a2eb4efb9ae4c736e1124c6d6c12ba5eccdd6a51a987647293852
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2be00bd5695f368f
chapter: CH-05
q: What is Corrections and nuances in the context of Rego/OPA?
a: Corrections and nuances:
reference: BLK-07f8a2771f295779
digest: 83dddb556a192e0ff30cf2b68a7d6b39cd3c5136bf3c12938fc3ba29b5610f95
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bfc9fcfc78e06228
chapter: CH-05
q: What is Use array.concat(path, [field]), not a non-existent append builtin. in the context of Rego/OPA?
a: Use array.concat(path, [field]), not a non-existent append builtin.
reference: BLK-073cbe3299458fca
digest: a4dd0f87a16d6e0ac56cd431ce2a5ccbe69fffa576954aae00f550e386601364
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e75aa2d44a7971f1
chapter: CH-05
q: What is Array.concat([1, 2], [3]) = [1, 2, 3]. in the context of Rego/OPA?
a: array.concat([1, 2], [3]) = [1, 2, 3].
reference: BLK-3f86fc771487f729
digest: 10e495f6a2ca19fa0ca514390f67db176d6caaf1db4016f5cb4e729d4b57042a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-03a15b4a7a96ea1e
chapter: CH-05
q: What is If either argument is null or non-array, OPA throws a type error, so in more defensive code in the context of Rego/OPA?
a: If either argument is null or non-array, OPA throws a type error, so in more defensive code:
reference: BLK-1606d5d3769853a7
digest: 9262f4f5630273b868a37354a23f4ea21661e72e04bed1f3296b991601a3200b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-64b95c995325d52f
chapter: CH-05
q: What is Safe_field_cost([path, field])  in the context of Rego/OPA?
a: safe_field_cost([path, field]) := c if { is_array(path) is_string(field) full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }
reference: BLK-daffda34523491fc
digest: ad85c8eaf7339f96f70359a949b56fcf91529fcb70def91fc2a8ad7fd97e5d36
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0d622e6e5cb3f977
chapter: CH-05
q: What is This function can be used inside a comprehension that walks a GraphQL AST in the context of Rego/OPA?
a: This function can be used inside a comprehension that walks a GraphQL AST:
reference: BLK-d766db30ebdfc849
digest: d9aee0b0b04417b1d9971895ffab7f72431f716160f3830d35cc92930fc5b379
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7639ed237bd745eb
chapter: CH-05
q: What is Total_cost  in the context of Rego/OPA?
a: total_cost := sum({ c | some i field := input.gql.fields[i] path := field.path # e.g., ["Query", "users"] name := field.name # e.g., "email" c := field_cost([path, name]) })
reference: BLK-6b73a05c5f7af41e
digest: 4d4f4c9a0761b5fefbda9117148d979e4c0ae14ac3f5835ff1490604847688cb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0b98c54eadc9ac34
chapter: CH-05
q: What is A compositional cost model (paths + leaves). in the context of Rego/OPA?
a: A compositional cost model (paths + leaves).
reference: BLK-95369408c55face3
digest: 15c53b319f0a7d53ed3f886e0484ac1e84bae40e31f18403b8ade9e2e59392bd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-332f0e772a5128e8
chapter: CH-05
q: What is Defensive concatenation. in the context of Rego/OPA?
a: Defensive concatenation.
reference: BLK-e23b8f98ae17ad67
digest: 0a8aff06a1aad7312b55c43c5c4f94ab53c9e7c70e2ef3820ef67328f63bb466
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c47687c1c7c6b483
chapter: CH-05
q: What is A clean hook for enforcing query limits in the context of Rego/OPA?
a: A clean hook for enforcing query limits:
reference: BLK-95a4d919e71a1c12
digest: 3cc786d4355bae4de72e1491f68dc39494c83c0dcf78fa283dfa51a9f99b1707
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-611bff1c445fd1d7
chapter: CH-05
q: What is Deny_reason  in the context of Rego/OPA?
a: deny_reason := sprintf("GraphQL query too expensive: cost=%v", [total_cost]) if { total_cost > data.gql.max_cost }
reference: BLK-b9edbad05e484b05
digest: 028bebb911bbb3533e1a857928deae29453b130225b6fc864619923382eea94a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9bbef1be805e2642
chapter: CH-05
q: What is ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can in the context of Rego/OPA?
a: ________________________________________ 16.3 REST / SQL / Data Filtering For REST APIs, you can: 1. Treat the request as input: method, path, query params, body. 2. Output a filter document: 3. { 4. "where": { 5. "tenant_id": "tenant-123", 6. "visibility": ["public", "shared_with_user"] 7. } 8. } 9. The service uses that filter to generate SQL. Example: package datafilter
reference: BLK-f3552229f486fc05
digest: b33ca645f1310f6100bb5002aca136e2855d5c4b94b97b893404e3251064ea7f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7a839643eb0dd015
chapter: CH-05
q: What is Default filter  in the context of Rego/OPA?
a: default filter := {}
reference: BLK-393f7de2a0c944c2
digest: 8bb3ca1c88d248499bac52c3a2edff6347f6aedb36d0369f3daf0acc7c216eea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f98248802c0556ce
chapter: CH-05
q: What is Filter  in the context of Rego/OPA?
a: filter := { "tenant_id": input.tenant_id, "allowed_status": allowed_statuses, } if { user := input.user allowed_statuses := statuses_for(user) }
reference: BLK-fbf68ce59d9c01f8
digest: 4ae6d0e7bfe628b36b8da671030602394df9f1dd90856a7e0cc306590e9a47ab
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5823ac404d5b2ddd
chapter: CH-05
q: What is Statuses_for(user)  in the context of Rego/OPA?
a: statuses_for(user) := {"active", "pending"} if { "admin" in user.roles }
reference: BLK-2ee574aac09ad686
digest: 2e247751cbb293e028a24c0eef838bb51d6dec3dc29e521f76f3e7d7091c78ad
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-38d7ac0e2f05e9dd
chapter: CH-05
q: What is ‚Ä¢ Allows multiple services to enforce the same logic. in the context of Rego/OPA?
a: statuses_for(user) := {"active"} if { not "admin" in user.roles } This pattern: ‚Ä¢ Keeps data access rules central. ‚Ä¢ Allows multiple services to enforce the same logic. ________________________________________ Chapter 17 ‚Äì LLM & Agentic Integration with OPA LLMs are good at generating Rego, OPA is good at executing and verifying Rego. Together they form: ‚ÄúAI drafts policy, OPA and tests keep it safe.‚Äù ________________________________________ 17.1 The Agentic Workflow Canonical pipeline: 1. Requirements in natural language: o ‚ÄúAPI keys must not be visible in logs‚Äù o ‚ÄúAdmin role modifications require approval‚Äù 2. LLM drafts: o Rego module. o Test suite (_test.rego). o Metadata (owner, rule_id). 3. Static checks: o opa fmt o Regal lint o opa check --strict 4. Dynamic checks: o opa test (unit + integration tests). o Fuzz/Golden tests for critical policies. 5. Human review: o Security / Policy engineers review diff, semantics. 6. Bundle build & rollout: o Standard policy SDLC. OPA becomes the execution and verification back-end for LLM-authored policy. ________________________________________ 17.2 Guardrails for LLM-Generated Rego When you let an LLM write Rego, you must: ‚Ä¢ Enforce style & safety: o Modern syntax only (import rego.v1 or future.keywords). o No http.send in production rules (unless explicitly allowed). o No secrets in code. o Type guards for all input.* references. ‚Ä¢ Require tests: o At least one positive and one negative case. o Use with overrides instead of real network/time. You can encode this as Rego that reviews Rego: ‚Ä¢ Use rego.metadata.chain() and AST analysis to enforce rules. ‚Ä¢ Or use external tools (Regal) plus your own AST/grep rules. ________________________________________ 17.3 ‚ÄúPolicy Copilot‚Äù Pattern A typical agentic stack: 1. Authoring agent: o Generates initial Rego module + tests from description and examples. 2. Critic agent: o Reads module, runs static analysis (Regal messages, opa check). o Suggests improvements and simplifications. 3. Tester agent: o Proposes additional tests (edge cases, negative paths). o Extends _test.rego. 4. Reviewer agent: o Summarizes behavior in human language. o Flags risky constructs, ambiguous cases. 5. Bundle builder: o Once human approves, compiles into bundle artifact. OPA is the deterministic core all these agents orbit around. ________________________________________ 17.4 LLM Self-Checking with Rego LLMs can call OPA during prompt execution: ‚Ä¢ Use examples like: o ‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù ‚Ä¢ LLM loops: 1. Generate candidate Rego. 2. Invoke opa test programmatically. 3. If tests fail, update policy and try again (up to N iterations). 4. Present final Rego + test report. This turns Rego into a ground truth oracle inside an agentic system. ________________________________________ Chapter 18 ‚Äì Rego Cheat Sheet (Condensed) This chapter is intentionally tight ‚Äì it‚Äôs the 2-page desk reference. ________________________________________ 18.1 Core Rule Types Type Syntax Example Boolean name if { ... } allow if { is_admin } Complete name := value if { ... } max_conns := 10 if is_admin Partial Set name contains x if { ... } deny contains msg if { ... } Partial Obj name[key] := value if { ... } roles[user] := role if { ... } Function f(x) := y if { ... } double(x) := x * 2 Default default name = value default allow = false ________________________________________ 18.2 Assignments & Comparisons ‚Ä¢ := ‚Äì assignment (one-way) ‚Ä¢ == ‚Äì equality (no binding) ‚Ä¢ = ‚Äì unification (binds if unbound, else compares) Examples: x := 10 # assignment ok if x == 10 # comparison
reference: BLK-c191fd1bb522212a
semantic_categories: [distribution, unification]
digest: 9efaddd1f37a74db766c597f615a20326adc8b693ad442e2731d07a47b149def
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ac57a452d831772f
chapter: CH-05
q: What is [x, "world"] = ["hello", y]. in the context of Rego/OPA?
a: [x, "world"] = ["hello", y]
reference: BLK-85a476063d06921f
digest: bf12e75b972f3acb76e15d7b8dd14f27fb58932519c1fe893368e2628ed1e253
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ea1be1deaca49c83
chapter: CH-05
q: What is # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array in the context of Rego/OPA?
a: # => x = "hello", y = "world" ________________________________________ 18.3 Collections ‚Ä¢ Array: [1, 2, 3] ‚Ä¢ Set: {1, 2, 3} (unordered, unique) ‚Ä¢ Object: {"k": 1, "v": 2} Special: ‚Ä¢ Empty set: `{}` (not `set()`, which is a type conversion function requiring an argument) ‚Ä¢ Empty object: `{}`
reference: BLK-2c5e711e15ee03f4
digest: 7e88e65a2b69a97b977b954f9e3c9df770034fa0c075e3a0e2805e06dcadfcb8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8b93df9670f5f4a4
chapter: CH-05
q: What is Test_admin_can_read if { authz.allow with input as {"user" in the context of Rego/OPA?
a: **Important:** `set()` is a type conversion function (e.g., `set([1,2,3])` ‚Üí `{1,2,3}`) and requires an argument. To create an empty set, use `{}` directly. Using `set()` without arguments will cause a runtime error. ________________________________________ 18.4 Iteration Implicit: arr[_] # all values obj[k] # binds k to each key set[v] # binds v to each member Explicit with some ... in: some x in arr # values some i, x in arr # index, value some k, v in obj # key, value some v in set # members ________________________________________ 18.5 Quantifiers ‚Ä¢ Existential: some x in xs { ... } ‚Ä¢ Universal: o Using every: o all_valid if { o every x in xs { o x.valid == true o } o } o Or via negation: o all_valid if not any_invalid o any_invalid if { o some x in xs o not x.valid o } ________________________________________ 18.6 Negation not cond = ‚Äúcannot prove cond.‚Äù Safety: variables in cond must be bound beforehand. deny if { user := input.user not blacklisted[user] } ________________________________________ 18.7 Built-in Highlights ‚Ä¢ Aggregates: count, sum, max, min ‚Ä¢ Strings: concat, contains, startswith, endswith, split, replace ‚Ä¢ Regex: regex.match, regex.split ‚Ä¢ JSON: json.marshal, json.unmarshal ‚Ä¢ Time: time.now_ns, time.parse_rfc3339_ns, time.clock ‚Ä¢ Crypto: crypto.sha256, io.jwt.* ________________________________________ 18.8 Testing ‚Ä¢ Tests: package ending in _test, rules starting with test_. ‚Ä¢ Use with to override input, data, or built-ins. test_admin_can_read if { authz.allow with input as {"user": "alice", "role": "admin"} } Run: opa test . ________________________________________ 18.9 Best Practices (Ultra Condensed) ‚Ä¢ Always opa fmt and lint. ‚Ä¢ Use modern syntax (import rego.v1 or future.keywords). ‚Ä¢ Prefer sets/objects for membership tests. ‚Ä¢ Avoid inline comprehensions in complex allow/deny. ‚Ä¢ Use helper rules with clear names. ‚Ä¢ Always have tests for deny/allow semantics. ________________________________________ Chapter 19 ‚Äì Glossary (Rigorous) Alphabetical list of core terms. ________________________________________ ABAC (Attribute-Based Access Control) Access model where decisions are based on attributes of subject, resource, action, and environment, not just roles. Allow / Deny (Effects) Canonical authorization decision outcomes. Frequently modeled via Rego rules like allow and deny or decision documents with effects. AST (Abstract Syntax Tree) Tree representation of parsed input (e.g., GraphQL query), often passed to OPA as input for fine-grained policies. Baseline Policy (Global Baseline) Organization-wide invariant policy layer that lower layers cannot override or weaken (e.g., ‚ÄúNo public S3 buckets‚Äù). Bundle A versioned tarball containing Rego policies, data, and a .manifest file. Used by OPA to load and update policies in production. Complete Rule A Rego rule that defines a single final value (e.g., max_conns := 10 or allow := true). Multiple definitions that produce different values for the same input cause conflicts. ConstraintTemplate (Gatekeeper) Kubernetes CRD that defines reusable OPA policies for Gatekeeper. Users instantiate constraints based on templates. Correlation ID Identifier used to tie together logs and traces across systems, included in OPA decision logs for observability. Data (in OPA) Persistent, relatively static information (loaded from bundles or in-memory), accessed as data.*. May mirror configuration, schemas, user roles, etc. Decision Document The JSON result of an OPA query (e.g., data.authz.allow or a more complex document with allow, deny, effects, risk_score). Decision Log Structured record of each OPA evaluation: includes path, input (or hash), result, metrics, and bundle revision, used for audit and observability. Datalog A subset of Prolog used for declarative logic programming, without complex function symbols. Rego is inspired by Datalog and extends it with JSON-like structures. Deny Rule A partial rule (often deny[msg] or deny contains msg) that accumulates violation messages, typically used in compliance and validation policies. Effect The semantic outcome of a policy evaluation (e.g., "allow", "deny", "warn", "override"), often encoded in decision documents. Fixpoint A stable interpretation of a logic program where applying the immediate consequence operator (deriving new facts) produces no new facts. Rego‚Äôs semantics can be described via least fixpoints. Future Keywords The future.keywords import (Rego v0.x) that enables newer language constructs like if, in, contains, every. In OPA 1.0+ this is replaced by import rego.v1. Global Baseline See Baseline Policy: global layer of policies applied to all services/tenants, usually with highest precedence for security. GraphQL Policy Policy that operates on GraphQL queries represented as AST; can enforce field-level auth, query depth, or cost. HTTP Sidecar Deployment pattern where OPA runs as a sidecar container next to a service, receiving authorization queries over localhost. Input (in OPA) Per-request JSON document provided by the caller to OPA, containing details like user, action, resource, HTTP request, etc. Accessed as input.*. LLM (Large Language Model) Neural network model (like ChatGPT) used to generate or refactor Rego; OPA then validates and executes resulting policies. NAF (Negation-as-Failure) Logic programming semantics where not p(X) means ‚Äúp(X) cannot be proven.‚Äù Used in Rego for negation. OPA (Open Policy Agent) General-purpose policy decision engine that evaluates Rego policies against JSON inputs and data. PDP (Policy Decision Point) Component that computes policy decisions (e.g., OPA). PEP (Policy Enforcement Point) Component that enforces decisions (e.g., API gateway, Kubernetes admission controller). Partial Evaluation (PE) Technique where OPA specializes policies with respect to known input and data, producing an optimized, often smaller program or WASM artifact. Partial Rule A Rego rule that defines members of a virtual set or object incrementally (e.g., deny[msg] or roles[user] := role). Rego OPA‚Äôs declarative policy language, inspired by Datalog and designed for reasoning over JSON-like documents. Regal A dedicated linter for Rego, enforcing style and correctness rules beyond opa fmt. Rule Conflict Runtime error when multiple complete rules or function rules with the same name and arguments produce different values. Schema (JSON Schema) Formal type definition for JSON documents. OPA can use schemas to perform type checking on input or data. Sidecar Deployment pattern where OPA runs alongside an application in the same Pod/host, reducing network latency for policy queries. Stateful Policy Policy whose decision depends on past events or accumulated state. Implemented in OPA by passing state snapshots as data or input, not by mutability in Rego. Stratification Property of a logic program whereby cycles through negation are avoided, enabling well-defined semantics for negation-as-failure. Temporal Policy Policy that involves time (e.g., deadlines, windows, schedules), typically implemented with time.* built-ins and time-stamped state. Tenant Overlay Per-tenant policy or configuration that tightens (but does not weaken) global/domain rules, often stored under data.tenants[tenant_id]. Virtual Document A Rego rule or package that behaves like a JSON document when queried (e.g., data.authz.allow), although it is computed on demand rather than stored. WASM (WebAssembly) Portable binary format that can run Rego policies compiled from OPA in multiple environments (browsers, proxies, services). With (Keyword) Rego keyword that allows overriding input, data, or built-ins for the scope of an expression; heavily used in testing and mocking. Zero-Trust Architecture Security model where no implicit trust is granted to assets or user accounts based solely on network location; OPA policies often implement zero-trust authorization logic.
reference: BLK-b1c0d736416df0fe
semantic_categories: [authz, distribution, negation, observability, performance, testing, theory]
digest: 3aa78af9d4f7dc946e3e100008291c25d3400ff454f85a8a261317fd13b74960
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-df48992913679b2f
chapter: CH-05
q: What is Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow in the context of Rego/OPA?
a: Chapter 3 ‚Äì Evaluation Flow (Diagram) 3.X Evaluation Flow: From Request to Decision
reference: BLK-e0278fba1f055245
digest: 37e64439d624cef8de79d3f4b80a2edac9a2c7acbdcd3c9f392c9201f762d187
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-29e5cb2ad9018be6
chapter: CH-05
q: What is The full decision path for a typical OPA evaluation looks like this in the context of Rego/OPA?
a: The full decision path for a typical OPA evaluation looks like this:
reference: BLK-a6843e981cac13eb
digest: b05ee66695b07a6198d74d6ff7a2403a4dc211e04a8603006934d117efe8110b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-06922b4eabd7bde3
chapter: CH-05
q: What is Flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[... in the context of Rego/OPA?
a: flowchart LR A[Client / Service] -->|HTTP/SDK| B[OPA] B --> C[Parse & Compile Policies] C --> D[Load Data Bundles] D --> E[Evaluate Query] E --> F[Decision Document]
reference: BLK-a81ca863b9a3b7d5
semantic_categories: [distribution]
digest: 8eb8760711753ce59c464e61b16d5c30e69de0b2afe11901679655a9e5e020c6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1d5cf60e1c98f6ef
chapter: CH-05
q: What is Subgraph POLICIES & DATA C D end. in the context of Rego/OPA?
a: subgraph POLICIES & DATA C D end
reference: BLK-7572efde313bc676
digest: 425295bd985a99f9bf9bfd6bdf397a80b681803ee1a6dd306f325a7d989fe0a8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b38d0f65d02e5a41
chapter: CH-05
q: What is Subgraph INPUTS B end. in the context of Rego/OPA?
a: subgraph INPUTS B end
reference: BLK-f623d12ad47f73ed
digest: 31ec0b2c508ddf897ad6c822dfeadd6db4aeb0ba1021477e30db8f9bfb4c8ad8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e21549c7e221cc49
chapter: CH-05
q: What is F -->|JSON Response| A. in the context of Rego/OPA?
a: F -->|JSON Response| A
reference: BLK-b0acb177781b0063
digest: dcf65b57b0dc10360b224890db335a7da30aa0d3018ee1b69a236ba0a1a66a91
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-526e49e5aab4dec4
chapter: CH-05
q: What is A more detailed view that includes partial evaluation and decision logging in the context of Rego/OPA?
a: A more detailed view that includes partial evaluation and decision logging:
reference: BLK-74371f1f90bb0e83
semantic_categories: [observability, performance]
digest: 9d21f9ad1a60e5ca20ac64e08cbc05041b8a873104980a3850c8b4424c21946f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-73036b94680bb450
chapter: CH-05
q: What is Flowchart TD R[Request in the context of Rego/OPA?
a: flowchart TD R[Request: input] --> OPA[OPA Engine]
reference: BLK-75ee5ef88004b802
digest: 4188bde732d5de0f87eda0b0ba608b426f73cd9cc981326f054206b60dd81360
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9eefa5618de717fa
chapter: CH-05
q: What is Subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional in the context of Rego/OPA?
a: subgraph Policy Lifecycle P[Parse Rego] --> Q[Compile to IR] Q --> PE[Optional: Partial Eval] end
reference: BLK-3a12d7c2cc6d03a1
digest: 8c93052accfd6856b62cb83d63ae1f24d0e57e9ebea670b40b033909955b14a5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dac675732b140165
chapter: CH-05
q: What is OPA --> P PE --> D1[Optimized Policy Set]. in the context of Rego/OPA?
a: OPA --> P PE --> D1[Optimized Policy Set]
reference: BLK-bfc749d64868bc9b
digest: 40b7465ec65063fac2959f365fad8ac11dee0cf72a2b2b7b5993f1c2f47b3dc3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-219395b4f8db81d7
chapter: CH-05
q: What is Subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end. in the context of Rego/OPA?
a: subgraph Data Layer B1[Bundles] --> LD[Load Data into data.*] DS[Dynamic Data APIs] --> LD end
reference: BLK-d20e8dfa86879fc7
semantic_categories: [distribution]
digest: 013d913e15424ebe697e78a4ed4d37c4090540d9aa48e64fdb02c6a9f663a52a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7326ba36cdade284
chapter: CH-05
q: What is LD --> EV[Evaluate Query] D1 --> EV R --> EV. in the context of Rego/OPA?
a: LD --> EV[Evaluate Query] D1 --> EV R --> EV
reference: BLK-30ddfd3dd392bd32
digest: 64be682f3b30cc3a8ac564b79e4bd35a701adfb0578f509627618962ebb00393
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-45b7c7643ee3b294
chapter: CH-05
q: What is EV --> RES[Decision Document] EV --> LOG[Decision Log Event]. in the context of Rego/OPA?
a: EV --> RES[Decision Document] EV --> LOG[Decision Log Event]
reference: BLK-2e5f3039527c7503
semantic_categories: [observability]
digest: 28b5ac802a76b49d90f332462664dd93aefcc27ad16650b597487d4c781ce006
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-040cb8bbbcc81493
chapter: CH-05
q: What is RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake]. in the context of Rego/OPA?
a: RES --> SVC[Caller / Service] LOG --> COL[Log Collector / Sidecar] --> OBS[SIEM / APM / Data Lake]
reference: BLK-d495a3815b3b05b9
digest: 4375d05695703ed07207a71f124c630e764b56dc8655b60f1e54510f433159a8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5bd1cd5d7edce79a
chapter: CH-05
q: What is Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path. in the context of Rego/OPA?
a: Policies are parsed and compiled once; optional partial evaluation moves static work out of the hot path.
reference: BLK-35f656550b066ee3
semantic_categories: [performance]
digest: 1668637c8d71184c2ae24436a38baf4eda21aaf924f9c70b1506a7261ddd95a6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-deaca142dae1b832
chapter: CH-05
q: What is Data from bundles and dynamic sources is loaded into data.*. in the context of Rego/OPA?
a: Data from bundles and dynamic sources is loaded into data.*.
reference: BLK-e06cf468a4849f5c
semantic_categories: [distribution]
digest: 5e81275dec6d96c745d20c1c8b50ea036e37a80e4a45ba58a7ab23ebfa1c0443
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0b407f9c90441d1d
chapter: CH-05
q: What is Each incoming request passes input + compiled policies + current data snapshot into the evaluator. in the context of Rego/OPA?
a: Each incoming request passes input + compiled policies + current data snapshot into the evaluator.
reference: BLK-f223eb01cf8eba29
digest: 6ce89302d0f54ea885618339415e9b0d72962258003c8589a64e9d8e21d83c75
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-77c4b72a0596369e
chapter: CH-05
q: What is The evaluator returns a structured decision document and emits decision logs for observability and audits. in the context of Rego/OPA?
a: The evaluator returns a structured decision document and emits decision logs for observability and audits.
reference: BLK-312401e4a78cb757
semantic_categories: [observability]
digest: 98b7d2f4c7e2fc0edd3c3838deb0f52f851b811b5badba4a5328055a9ad8878b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-28bcf03127a1a945
chapter: CH-05
q: What is Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram. in the context of Rego/OPA?
a: Chapter 8 ‚Äì Deployment Topologies (Sidecar vs Central vs Embedded) 8.X Topology Overview Diagram
reference: BLK-b172f82260025d9b
digest: 139f7255800bbe75613663cf96c66168fae65eabfffbe234f55054b51a62b719
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-43d4dcd37056ab6f
chapter: CH-05
q: What is OPA can be deployed in three canonical modes in the context of Rego/OPA?
a: OPA can be deployed in three canonical modes: sidecar, central service, and embedded.
reference: BLK-6a5cb055b34e7cb6
digest: e48f57381f45906312279a36fcfc8b13fd4aab7f3eff6db0f116adbfa0a43cd5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d4a5fef655e5fe85
chapter: CH-05
q: What is Flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end. in the context of Rego/OPA?
a: flowchart LR subgraph Sidecar Mode A1[App Pod] --- O1[OPA Sidecar] end
reference: BLK-5be303f8619ebc37
digest: bd6d2c710c43524d0f89d39f0ed227d79c727738fcba0fead36dfd721862dc75
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-67241ef276dff81c
chapter: CH-05
q: What is Subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end. in the context of Rego/OPA?
a: subgraph Central Service A2[Apps / Gateways] --> O2[OPA Cluster] end
reference: BLK-f3d455506a6b7cc8
digest: aa1ed796ec75e4ff68c213fd7b6f5fde66e01b495e02a7f787b0629ef367c128
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b4e978e783d5a795
chapter: CH-05
q: What is Subgraph Embedded Library A3[App Process with OPA SDK] end. in the context of Rego/OPA?
a: subgraph Embedded Library A3[App Process with OPA SDK] end
reference: BLK-a164ce803bbdb95f
digest: 897370e6d40e5565bd2bab41ff9653a7424523a0f959b00e1fd48981ff2fc045
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c9800352bde344c1
chapter: CH-05
q: What is 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost in the context of Rego/OPA?
a: 8.X.1 Sidecar Mode flowchart LR SVC[Service Container] -->|localhost:8181 /v1/data/...| OPA[OPA Sidecar]
reference: BLK-0917a2a8dc7a41ce
digest: 724608bc222724715f7e3a7df34420699b43cdab02dd045f63b3463e9945f9c3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bf8042326595a851
chapter: CH-05
q: What is B[BUNDLE Server] --> OPA. in the context of Rego/OPA?
a: B[BUNDLE Server] --> OPA
reference: BLK-b08121aaef4efdfc
semantic_categories: [distribution]
digest: b02404a89749fb7a86ec5f0ad37fe34ae9f0c899d761cdd7184337c96be1b1ea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-de7880139516292d
chapter: CH-05
q: What is Each app pod has its own OPA. in the context of Rego/OPA?
a: Each app pod has its own OPA.
reference: BLK-f133e19232661cc2
digest: 0591d25058860dc216aa09a2ac775743853bf8d70fa282c81232bc6984469541
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4927e12986401b08
chapter: CH-05
q: What is Low latency (localhost). in the context of Rego/OPA?
a: Low latency (localhost).
reference: BLK-b19700b3080dc69c
digest: 23c9ac86a551a738d7c839e8410266e3c56cdee7ddea46cc221923fe94777cc6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-aa0013b15def7239
chapter: CH-05
q: What is Good for microservices and per-tenant tuning. in the context of Rego/OPA?
a: Good for microservices and per-tenant tuning.
reference: BLK-37b6ab540b493df4
digest: 637d0dc5274657fc498d5248441f03e7c63ccf2083235462bfc60a23705f01a3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2bc3cd0bf1b6ea0d
chapter: CH-05
q: What is 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE S... in the context of Rego/OPA?
a: 8.X.2 Central Policy Service flowchart LR GW[API Gateway] -->|batched queries| OPA_CLUSTER[Central OPA] AUTH[IdP / Token Service] --> GW B[BUNDLE Server] --> OPA_CLUSTER
reference: BLK-bf480b6db9e70e26
semantic_categories: [distribution]
digest: a147bba03f17c82716e8ea3d8c701233783a62e359bfdfbfd13ad0c03154ac14
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ab7cf79f54d9167a
chapter: CH-05
q: What is One or a few OPA instances serve many clients. in the context of Rego/OPA?
a: One or a few OPA instances serve many clients.
reference: BLK-e3c06649001ac7cb
digest: 2390e25529bc755c4103b1ceb6b8c60badf112e29eab1fda907d1d0d8b184f15
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fd0d6f5492b4420b
chapter: CH-05
q: What is Great for shared policies and simple clients (like Nginx, legacy apps). in the context of Rego/OPA?
a: Great for shared policies and simple clients (like Nginx, legacy apps).
reference: BLK-2c956a537c865bff
digest: 9637de4ccf6fcb11a340f588514aa9df39181c0696db1d72fef2cd8d0fedbf5f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5de9a774ea4b05f7
chapter: CH-05
q: What is 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP. in the context of Rego/OPA?
a: 8.X.3 Embedded OPA flowchart LR APP[Application Process] -->|in-process call| LIB[OPA SDK / WASM] B[BUNDLE Source] --> APP
reference: BLK-d17bf7dff7e2687d
semantic_categories: [distribution]
digest: d236c73cc0c5fe06b1c7fc79cf391cfc033f6dea82f8bcd99271cd54a8c653a2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-eaa40d8f1e5e5915
chapter: CH-05
q: What is OPA compiled to WASM or linked via Go library. in the context of Rego/OPA?
a: OPA compiled to WASM or linked via Go library.
reference: BLK-00aae760c3f524cb
digest: 14e7660f32ee3fa38a5d664d0eaf3f235370d7f0fc3d656ab32edfd1821dba98
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3ae345e6f1ee50e7
chapter: CH-05
q: What is No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths. in the context of Rego/OPA?
a: No extra HTTP hop; ideal for edge, FaaS, or latency-critical paths.
reference: BLK-7984539227277d1e
digest: e18737fd022113389c33eb4a0f50549b914adc1b04b14b4094b0bbeb2395cbea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6505db860235d38e
chapter: CH-05
q: What is Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[D... in the context of Rego/OPA?
a: Chapter 13 ‚Äì Multi-Layer Policy Architecture Visualization 13.X Multi-Layer Policy Stack flowchart TB G[Global Layer\n(org-wide baselines)] --> D[Domain Layer\n(product / region)] D --> T[Team Layer\nservice / app] T --> N[Tenant Layer\ncustomer-specific]
reference: BLK-88897c889d38315b
digest: d9f6a687ae44348515a36e835866cbf8a6f0743ba6edc46e1420476db4d81776
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ae50b7196579a594
chapter: CH-05
q: What is N --> Q[Final Decision]. in the context of Rego/OPA?
a: N --> Q[Final Decision]
reference: BLK-c6a16c819faf270c
digest: df145ca1ca9f47f8d288c8b5babde9e9c202ff61a4bd057e9b9056c1bdead57c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-db616b6a349f9973
chapter: CH-05
q: What is Global in the context of Rego/OPA?
a: Global: Non-negotiable baselines (e.g., MFA required, PII rules, legal holds).
reference: BLK-5051a10ae5706b97
digest: 53b8c0f238027e41fa32cc25a3e9715a26c48728ce529f7eeddad936f0102f98
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ed13e91d7e76e513
chapter: CH-05
q: What is Domain in the context of Rego/OPA?
a: Domain: Variants per product/region (e.g., EU vs US data rules).
reference: BLK-ac0efa57c504e47d
digest: d9a87eb2125baac58dfcc99e6f85ba3737acf045cd71d1836099c17d95e27596
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ad04f173175d9dd3
chapter: CH-05
q: What is Team in the context of Rego/OPA?
a: Team: Service-specific routes/resources (e.g., /billing/* vs /analytics/*).
reference: BLK-9b47d89fb37632a4
digest: a8a29e53adf948102d654ab9180756583b1272909ce73231ec3483a678ba9cc4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d99c6821a97b08e2
chapter: CH-05
q: What is Tenant in the context of Rego/OPA?
a: Tenant: Overrides and feature flags per customer (e.g., stricter IP allowlists).
reference: BLK-be239d14ac089893
digest: e85aebe10879aa5afa830555525bff2a28c72a6cce247a0e36f3902551ad8a60
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c876443da323b17a
chapter: CH-05
q: What is 13.X.1 Layered Evaluation Example package authz. in the context of Rego/OPA?
a: 13.X.1 Layered Evaluation Example package authz
reference: BLK-fb9f85c09a41dacf
digest: 8fa0592465ff50cc0ce283e19f00fd1dab35acd57171a0400456cd32b8ea030a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-41d7ee4f48f77e6f
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-29dadeb3f0a54d1b
digest: 0f0ade58e73999f0f68559e751814b91d315430f68c96940836bbd38708515bc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c2838838731185f3
chapter: CH-05
q: What is # Global in the context of Rego/OPA?
a: # Global: no public write operations global_deny[reason] if { input.method == "POST" input.path == [ "public", _ ] reason := "Global: public writes forbidden" }
reference: BLK-a6ad7c1547585e40
digest: 98339a399c5a4f2bf8d2b531f4d972c57e1a033b23ee886c780388f687d7047c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-60452740cf233f4c
chapter: CH-05
q: What is # Domain in the context of Rego/OPA?
a: # Domain: EU requires additional consent domain_deny[reason] if { input.region == "eu" not input.user.consented reason := "Domain(EU): consent required" }
reference: BLK-24e160a1846f69ab
digest: 996fa34a76e4cf698112d1bc8ab391fc356c421c58eb41f93d7e61bf8431e29b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9f657777d51caa4f
chapter: CH-05
q: What is # Team in the context of Rego/OPA?
a: # Team: service-specific checks team_deny[reason] if { input.service == "billing" not input.user.roles[_] == "billing_admin" reason := "Team(Billing): admin role required" }
reference: BLK-05d76e22769680a5
digest: 084f8c0ac24bd7c9716a06ab7d7530faa28007b982ff8d1b349414ff26ea8070
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8432b87bd232de86
chapter: CH-05
q: What is # Tenant in the context of Rego/OPA?
a: # Tenant: per-tenant overrides tenant_allow[reason] if { input.tenant == "tenant-123" input.path == ["beta", "feature-x"] reason := "Tenant override: feature-x beta allow" }
reference: BLK-c37d51b33f8c33c7
digest: d8e1ed53830ddbd5d34642abf0f55e039f602e8fa3cb5b2d6297caf59e58833e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6784c60396255d7b
chapter: CH-05
q: What is Deny[reason]  in the context of Rego/OPA?
a: deny[reason] := reason if { some r r := global_deny[r] # global always first } or { some r r := domain_deny[r] } or { some r r := team_deny[r] }
reference: BLK-3797e2670efc01ec
digest: 18b70673203505c21d0f6a6878360402388efd2bcc0f97724472fa567475abea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-062314ad37a7cb3a
chapter: CH-05
q: What is Allow  in the context of Rego/OPA?
a: allow := true if { count(deny) == 0 some r r := tenant_allow[r] # tenant can only *widen* within guardrails }
reference: BLK-26016fa8bb549e8a
digest: 9bc854e725619ca8575929e0088ed7bef634c00c1ac96b443a389664435f36f4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b431a0ddf40b8d30
chapter: CH-05
q: What is This pattern makes layer provenance explicit and traceable. in the context of Rego/OPA?
a: This pattern makes layer provenance explicit and traceable.
reference: BLK-5ff9a90c174543e6
digest: 179b3c9b809925293c5ed0e4cf18c2425da9f84d18cad488f1d6dea927fe2301
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ba29acaddf39e035
chapter: CH-05
q: What is Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OP... in the context of Rego/OPA?
a: Chapter 14 ‚Äì Decision Log Flow Diagram 14.X Decision Log Pipeline flowchart LR REQ[Incoming Request] --> OPA[OPA] OPA --> DEC[Decision Response] OPA --> LOG[Decision Log JSON]
reference: BLK-c90e38cedbdc43d1
semantic_categories: [observability]
digest: c18a935f51d8c3c4bb92cdbfa527c7ce79a51f5b4fa249f8f868503408772120
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6fc4cf4a7b5bdb93
chapter: CH-05
q: What is LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Da... in the context of Rego/OPA?
a: LOG --> COL[Log Collector / Sidecar] COL --> BUS[Message Bus / Stream] BUS --> SIEM[SIEM / Security Lake] BUS --> APM[APM / Metrics] BUS --> DWH[Data Warehouse]
reference: BLK-a1aba1f7c35dda91
semantic_categories: [observability]
digest: e00eab80db10fa4cee26aa486b820462aaa446a019ffa2bfb5de69ebce324136
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-609ec1648e2f1fa3
chapter: CH-05
q: What is Typical fields in the decision log in the context of Rego/OPA?
a: Typical fields in the decision log:
reference: BLK-f13d3c0879266a61
semantic_categories: [observability]
digest: b06382e9e26ab8fe0e19b942b4000d5fe6915e0198ce0d4fd46ce8cccef592b8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f7cd121f67d4d2af
chapter: CH-05
q: What is Input (possibly redacted). in the context of Rego/OPA?
a: input (possibly redacted)
reference: BLK-5d6ddaa19e8cfcaf
digest: 552fd5764467a4f2b7caa3f7d9c15462316eef60d003af7548b61dd78e31acf6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a446ab270b69a0e1
chapter: CH-05
q: What is Result (decision document). in the context of Rego/OPA?
a: result (decision document)
reference: BLK-42e8f5f868517157
digest: 55eade8c9736e48ea29d874339b7d3f66e52986c87687f22f45a3780a56e5a59
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f111649600818372
chapter: CH-05
q: What is Labels (instance, version, tenant). in the context of Rego/OPA?
a: labels (instance, version, tenant)
reference: BLK-0e27cac7a34ed96c
digest: 6daa509bcc318341c6625bbf81fb6958baa735634475268297d25978532e58f1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-985039a2d5c50540
chapter: CH-05
q: What is Metrics (eval time, number of rules evaluated). in the context of Rego/OPA?
a: metrics (eval time, number of rules evaluated)
reference: BLK-04f8b905633b2c5f
semantic_categories: [observability]
digest: 35481e64dfb2698e8ea3ed886d657be875cb86f8568daf330e30fb9533ddd265
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d4e10a9cdd98a2c7
chapter: CH-05
q: What is This pipeline supports in the context of Rego/OPA?
a: This pipeline supports:
reference: BLK-9d3aeb0abc8fd54e
digest: 18e8281f0c7df1a136d3d0aa01925b38b66d9ad3ae3d3ed95de5e9b339c42d6e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-46d414ab4649fd6a
chapter: CH-05
q: What is Real-time alerting (SIEM / SOC). in the context of Rego/OPA?
a: Real-time alerting (SIEM / SOC).
reference: BLK-56a7595a69adae94
digest: a34048beb37e66cbee90fc11b387d7f370882cf35fbc7ee383840ba877551f2a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fad80d18db9c8278
chapter: CH-05
q: What is Dashboards (latency, volume, error rates). in the context of Rego/OPA?
a: Dashboards (latency, volume, error rates).
reference: BLK-5e0ef2d16b64008e
digest: 09f628be93beff5ef42059df98d01d7c9357c289114fb457a6aab0d03f20a17d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a41bd2de2c4a1dca
chapter: CH-05
q: What is Audit trails (who allowed what, when, and why). in the context of Rego/OPA?
a: Audit trails (who allowed what, when, and why).
reference: BLK-81be0a89ed2bbdeb
digest: 02ad3a9acb9609aaec357d8187ac7263b2ac729cd426bdaeca56640aa3edf13e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-71c135e782c16caf
chapter: CH-05
q: What is Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering. in the context of Rego/OPA?
a: Chapter 5 ‚Äì Real-World Comprehension Examples 5.X Nested Comprehension with Filtering
reference: BLK-976f4a3022f5c700
digest: f46c1664f5a2f50c839f8ef8bc78e3a233df24c3cb42f04356263621bf419638
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9b3d5eec04291255
chapter: CH-05
q: What is Scenario in the context of Rego/OPA?
a: Scenario: You have data.resources listing projects and environments, and you want all production services owned by a user.
reference: BLK-2b29aec02bdf3804
digest: 60519623f13bb0189058e56e64bbe139ea979a5b0d90049bc3a4504ab73c0de3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f965cd08e4f86b24
chapter: CH-05
q: What is # data.resources.projects = [. in the context of Rego/OPA?
a: # data.resources.projects = [
reference: BLK-9ee40e622c0b8c69
digest: 1a189ac44ca4678c0c684637e2550741907a70cedaec0f580a8a52256f639204
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4668a502d0e494b1
chapter: CH-05
q: What is # {"name" in the context of Rego/OPA?
a: # {"name": "svc-1", "env": "prod", "owners": ["alice"]},
reference: BLK-62df538504d93142
digest: 0e539bff03d13f8edfea76fba1df1ee5595daa090b41d1cd507ae65c440eb8ae
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1949f3076ab9d65a
chapter: CH-05
q: What is # {"name" in the context of Rego/OPA?
a: # {"name": "svc-2", "env": "dev", "owners": ["bob"]}
reference: BLK-8564f950737ad167
digest: 8a19eb2d2516b69250ca69ca850e0f38d69167e1d7597de6920ace06a9a39f41
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7eef6884a52a2611
chapter: CH-05
q: What is # {"name" in the context of Rego/OPA?
a: # {"name": "svc-3", "env": "prod", "owners": ["alice", "carol"]}
reference: BLK-81063a0c4670fed4
digest: 50d7b501f51155a642bf3adde8e5e2932628e177bdb0c55f41c74b4d9099bb35
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7edc5251b1f26ac2
chapter: CH-05
q: What is Prod_services_owned_by(user)  in the context of Rego/OPA?
a: prod_services_owned_by(user) := result { result := [ { "project": proj.name, "service": svc.name, "env": svc.env } | proj := data.resources.projects[_] svc := proj.services[_]
reference: BLK-710e9c5927914bb2
digest: b09013453b382e0f5a69efebfdb2701bfb9387071612a3d6173a1291aa6901b9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-617cabc3272bdfd0
chapter: CH-05
q: What is Svc.env == "prod" svc.owners[_] == user ] }. in the context of Rego/OPA?
a: svc.env == "prod" svc.owners[_] == user ] }
reference: BLK-a2f928d215b1d576
digest: 724c001d44f6c8b9fd149a4339265bd94c5f0cba2f323fe533d292abb278c754
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7096662eabafd598
chapter: CH-05
q: What is Alice_prod  in the context of Rego/OPA?
a: alice_prod := prod_services_owned_by("alice")
reference: BLK-35b8084f79c559ed
digest: 82a89a63f693d8f07b0ee95052fc0a21b62378ab57882daf00c2210a18ee0e56
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-17999214a99704d2
chapter: CH-05
q: What is [ {"project" in the context of Rego/OPA?
a: [ {"project": "proj-a", "service": "svc-1", "env": "prod"}, {"project": "proj-b", "service": "svc-3", "env": "prod"} ]
reference: BLK-f51067adb203c9c1
digest: 4293582b73b75aca05b8ca95072703c3f9ad5af918c12f6297689872f831ed75
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4aa07e9741eafdeb
chapter: CH-05
q: What is Two nested comprehensions (projects[_], services[_]). in the context of Rego/OPA?
a: Two nested comprehensions (projects[_], services[_]).
reference: BLK-c947320997cd09cc
digest: f5ac8b3afcd07cd4527b18d8e73ff6ca1ef09dffa7028f6397ed35b3419c16e5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c71d343bcebe7240
chapter: CH-05
q: What is Inline filtering by environment and ownership. in the context of Rego/OPA?
a: Inline filtering by environment and ownership.
reference: BLK-bb993ad92ca88b76
digest: 6a948ff249619d97d98d9a43c7a70d15f8be3ab650938f5207b12625cc8677f5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b4aff1a92edaa91e
chapter: CH-05
q: What is Structured result objects built inside the comprehension. in the context of Rego/OPA?
a: Structured result objects built inside the comprehension.
reference: BLK-813a09749e866fe6
digest: 07a86460c327af41456ca31e3a1b1647d0aea11e250b978e8deb13e884ebcd98
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6a2d96a223b735aa
chapter: CH-05
q: What is Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example. in the context of Rego/OPA?
a: Chapter 6 ‚Äì End-to-End JWT Validation Workflow 6.X Full JWT Validation Example
reference: BLK-2ceb4799a2c96bb9
digest: c36190c575c65cfef8717feb7458752a74a94d5cfc0985c4a625d94ee7a725ad
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-94070f0f43b966c0
chapter: CH-05
q: What is Complete pattern combining decode, verify, and claim checks. in the context of Rego/OPA?
a: Complete pattern combining decode, verify, and claim checks.
reference: BLK-fac5338924d4d432
digest: 88918b2981af1c9ab397a4e7e1f66035024dba635e92ec3c81825f173769bc8b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fc9a4e316c86ce58
chapter: CH-05
q: What is # Configuration in data.jwt in the context of Rego/OPA?
a: # Configuration in data.jwt:
reference: BLK-f5eae2ff1df643e4
digest: ace6b9229aa90aceb8c18be4620d553a1118852876681e0ce65548043561b712
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4241d6aef4cd06eb
chapter: CH-05
q: What is # "issuer" in the context of Rego/OPA?
a: # "issuer": "https://issuer.example.com/",
reference: BLK-9dd87631232b80f5
digest: ffe1a910db923e0d3167c7eeef761b076bdf706287c51fd73cd3314a45935731
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-741b38c931dde500
chapter: CH-05
q: What is # "audience" in the context of Rego/OPA?
a: # "audience": "my-api",
reference: BLK-b7a8495733a99b9e
digest: 428f639f2a92241bdaa07c95291469b0b547462fe1bc6fc5470c8e32e793a109
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-466c3df94bca0b9f
chapter: CH-05
q: What is # "jwks" in the context of Rego/OPA?
a: # "jwks": { ... } # if using embedded JWKS
reference: BLK-6e4d17c6138f8e98
digest: 1a8e25f7b5ad7d9bcfe499a2993dc7d3516db7a677b33e456a7f7ad2511c02dc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1a77ddd6f5f57a3d
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-8ad24621e33d0824
digest: 15e58d042f593a53a5f2f20507f5b67d6d720989b6878046846dcebad22717d2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-eccce0b83db3f797
chapter: CH-05
q: What is Allow if { token  in the context of Rego/OPA?
a: allow if { token := input.headers.authorization startswith(token, "Bearer ")
reference: BLK-5a57193e78bc4589
semantic_categories: [authz]
digest: f21f2ea0a1002c2c3fba83e69d26d926186d6b04bd0f84b522c5ef47174006fa
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-87758232f98bb3ce
chapter: CH-05
q: What is Raw  in the context of Rego/OPA?
a: raw := substring(token, count("Bearer "), -1)
reference: BLK-d4ff7978dd13cf56
digest: cf3a3dbe7bb88e8f0113540272aba277521cf36ed500f700b9f26a0e6942b068
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-80782c50f32e86a9
chapter: CH-05
q: What is # Decode (header, payload, signature) [header, payload, signature]  in the context of Rego/OPA?
a: # Decode (header, payload, signature) [header, payload, signature] := io.jwt.decode(raw)
reference: BLK-c163d16de7a9a92c
digest: 75b0b2b390d27df8f37945bf28b3a874ad7b9816623888bbc917556da4fb9f1f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-19b308b7474c89a3
chapter: CH-05
q: What is Verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) }. in the context of Rego/OPA?
a: verify_signature(raw) verify_standard_claims(payload) verify_custom_claims(payload) }
reference: BLK-477027788171287a
digest: cde3028c341663aa3ac46caa29cfbd3a7d891137f18f378a1b17feabb9aaf9a1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-17309b67ff67992f
chapter: CH-05
q: What is Verify_signature(raw) if { # For symmetric key in the context of Rego/OPA?
a: verify_signature(raw) if { # For symmetric key: # verified := io.jwt.verify_hs256(raw, data.jwt.hmac_secret) # verified == true
reference: BLK-1003fa1dd551feed
digest: eebd2945b92b95f65994bab439fc83540d10d88dc33b9fc8f63bb6b596029789
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7edf27887c80685b
chapter: CH-05
q: What is # For asymmetric key w/ JWKS in the context of Rego/OPA?
a: # For asymmetric key w/ JWKS: valid := io.jwt.verify_rs256(raw, data.jwt.jwks) valid == true }
reference: BLK-a99828297e3dc974
digest: 2cd3711ba623c184db0a21c77ddf4e0d1c5d4b37c782d7368365d380fcb9048f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9a6519fd0bbe6290
chapter: CH-05
q: What is Verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer. in the context of Rego/OPA?
a: verify_standard_claims(payload) if { # iss payload.iss == data.jwt.issuer
reference: BLK-ed618edd2a05c651
digest: ea1a7c7379d43581d9c3326ad73e03cbeee9f452f75f6fcbf4721aebc54a99d4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-909e99edae4cfe4e
chapter: CH-05
q: What is # aud (can be string or array) ‚Äì normalize to array aud  in the context of Rego/OPA?
a: # aud (can be string or array) ‚Äì normalize to array aud := payload.aud ( is_string(aud) ; aud_array := [aud] ) or ( is_array(aud) ; aud_array := aud )
reference: BLK-80e59217aeec7749
digest: a5f41b597826937dc35ed68f0420526092b32b50dd6c134ccf3cb99b448d0fff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-70ab1741cb6a57c3
chapter: CH-05
q: What is Some i aud_array[i] == data.jwt.audience. in the context of Rego/OPA?
a: some i aud_array[i] == data.jwt.audience
reference: BLK-2326d2661bb082c0
digest: 9748b98aadcc49e35c3441aec4375f789fbdeeb4d695a060d76b920f7cd5f3a9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-760239fbd7de1699
chapter: CH-05
q: What is # exp (timestamp in seconds since epoch) now  in the context of Rego/OPA?
a: # exp (timestamp in seconds since epoch) now := time.now_ns() / 1000000000 payload.exp > now }
reference: BLK-b4e88b76bdf8c0c0
digest: 34a17db81316eb0fb80e5f471ff28801d3a599411b73f01612b0131cf1aa189f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1aa8fd5befe00f6b
chapter: CH-05
q: What is Verify_custom_claims(payload) if { # Example in the context of Rego/OPA?
a: verify_custom_claims(payload) if { # Example: require email_verified payload.email_verified == true
reference: BLK-b75673f31a5a408f
digest: 7fedb24846bd6921f56258dbea986c16074124452234a2512a94521b1dfa1b54
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-02932a4e42a04c09
chapter: CH-05
q: What is # Scope-based check some i payload.scope[i] == "read in the context of Rego/OPA?
a: # Scope-based check some i payload.scope[i] == "read:orders" }
reference: BLK-05ff27cf94f0f286
digest: dacaf39c39a1ffc109ec0f9d4aff1c55528ca2524894d54ad7feab922a3c4db5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6df8bab96c859ec2
chapter: CH-05
q: What is This example is realistic enough to drop into an API gateway or backend service. in the context of Rego/OPA?
a: This example is realistic enough to drop into an API gateway or backend service.
reference: BLK-441c9184c5a43cc2
digest: df92c21d16c36e828429670a265d8cc2fd1f8bdace1f97994f94ad736e4763e8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c13e69984f0dafa9
chapter: CH-05
q: What is Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example. in the context of Rego/OPA?
a: Chapter 9 ‚Äì Full Bundle Structure with Manifest 9.X Bundle Layout Example
reference: BLK-bda11239f7ba578b
semantic_categories: [distribution]
digest: 0902fac5e3e61f6ababea9f8ce427cd60b779a5b3c6b2b40ca2f2f8ce37bdd2d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-55a596072f58e6c5
chapter: CH-05
q: What is A typical bundle layout on disk in the context of Rego/OPA?
a: A typical bundle layout on disk:
reference: BLK-d34d0d419aa0c7e2
semantic_categories: [distribution]
digest: e24aebc9962a48adecfbf1d72a5dcae41aa92fb824a89e79fc44ae3e94e874d4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-71518a1c7b268ea9
chapter: CH-05
q: What is Bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî... in the context of Rego/OPA?
a: bundle/ ‚îú‚îÄ‚îÄ .manifest ‚îú‚îÄ‚îÄ policies/ ‚îÇ ‚îú‚îÄ‚îÄ authz.rego ‚îÇ ‚îú‚îÄ‚îÄ jwt.rego ‚îÇ ‚îî‚îÄ‚îÄ resources.rego ‚îî‚îÄ‚îÄ data/ ‚îú‚îÄ‚îÄ config.json ‚îî‚îÄ‚îÄ tenants/ ‚îú‚îÄ‚îÄ tenant-1.json ‚îî‚îÄ‚îÄ tenant-2.json
reference: BLK-5bbfded757016e50
semantic_categories: [distribution]
digest: 5bc1caa0113d084c82fe4eafabd7dd933ab162d0b519b92869553b96ae912c2a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1ba84079afda3478
chapter: CH-05
q: What is 9.X.1 Example .manifest File { "revision" in the context of Rego/OPA?
a: 9.X.1 Example .manifest File { "revision": "2025-11-25T10:00:00Z-abc123", "roots": [ "authz", "jwt", "config", "tenants" ] }
reference: BLK-69b6a886fdd31d76
digest: 0986fdf4f9c76771580607d87d664415531c70ce5aa711d655c846cc2cbb53b4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3af28de9a02c6437
chapter: CH-05
q: What is Revision is an opaque version string for debugging/rollback. in the context of Rego/OPA?
a: revision is an opaque version string for debugging/rollback.
reference: BLK-faf25efc6ab6024c
digest: 16a5fc9a92207a87025cfc8594dfd28b710c6ba80ce721685d91adcc7df05939
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5ad778a307823620
chapter: CH-05
q: What is Roots tell OPA which prefixes in data this bundle owns in the context of Rego/OPA?
a: roots tell OPA which prefixes in data this bundle owns:
reference: BLK-cc9220c066084a66
semantic_categories: [distribution]
digest: 8eb36a11b6ec34e03e004cb30de4d5a3cb774e4497dfa00bcad9f703244c836e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-57e8cf0c31015e2e
chapter: CH-05
q: What is Authz ‚Üí data.authz.* (from authz.rego). in the context of Rego/OPA?
a: authz ‚Üí data.authz.* (from authz.rego)
reference: BLK-ae2f270b91be8579
digest: a5a652a3cd8b915399d35e23bace2d735d81c90b0c41845703e49f8393278cff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a09aeed9b738677a
chapter: CH-05
q: What is Jwt ‚Üí data.jwt.* (if any data). in the context of Rego/OPA?
a: jwt ‚Üí data.jwt.* (if any data)
reference: BLK-0ac25a2b767e2140
digest: 2225d83ce28c5d10655da40cb8a9f47a4f11827c492c6b8c8e9147b7b6121a70
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-25ba3a55ddbe8767
chapter: CH-05
q: What is Config ‚Üí data.config.* (from data/config.json). in the context of Rego/OPA?
a: config ‚Üí data.config.* (from data/config.json)
reference: BLK-c70f9f364e197266
digest: 7964b4ed91c00a386c48145b6574f30c42bc44fbc5850b51352c769f4094dc78
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bffac705dea3344a
chapter: CH-05
q: What is Tenants ‚Üí data.tenants.* (from data/tenants/*.json). in the context of Rego/OPA?
a: tenants ‚Üí data.tenants.* (from data/tenants/*.json)
reference: BLK-f5381b4672ab8919
digest: 1b92268a77bc54284de23cd7b792034de1081c6669bc8df6000df8071206bb0b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c837a29060b2dd97
chapter: CH-05
q: What is You can layer bundles by in the context of Rego/OPA?
a: You can layer bundles by:
reference: BLK-f65b10d7491c5a74
semantic_categories: [distribution]
digest: 205596c3a0744e0b0a27f5e6756419db5dbbfe21562be6ac9534eb180bd2c377
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-76f7564b3c39e759
chapter: CH-05
q: What is Using disjoint roots (e.g., authz/ vs pricing/). in the context of Rego/OPA?
a: Using disjoint roots (e.g., authz/ vs pricing/).
reference: BLK-0e8c5e2011dd4b9b
digest: 971492dfc7fb4c85ca1c531b379f46dd106f94dfbba085bf58662ead6504f734
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0c86de215745d87f
chapter: CH-05
q: What is Or orchestrating versioning in the bundle distribution system. in the context of Rego/OPA?
a: Or orchestrating versioning in the bundle distribution system.
reference: BLK-c8f0e1b1efee8906
semantic_categories: [distribution]
digest: 7c4ed05f63f28b9d1f232c79850669b1f445d0896971779d3f3a74a9bfb73b49
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9748bad2dbb59198
chapter: CH-05
q: What is Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document. in the context of Rego/OPA?
a: Chapter 13 ‚Äì Multi-Tenant Decision Aggregation (End-to-End) 13.Y Multi-Tenant Aggregated Decision Document
reference: BLK-c1dbf3b38ab667e9
digest: 9ff34f50203a243893547f7cea8e82f60b2d1f5933ce84d5b50f84bb18334951
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a4adf58a76ae5903
chapter: CH-05
q: What is Goal in the context of Rego/OPA?
a: Goal: build a decision document that exposes per-layer decisions and the final result for a multi-tenant system.
reference: BLK-778e8e4ce5250571
digest: dbc90c130dfb8e8401af68421c83aea7422393d9bccad36774447c00898ff073
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6e3161182cbf510f
chapter: CH-05
q: What is Package authz.multi_tenant. in the context of Rego/OPA?
a: package authz.multi_tenant
reference: BLK-35e5e00ecdd4703e
digest: 87a2fd715d1992cd983595a960b5b8bb56f40d2b22b1bc66eac4316734d2a4a6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8c9701cfbb4df492
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-edc2afac6508d102
digest: 4d3bc0a101bb8f431d9402a21cf2df11556439390a4d5adf4e1d417730c3d0b7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-345014ab4ad118fd
chapter: CH-05
q: What is # Layer rules return {allow in the context of Rego/OPA?
a: # Layer rules return {allow: bool, reasons: [string]} global_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := global_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 }
reference: BLK-561e364c0bc56c05
digest: e66a0f2ca7cfc53fe1c0a94ad7483dc109f91ab6b1552be7b0cf1c3ec7a2dc30
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-97f7bc04ef5e1300
chapter: CH-05
q: What is Domain_decision  in the context of Rego/OPA?
a: domain_decision := {"allow": allow, "reasons": reasons} { deny_reasons := {r | some r r := domain_deny[r] } reasons := sort(deny_reasons) allow := count(deny_reasons) == 0 }
reference: BLK-217a40a7d3f6722c
digest: 6c87238ffacc18ad2ef900e4b3908b7065a8bb2b589d35874fd8b0fb37723e1c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e247375c69f2dbc9
chapter: CH-05
q: What is Tenant_decision  in the context of Rego/OPA?
a: tenant_decision := {"allow": allow, "reasons": reasons} { allow_reasons := {r | some r r := tenant_allow[r] } reasons := sort(allow_reasons) allow := count(allow_reasons) > 0 }
reference: BLK-5feaf7cf3b0268ba
digest: a9364b79ad916b4e6213c9c67e3af5f5d11cecb966d1336b4f6d62f805c53a06
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b2cf3eed5c82ca52
chapter: CH-05
q: What is # Final decision aggregates the layers decision  in the context of Rego/OPA?
a: # Final decision aggregates the layers decision := { "global": global_decision, "domain": domain_decision, "tenant": tenant_decision, "final": { "allow": final_allow, "source": final_source } } { not global_decision.allow final_allow := false final_source := "global" } { global_decision.allow not domain_decision.allow final_allow := false final_source := "domain" } { global_decision.allow domain_decision.allow tenant_decision.allow final_allow := true final_source := "tenant" } { global_decision.allow domain_decision.allow not tenant_decision.allow final_allow := true final_source := "domain/global" }
reference: BLK-3632bbb69a6a4073
digest: f2f43d17ac910679fe68a3cf65c6181e16aa11126ddd6898b1081abff20761d0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fc0932de2fead7f6
chapter: CH-05
q: What is Clients now get a rich decision document in the context of Rego/OPA?
a: Clients now get a rich decision document:
reference: BLK-ecab223a7c0486a1
digest: 28259fa8c1f0ccc04f9196e70d1b65acb146ac9ef0e7737c83ca3df8e44bc9a2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6be7597133479d48
chapter: CH-05
q: What is { "global" in the context of Rego/OPA?
a: { "global": {"allow": true, "reasons": []}, "domain": {"allow": true, "reasons": []}, "tenant": {"allow": true, "reasons": ["Tenant override: feature-x beta"]}, "final": {"allow": true, "source": "tenant"} }
reference: BLK-09019c1063d48428
digest: 79c7f7652881895cd8adaf1551ed20d93c5a2e62f0eaee72b9d1c954eea5cdb8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d369fb813620da62
chapter: CH-05
q: What is Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth. in the context of Rego/OPA?
a: Chapter 16 ‚Äì Complete GraphQL Authorization System 16.X GraphQL Schema, AST, and Field-Level Auth
reference: BLK-5e538168da6683e7
semantic_categories: [authz]
digest: 16156735050f7317726165051a4f8ab73f134c2d45e06dc191d858928f17ad98
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-599f70b60319238b
chapter: CH-05
q: What is API gateway parses GraphQL into an AST and passes it in input.gql. in the context of Rego/OPA?
a: API gateway parses GraphQL into an AST and passes it in input.gql.
reference: BLK-75950f14edf8397e
digest: 3758ea5f2f5fc385ce4ce15fbc308ce78ffcd407549068c64f1c106a5b8a465f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-278133a869055c85
chapter: CH-05
q: What is Schema-driven config is in data.gql. in the context of Rego/OPA?
a: Schema-driven config is in data.gql.
reference: BLK-aa71c08475407014
digest: dceaa762d8b9d3a234c2d7a93be469d2c3159d8eb851b10c510aefcdffab4a6b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e8188c23330655e6
chapter: CH-05
q: What is { "field_costs" in the context of Rego/OPA?
a: { "field_costs": { "Query.users": 1, "Query.users.email": 2, "Query.users.orders": 3 }, "max_cost": 20, "roles": { "Query.users": ["admin", "support"], "Query.users.email": ["admin"], "Query.users.orders": ["admin", "billing"] } }
reference: BLK-1708ce308bfcfad0
digest: 2c7b5a1989a12fdda3a36233cea70e349c22f8d7bd074c8d4abb57f9ca98d878
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-097a7ac981b34f09
chapter: CH-05
q: What is Import future.keywords.in. in the context of Rego/OPA?
a: import future.keywords.in
reference: BLK-bb3abd47870bb2d7
digest: 7f9631c715e926b13cad7bf21cacd7fe77556a11b7d80bd05c99e3e744ad2b01
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-87c62eab173a70ef
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-2f580e08bcbba95e
digest: 830265d49091a31459bd15431d852ef892e6187e8a3bb633e8162eefeccb0eaa
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d585f6c03c797730
chapter: CH-05
q: What is # input.gql example in the context of Rego/OPA?
a: # input.gql example:
reference: BLK-2a2bc1ccf807b459
digest: c0656e99b5ad39e5aa31b4e6ceeeaccd268b66d31d906f5b1ac0902604b19943
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-96ed04521209aff2
chapter: CH-05
q: What is # "path" in the context of Rego/OPA?
a: # "path": ["Query", "users"],
reference: BLK-3dc6f99a487983ea
digest: f82ff242523da3a0468fa8f66a4e32a4a580ac05407834a95ff8305f645d73a1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f4f6b1bf048e0a65
chapter: CH-05
q: What is # {"path" in the context of Rego/OPA?
a: # {"path": ["Query", "users", "email"], "name": "email"},
reference: BLK-489f1a3e7b195d7f
digest: 530d4adc096b1d8afb37aa85315d5dbd4734f6de8ca55bcec1acbd34afae09e2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-327310094e4f494f
chapter: CH-05
q: What is # {"path" in the context of Rego/OPA?
a: # {"path": ["Query", "users", "orders"], "name": "orders"}
reference: BLK-23d21738b0f1b56f
digest: b985b7fb67c0bf54e084c07be7c2cda50f258c83cc5f7a84d6c31c005b35ae74
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fdda7c2cbfb2278f
chapter: CH-05
q: What is # "roles" in the context of Rego/OPA?
a: # "roles": ["support"]
reference: BLK-d94d9a8b50f394c0
digest: 1fd4d756a6e1e5ee8ef477dbe9c721d72ee02e90e5f4f59af9c3fde9ddbf3de0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-abd1a2af8757a0a5
chapter: CH-05
q: What is User_roles  in the context of Rego/OPA?
a: user_roles := input.gql.user.roles
reference: BLK-84861e440fcba053
digest: ff49a2d9500913bc9dcd9a7657012e6a0866bfe396e9d838d1550d92cf7b4b73
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a69be5b6c756ef06
chapter: CH-05
q: What is # Check if user has required role for a field field_allowed([path, field]) if { full  in the context of Rego/OPA?
a: # Check if user has required role for a field field_allowed([path, field]) if { full := concat(".", array.concat(path, [field])) required := data.gql.roles[full] some r in user_roles r in required }
reference: BLK-42ff1a2ed90a4135
digest: aff3d95ec363293febae5a73f5279dec4207f61552650fbeb25fedf4583b9d13
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c010ecdcce11f033
chapter: CH-05
q: What is Field_cost([path, field])  in the context of Rego/OPA?
a: field_cost([path, field]) := c if { full := concat(".", array.concat(path, [field])) c := data.gql.field_costs[full] }
reference: BLK-b5bff85150d3377c
digest: 050963414227d30ca79b31a245b66e248835f0ae18c8425d1dc91524ea89f9d0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-47779488effc8ad0
chapter: CH-05
q: What is Field_cost([path, field])  in the context of Rego/OPA?
a: field_cost([path, field]) := 0 if { full := concat(".", array.concat(path, [field])) not data.gql.field_costs[full] }
reference: BLK-baba7ac4a7b4d63d
digest: 4568a8bb0d4390e9e9fac29585f8f5fae7878be55e0e7c9f084bc50b2d751cb1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8ea2d48524a70fe1
chapter: CH-05
q: What is # Flatten all selected fields (including nested subfields) all_fields  in the context of Rego/OPA?
a: # Flatten all selected fields (including nested subfields) all_fields := result { result := [ {"path": f.path, "name": f.name} | op := input.gql.operations[_] f := op.fields[_] ] ++ [ {"path": sf.path, "name": sf.name} | op := input.gql.operations[_] f := op.fields[_] sf := f.subfields[_] ] }
reference: BLK-e0c6ec40c537eb08
digest: 8909742fbdca1b33cffa26ccfe433e945f6cb4a0d0e17e7e106daa37e14f0b30
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-27bd0a36f1ebd345
chapter: CH-05
q: What is Total_cost  in the context of Rego/OPA?
a: total_cost := sum({ c | f := all_fields[_] c := field_cost([f.path, f.name]) })
reference: BLK-1804a20482d1b343
digest: 3d22e257012306ba17dbb3f50ee9727cbea0decd8ee4f249cdeb21c6738fd5cd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-881b84c3e6e6b8ee
chapter: CH-05
q: What is Too_expensive if { total_cost > data.gql.max_cost }. in the context of Rego/OPA?
a: too_expensive if { total_cost > data.gql.max_cost }
reference: BLK-39ed6f20348b8623
digest: f62869160480272e6b7ad4125509068ef6d12ac5aa62d6e50db0d6ea287a6d37
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e9cc6cdb37854503
chapter: CH-05
q: What is Unauthorized_fields[full] if { f  in the context of Rego/OPA?
a: unauthorized_fields[full] if { f := all_fields[_] not field_allowed([f.path, f.name]) full := concat(".", array.concat(f.path, [f.name])) }
reference: BLK-2290e821ea646404
digest: 894cd026dbbedf9cd61e002746e33254954b3a2cd3aa09dd24404df79b0e140a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cb61b1307cbc4a4e
chapter: CH-05
q: What is Allow if { not too_expensive count(unauthorized_fields) == 0 }. in the context of Rego/OPA?
a: allow if { not too_expensive count(unauthorized_fields) == 0 }
reference: BLK-0f57f72096c4c8a0
digest: 3aa6234d6a0ea07f5a90ba407c539b3cc8c658bfa1624c29254a4ac647954dde
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9aad57c2e204786e
chapter: CH-05
q: What is Decision  in the context of Rego/OPA?
a: decision := { "allow": allow, "total_cost": total_cost, "unauthorized_fields": unauthorized_fields }
reference: BLK-4ce77748e8276750
digest: 8eed5017cd60969c5e77da2a1e02ef675821c09514c8e402dbd671d48c584bdf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-32b90444eb477b64
chapter: CH-05
q: What is Field-level auth (field_allowed). in the context of Rego/OPA?
a: Field-level auth (field_allowed).
reference: BLK-d936cb7e30a4ea67
digest: c6ab446505bcdf110ffc4dc92b026d54960875e516f0ef2ead93e1534cefde98
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-129f525eae1f3661
chapter: CH-05
q: What is Cost-based limiting (total_cost, too_expensive). in the context of Rego/OPA?
a: Cost-based limiting (total_cost, too_expensive).
reference: BLK-36ea9500bf4999b0
digest: 1173451da9ea1048f0c6d6e75db3053220eb233a01b31c7c2945ccad85562950
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bdb5b6e977f7c208
chapter: CH-05
q: What is A rich decision document for clients. in the context of Rego/OPA?
a: A rich decision document for clients.
reference: BLK-d8cbad3b94589fdb
digest: bf406817d75b128f53162a0ee3d88d7f45ae6b9bc7f18a41c400a1c4c67af5a5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d2b611f38599568f
chapter: CH-05
q: What is Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot]... in the context of Rego/OPA?
a: Chapter 17 ‚Äì Full LLM ‚Üí OPA Workflow with Validation 17.X Architecture Diagram flowchart LR REQ[User / Dev Describes Policy] --> LLM[LLM / Copilot] LLM --> CAND[Candidate Rego Policy] CAND --> PIPE[Validation Pipeline] PIPE -->|fail| FEEDBACK[Errors / Suggestions] PIPE -->|pass| BUNDLE[Signed Policy Bundle] BUNDLE --> OPA[OPA Deployments]
reference: BLK-f234f625c8beddfc
semantic_categories: [distribution]
digest: 5a5f0991c635d5a53714df3ef68ca8f7e9bbd0e939c44459f560544a743a4132
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3fbfb249d182f2ff
chapter: CH-05
q: What is 17.X.1 Validation Pipeline Steps. in the context of Rego/OPA?
a: 17.X.1 Validation Pipeline Steps
reference: BLK-3ed64c8d88ca8eca
digest: bf479d420f6d5f4370278fd9bb5d4d88e2d08478b43ceac2c72c604fc61e0629
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f0b51f7c7778337d
chapter: CH-05
q: What is Syntactic checks in the context of Rego/OPA?
a: Syntactic checks: opa fmt, opa check.
reference: BLK-21b409432e66beb2
digest: 2a10259511446b7e82a555a12a48e9b2f7299b0ac007c29aba791cf0cfb8e8b9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-31a493e3473888df
chapter: CH-05
q: What is Unit tests in the context of Rego/OPA?
a: Unit tests: opa test.
reference: BLK-97ebf04ed742eadc
digest: a1b08a37cbb99837d55f26359d1d402ffa360f0c20c39c6cb78a32a54bfb9e7e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6041c22e5d198f6e
chapter: CH-05
q: What is Static analysis in the context of Rego/OPA?
a: Static analysis: internal style & safety rules.
reference: BLK-56ab8a64b9bbcf14
digest: 5e48f8bb76ee3e9306e419ec8050d5f983dc47fca3808c8f6da6f408bf2f4066
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c2aa49f74e0175da
chapter: CH-05
q: What is Staging OPA in the context of Rego/OPA?
a: Staging OPA: run candidate policy against recorded traffic (shadow mode).
reference: BLK-980f1c312cf40eb8
digest: 9ebaa99b5bb36ca9a932ed3fc2e5bfedd5cd6d4546b63b8b25c2b930fce6527f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-895330a0c5461a25
chapter: CH-05
q: What is Human review for MAD (Major Action/Decision) changes. in the context of Rego/OPA?
a: Human review for MAD (Major Action/Decision) changes.
reference: BLK-d10604b78eaedde3
digest: d37676977a1986b98f2a2c62df47337c6ee836dbb4a36ed466519cc03d91e88f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e019a5835c804237
chapter: CH-05
q: What is 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests. in the context of Rego/OPA?
a: 17.X.2 Example ‚ÄúLLM-Written‚Äù Policy + Tests
reference: BLK-3cec2ea33dbc48c5
digest: 43e005496930a8d7b6a874d2ed7512a6e83b4ba42ddf6e71f689ddc2b7f9cd4f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2739fd4904507e41
chapter: CH-05
q: What is Candidate Rego (generated by LLM) in the context of Rego/OPA?
a: Candidate Rego (generated by LLM):
reference: BLK-b808b17ee8a689c6
digest: 67152bc2da0203ae4f1c5bcbf9afbc3446e88a71f06f802c534fdf56a8c855bf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8d9a2f41ec9e23b2
chapter: CH-05
q: What is Package authz.orders. in the context of Rego/OPA?
a: package authz.orders
reference: BLK-33fa20a5d4c88b66
digest: 5a40c3655d00eb18436dc0c907c7e3544daf1a1c3b63211f84e9e1ab2e5b6719
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7ceb46cdb7ea7697
chapter: CH-05
q: What is Default allow  in the context of Rego/OPA?
a: default allow := false
reference: BLK-70478133c7e3b2e9
digest: 81697ec8ca5af920e4a4515c11e6824365a79a3dbb051ba9f6b99410cbb90463
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f95006543bf79921
chapter: CH-05
q: What is # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id]. in the context of Rego/OPA?
a: # Allow read if user owns order or is admin allow if { input.method == "GET" input.path == ["orders", order_id]
reference: BLK-03fccd8e6d2155ad
digest: 32c8dd22d83e7aa6e49dc2db40b683119cf77352850cd73c6df1b45b7c4501d3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f5b8842d8f397471
chapter: CH-05
q: What is Some order order  in the context of Rego/OPA?
a: some order order := data.orders[order_id]
reference: BLK-270b38e64b2b00e3
digest: 5cc0bc9cd3b4701136917d4b241d691886f521c4aa1822d7f522193ad70896f9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0c92096ab3271795
chapter: CH-05
q: What is ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) }. in the context of Rego/OPA?
a: ( order.owner_id == input.user.id ) or ( input.user.roles[_] == "admin" ) }
reference: BLK-70a8f91f82a18e3d
digest: c4aff5e472095c6eae13332ce0e0fd6667e703d2034e4ad94188cf7f0d709661
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c60a9db4529168a9
chapter: CH-05
q: What is Package authz.orders_test. in the context of Rego/OPA?
a: package authz.orders_test
reference: BLK-fbbe119189f2ab36
digest: 7b7f9a0cc3969b670414931987d23926c57fd15023b7971c64c6fbf0ee1efed2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-721618cc8d81c944
chapter: CH-05
q: What is Import data.authz.orders. in the context of Rego/OPA?
a: import data.authz.orders
reference: BLK-54d277aeaababbe9
digest: c14274ec8be3a0b5a7720dbf601dd301778271d4c3f9c89749024a46bef3e774
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ccdfd4880bc2d838
chapter: CH-05
q: What is Test_owner_can_read if { input  in the context of Rego/OPA?
a: test_owner_can_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "alice", "roles": []} } data.orders["o1"].owner_id == "alice"
reference: BLK-405a975fd98ce06b
digest: 219a4f158801cf35a745e0f25ea5d98a0c0d99f438267354c03362aef81d05d1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1544151535ec80b1
chapter: CH-05
q: What is Result  in the context of Rego/OPA?
a: result := orders.allow with input as input result == true }
reference: BLK-7f7b19bbfe9ca742
digest: d40c2debe172aa5ad42bab6c1448407e2405491c65f1f3fd4bc39a2758f77534
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3973669dd3a66389
chapter: CH-05
q: What is Test_non_owner_cannot_read if { input  in the context of Rego/OPA?
a: test_non_owner_cannot_read if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "bob", "roles": []} } data.orders["o1"].owner_id == "alice"
reference: BLK-09066e199d225e96
digest: 425e4adf231068ecd91d63b4d915644f2354ddf4b253e348efe298c8146cf46b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e8582c6d8f257732
chapter: CH-05
q: What is Result  in the context of Rego/OPA?
a: result := orders.allow with input as input result == false }
reference: BLK-2ef9e325c3ede69b
digest: b4f7e537647293e97fe0105b9fb1bec911379ea083f80bc9c2754c6325e994fc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8a868281ae3ca4be
chapter: CH-05
q: What is Test_admin_can_read_any if { input  in the context of Rego/OPA?
a: test_admin_can_read_any if { input := { "method": "GET", "path": ["orders", "o1"], "user": {"id": "random", "roles": ["admin"]} }
reference: BLK-6c4f81cc9fa85914
digest: b8ea90ece4dabbf2456385a2a1d5b888810a0698159adab9d051820a6830d9af
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-73af52fe3c037db5
chapter: CH-05
q: What is Result  in the context of Rego/OPA?
a: result := orders.allow with input as input result == true }
reference: BLK-0e04cfd232a00a3d
digest: 35532b52e2ab302cc72991578b75577c06cf3dab8feddf749628e8b9ce1f60f8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d38127c277f76755
chapter: CH-05
q: What is Run opa fmt ‚Üí ensure style. in the context of Rego/OPA?
a: Run opa fmt ‚Üí ensure style.
reference: BLK-0b9f5a2396b4bc82
digest: f3b1577f02cd71102c0d24c6bc1d4965677e0ce3a344024227c0e7daea2f7156
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-df7525617db01e55
chapter: CH-05
q: What is Run opa check ‚Üí catch unknown refs, unsafe vars. in the context of Rego/OPA?
a: Run opa check ‚Üí catch unknown refs, unsafe vars.
reference: BLK-b23aa9257026f9c0
digest: b62b7aed460109f5d73586451b7a23f53f67f68683da912efa284c810d3b9d31
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-119793bf7dd444b0
chapter: CH-05
q: What is Run opa test ‚Üí ensure behavior matches expectations. in the context of Rego/OPA?
a: Run opa test ‚Üí ensure behavior matches expectations.
reference: BLK-8b09faf1219c8625
digest: 63c6af6edf8579d1a41a312b52325c1f2bba4fd9cb4f8b3a59c5fb3a696e500d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-280963056a985106
chapter: CH-05
q: What is Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths). in the context of Rego/OPA?
a: Run internal checks (e.g., no input.user.is_admin == true shortcuts, no unsafe wildcards in paths).
reference: BLK-a39d79842263ba83
digest: a2247c106e2758cb17f447e0a4902b7261e6d4a5bef2fe01685dff5a4240a3de
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cac44acfcab95a01
chapter: CH-05
q: What is If all pass, bundle and distribute. in the context of Rego/OPA?
a: If all pass, bundle and distribute.
reference: BLK-8c30db71e7f93b4d
semantic_categories: [distribution]
digest: cb688f66ea45ee9be2b2ec310fbb056f4171350a3f48f76249fc6f0135fbaf94
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-48b518ceb142a751
chapter: CH-05
q: What is Rego‚Äôs scoping rules are simple but unforgiving. in the context of Rego/OPA?
a: Rego‚Äôs scoping rules are simple but unforgiving. Most ‚Äúmysterious‚Äù bugs in policies stem from variable scope and safety issues.
reference: BLK-2757c170b17bf0a0
digest: 4564fbb606e8aa798eb9c0fe63b1194fbeb91f473dfafc28f084501f0441b1b7
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-057a1d17227620ea
chapter: CH-05
q: What is Inner blocks can rebind a variable name used in an outer block, changing meaning silently. in the context of Rego/OPA?
a: Inner blocks can rebind a variable name used in an outer block, changing meaning silently.
reference: BLK-94f8c149d00a676c
digest: 63592b90645887c86e2d716e80c16f33ca196509350bd26caad6ea5ed52cca8f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8b1d6e96f98638f2
chapter: CH-05
q: What is Allow if { user  in the context of Rego/OPA?
a: allow if { user := data.override_user # shadows outer user user.id == "admin" }
reference: BLK-c1e1ad2a784b9961
digest: bebf0b5b13c2486b6ef325c2c071eb4d6c1638895072678ebe23c7ad9e9ad304
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8a811213a24b2399
chapter: CH-05
q: What is The inner user hides the outer one. in the context of Rego/OPA?
a: The inner user hides the outer one. Prefer distinct names unless you truly mean to shadow:
reference: BLK-e9a2a703bbdc8110
digest: 7a5e949584b92f2d2f4d3c48fb558f463f6146b147b2a36834d846cb9d5d682f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a82bb1afc7e4d9ba
chapter: CH-05
q: What is Allow if { override_user  in the context of Rego/OPA?
a: allow if { override_user := data.override_user override_user.id == "admin" }
reference: BLK-5fe91289cef7406b
digest: c9e4fd4d115bf2ef67e324cf960b31d59995220531f74cfdaa92baceac0ee9d1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9652e829c267adae
chapter: CH-05
q: What is # ‚ùå Unsafe in the context of Rego/OPA?
a: # ‚ùå Unsafe: r is not always bound deny[r] if { input.violations[_] == v v.level == "HIGH" r := v.reason } else { # no binding for r here }
reference: BLK-3062214c3efb9bc9
digest: 21f2210aeae68ecaf49b52d48f08a554778396803fbf032c52a945653b79ed47
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-66e37d0f4def50ad
chapter: CH-05
q: What is Use opa check to detect this and refactor to ensure all head variables are always bound in the context of Rego/OPA?
a: Use opa check to detect this and refactor to ensure all head variables are always bound:
reference: BLK-01dc213f722cd9db
digest: 9fad9c14d589da6037282c2d9397dbb777204a15a151879eb7d4b5e63e6ae614
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f0d154284cb02412
chapter: CH-05
q: What is # ‚úÖ r always derived from same comprehension deny[r] if { r  in the context of Rego/OPA?
a: # ‚úÖ r always derived from same comprehension deny[r] if { r := v.reason some v in input.violations v.level == "HIGH" }
reference: BLK-7e368e0110cc4ce5
digest: 0e0df3e16fe2fe91beeef13e05bddf44ca97801d3fa37ebf610a59f436ff74bf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-74ee93244fcbf731
chapter: CH-05
q: What is Some x introduces a new variable local to the current expression. in the context of Rego/OPA?
a: some x introduces a new variable local to the current expression. Using it incorrectly can over-constrain or under-constrain rules.
reference: BLK-bd9cc15be97aaac3
digest: 9bbc89fd5e64c9fff159c6bcfb66fa803efebfda56a065ac626898e5fdb5958d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-881c6d3ad202dbe5
chapter: CH-05
q: What is Use distinct names in the context of Rego/OPA?
a: Here the second some i doesn‚Äôt ‚Äúreuse‚Äù the first one; it introduces a new i but still scoped to the whole body in practice. Use distinct names:
reference: BLK-66161b54f3ab4c92
digest: 76c0149fefc5223e4c4a3d4a61cf2611aee5e6ce4e89fb709488404ed0b8b5bf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-63e9059ca78cdfad
chapter: CH-05
q: What is # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }. in the context of Rego/OPA?
a: # ‚úÖ Clear indices good if { some i arr[i] == "a" some j arr[j] == "b" }
reference: BLK-d72d3ae58221ff67
digest: e0073bdd735d59bbdd87bdab7d98cbcf36269bd0515ba05b0c7a3169f86a03dc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5b5d7e045c08e5bb
chapter: CH-05
q: What is Each rule evaluation is pure and has no hidden global state. in the context of Rego/OPA?
a: Each rule evaluation is pure and has no hidden global state. Avoid writing rules as if they ‚Äúaccumulate‚Äù across calls:
reference: BLK-47e95b45cc5edf3c
digest: e78492bdec96dddc6c9042850709f1e958cd7f0a8fedeced82e2f4e4ab3ffc9c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-320e7b55750c2f5e
chapter: CH-05
q: What is Instead, build sets or arrays with comprehensions, then aggregate in the context of Rego/OPA?
a: Instead, build sets or arrays with comprehensions, then aggregate:
reference: BLK-633a4a5154649ed1
digest: 6a0058c17b9e1f3e449d8214ecb4ddc03d8d829431eb1b9f5575afc9afbd1727
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-47781507956ddcef
chapter: CH-05
q: What is Violations  in the context of Rego/OPA?
a: violations := { v | some i v := input.items[i] v.level == "HIGH" }
reference: BLK-4504655151caa66a
digest: 2175d9628b608a2384833d01016649c9ece9484e3e67b061a0db241c16a17bbd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-31dcac2da1fde021
chapter: CH-05
q: What is Violation_count  in the context of Rego/OPA?
a: violation_count := count(violations)
reference: BLK-b7db79b559c9a8be
digest: bd4c245c5f2561262b0383c8a813eeba812d23e6f241ffde5a3815e5df6d9086
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-afbe4f7265f5e147
chapter: CH-05
q: What is Rego is strict about types, but JSON inputs are often messy. in the context of Rego/OPA?
a: Rego is strict about types, but JSON inputs are often messy. Nulls and missing fields are a frequent source of runtime errors.
reference: BLK-36c3bcd5e1134f4f
digest: a47fac5164c99e484e38311a28e59b926794d9f79110a2bf2f9e736ede0123fb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-978b23bab8e0417f
chapter: CH-05
q: What is Always guard when reading from untrusted inputs in the context of Rego/OPA?
a: Always guard when reading from untrusted inputs:
reference: BLK-b7d90967e18de369
digest: 2cf3ed2b058c227cee9efe8ebf8b83c0bfe60f5ee6a4a9f1fd3610011781045b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6e6e7301604da4f2
chapter: CH-05
q: What is # ‚úÖ Safe pattern with guards user_email  in the context of Rego/OPA?
a: # ‚úÖ Safe pattern with guards user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }
reference: BLK-e35261e5caf2b447
digest: e2096cc47263835085c288b6abebb0bdfd960d47175d0236aec17bae86751357
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3fe41b9ed262b05e
chapter: CH-05
q: What is You can also provide a default in the context of Rego/OPA?
a: You can also provide a default:
reference: BLK-dc69febaea17b4d4
digest: 1e0b9d46e37fd99afd3e8eef55df1814940334b5d80253ee1debe376dff0a7ff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d4b7028d6183510a
chapter: CH-05
q: What is User_email  in the context of Rego/OPA?
a: user_email := email if { is_object(input.user) is_string(input.user.email) email := input.user.email }
reference: BLK-e47efc5955420f53
digest: bd49e96c370c99f764a18ea8612dca21f5726c0f6bc049d02dfff12bb04ae524
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0118e7a2f2310050
chapter: CH-05
q: What is User_email  in the context of Rego/OPA?
a: user_email := "unknown" if { not is_string(user_email) }
reference: BLK-7c1a3d4a579c38de
digest: 5651c15b5f2c29cd671f245041dd51821a2cefba0b6a4b0d2fa6160a31065a0d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4da0a36adffa1c5c
chapter: CH-05
q: What is Null, missing, and ‚Äúfalsy‚Äù values are different in the context of Rego/OPA?
a: null, missing, and ‚Äúfalsy‚Äù values are different:
reference: BLK-e4237f7442d9769a
digest: a0af43f06d95dbb163705941a62b18ec7b289c214df8ec966d12a56489c4d872
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-70747cb862c64449
chapter: CH-05
q: What is Missing in the context of Rego/OPA?
a: Missing: input.user.email ‚Üí error if user missing or not object.
reference: BLK-365c96c74e794ad8
digest: 90d706e9d9adc16b84909e1054cd34141bf0211c9493e2ba6403337f4b0373c2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9384e3d64e5a5c0f
chapter: CH-05
q: What is Present but null in the context of Rego/OPA?
a: Present but null: input.user.email == null is valid.
reference: BLK-624f75dd97acc370
digest: 523c05ee0d7e76158544a843bcc26e5dc2f34e9ab5cc5d37fd18ed6d1502f6cd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0a119fe4b2dcf0e2
chapter: CH-05
q: What is Falsy (e.g., "", 0, false) in the context of Rego/OPA?
a: Falsy (e.g., "", 0, false): normal values.
reference: BLK-7b110b84bf4a7140
digest: 8c85557b9ef22a32eb63d5837ec35f5c9612cd2cf7597dc786cf960c221da381
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-12cd0958b2d800ad
chapter: CH-05
q: What is Use guards to distinguish in the context of Rego/OPA?
a: Use guards to distinguish:
reference: BLK-d4b34685c6fe166d
digest: b068f5243d5715a73c02b48291ca07dfa7b102c1ef927f1ce0c8735b7c1b8854
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f9179006b9000796
chapter: CH-05
q: What is Has_email if { is_object(input.user) input.user.email != null }. in the context of Rego/OPA?
a: has_email if { is_object(input.user) input.user.email != null }
reference: BLK-21057b3108817270
digest: 62df487e1655b15fef1ffa80c2a2bee0ced2c809f43f9fab4e4bed196ac51276
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-377bf6cdf5b71c82
chapter: CH-05
q: What is Wrap in a safe helper or use guards in the context of Rego/OPA?
a: Wrap in a safe helper or use guards:
reference: BLK-9c0b54c322f0cfd2
digest: 11d4d8b979e38b200e05c33292d815a09fde2157a91d4fbf943d83d1cadbe8a5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3f119339c0fd890a
chapter: CH-05
q: What is Full  in the context of Rego/OPA?
a: full := concat(".", array.concat(path, [field])) if { is_array(path) is_string(field) }
reference: BLK-831a0270acb78581
digest: 775757b0d07ef46639bdc47ae9c6a846a5584f62d3c9c4209ff12ad9ce5da18a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8bf6e6b24143a5ae
chapter: CH-05
q: What is Safe_concat(a, b)  in the context of Rego/OPA?
a: safe_concat(a, b) := array.concat(a, b) if { is_array(a) is_array(b) }
reference: BLK-825177e2f70d19a9
digest: 894140e74510cc41cdebce4c9d74d2a02eefe8222a2d4801c523fdc0f2e07969
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-10ab36e82365fc36
chapter: CH-05
q: What is If input.user.id is a number and data.allowed_ids are strings, this will never match. in the context of Rego/OPA?
a: If input.user.id is a number and data.allowed_ids are strings, this will never match. Normalize types first:
reference: BLK-67a3905c24c8c0ec
digest: db3c28feb82ba743a060d65428656dd67e379b3f737e6dfcdadb4cf8c2bb8f74
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-de0243f144783531
chapter: CH-05
q: What is Allowed if { id  in the context of Rego/OPA?
a: allowed if { id := sprintf("%v", [input.user.id]) id == data.allowed_ids[_] }
reference: BLK-55ada30082a8703f
digest: bf97e49f93575b961c8a04bc82376b9fdd32e13c62305f590448fbd4680319a9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-777e83443d0df451
chapter: CH-05
q: What is X in y behaves differently depending on whether y is an array, set, or object. in the context of Rego/OPA?
a: x in y behaves differently depending on whether y is an array, set, or object.
reference: BLK-b5937dcce3d0252f
digest: c9ef0b70b5cc53296347124468644358e41f97866e9c86b201e97629e45b5875
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2d7897d59e15c908
chapter: CH-05
q: What is Array in the context of Rego/OPA?
a: Array: x in ["a", "b"]
reference: BLK-79448506eb420437
digest: 3f74250f03937654fb419f642fe6d72f7f4baea85af4071907c167717d26639e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-19479e7fc2ac5297
chapter: CH-05
q: What is Set in the context of Rego/OPA?
a: Set: x in {"a", "b"}
reference: BLK-b7157bcb8e94b0ed
digest: 765aef985c4d9f3e67b0db630e95478ba475bbad06f83b0ba799fbdc88384294
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-02cd2c3f8ead0fb9
chapter: CH-05
q: What is Object in the context of Rego/OPA?
a: Object: k in {"a": 1} matches keys, not values.
reference: BLK-2e17d5deecfb16e9
digest: d4c0d89eace79815b3a6666b63140ac920307da0f7f2753641eb4c9b70856a6f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-32241de7079a4b7d
chapter: CH-05
q: What is Be explicit about what you mean in the context of Rego/OPA?
a: Be explicit about what you mean:
reference: BLK-d2517da8161f68a7
digest: 280577079a71412e3d120bc9d49d39bb2fa9b2885c31f447dc97e7968fcf295f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5cd38447b501c995
chapter: CH-05
q: What is # Key membership "k1" in {"k1" in the context of Rego/OPA?
a: # Key membership "k1" in {"k1": 1, "k2": 2}
reference: BLK-c6c12d42e06d1082
digest: e8ac38d92477deef6d51997efcdb6fb08315da6a04b5d74e27ba27f429a9084b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f33bab17bbe2d955
chapter: CH-05
q: What is # Value membership ‚Äì convert to set/array some v in {v | some k; v  in the context of Rego/OPA?
a: # Value membership ‚Äì convert to set/array some v in {v | some k; v := obj[k]; v == "needle"}
reference: BLK-352021e25dd18271
digest: 9b897fbfc7053931ea7720cdb547fbafb8a409000feea3aca7e2b53a0efd0eff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bcd88ad1d99d82c1
chapter: CH-05
q: What is Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins. in the context of Rego/OPA?
a: Performance problems in OPA usually come from data modeling and unbounded searches, not from individual built-ins.
reference: BLK-05f8217e07cce144
digest: e45f579fa66ab58cf236b047d99ea2e89d03111bf49b11529938431d168fee52
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4e07a9d1832023ce
chapter: CH-05
q: What is Pre-index large data sets offline (e.g., data.events_by_ip[ip]). in the context of Rego/OPA?
a: Pre-index large data sets offline (e.g., data.events_by_ip[ip]).
reference: BLK-5178d3c470aafde0
digest: decd7cccc1b7b64021b3995094e61557e62c270f0ca2a484b83a271e1cd2bd11
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8ab798dcca99d22d
chapter: CH-05
q: What is Use sets for membership checks. in the context of Rego/OPA?
a: Use sets for membership checks.
reference: BLK-99693fd9c0631dc9
digest: 4a1c73c73fee5c58942f1a9d8128afbbf925f3ac80b7a2099116faa2aff1a19a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-403d827d24eb232f
chapter: CH-05
q: What is # Precomputed in the context of Rego/OPA?
a: # Precomputed: data.events_by_ip = { "1.2.3.4": true, ... }
reference: BLK-89b4222f574f5bd8
digest: 0dd55c57ed1194a0dfebe32faa8e7da1421c51ef8d8ee1640ebd067d187726fe
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c263b8d2dcf4873c
chapter: CH-05
q: What is Deny if { data.events_by_ip[input.client_ip] }. in the context of Rego/OPA?
a: deny if { data.events_by_ip[input.client_ip] }
reference: BLK-2b4b1821e0d0db43
digest: c56045fa5bd0ddbc48d963e0b0d8d771e5218ca9ca93b4b621cb263cd480e6af
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9d4de9e84e885670
chapter: CH-05
q: What is Push pattern constraints into data modeling if possible. in the context of Rego/OPA?
a: Push pattern constraints into data modeling if possible.
reference: BLK-b992c588b72a15d0
digest: adbc25ab2e87027f6b25eefd819dcf0e88f84a34514242663b7c1c2d9c928ded
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-17554570acb51d70
chapter: CH-05
q: What is Limit regex to narrow fields and avoid complex patterns. in the context of Rego/OPA?
a: Limit regex to narrow fields and avoid complex patterns.
reference: BLK-a62e5ffefca78bb2
digest: 62a7c66f4f61c45501db98d10bb4a624b9d00a849566d8948c3ac8566dd724ee
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-902dd19b73a15b1d
chapter: CH-05
q: What is Precompile filters into simpler checks (startswith, contains equivalent logic). in the context of Rego/OPA?
a: Precompile filters into simpler checks (startswith, contains equivalent logic).
reference: BLK-a0d6a6b70fe5fdb9
digest: fd64cfd191d63ce282b2f1247b3e5dd3fbd1ca77ab01714ff91183c8bbed4e29
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-be872eb91947e4b4
chapter: CH-05
q: What is Bind once and reuse in the context of Rego/OPA?
a: Bind once and reuse:
reference: BLK-d2bdd9db4aebc3a8
digest: 168f0d05e9f2d93b8d8a676433526a9c81689da30f68445f00cbbbbb76722043
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9659d93cc4d311ad
chapter: CH-05
q: What is Deny if { name  in the context of Rego/OPA?
a: deny if { name := input.user.name re_match("admin", name) some p in data.profiles # reuse name without extra call }
reference: BLK-637e77339c5814ec
digest: 062ed48b38d7a12cd9e173c55551da42d0a8848e429da0c2090f10a227d04840
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e00a3f798e03f934
chapter: CH-05
q: What is You can also use helper functions for complex computations. in the context of Rego/OPA?
a: You can also use helper functions for complex computations.
reference: BLK-8824da1c32a641ad
digest: 5ff0631ec370e14ab81204a73f6200bc0b906475dcdf1d8575eddb60720ce8ca
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-86557e0b1152bb20
chapter: CH-05
q: What is Evaluating large, mostly static policies at runtime in the context of Rego/OPA?
a: Evaluating large, mostly static policies at runtime:
reference: BLK-13991d114e5dea7e
digest: 850e56a207fe2d88d27fa2f28b6bb9c59f3326afef3509f07aaaaea2e2b9df21
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1e516df87bf145e4
chapter: CH-05
q: What is If most config is static, bake it into data and use partial evaluation in the context of Rego/OPA?
a: If most config is static, bake it into data and use partial evaluation:
reference: BLK-52bb492156ce1912
semantic_categories: [performance]
digest: cb46dbcb107a4734481f7f69d864eae713991d349140275f6f832c6de68a3631
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b6bc85559eb4fa29
chapter: CH-05
q: What is # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/. in the context of Rego/OPA?
a: # ‚úÖ Precompute static parts into a bundle or WASM opa build -e 'data.authz.allow' policies/
reference: BLK-322b0467c2590b89
semantic_categories: [distribution]
digest: c6ed8565b4a2336accdc0099cc7b049e139c94c1f1ba2be075e0052bd581357b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-aaa090646b0a0652
chapter: CH-05
q: What is Then pass only request-specific input and reap the performance benefits. in the context of Rego/OPA?
a: Then pass only request-specific input and reap the performance benefits.
reference: BLK-0ce0885ddcf9ff4e
digest: 79e173c0f5bb043145ebb9d2f1c87d3364fed4c65d4a81196a0d43e5fb5e9ceb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-60085d8d09ca3cd2
chapter: CH-05
q: What is Walk is powerful but traverses entire trees. in the context of Rego/OPA?
a: walk is powerful but traverses entire trees. Instead:
reference: BLK-1b7adba70540b67a
digest: a72e20705e559a0946e8621d92d0c8c380ab873c20fcb17b4bf3c4898d36ef06
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-73c7bb71b2433961
chapter: CH-05
q: What is Narrow the search to known subtrees. in the context of Rego/OPA?
a: Narrow the search to known subtrees.
reference: BLK-a7dbd4176f57e16c
digest: 92e77d19fbdce58710857c7e620031de22c62fefec7540451af5492252a0f38a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9293836814ffcc87
chapter: CH-05
q: What is Maintain dedicated indexes for sensitive values. in the context of Rego/OPA?
a: Maintain dedicated indexes for sensitive values.
reference: BLK-223e103f0ca5d229
digest: 0f5362bf078975476b61145e562fdbad3837067c2fc7e3979193ac80bbd3ee00
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2666f7eb4e712034
chapter: CH-05
q: What is Use more structured queries instead of full traversal. in the context of Rego/OPA?
a: Use more structured queries instead of full traversal.
reference: BLK-f467d2011eab9dfc
digest: c5fbc6a22e6f37d760e10a5dd02da2c0e5d2e58b74e9fd7b8a3189dbca27be8d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-131b86384ddffab5
chapter: CH-05
q: What is # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }. in the context of Rego/OPA?
a: # ‚úÖ Narrowed search deny if { some path, value walk(data.tenants, [path, value]) value == "secret" }
reference: BLK-dc6be62dc0d450eb
digest: 180f681bb70f67e934d484544226e536a3f5293a38e8b891aba4a965256849f9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ac57a016ee0add40
chapter: CH-05
q: What is Use opa fmt --skip-constraints (most reliable built-in). in the context of Rego/OPA?
a: 1. Use opa fmt --skip-constraints (most reliable built-in)
reference: BLK-84a9bbab21a7036f
digest: 58658628126c26702c59f059f96317beb17e3d04c2477adea0ad407a1ee5a3cb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9dff274cfc5dfe45
chapter: CH-05
q: What is Opa fmt removes unused aliases but NOT unused imports. in the context of Rego/OPA?
a: opa fmt removes unused aliases but NOT unused imports.
reference: BLK-de4bad29442a85ab
digest: 4648aac76923eec9c266866f12baeb1fa6bc1ae9c2961f829ab278680e5358d8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-217888097154e30e
chapter: CH-05
q: What is Import data.utils as u. in the context of Rego/OPA?
a: import data.utils as u
reference: BLK-981ffefdcd4afb94
digest: f00a077b281fb66fbe31ac8e86a54557f70fbae898c632da519294c0a757477d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6272ccb95212f2be
chapter: CH-05
q: What is If u is never referenced, opa fmt will not remove it. in the context of Rego/OPA?
a: If u is never referenced, opa fmt will not remove it.
reference: BLK-9124fbb631e1cbb3
digest: b153106bb15e792ec9c18e177906414a830fc6c83d4b3e1147d508ff4e9421c1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b6ef7049e070a656
chapter: CH-05
q: What is Some versions of opa fmt will rewrite it to in the context of Rego/OPA?
a: Some versions of opa fmt will rewrite it to:
reference: BLK-d0f4b36469b3fdf9
digest: 865384ddf9b323510c0cdf99a9f64da3d525e0f4352d6987e7cd2de8200b3e55
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fd047a325d98ade6
chapter: CH-05
q: What is ‚Ä¶and will not remove it. in the context of Rego/OPA?
a: ‚Ä¶and will not remove it. Bottom line: opa fmt alone cannot solve unused imports reliably, but helps a bit with alias trimming.
reference: BLK-a51da1defba3faaf
digest: 14e044ac2ac50495a5e5c1cbcdb76afe5367b9459010b18fa5583f53f25fc54e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c1af655b78b8bd48
chapter: CH-05
q: What is Use opa check --strict. in the context of Rego/OPA?
a: ‚úÖ 2. Use opa check --strict
reference: BLK-5a847029cb16e01b
digest: 07a6891e73089f8fedbe81cdc26fbf64afb81c63b9ad2c2a1a77f559160cd47c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-032a987af20db8bf
chapter: CH-05
q: What is This is your best current built-in tool. in the context of Rego/OPA?
a: This is your best current built-in tool.
reference: BLK-bc5639f652d5d406
digest: e8b210fcb3dc5b7aa2773d15d5a5171dadc88bd66c39a50bf45a7b60929b2c8b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3a8fbc98d96b7b73
chapter: CH-05
q: What is Opa check --strict . in the context of Rego/OPA?
a: opa check --strict .
reference: BLK-05e28689781336be
digest: b26591f89ee2a9f091d1d204c98484f7b2311babb1e569871a5e066cc3396b01
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bfccb0874e13be7e
chapter: CH-05
q: What is Unused function parameters. in the context of Rego/OPA?
a: unused function parameters
reference: BLK-b9153a25532c29d8
digest: aa69d861fcb136d70b9dad241ec161026cd153e152f4454d8736b969427de475
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-56d92f97b5352756
chapter: CH-05
q: What is ‚Ä¶but NOT unused imports. in the context of Rego/OPA?
a: ‚Ä¶but NOT unused imports.
reference: BLK-eca62ba9be73fa32
digest: 013a2702e86907f93b161aa9c3966c5ed9dee367617f60dfe5cf2d38e83be0f8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1032c8abfdb94da7
chapter: CH-05
q: What is Still, it improves safety and catches 80% of redundant logic issues. in the context of Rego/OPA?
a: Still, it improves safety and catches 80% of redundant logic issues.
reference: BLK-677d05531da1a273
digest: cc787cd3bcb05c53dcf23f28264ef09ffe2e9c73b16921fc5232810b74f7c2b8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-092c64fa829bc925
chapter: CH-05
q: What is Use Rego Linter Plugins (best solution). in the context of Rego/OPA?
a: ‚úÖ 3. Use Rego Linter Plugins (best solution)
reference: BLK-93ffa0f5a38427e7
digest: 25f752fc43a2e5bd2a58630730601f8cc55b7a7c7f1e8a78e3716d5043638d37
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ea747405a9b96b53
chapter: CH-05
q: What is Several teams build a custom linter using rgl, conftest, or their own parser. in the context of Rego/OPA?
a: Several teams build a custom linter using rgl, conftest, or their own parser.
reference: BLK-1a7182fdc95d78a0
digest: e807b1c123e670ef2ddcde9dc6e0d8f5dd116f5afd564a9c33197c2f3edcd94a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0a489aa533a125a2
chapter: CH-05
q: What is The best available tool today is in the context of Rego/OPA?
a: The best available tool today is:
reference: BLK-15363c301ec7d7cb
digest: 3dc927d8bf84cb9f98cdaa1e341e46d8d64a51d54841b39fba6577a877dd5aa9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4350108cd86dd8f6
chapter: CH-05
q: What is GitHub in the context of Rego/OPA?
a: GitHub: https://github.com/GearPlug/rgl (community linter)
reference: BLK-c888ec6fcbcc9a8d
digest: 05c80176426576d7fba6ade6d25a0469fdce46a4b9990c93f11ec25cebe5cebd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6e3240605767eee5
chapter: CH-05
q: What is Unused local variables. in the context of Rego/OPA?
a: unused local variables
reference: BLK-1e5b7b422e5753f5
digest: 4eac4b3e5f8be750293dbdd8307f660a9a57ba66120c3db774c2ee426b0285de
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5ff22a782671f9cf
chapter: CH-05
q: What is This is the closest to ESLint/flake8 for Rego. in the context of Rego/OPA?
a: This is the closest to ESLint/flake8 for Rego.
reference: BLK-a18f52daf68b5951
digest: 97ebaa7bd50f902f3e6bbf099416f323d8e31685812bbde67cdea8f24d321a4e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-83ab71d076787242
chapter: CH-05
q: What is Recommend adding this to CI. in the context of Rego/OPA?
a: Recommend adding this to CI.
reference: BLK-96e5ec08b719db94
digest: b786e3897029e19522eac13e8f27165d42cf861299d0b15e963c687dc9373000
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9d711dfe86fb7d0b
chapter: CH-05
q: What is Use Styra DAS Rego Analyzer (if enterprise budget exists). in the context of Rego/OPA?
a: ‚úÖ 4. Use Styra DAS Rego Analyzer (if enterprise budget exists)
reference: BLK-d1deb4055bd6abbf
digest: a7bd3f35df55e9fee64a3b500f5c7c5bf232342ce5e468b267584bfcc842ff8f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d455496785227540
chapter: CH-05
q: What is Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags in the context of Rego/OPA?
a: Styra‚Äôs Rego Style/Structure Analyzer (in DAS) flags:
reference: BLK-ea1b59903a6ee23e
digest: acf0691ca02188e39dc2b67289ef3a5c0620864626ff9e05a4fbbec97523bd23
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-06254f294d3fdbab
chapter: CH-05
q: What is Unnecessary negations. in the context of Rego/OPA?
a: unnecessary negations
reference: BLK-8aab5191c0a4c854
semantic_categories: [negation]
digest: 6dee6d747530479a15f071336bf8666faba523dfec72825b6779b0ec1a23eb81
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c839689483003d2e
chapter: CH-05
q: What is Inefficient comprehensions. in the context of Rego/OPA?
a: inefficient comprehensions
reference: BLK-e671dc0247adca2d
digest: a86d416d980c967966361120d8efa82548624262892ec863d76eafa5fda655ea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cccbfa377921e91a
chapter: CH-05
q: What is Policy design smells. in the context of Rego/OPA?
a: policy design smells
reference: BLK-ff117af14d974338
digest: 512363c848f410b3c960aefe14174e624937eb03c9180118c9be398b6467e308
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6505b3677987c979
chapter: CH-05
q: What is This is the gold standard for production environments but requires paid DAS. in the context of Rego/OPA?
a: This is the gold standard for production environments but requires paid DAS.
reference: BLK-88cc3f7309a3f03e
digest: 362b2cd1654d7d96c2cb9e1a00577975d63a8498496ce91e1040d27885d44c6b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9dfc5187c3858edb
chapter: CH-05
q: What is Use editor extensions (Cursor, VSCode, JetBrains). in the context of Rego/OPA?
a: ‚úÖ 5. Use editor extensions (Cursor, VSCode, JetBrains)
reference: BLK-288854f032dcf91b
digest: a3ede1604651a299d84d5ca578672c2bf868052056efb8863b56bd33b1f56aff
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9a4a82c74e10aaf5
chapter: CH-05
q: What is If you‚Äôre using Cursor, the best workflow is in the context of Rego/OPA?
a: If you‚Äôre using Cursor, the best workflow is:
reference: BLK-3ded27af0667e46d
digest: 7129cd6693b07ca6bfb04aa92b426ad261b17ab7515b21f118a8021a374b5f42
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-67095c92f7dfdd8c
chapter: CH-05
q: What is Add a Rego post-save hook // .cursor/rules.json { "onSave" in the context of Rego/OPA?
a: Add a Rego post-save hook // .cursor/rules.json { "onSave": ["opa fmt -w", "opa check --strict"] }
reference: BLK-1a1e1d4534d9231d
digest: cfa29ef6dd5f16f43f858d21210ee9114a4f1b6bee379a3671649f9f3b345a0b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a2ca5d89379342ca
chapter: CH-05
q: What is Then configure a custom linter rule using a regex in the context of Rego/OPA?
a: Then configure a custom linter rule using a regex:
reference: BLK-0700523bfa0d00a5
digest: 48c864de184c94c9fa3b7028185c66dd844f888070825e2298eccc10495b86c1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ba3a5855c59ca0f7
chapter: CH-05
q: What is Import ([^ ]+)( as [^ ]+)? // highlight if alias is unused. in the context of Rego/OPA?
a: import ([^ ]+)( as [^ ]+)? // highlight if alias is unused
reference: BLK-01855145c4052297
digest: a207a21d0e5cf77e84ebce82d6a48d060a21c8b5698174f41bc1b4a75aedce80
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-963430a8a2ca6f60
chapter: CH-05
q: What is Cursor can highlight this dynamically. in the context of Rego/OPA?
a: Cursor can highlight this dynamically.
reference: BLK-e91de7f88c47fe02
digest: e574682df63f24e634b2e28a22d2ccbb0e9570e01ef9725cfc18ca009a95c21f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-97ffb4cef576d111
chapter: CH-05
q: What is Organizational best practice in the context of Rego/OPA?
a: ‚úÖ 6. Organizational best practice: Avoid wildcard imports
reference: BLK-05bf15ca8721ad44
digest: 10248362630be405f395c3e56751bcf39ff211d4636140fa0de90f1fb921676f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-641f2f67b3db9d2b
chapter: CH-05
q: What is Import data.services.*. in the context of Rego/OPA?
a: import data.services.*
reference: BLK-27062c2f2ad4bea0
digest: 6fb5ddfcde2f7ba3f66521daf4cddd17f4b81fcb846dcfd18485d1b851e906ad
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-926195cb016caeca
chapter: CH-05
q: What is Harder to detect unused segments. in the context of Rego/OPA?
a: Harder to detect unused segments
reference: BLK-bf8a85428b528a50
digest: 58752b169cf85079a1aaf461fda08846985dd394407800feac859b3484cd2736
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e59e4b7d2ffca166
chapter: CH-05
q: What is Harder to find where names come from. in the context of Rego/OPA?
a: Harder to find where names come from
reference: BLK-9a8c8c3ad33b8ee2
digest: 86b243243f4b60a27fa8fb1fa93b877a12515175327afd860cebc1832d49a3f5
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-edb26c9f5ff0d4f1
chapter: CH-05
q: What is Encourages shotgun imports. in the context of Rego/OPA?
a: Encourages shotgun imports
reference: BLK-0fc3cbba44a5ab8b
digest: 9a36bc035375f9692323ae72e6e99815d4e7e464702a2f51b2adac531e837d4e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7aaa986cf7275bcb
chapter: CH-05
q: What is Always prefer small, explicit imports in the context of Rego/OPA?
a: Always prefer small, explicit imports:
reference: BLK-1d0b9f66d47eaeaf
digest: f434cb3078767a089f7cd3c65fe1435a6a1fa88bd13f1fa66987b9177ec77bc1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-810ed027ed50e37d
chapter: CH-05
q: What is Import data.services.crm.allow import data.shared.strings as str import data.shared.constants. in the context of Rego/OPA?
a: import data.services.crm.allow import data.shared.strings as str import data.shared.constants
reference: BLK-a55c36241eba7524
digest: f8af97b17203afff6ac477f68b75e6dc750ea73313ba02eb36e24fa428520c04
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e380f2c2c08da70a
chapter: CH-05
q: What is Recommended CI rule in the context of Rego/OPA?
a: ‚úÖ 7. Recommended CI rule: Reject files containing unused imports
reference: BLK-ad7f2ed6a6987d63
digest: 821b755191423754d9174ab2b716244188767d20bfa0c521a1fb50a92e313828
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1522cc281655af46
chapter: CH-05
q: What is Here is the enterprise-grade script in the context of Rego/OPA?
a: Here is the enterprise-grade script:
reference: BLK-442aa4acd401c5ce
digest: fe7f552e57b18fd4020853334fef77078e766acbcc31e062629dd311124a66e4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-19623044594ffed0
chapter: CH-05
q: What is .ci/lint_unused_imports.sh #!/usr/bin/env bash. in the context of Rego/OPA?
a: .ci/lint_unused_imports.sh #!/usr/bin/env bash
reference: BLK-befcf2864cbe4ba2
digest: 4e56e45cbaac3d0768314cf79514dfb66cfde15940e2031b68d64974ff5b03c3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b406a0c574f20b95
chapter: CH-05
q: What is --format json | \ jq -r '.imports[] | select(.used == false) | .file + " in the context of Rego/OPA?
a: unused=$(opa inspect . --format json | \ jq -r '.imports[] | select(.used == false) | .file + ":" + .path')
reference: BLK-b24e880e43548028
digest: df2e8edf1cb60d72b1d75aee9c3cab6ecca47dc6f93cafe937992d9a03a4ae7f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c7cd97115006e29c
chapter: CH-05
q: What is Echo "‚úì No unused imports". in the context of Rego/OPA?
a: echo "‚úì No unused imports"
reference: BLK-4e06b56bed56546c
digest: 24f80ae1ef56da8a7aa59d92ce12ecda2039e77a07145398ce92419d3178fbeb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d5745a8433d06828
chapter: CH-05
q: What is Opa inspect (which parses import graph). in the context of Rego/OPA?
a: opa inspect (which parses import graph)
reference: BLK-3364104f50f32b25
digest: bb604f1291672c34dea9d043fd5011cab5c7a520aa44b549a45d9ca1f09494bf
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7006ded3d5cbfb59
chapter: CH-05
q: What is A small jq filter to detect unused imports. in the context of Rego/OPA?
a: a small jq filter to detect unused imports
reference: BLK-bd36eb180f9a0870
digest: 9abbb10ce7b859b143de032c01a0764550a41ef8ec9c9aeb14aab25791643934
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9aca6fbc8971c107
chapter: CH-05
q: What is This is currently the single best approach that works reliably as of 2024‚Äì2025. in the context of Rego/OPA?
a: This is currently the single best approach that works reliably as of 2024‚Äì2025.
reference: BLK-0f79a0a4b3796507
digest: e6e1dd2f02b42eb2a8d14519b0c15855e1a7d4d905afc562cfd38710e3908b9c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c173fd7f9553897c
chapter: CH-05
q: What is üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough... in the context of Rego/OPA?
a: üß© Summary ‚Äî Best Way to Handle Rego Unused Imports Method Effectiveness Recommended opa fmt ‚ùå Does not remove unused imports Useful, but not enough opa check --strict üî∂ Detects unused variables, not imports Use always rgl (Rego Lint) ‚úÖ Detects unused imports Best open-source option Styra DAS üî• Enterprise-grade policy analyzer Best paid option CI + opa inspect + jq üî• Fully reliable in CI Recommended Cursor/VSCode rules üî∂ Helps devs during coding Recommended
reference: BLK-916a2b733c75da32
digest: a0f1725299a730bd5325a4c0cea9c470b35a154fdc3d983fe20a7f841c8c03eb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2547a4802a5f5455
chapter: CH-05
q: What is The best lifecycle is in the context of Rego/OPA?
a: The best lifecycle is:
reference: BLK-6f78ccb1a2aa0db5
digest: 7a985f7a6c052f654e20fcbe9c9842655798a3cfd56723a2e428a301218732e6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3535c9bce449fa75
chapter: CH-05
q: What is Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional). in the context of Rego/OPA?
a: Cursor lint ‚Üí opa fmt ‚Üí opa check ‚Üí CI lint w/ opa inspect ‚Üí Styra Analyzer (optional)
reference: BLK-055762078b24cd0d
digest: 07c0cf1d34eabba3110fc659772d9448cd2cec8c0cf5ca90eea4d9d2d49d64bd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ec2e82288aa3a9d7
chapter: CH-05
q: What is ‚úÖ What I Would Do (Best Practice) I would choose Option 2 in the context of Rego/OPA?
a: ‚úÖ What I Would Do (Best Practice) I would choose Option 2: Use the import explicitly, not rely on OPA‚Äôs global data-tree search.
reference: BLK-1e753a25a214b3ee
digest: 0e919ce50f719ab4bcd4d102fb4e96dac03d51ba673887554fe5f96872727292
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-93658e2e4e3b694a
chapter: CH-05
q: What is Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become in the context of Rego/OPA?
a: Because tests that depend on bare rule names (warn, deny, allow, audit, etc.) become:
reference: BLK-91376980b3497347
digest: 53b14d063afdcdbdce1206338631be6b2dbf5971c3a7181ffe00444c6731e0d4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0505646ec288f639
chapter: CH-05
q: What is Confusing during refactors. in the context of Rego/OPA?
a: confusing during refactors
reference: BLK-fe348bf4a59d3eca
digest: dcbc14917914bf0db4a9e9dcd16cbfdba040fa65c2253e07d97e49d7953c9c56
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-49d8e0a607d089ef
chapter: CH-05
q: What is Conflicting when multiple packages define the same rule. in the context of Rego/OPA?
a: conflicting when multiple packages define the same rule
reference: BLK-de0aa65f66c9c2e5
digest: 53bf3added461343253d89f77cd447151d3b4d94ababffdb6d984c8f16f65881
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f4f51c7aa3508c7d
chapter: CH-05
q: What is ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly in the context of Rego/OPA?
a: ‚úîÔ∏è I would keep the import ‚úîÔ∏è and update the test to reference it explicitly: import data.compliance.tech_debt
reference: BLK-8bcbd5638e8f2f52
digest: 9e8c6b962fa13673f19a1836e62501d746be0cdaffcc564d099261173f66e090
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d33f12eeb819f8fe
chapter: CH-05
q: What is Count(tech_debt.warn) == 0 with input as mock_input. in the context of Rego/OPA?
a: count(tech_debt.warn) == 0 with input as mock_input
reference: BLK-811010e43f08ad56
digest: 6c69d7068699ca7878e8049e15ef42cb1ddc87ede45ef9da4594dae82dbe2a6b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4ea6e1befd5d3ef0
chapter: CH-05
q: What is This is the safest, clearest, least ambiguous long-term behavior. in the context of Rego/OPA?
a: This is the safest, clearest, least ambiguous long-term behavior.
reference: BLK-402d3ae84b7a6ec5
digest: 4d7a9a320bcfbc52294df92b8c27e7e7d9de0993dbb08babab9796f6c1cc34e8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bb2bf8db89803ee5
chapter: CH-05
q: What is üß† Short Answer You Requested (Concise Explanation). in the context of Rego/OPA?
a: üß† Short Answer You Requested (Concise Explanation)
reference: BLK-8912a891da49a895
digest: 2327eb69cf767b624d2c85e9022cb3968f6f81ea533e72d8f9c75fca0ed2afee
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f7db536897806d0b
chapter: CH-05
q: What is Answer in the context of Rego/OPA?
a: Answer: The warn reference comes from the data tree, not from the import. During opa test, OPA loads all policies under services/opa/policies/ into the data namespace. When the test references warn, OPA resolves it by searching all packages for a rule named warn, which finds data.compliance.tech_debt.warn. Because the test never uses tech_debt.warn, the import data.compliance.tech_debt is unused and can be removed.
reference: BLK-4bbc8cdf4775092d
digest: 69e7b243cd3e132673f40b0d3ea3293fb2bb71cf94bc43344692a7f0bbcf5e4b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0c1a4010dbc80b03
chapter: CH-05
q: What is However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define ... in the context of Rego/OPA?
a: However, the better practice is to reference the import explicitly (e.g., tech_debt.warn) to avoid ambiguity with other packages that might define warn.
reference: BLK-a0487d3cbb802b3d
digest: ae8d22d909c03248a3b193b9eb5a726ed573542f6a7361b5fdf6e3e7dfab3cea
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a122f68c9ef0084d
chapter: CH-05
q: What is üîç Full Explanation (What‚Äôs Happening Under the Hood) 1. in the context of Rego/OPA?
a: üîç Full Explanation (What‚Äôs Happening Under the Hood) 1. How OPA loads data during tests
reference: BLK-904181a17b9dcc04
digest: 8fdf5e1c664743482facf6120b5f75dcba5275a1cd5465f51ff33559e8fa1844
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a0f72352fef26d8c
chapter: CH-05
q: What is Opa test services/opa/policies/ services/opa/tests/. in the context of Rego/OPA?
a: opa test services/opa/policies/ services/opa/tests/
reference: BLK-8e593dfe4228799c
digest: a11c5f8c38495f4654786473e7ab7dcc04686d5f85ca2b2b16d9bfb54a38cec4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1b5f04e60701a423
chapter: CH-05
q: What is Every .rego file from policies/ ‚Üí into the data tree. in the context of Rego/OPA?
a: every .rego file from policies/ ‚Üí into the data tree
reference: BLK-cf1cf42e9d5ccf61
digest: ee00814c26b728180967d579e2eb5cee642ba6157f86dc30cae257f7f8974ece
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f0dbbefc7fa09b5a
chapter: CH-05
q: What is Every test module in tests/ ‚Üí evaluated with the loaded data. in the context of Rego/OPA?
a: every test module in tests/ ‚Üí evaluated with the loaded data
reference: BLK-46c7fbb1283483ac
digest: 76d022eed3fe942cbb62dd5cc24b762f9b0b41b554db764cec4b97711f1799de
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d4b69c1dc36b6965
chapter: CH-05
q: What is This means all rule names become visible under data.*. in the context of Rego/OPA?
a: This means all rule names become visible under data.*.
reference: BLK-a3d9d649abe9ea27
digest: ea3a1b0901f6ef02629cb1b559b0f2a705d9fa9cbea63713252f918bf0857259
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-49906e3b12fe553f
chapter: CH-05
q: What is How warn is resolved. in the context of Rego/OPA?
a: 2. How warn is resolved
reference: BLK-f4849492414ac27e
digest: 2bb027eb2ba0f07b7b591e56e0f6a09e5fb80f3ccc5daa13783b2ad33c3afbeb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f67180fef23f8072
chapter: CH-05
q: What is When the test evaluates in the context of Rego/OPA?
a: When the test evaluates:
reference: BLK-e496ef913bfa6596
digest: e6621908d4729cee2575a51c3bc5a08b6dd0c1345558d85e6e2bda776745135f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e9e960e52953b1e6
chapter: CH-05
q: What is OPA resolves warn like this in the context of Rego/OPA?
a: OPA resolves warn like this:
reference: BLK-b34b8dd3cc79096e
digest: 10abf5cd71242b176a86fe6d190162cf3ae761ec21759633808e579cf901dbf3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2e8b862c6df13b63
chapter: CH-05
q: What is Does the test file define a local variable named warn? No. in the context of Rego/OPA?
a: Does the test file define a local variable named warn? No.
reference: BLK-c83570b0bab95162
digest: d7a0f0c6161e8d3f179c170000c0fe25663ef917065c944c854c45c4a9929d5c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8113a4fa5ede414d
chapter: CH-05
q: What is Does the file import something named warn? No. in the context of Rego/OPA?
a: Does the file import something named warn? No.
reference: BLK-cdba5783ce8acf92
digest: 0a8f207f72e347f3f536912ddfda2c98189dfd59c5a31915cb2d23245b4a832a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-72bf975c4cad7ebf
chapter: CH-05
q: What is Search the global data tree for any rule named warn. in the context of Rego/OPA?
a: Search the global data tree for any rule named warn. Finds: data.compliance.tech_debt.warn
reference: BLK-66c781d55a92faaf
digest: 620217261db1ba89f2090d18af10934c3acd94ef731e7e2ff7a602a2b4b22179
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8981d03c1c94e974
chapter: CH-05
q: What is Thus, the test works, but‚Ä¶. in the context of Rego/OPA?
a: Thus, the test works, but‚Ä¶
reference: BLK-522dcd428818f34e
digest: 8c64607b8df2e4544d17e81dcf4ee0d41ece246328d5a6741d568f30010ab235
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1e74e8a490a8466c
chapter: CH-05
q: What is The import is unused because OPA never needs the alias tech_debt to find the rule. in the context of Rego/OPA?
a: The import is unused because OPA never needs the alias tech_debt to find the rule.
reference: BLK-95ca2e72cd741b4e
digest: 83185d756018aaa4db8d146eb832d2df58839ab68f26215bafe36835195d291d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7913bf178bcdd672
chapter: CH-05
q: What is ‚ö†Ô∏è Why this is risky. in the context of Rego/OPA?
a: ‚ö†Ô∏è Why this is risky
reference: BLK-87787a835dbfdc8d
digest: 4a77a8fade016b791fcfed0e3a26125fd8980574509343dfeb6eecb4e8807891
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-12b6c691c593917d
chapter: CH-05
q: What is If tomorrow someone adds in the context of Rego/OPA?
a: If tomorrow someone adds:
reference: BLK-03e7fcc4768817d5
digest: ecee3248fbe85b42c69397c264db707661889f980091ead4bbe90348029eb044
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e50e25d86247f862
chapter: CH-05
q: What is Package compliance.sample warn { .. in the context of Rego/OPA?
a: package compliance.sample warn { ... }
reference: BLK-8751d75b24bfe192
digest: 314740547123df0c7f9022100a9fde3fffde4cf96dc8adc8cf75e8a144a6b1e2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c427e584d1573644
chapter: CH-05
q: What is Warn becomes ambiguous,. in the context of Rego/OPA?
a: warn becomes ambiguous,
reference: BLK-b78146783f0378c4
digest: c34c51931ff547a1808fad1240cc5c0364ccf0b8e7791d03cfe79f758d357556
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3fc844a103592337
chapter: CH-05
q: What is Tests start failing, or. in the context of Rego/OPA?
a: tests start failing, or
reference: BLK-0677b2d89a2bb634
digest: e79813657814fc1c62f09023e91e36bad589f041edf51469357009d20b25d012
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c79337c73470fe7f
chapter: CH-05
q: What is This is how critical bugs enter policy codebases. in the context of Rego/OPA?
a: This is how critical bugs enter policy codebases.
reference: BLK-0f7eb6e9110cfd7d
digest: 6e677191ffa19de6fc359d9e3fec90ce52db5738c7caee5504a67738e923a1dd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-7afd319eba08e9f3
chapter: CH-05
q: What is üß© Therefore in the context of Rego/OPA?
a: üß© Therefore: Best Practice for Enterprise Codebases üìå Always reference rules with namespaced imports
reference: BLK-dc195421896fae6e
digest: 840e909e576d481698563ce02e2085f1525c4abdd66d867dc0911a6fc1bd81ee
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-14a094962c22fad3
chapter: CH-05
q: What is Never rely on bare rule names in the context of Rego/OPA?
a: Never rely on bare rule names:
reference: BLK-c769e5e37ddda8d1
digest: 1af6b20fc8f615f172c02f2803c80b7a8138780a9022980589bb24cbb9032645
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-dbc61a9063a7b446
chapter: CH-05
q: What is Count(tech_debt.warn) == 0. in the context of Rego/OPA?
a: count(tech_debt.warn) == 0
reference: BLK-c93c5530af136464
digest: 785cec6c0a044deece5e744701602b8c99696a89155d1c14982a4aa7148162f3
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2187acdcf802b655
chapter: CH-05
q: What is ‚úîÔ∏è Even safer if using as. in the context of Rego/OPA?
a: ‚úîÔ∏è Even safer if using as
reference: BLK-d0196af4f922ba99
digest: b5e2070fde7ed6e4b7b5b4e3fe70026350d629120be376512d36c5f4c6386146
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6c3e3ab2d00fa424
chapter: CH-05
q: What is Import data.compliance.tech_debt as td. in the context of Rego/OPA?
a: import data.compliance.tech_debt as td
reference: BLK-471eebb35854e544
digest: e7aba2c32a444d419c8b2403d0f68a226be8563e6d9211f22525f2885b959aa8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3013d2c385be70bb
chapter: CH-05
q: What is The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused. in the context of Rego/OPA?
a: The import data.compliance.tech_debt on line 3 of tech_debt_r14_test.rego is unused.
reference: BLK-f2d6de3be5108863
digest: fa960dcdb97b5709b0173bff2c61223eae730a16dcea79a38d96586a44065169
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a457dc09265d7023
chapter: CH-05
q: What is You removed it, and the tests still worked. in the context of Rego/OPA?
a: You removed it, and the tests still worked.
reference: BLK-033ecc50bad86de4
digest: 75e58915a251778b39b1c7ed3b86b04c915e1f8f1215e69f4ef9daa671649ab1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-297721473a8368e4
chapter: CH-05
q: What is ‚úîÔ∏è Why tests still work. in the context of Rego/OPA?
a: ‚úîÔ∏è Why tests still work
reference: BLK-56fc64cdaff7a3ab
digest: ac6c3bf12b5f1aa4bbc721fa6410cf899ab5ba3c9e63ae75f7c0807356b5c220
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-98681f8f51877553
chapter: CH-05
q: What is The tests reference warn without a package prefix in the context of Rego/OPA?
a: The tests reference warn without a package prefix:
reference: BLK-2c1d51f4e5a960ff
digest: ca3f2ec291e1603266b993df6be9548d4929941eb600b0e558db9f018c683a6a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1c29fe3f41c5c30b
chapter: CH-05
q: What is OPA loads all policy packages in /policies/**. in the context of Rego/OPA?
a: OPA loads all policy packages in /policies/**
reference: BLK-2602fdd8c51b5938
digest: 4ef1703bf4480a8fdd88cbd51dde898d4078d9f8c18da78b19d09d01f37bc532
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-bad50a33d6d38166
chapter: CH-05
q: What is So the rule warn is available at in the context of Rego/OPA?
a: So the rule warn is available at:
reference: BLK-440f2e7d6df53450
digest: 0faabbe73b38958de5476291f898675bc242025f41d5c9377966f2bdb7475c8c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-648428f41b3b70d8
chapter: CH-05
q: What is data.compliance.tech_debt.warn in the context of Rego/OPA?
a: data.compliance.tech_debt.warn
reference: BLK-c332a68f35c8a3ec
digest: 711405935ee0ffe7e3c56cc370b5c6413235ae016d8db799285d2686e8ebd366
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-64f70c530ec17beb
chapter: CH-05
q: What is OPA resolves bare rule names by doing a global search in data. in the context of Rego/OPA?
a: OPA resolves bare rule names by doing a global search in data.
reference: BLK-146721aedc728fd8
digest: 5e94898cfeb0395d1f28481b0a22f68c9f0ec22e6ba28d922ecb0e8cd235dc27
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-87a62421643e691c
chapter: CH-05
q: What is So the import is indeed unused, and removing it does not break the test in the current setup. in the context of Rego/OPA?
a: So the import is indeed unused, and removing it does not break the test in the current setup.
reference: BLK-1601cc39b76cae1a
digest: 25688ef98386937daff335555ec8f9204bfed250cbecafcd881219c4ca34cb48
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-02027d7c024e0cf6
chapter: CH-05
q: What is ‚ö†Ô∏è But removing it is NOT the best practice. in the context of Rego/OPA?
a: ‚ö†Ô∏è But removing it is NOT the best practice
reference: BLK-2c388bc6691a4f51
digest: fd6a5cccd0d0a81a309f83a27c8de39a9e39ecffa871a0eaa2adca718952f691
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ece015c5b24a9b28
chapter: CH-05
q: What is Even though the import is unused now, this approach is fragile. in the context of Rego/OPA?
a: Even though the import is unused now, this approach is fragile.
reference: BLK-dead8fc635007af0
digest: 58b67a7e0c49dbe780cac15ade1e82c4c402ed9f7bafc2a98e702669eb063a0e
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3034321aa9220605
chapter: CH-05
q: What is Bare rule names (warn) are ambiguous. in the context of Rego/OPA?
a: Why? 1. Bare rule names (warn) are ambiguous
reference: BLK-1896739847a942b1
digest: 5c2460a1d6760a3f5e34552069e8f79cbfc46c59a791900f3ea502e50e3a6e63
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f3b082b86264b66a
chapter: CH-05
q: What is Example in the context of Rego/OPA?
a: Example: If another policy someday adds:
reference: BLK-b0975f5a5f83bad3
digest: abc7858af2310f85c0dd4d2e54ca3bfe19a929c9d0a168ac4547c64e2a97fa09
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-433c8659558f6b17
chapter: CH-05
q: What is Package compliance.security warn { .. in the context of Rego/OPA?
a: package compliance.security warn { ... }
reference: BLK-98a5e27b479b7275
digest: 15b5ad40489c5b7ad83ef68376696c96cf3524e4484fae783e17b5df7da049b8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c9b23e1fbe49e9a4
chapter: CH-05
q: What is Becomes ambiguous and OPA may in the context of Rego/OPA?
a: becomes ambiguous and OPA may:
reference: BLK-4cf1d9d3379ed5ab
digest: e168cd05cc027fdd185cb6acf3490e23ac31cc32fd32939156152c26bb90efe4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-542ad3f60a2463df
chapter: CH-05
q: What is Give unpredictable results. in the context of Rego/OPA?
a: give unpredictable results
reference: BLK-c16b774f244e504a
digest: 68d10cc94a9316a5543db308f29833f85bb2cf112fbf8aaa28ab25891a7f9db0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cbdb45467e8df9e8
chapter: CH-05
q: What is Tests become context‚Äêdependent. in the context of Rego/OPA?
a: 2. Tests become context‚Äêdependent
reference: BLK-cf07614973daa160
digest: 14ef0e527270ae2699078c28c8a1ea92f7ce5045e94d05426908fb978288bddc
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b1471caea6c97e1e
chapter: CH-05
q: What is OPA test behavior depends on all loaded policies. in the context of Rego/OPA?
a: OPA test behavior depends on all loaded policies. If someone changes folder structure or adds a new rule, this test may start failing.
reference: BLK-ee4b87e1821ec277
digest: fdd67e0866a5a322c7b676ad5e103289a79681536402862e18bfaa1111c3ed80
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4fb85531a5c24d8c
chapter: CH-05
q: What is Not explicit ‚Üí Not safe in enterprise systems. in the context of Rego/OPA?
a: 3. Not explicit ‚Üí Not safe in enterprise systems
reference: BLK-f3ae62e558c8b1ba
digest: ead0aeb846bb25a672e5c9a3fda69e1d8f314bc1fd1f1bee30a7255125a16254
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8fd416bf81e20683
chapter: CH-05
q: What is Implicit resolution is one of the most common sources of bugs in OPA deployments. in the context of Rego/OPA?
a: Implicit resolution is one of the most common sources of bugs in OPA deployments.
reference: BLK-d0319c48162006d3
digest: abdf5f7c4d323df252157210163d69f427968bf83df84d38c86cce3090a4a56d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fc79fe5d234235a7
chapter: CH-05
q: What is Count(tech_debt.warn) == 0. in the context of Rego/OPA?
a: count(tech_debt.warn) == 0
reference: BLK-ab7e5a89ec7dec84
digest: 8fc7be5b64a858ecd591cb06748a2bf487b7cab0e94dbb6482f646d1d28898a4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-9ffb23caeff6b8bf
chapter: CH-05
q: What is This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct... in the context of Rego/OPA?
a: This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct pattern for all enterprise-grade policy suites.
reference: BLK-40bec3306bf43c74
digest: c02fee8c0208f3f13f52b7c7d95b8d05dfc28759ddeec367735d9d4c73049cd4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a0f5b0be8ce3be31
chapter: CH-05
q: What is üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like in the context of Rego/OPA?
a: üß© Best Practice for Enterprise Rego Test Suites Do NOT rely on bare rule names like: warn deny audit allow validate
reference: BLK-ddd5bab848658cd1
digest: b3f973c604921a90447a3527851b2ffebc0b8ead90540a2794b4cd46ed504275
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5464f32fffb83ee3
chapter: CH-05
q: What is Instead in the context of Rego/OPA?
a: Instead: Use explicit, namespaced references in all tests.
reference: BLK-1e9f46006e81b12b
digest: a02b95172f2fcf034dff123f9c1560df68516f1af273196d76dabdc45bd214c2
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-cb98d63feb21da33
chapter: CH-05
q: What is ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly. in the context of Rego/OPA?
a: ‚ùó Never let OPA resolve a rule through the global data tree ‚Äî always reference it explicitly.
reference: BLK-4a3213cba6c14203
digest: 322616c71ff2fc4ccbe380c08c4bbc1fefccc03717edd73d4c3cea35aeb270e0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-3db21658bc5a650f
chapter: CH-05
q: What is Formal Recommendation (Chapter 7.2.1) in the context of Rego/OPA?
a: **Formal Recommendation (Chapter 7.2.1):**
reference: BLK-6f8c40f9057e8541
digest: dcda3ff6d627877576ca9d4505121673d8c7abe8796254ca180b1bcb68754fc6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-97092ca37fc933c6
chapter: CH-05
q: What is In test files, always use explicit package-qualified rule references in the context of Rego/OPA?
a: In test files, always use explicit package-qualified rule references:
reference: BLK-5fe7ad67431a1a6b
digest: e8e71335b96bcddec8dab61556bbfae39ebe828a47dd034819dd3526e1b6e1a6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c078ffd564a2c0b8
chapter: CH-05
q: What is Ambiguity Prevention in the context of Rego/OPA?
a: **Rationale:** 1. **Ambiguity Prevention**: Multiple packages may define rules with common names (`warn`, `deny`, `allow`). Explicit references eliminate ambiguity. 2. **Maintainability**: Tests remain stable when new policies are added that might introduce naming conflicts. 3. **Clarity**: Explicit references make test intent clear and reduce cognitive load during code review. 4. **Refactoring Safety**: Policy package reorganization doesn't break tests that use explicit references.
reference: BLK-5a5fb3b6a6feb291
digest: e86c42547c9f090bdb74d578543bbfee5575a870e7d5be99fb6435d6beb135d8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-54e2443eb5091fbd
chapter: CH-05
q: What is üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import in the context of Rego/OPA?
a: üõ†Ô∏è Recommended Final Fix for your file Instead of removing the unused import: Fix the test to reference it: package compliance.tech_debt_r14_test
reference: BLK-065b5e4f94f9236b
digest: 38b5eb3fad8030e15380c89126e487e86c88be32d6766b51cffcbb7bcac69c26
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-0b9360e4dd6375f2
chapter: CH-05
q: What is Import rego.v1 import data.compliance.tech_debt # ‚Üê keep this. in the context of Rego/OPA?
a: import rego.v1 import data.compliance.tech_debt # ‚Üê keep this
reference: BLK-7eb95260235a09c0
digest: f6183520e979ef76ea39430d56019159317e75cce27376aee5bc8b6b737a852a
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-45dd681ad68ae2a4
chapter: CH-05
q: What is Count(tech_debt.warn) == 0 with input as mock_input. in the context of Rego/OPA?
a: count(tech_debt.warn) == 0 with input as mock_input
reference: BLK-970b9d75dc34a42c
digest: 26e22f5233378f339a652f7bf4e7e41381debfcc72b54085306326616805f646
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d39101d0148ce0a0
chapter: CH-05
q: What is How your test diff strings are represented inside Rego test files. in the context of Rego/OPA?
a: how your test diff strings are represented inside Rego test files.
reference: BLK-94b0c6d4242ec932
digest: e1227c323c54181b347b80bad054c5456762dd67c59b2d4f35a56db67577627d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1933251c3b047900
chapter: CH-05
q: What is ‚úîÔ∏è When using opa eval with JSON, your inputs contain in the context of Rego/OPA?
a: ‚úîÔ∏è When using opa eval with JSON, your inputs contain: "+ // TODO:\n+ function getUsers() {"
reference: BLK-2692a565a55bc811
digest: cdc2e2802f65d9170ec55c5843567d61204b790679f59bdee4a960b0f149587d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-d2607a47fd3bf815
chapter: CH-05
q: What is ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character. in the context of Rego/OPA?
a: ‚Ä¶and OPA treats \n as an actual newline because JSON escapes it as a newline character.
reference: BLK-4b75100e9c1723da
digest: f86ce319dde59de64cc392ce16a9a120d9c00b37d32f9fae935136e94176f4e0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-03dc0bf843ece140
chapter: CH-05
q: What is Does not produce a newline. in the context of Rego/OPA?
a: does not produce a newline.
reference: BLK-18bcb7950f8dcf72
digest: 0dc6ba8bd4deac386a3186fc080d49b951dad5f370eef3517138d5ecd7d60c30
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c687bffc81d465e0
chapter: CH-05
q: What is \n is literal backslash + ‚Äún‚Äù. in the context of Rego/OPA?
a: \n is literal backslash + ‚Äún‚Äù
reference: BLK-a75307e7442dd9e9
digest: 0a9062b5162df83aafff1ad382b1e1817ac27e41668a8b1b2ceb204b908df6bd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-6611dc222d020c2b
chapter: CH-05
q: What is NOT matched by regex patterns expecting real newlines or multi-line content. in the context of Rego/OPA?
a: NOT matched by regex patterns expecting real newlines or multi-line content
reference: BLK-c91a17469e570904
digest: a2224d9e68975b27ab0a0b943df7eba623cd970833efe1fce4824c895bf36115
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ca607479269ea9d0
chapter: CH-05
q: What is NOT iterated the same way. in the context of Rego/OPA?
a: NOT iterated the same way
reference: BLK-2a6fca36dc1d9152
digest: 42a46815774198be7c8fbcab7258a1a8c69975f9a8518458760829d5bc078c86
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fc0be20bf4b0b04d
chapter: CH-05
q: What is So your regex patterns such as in the context of Rego/OPA?
a: So your regex patterns such as:
reference: BLK-db4ad97b2c59bf89
digest: eb1139e2d740297a7004c27e66b6294452a284b318638cac0a8a8b9e08192b65
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b5293177e4a24b16
chapter: CH-05
q: What is Regex.match("//\\s*TODO in the context of Rego/OPA?
a: regex.match("//\\s*TODO:", file.diff) regex.match("-.*TODO:", file.diff) regex.match("TODO:[\\s\\S]*TODO:", file.diff)
reference: BLK-533b2ce56a96a5b1
digest: 256bf6eeedc77f0ffdbad1f8cb0d8e0542e902c33cd06137e5927fd6809da95c
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5df89b9fa75533d3
chapter: CH-05
q: What is Never see the newline, so they fail. in the context of Rego/OPA?
a: never see the newline, so they fail.
reference: BLK-5034a2914309672a
digest: 8de2fc41a80ac6686ee411a389e1b503dedf71b94aea17fabfab4e2cc83605ba
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2b47d3d6183af7b2
chapter: CH-05
q: What is This perfectly explains your trace output in the context of Rego/OPA?
a: This perfectly explains your trace output:
reference: BLK-6b3973c5adc77112
digest: 1758e3ce9fa996fca588f23e3a06c54666859fe1cb90c6b87c5d4802e07f06cd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-29520422812902ee
chapter: CH-05
q: What is __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context. in the context of Rego/OPA?
a: __local3132__, __local3138__ variables suggest file.diff is not being accessed correctly in the test context.
reference: BLK-d61d9d1a25742a7b
digest: 026641f3f6911394372fe1ae34f97e6fee0d7e060b0515f0717ddafe7ac609b4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-041dbcc9fcfd2e9a
chapter: CH-05
q: What is They are being accessed ‚Äî the content is just different from what your rules assume. in the context of Rego/OPA?
a: They are being accessed ‚Äî the content is just different from what your rules assume.
reference: BLK-bf4723cba99361ab
digest: 17f3c61517ffbad65a1d984e0a79f05d5d122eefd96df366d321607db6d07344
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-53f8c7eb8c77ee03
chapter: CH-05
q: What is üî• Proof in the context of Rego/OPA?
a: üî• Proof: Why the three affected tests fail 1. test_todo_without_clear_action
reference: BLK-83a2499bac0ee44d
digest: bd60cf81dee81f5c62e8ac86081119d3d81e0101940a29aaf41f1e8e005abbc0
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2d58173f39099d81
chapter: CH-05
q: What is TODO in the context of Rego/OPA?
a: TODO: <newline> function()
reference: BLK-6143e7b8d21b076b
digest: c1099349de01d5415c3175cb07c460cb8da721f248fd941587d874c2a86de9b8
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-681dfd8eb67d8aea
chapter: CH-05
q: What is "T O D O  in the context of Rego/OPA?
a: "T O D O : \ n f u n c t i o n"
reference: BLK-8124b98cebb7344a
digest: 372a1a2b0d5092d80fe4841dfc5a7b6fed4754844691a121ee1db93a1eebbdf4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c53e057db86bc7ae
chapter: CH-05
q: What is ‚Ä¶but the newline is missing ‚Üí FAIL. in the context of Rego/OPA?
a: ‚Ä¶but the newline is missing ‚Üí FAIL.
reference: BLK-1c354b57ee22967c
digest: c2c0510e370d2208157d1defbde3820684002135d2f91ff263ca62181b143b16
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-725823324a9f0728
chapter: CH-05
q: What is test_fixme_added_without_reference in the context of Rego/OPA?
a: 2. test_fixme_added_without_reference
reference: BLK-365b36bfe5904699
digest: 02d2a4a5b3a1e69b3414e64c99ef1155b5708938099bb9502a95f150a7d8c625
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-34070ab6abb23009
chapter: CH-05
q: What is "+ // FIXME in the context of Rego/OPA?
a: "+ // FIXME: Temporary hack..."
reference: BLK-9cb0813090319e09
digest: baaac3a6f70d354343264286984d8259b1e1f243292d049b7c5a771c04fc52bd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-2836d86ec2f75a9a
chapter: CH-05
q: What is Contains(diff, "FIXME in the context of Rego/OPA?
a: contains(diff, "FIXME:")
reference: BLK-ae9cdf2a87e2849e
digest: 29cc58ca4fb3538d21e6e08a1c4702b19bd3ad1fd91d8e9d139852565d63b0d6
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c1016749c5a89609
chapter: CH-05
q: What is "+ // FIXME in the context of Rego/OPA?
a: "+ // FIXME: Temporary..."
reference: BLK-63c154a8c410ed16
digest: 4e98fc3fea78f11341a85a263073217a04ebb604aa65a2eb1572b75c2b6b9808
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-22d2d1da595afa81
chapter: CH-05
q: What is Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g. in the context of Rego/OPA?
a: Because your test framework wraps the diff in a JSON string inside Rego, so additional escaping happens, e.g.
reference: BLK-930cbcf639591aef
digest: d1fc22ad5659c7726ab2c656cb3c06283b2e46b91ea893991679155379249ccb
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-c6906c986bfc2951
chapter: CH-05
q: What is "+ // FIXME in the context of Rego/OPA?
a: "+ // FIXME: Temporary hack for authentication"
reference: BLK-b5f2b2e0022c070b
digest: 60ceb58419bba85b102112cbdf3e845ad8899d1d014dcbe799b83362e9a5bf88
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4eec40b7c219e88e
chapter: CH-05
q: What is "+ // FIXME in the context of Rego/OPA?
a: "+ // FIXME: Temporary hack for authentication"
reference: BLK-a994f5dd4573c580
digest: d4021a13fa2dbe6d2335d81a9e1174bc2476cd088a96e39b69c64e9b4ae06916
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f512eeedc0196cee
chapter: CH-05
q: What is But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context. in the context of Rego/OPA?
a: But your policy expects diff lines beginning with + or matching exact patterns that assume multi-line context.
reference: BLK-b2462fef40f9e1a3
digest: 416ed342d4e98ffa5c95df735ef4b0e858d030dc51c67b230d17eb89fd65b93b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8549bc60b22ca166
chapter: CH-05
q: What is test_meaningful_todo_not_logged in the context of Rego/OPA?
a: 3. test_meaningful_todo_not_logged
reference: BLK-8c1f028fe1d5059b
digest: fc810c7c084d8b85f87cb47b30aae8a7ecc00508ffa3285de4245b65f38897c1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8469a249e4ce4f3e
chapter: CH-05
q: What is Same issue in the context of Rego/OPA?
a: Same issue: Your rule expects:
reference: BLK-7224d1b50de33c99
digest: 0e387c807856e98c468db897b4c64d98a9689fa2e9584a252fb104743c25469d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4de5f361b53a5b20
chapter: CH-05
q: What is TODO in the context of Rego/OPA?
a: TODO: Fix N+1 query (workaround)
reference: BLK-de1b194932f56032
digest: 2fdf0256a937b9ca9801761a706dffcd48da44e56910a1b976399c53bb93326d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-f8740a8accf43e93
chapter: CH-05
q: What is OPA evaluates the Rego test literal as in the context of Rego/OPA?
a: OPA evaluates the Rego test literal as:
reference: BLK-9ab409739c58aced
digest: aac66298d9e5bc6eae9176876fdb7f9eef2c8c59cf157319c43e2f6e1bbf29a1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b9a19c8ff0d49fa2
chapter: CH-05
q: What is T O D O  in the context of Rego/OPA?
a: T O D O : \ s F i x ...
reference: BLK-b8e54938be458fcb
digest: f17d3404e7d57be4f5ea76066097361d4bddcd757bed25c90e2aeafdd667a898
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-e6b81a0c8ee06356
chapter: CH-05
q: What is The pattern never matches because whitespace escaping does NOT behave like in JSON. in the context of Rego/OPA?
a: The pattern never matches because whitespace escaping does NOT behave like in JSON.
reference: BLK-475ae3ca4b662fcb
digest: 652fbf63fad296d6855ac1ffb234b5e6c6e0677f76de9b4099268e3dc69a9469
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-5b7cbcd55500576e
chapter: CH-05
q: What is üß† Why direct opa eval --input JSON works. in the context of Rego/OPA?
a: üß† Why direct opa eval --input JSON works
reference: BLK-ec33c76e3eda42a5
digest: bf8aa97f5fe7b6ef9814b076ef94a4297e6da103d2c2be78b7c02e49c80bc059
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-8155fb873ece2706
chapter: CH-05
q: What is Because JSON ‚Üí OPA decoding translates \n into real newlines. in the context of Rego/OPA?
a: Because JSON ‚Üí OPA decoding translates \n into real newlines.
reference: BLK-fe580d36f95ecec0
digest: 840d065e1ad583c6158d92aa4b533d6a7b31be85966dc52483233a42a4744184
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ce323a11568b9049
chapter: CH-05
q: What is Rego test files do NOT. in the context of Rego/OPA?
a: Rego test files do NOT.
reference: BLK-914d3ab30c1cbcd0
digest: 25b363aaca3c68f652365b806c74c872bd8670275e2523106f1d352455d7e4b4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-4b7382d9f77a42c9
chapter: CH-05
q: What is üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix in the context of Rego/OPA?
a: üß© Fix Options (Ranked Best ‚Üí Acceptable) ‚úÖ Best Fix: Convert test diff strings to multi-line Rego strings
reference: BLK-91b98d897aa10bbe
digest: 5fd2de12f64259854c7474abfc88174082d1ed81d461c6724c4def2c5904aa9b
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b9f0e01b341452cc
chapter: CH-05
q: What is Rego supports multi-line raw strings in the context of Rego/OPA?
a: Rego supports multi-line raw strings:
reference: BLK-f190297a6c64fecc
digest: 4f86f00e4c642cc02e9975c006ba6c72050b706da8b1f96efcbec50331dc396f
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-fff55b20317aa3e1
chapter: CH-05
q: What is Diff  in the context of Rego/OPA?
a: diff := `+ // TODO: + function getUsers() {`
reference: BLK-661d723e70c87b2f
digest: 8dd8480b2dd3f250fa1200bf94bd823e002e05ef6b0cd839e11b923fdf891b87
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-36cbdcc5c0e8b254
chapter: CH-05
q: What is This will perfectly match the policy expectations. in the context of Rego/OPA?
a: This will perfectly match the policy expectations.
reference: BLK-a9c05c7f62d3cb54
digest: cb2b5061039fc2125ac710cd5085499058116d863830c21749e43a18577ba8dd
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a4a7c3e9967894d8
chapter: CH-05
q: What is Update all test inputs to use multi-line raw strings. in the context of Rego/OPA?
a: Update all test inputs to use multi-line raw strings.
reference: BLK-3018dbc1695a1713
digest: 63687509ef947ed92d041bf735e6bac5a830342f50a2a4facaf842a762f16f97
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-879adf21c36c1a4e
chapter: CH-05
q: What is ‚úÖ Second Best Fix in the context of Rego/OPA?
a: ‚úÖ Second Best Fix: Convert \n to actual newline inside the test file
reference: BLK-99ded45841e99ee9
digest: b3ea0ff3afaa2db65477727106e9cd65cfa6a7494ef40903c7ece92d5b52fba1
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-61d9d2b1ab48b095
chapter: CH-05
q: What is "diff" in the context of Rego/OPA?
a: "diff": "+ // TODO:\n+ function getUsers() {"
reference: BLK-54e698b7ae1d69f6
digest: 5436d0aa38c7dfc31c8251d6b274406aaadeb6324b371b6b2fa7bdb4c243c1b4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-992ccef8d16eb357
chapter: CH-05
q: What is "diff" in the context of Rego/OPA?
a: "diff": "+ // TODO: + function getUsers() {"
reference: BLK-62b84bd110ac2fbb
digest: a28272e6e54f5e9c22fbeb328db1282fcf8f5d620c197e7b382e280a737b8332
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-1705b1c6c5da5883
chapter: CH-05
q: What is This is the simplest solution. in the context of Rego/OPA?
a: This is the simplest solution.
reference: BLK-0906546a75dd84e2
digest: 5367d2670b9eb36ee413116387c694602bd347a9144385f7bf4fd9c3f2d10ab9
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-ba23668728feba09
chapter: CH-05
q: What is ‚ö†Ô∏è Third Fix in the context of Rego/OPA?
a: ‚ö†Ô∏è Third Fix: Change all regex patterns to handle literal "\n"
reference: BLK-694a2f9470d0042f
digest: 4b271b509bb74a6dab18aaa063fca4ddb9fcef67951240867daf951da9135252
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-909970edf072981a
chapter: CH-05
q: What is Regex.match("TODO in the context of Rego/OPA?
a: regex.match("TODO:(\n|\\\\n)", diff)
reference: BLK-22ef61310b55ff98
digest: a9306389383d63c9483cce285a53c2ff772084605b8c33f877b74ab9fc97711d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-a04f5a0dff627e69
chapter: CH-05
q: What is But this becomes ugly and error-prone. in the context of Rego/OPA?
a: But this becomes ugly and error-prone.
reference: BLK-42ef9188bb22552f
digest: cea3296bf4dee801bdf66a55b826aa8172e2934b65f3388e3d52b20c73e41979
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-00c5ccedecd85c90
chapter: CH-05
q: What is ‚ö†Ô∏è Temporary Fix (Not recommended) in the context of Rego/OPA?
a: ‚ö†Ô∏è Temporary Fix (Not recommended): Decode the string inside policy
reference: BLK-bf3d83b7e8b7048b
digest: e97a8547af8a2531c26c119ca263453a8a9f029d636b24a8bea6c24123a1f0d4
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b21b9b07229bc8bc
chapter: CH-05
q: What is Diff_unescaped  in the context of Rego/OPA?
a: diff_unescaped := string.replace(file.diff, "\\n", "\n")
reference: BLK-23099cfd845b535f
digest: f6c86cda0064cbe509056b53ac82018101b1690827ab051c9adeb2343c02d575
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b442aef3e458eb9f
chapter: CH-05
q: What is But this will add noise to all rules. in the context of Rego/OPA?
a: But this will add noise to all rules.
reference: BLK-44a8a9caa5e043ee
digest: 6a06253fa4d347199aaf2bbbbb3d060f64b7227685520b6f33587bc3d663642d
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-679cf41d8d525abf
chapter: CH-05
q: What is Because you‚Äôre building an enterprise system in the context of Rego/OPA?
a: Because you‚Äôre building an enterprise system:
reference: BLK-c511802d86d94661
digest: 29a4651e2ecee4085635a19851738a425748f54f2eef8a79b4557649d0233e69
symbol_refs: []
semantic_role: explanation
:::
:::

::: qa
id: QA-b9082b0a411df4d0
chapter: CH-05
q: What is ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs. in the context of Rego/OPA?
a: ‚Üí Fix the tests ‚Üí Keep the policy pure ‚Üí Avoid hacks in Rego logic ‚Üí Use real multi-line diffs
reference: BLK-f707e7c8060ca885
digest: 680c7afda94ca669769d7d5c2f81407a26e2926806ac05638a826e6696be2dca
symbol_refs: []
semantic_role: explanation
:::
:::

::: reasoning-chain
id: CHAIN-0ce2a2bf9dd58daf
chapter: CH-05
qa_id: QA-6d360af85dc91dcf
reference: TERM-b522fb509bee52d0
semantic_categories: [truth-values]
digest: f76fb846b0a6db687230f0f46636f39af9583cff5a93921ba7e4547058398165
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0fd74a61a6b821b1
chapter: CH-05
qa_id: QA-e1b6b14138d6a153
reference: TERM-77eaf07b79028829
semantic_categories: [truth-values]
digest: 1eb200ee2d332d482e90bd52b4bccdca575dd24d94a24b281addae258853e468
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cd74314a2fd5e7da
chapter: CH-05
qa_id: QA-6dffea90674492aa
reference: TERM-765461e32a3f2ac4
semantic_categories: [truth-values]
digest: 14cb92455fa863b8d7968d7f64d5638192b075e15d1c8c1361f3f42901156803
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4dc8fc8dff526f9e
chapter: CH-05
qa_id: QA-ea707f6dc4a5ebcc
reference: TERM-2e68e77273483d64
semantic_categories: [truth-values]
digest: e70599f2f226e5443cee10b9d9badfcc8a1286ea26d8e674df5443176548ddf5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-188c5af6297b38ee
chapter: CH-05
qa_id: QA-f19da1f7c3eb1112
reference: TERM-f0f922c28fb58f42
semantic_categories: [truth-values]
digest: 894b51321cee44e1e8b08889e6424ab4749b5b33f52191419bf5509d68462ede
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-345f54770601e682
chapter: CH-05
qa_id: QA-9c0314476e6109e4
reference: TERM-08f1447eec4c64e2
semantic_categories: [truth-values]
digest: e557733ae180ce56384db59755f2ec7ceb0ca446e2625f111915d3021f66a122
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7e1aee65895b590e
chapter: CH-05
qa_id: QA-4f586c50bb35a97c
reference: TERM-37943d9555f9fb02
semantic_categories: [truth-values]
digest: deb331f53d59036345b94a8f7d94921ec3226af0871eeae5c54ee22e6b43792e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-64db029b53155d34
chapter: CH-05
qa_id: QA-8224e9bfc30df774
reference: TERM-4bf6ca2b25fb033e
semantic_categories: [truth-values]
digest: 4edfcede4805ad0505c1db9231aad5d9125593fe5bc75bc72417145e5bbfc665
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0bbd6a217e74748a
chapter: CH-05
qa_id: QA-4ac97394f1220fab
reference: TERM-d3125a26b9e36f78
semantic_categories: [truth-values]
digest: c4ac88ddb6605d3bc040894241fe7ab5fe3390d1203b136cd0fc9ae1081bfcb2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ad9ba2c4158bd82a
chapter: CH-05
qa_id: QA-17e0a17d4cfc10c1
reference: TERM-61b8c1a83d1cdbdd
semantic_categories: [truth-values]
digest: fdf2892b1b7a7919d436f1913e6477722823635faf202692309a70ad9722da25
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2c0f6ee910cc0046
chapter: CH-05
qa_id: QA-f5cf7ef0c45b36b7
reference: BLK-ef0eb00e6bda8ba3
semantic_categories: [truth-values]
digest: d5e38336370d064aaaba7076247d66575c8f6596d6086bcae465590ecae5a7e7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eb5e59a2c70d9fe3
chapter: CH-05
qa_id: QA-b7981dbed08bad18
reference: BLK-49055f6875f1cc73
semantic_categories: [truth-values]
digest: 6dbd0d40e1107dbe822c3560ab502afbe87e97ceb867962d1ec759b232dbf4cc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bf8e44f79aa33816
chapter: CH-05
qa_id: QA-9afcacd1ed00a398
reference: BLK-cf46e6696f6b22f0
semantic_categories: [truth-values]
digest: 61d086798734a145ba1a6106cc4879bc3315d8f582362ef299aff1a6346c3243
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1da403cd5be39918
chapter: CH-05
qa_id: QA-7c2c3dcce3115430
reference: BLK-b772a28e5960357e
semantic_categories: [truth-values]
digest: 16a711e8b7bcdb8d2c58b13aa7c2233959579553fc62afe4e05ab91ad041abd5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e19ced32522e57e0
chapter: CH-05
qa_id: QA-26ceca933715b525
reference: BLK-6e16416ce945a0fe
semantic_categories: [truth-values]
digest: 65d761e35fdd2e1f38a9bf8717edb937f9f618243cafb045191ad315465ee505
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-65fd1929d942377b
chapter: CH-05
qa_id: QA-5c16c315ea85a723
reference: BLK-b6acfeb73ecfb3bd
semantic_categories: [truth-values]
digest: 929df25976a58cd5abade4701f004483e9a84b0df0928d3d6af364095cdeedef
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bd6c559045b65635
chapter: CH-05
qa_id: QA-b3eee0ceb13d0214
reference: BLK-ffa6ad16a050d7d9
semantic_categories: [truth-values]
digest: c8d491853a821b5ec0da0d98cdf92caf5dc20e8de8bbc4fd423465ee65c8f53c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7a095443f4cb5677
chapter: CH-05
qa_id: QA-848bcc3ba54749b3
reference: BLK-3d88482e4061db9e
semantic_categories: [truth-values]
digest: 2f8fe64de902f7f63529e82bf4cc2496f416f0e22c12ac1479f2c1d2e3451479
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-13ee99221b7213ab
chapter: CH-05
qa_id: QA-70ed967bc56e59ed
reference: BLK-aad1a170dd666677
semantic_categories: [truth-values]
digest: 103e85ad3e6c170ed6c54e8f66cd7dee8d945d4975f095e2d3502677dd3ca90a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d0426acf9ec4d849
chapter: CH-05
qa_id: QA-0b23e837b6b33196
reference: BLK-ccdb280747300dd7
semantic_categories: [truth-values]
digest: 539cecc5bf0c88293ddabd6610d9d5642ef1ccd52e684dac77dee282fbd1c522
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-652a04fd44bc5f49
chapter: CH-05
qa_id: QA-0fc5522b563dc927
reference: BLK-6019bf75ef6624c0
semantic_categories: [truth-values]
digest: df9a32836a0197b571b18b819709d974b3d353147eb2a95fe5eb2b9590daafca
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7bb0a07de4233676
chapter: CH-05
qa_id: QA-4b18ecb21a93c1be
reference: BLK-6b408802776a93cd
semantic_categories: [truth-values]
digest: e33e5b98bd8c3d20e27be9e8380589e80d41ae45081c7aa66240b214b633c8f5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8cf58f643aadd310
chapter: CH-05
qa_id: QA-e773a1fa91cb51e6
reference: BLK-f4ead349338c8ef6
semantic_categories: [truth-values]
digest: 798b1e08b366c12347e4c57cf2277b3c49f211f93fcad312831cef83291e4069
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cef544325e483cd7
chapter: CH-05
qa_id: QA-6c3015db9d5159fd
reference: BLK-54e2cf6d9a981dc3
semantic_categories: [truth-values]
digest: fc7ba2be69343a34848431340734ae0e306abaf722458fa69fd9b9240705b78c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-837ad4e790dc79ed
chapter: CH-05
qa_id: QA-aaa203e328c850f5
reference: BLK-c595ba2ed67a0e45
semantic_categories: [truth-values]
digest: 32b4452949dc8a4f4d2da612f018ca89b52affffdce5d727306c5834414bac82
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cb9e74741737cbd4
chapter: CH-05
qa_id: QA-387c97b708f97780
reference: BLK-c7baced805939b57
semantic_categories: [truth-values]
digest: 65de5f43e23469600f3e61206c21d7c5c33b8824508258d3afc40b70e3f0a7a1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b98744fbc6ffc004
chapter: CH-05
qa_id: QA-dd7c9d2c11814dc8
reference: BLK-82cc3ccae9f078e0
semantic_categories: [truth-values]
digest: 43cdd7d8962bfc320146d3ca7a15430c3acece7a5c8a92b97bdc7df37da54a80
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-01be6e5a67aa9e6f
chapter: CH-05
qa_id: QA-fc49602cc90e990b
reference: BLK-cdbdae08e6768e75
semantic_categories: [truth-values]
digest: 463e31a71c34776da8f00b198d04ddad6e2d0f4f1088314b347980efcf4f91b0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6c589faaf40321ec
chapter: CH-05
qa_id: QA-81a387de8345c31f
reference: BLK-872e72b8a1e0cda1
semantic_categories: [truth-values]
digest: 5f3e1ee9f64740dcfcc2c8587fbaa56ee2d196d334bb271feb6a44cc4a1246d3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d4a62180261da7be
chapter: CH-05
qa_id: QA-0f24718fc2eb1f00
reference: BLK-c179f5c2a30f1d7c
semantic_categories: [truth-values]
digest: aac4bb960ed1cf90b5862d1b66ffe84a32ed56e193488ff050f17d0813f8aa3d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7c6dfb9efb64fefe
chapter: CH-05
qa_id: QA-4ae8445ec4a8411d
reference: BLK-00a76d3fd313f7d0
semantic_categories: [truth-values]
digest: cc91d7ceb6e209cca140dcdc2263e238a4a62098f63d20ce10125d08145e33c9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eb0f047067d501bf
chapter: CH-05
qa_id: QA-10b094b956cd7043
reference: BLK-2ef44c7e2eba38d6
semantic_categories: [truth-values]
digest: 9eca1d7bfc0e80f230e2d66f38ceb610df4b89f6f80c126381b8b9aa819b76df
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1a6a64aabb024fbd
chapter: CH-05
qa_id: QA-0374817e1a9cade2
reference: BLK-962ae7799bfaea26
semantic_categories: [truth-values]
digest: 44d5ebcfeddd33726a045e37e3ae8ed69f692b9c3f56a0834d814266d8f47830
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dc1fd6c9400bcd90
chapter: CH-05
qa_id: QA-d29f1894b337fad5
reference: BLK-596d0d11df0a2b34
semantic_categories: [truth-values]
digest: 7fd61bde2012df09524e8cede3e625230524fcb5bf00f99c1267ea186ad61193
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ea846523fa39ae83
chapter: CH-05
qa_id: QA-e22ee2b56fd30589
reference: BLK-7934af716417f7d8
semantic_categories: [truth-values]
digest: eea8080eeb76b1f09753f1593bb9365c189663642ca0dd53f008d05dfb5660ac
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d018d0b6e395281d
chapter: CH-05
qa_id: QA-3523833ddb6e257d
reference: BLK-791542a3ee72c589
semantic_categories: [truth-values]
digest: aebc42f56e74ecba78b0aff58122ae72a24f07f4fce7821f43bb09a07ee6b730
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fbc1021e5c5cf4e4
chapter: CH-05
qa_id: QA-30e59fc70b3bcd95
reference: BLK-f48113faff5c16ae
semantic_categories: [truth-values]
digest: 7dee415d4434d48ea4c8baf00933d3597f0e45ee468ab5632edc9275438090b8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-989c0294484c3072
chapter: CH-05
qa_id: QA-19bc8ae2a6fa3461
reference: BLK-eb3d6c96d1f72a4a
semantic_categories: [truth-values]
digest: 97dba7c5469f426d25f61ac828acd65682fbf0b581893ea605ddeb6fe2f15798
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6083237cae8d5207
chapter: CH-05
qa_id: QA-c3ba087fe00bf1a6
reference: BLK-74ff565e561f01ba
semantic_categories: [truth-values]
digest: b5605c13ea24bf55a51564888b4d1af04f336348e8cda988a06726a88212ea58
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c56841037497208d
chapter: CH-05
qa_id: QA-d035f0c5f6456fd9
reference: BLK-2c081e539ff9ca26
semantic_categories: [truth-values]
digest: e6d6c83d00c07a38357b9eaf9cd2b4a41e6d5dbe86f685b1ece36e6389a4e278
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c7cbd59843018abd
chapter: CH-05
qa_id: QA-38915b5116cf041b
reference: BLK-15482deb4216bdc0
semantic_categories: [truth-values]
digest: 9d6ddd3c5f74330510060504fa5336e573b78067649c4a719eedb6dbe2d1835d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dbc2183fc09d68bb
chapter: CH-05
qa_id: QA-03d6842be110ec68
reference: BLK-99bc66bd2d2d22ac
semantic_categories: [truth-values]
digest: aa2fbf1cd5a167c5ef1687f0ebd8ba39100e9a8bedc0e31deb1effcc7b7ea151
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9ff281c5a6663bdb
chapter: CH-05
qa_id: QA-f6c851b854d87834
reference: BLK-bbc8d74e03606e88
semantic_categories: [truth-values]
digest: 4c83619a49fcef991043c54cdd0d8a8ee3bdfe4d8e5fc2c2d2bca6dfd1bfdc9a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4a3b6e9432510c90
chapter: CH-05
qa_id: QA-6060ad799721142d
reference: BLK-63f3203792f6dd9a
semantic_categories: [truth-values]
digest: 62c1046256dbe736cdaa74afdbf8668e28f0bf3467f203adebc162de6cfeeaed
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-716e7476495262e8
chapter: CH-05
qa_id: QA-4e2d8aaef6a7343a
reference: BLK-0170fbca460ac05f
semantic_categories: [truth-values]
digest: 30a3225c945674d3e9dd76f7c05d298617b50bb3a250b4759bc2a932e8affde7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dcf8c06f734274a7
chapter: CH-05
qa_id: QA-9bad293c7091e255
reference: BLK-fe1ce0476ba80606
semantic_categories: [truth-values]
digest: 456225bc25cc7e69c1a26266c3798a1fc6147f667111dd2248cd584e4ccddb34
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-102b2cee7ac6c001
chapter: CH-05
qa_id: QA-8757f7b5f225e6c8
reference: BLK-404c395d3ea15d7a
semantic_categories: [truth-values]
digest: ce6126c8365f01cf4bc2e7fd3a2a5ff21e6806a5a053df26365135fc50fd954a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-77d44884faf5ff6b
chapter: CH-05
qa_id: QA-d210151310e43858
reference: BLK-21aad7baea9ba2e2
semantic_categories: [truth-values]
digest: efd35b31db16868faa2dd0e8966c37736f76b8b741866de68006df5e2d97e230
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1bc10f16386a73c8
chapter: CH-05
qa_id: QA-674b48ccc6d775f6
reference: BLK-0c491778be16cb9f
semantic_categories: [truth-values]
digest: 9a3919065e91e000d88bb5d650865f0a12a76a676445def21796eb35dca17eb9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3ff284abca583990
chapter: CH-05
qa_id: QA-6eda01b8d6d9090f
reference: BLK-e94daebb356ba43f
semantic_categories: [truth-values]
digest: e82398cc09517c48a351daaa577efffca79a69a2c609bc4cdaeb4e7b2b9d9253
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ab57e13f713a9d8f
chapter: CH-05
qa_id: QA-e8d165609e493b88
reference: BLK-08cda054b5b03bbf
semantic_categories: [truth-values]
digest: 5d34bb46f46a81c49d9dec63f8cfffe1a1572040ef2bf7f200a17d25cdcb9f70
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0508af0096e55629
chapter: CH-05
qa_id: QA-95534c53d589afed
reference: BLK-f73cb48d2abbbafb
semantic_categories: [truth-values]
digest: b273287f931d929c11032f13607d2f0c0c9aecad3e773b4b851b26eef10e071d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ab29f5c0643b03e1
chapter: CH-05
qa_id: QA-8c1e5771712a12c9
reference: BLK-e37b22113d09ec95
semantic_categories: [truth-values]
digest: e9c668f23b471e18d4563a1ff82d48e4ee2802b1162085defecabed77dc25a45
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2f4e5fd2c9435878
chapter: CH-05
qa_id: QA-c38043398d2dffcb
reference: BLK-12487ad1b10432e4
semantic_categories: [truth-values]
digest: 7b6e5a4988d4671010cb3fbaaf50c393ad30f731a2f826dd8d37e328cfd34f3f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9b33ec4af9fce73f
chapter: CH-05
qa_id: QA-e6c2a2a0a5fa438b
reference: BLK-3db95d70e67fc31e
semantic_categories: [truth-values]
digest: 2b4ab3b52754d4cc67a78ad68d98d54ccd71828a646205aa6e4136252d78721a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8df0b6804aba4521
chapter: CH-05
qa_id: QA-fb5ec3ccc3ed2475
reference: BLK-523debf78d115993
semantic_categories: [truth-values]
digest: 0378a08eb678c97290973957d91c378c0611c028ef9b98580e11fd5f9bea254e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a5ac5bbb770c6005
chapter: CH-05
qa_id: QA-eb7ff490e3fbfb08
reference: BLK-d047ca3d47b07bab
semantic_categories: [truth-values]
digest: 6ef597aab0cca6e94f78e5831ca0d9e32d7439af2bddbb42f6f84f1d7fbe228c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a4a305b4fa13919d
chapter: CH-05
qa_id: QA-6d29e566b49e0dbe
reference: BLK-958bba1048ce58c0
semantic_categories: [truth-values]
digest: 27daec5e559f16c38015d78ad0ddfc03c4cdfbc0619050e8ae969b2f1a6a8a44
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c7a87c80ac755139
chapter: CH-05
qa_id: QA-d89261e24af26ba7
reference: BLK-9936fd64e4071bcd
semantic_categories: [truth-values]
digest: 2a971d815895bbbfd203d067de7c9d1be411a3ae72d067693882d7f49dfb8440
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5517c1ba030c9524
chapter: CH-05
qa_id: QA-922a84fd9dc2dab0
reference: BLK-b7a1e245e128d594
semantic_categories: [truth-values]
digest: 99a88f7d56e9cacb07b6eff30ecb0409d4d83ac2dc2cf08ef56743812325be7e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-096d806a4a7c50d9
chapter: CH-05
qa_id: QA-51672e9a39f08ae3
reference: BLK-6896accc71c6a5e8
semantic_categories: [truth-values]
digest: 6bda1d3bf8f17e46cecc18bf89081a7287d96d3256d787d3146df39cd355fed5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ca27c3ea1d95cd54
chapter: CH-05
qa_id: QA-0d2ebb487c9869df
reference: BLK-6809c3d7905f3972
semantic_categories: [truth-values]
digest: f5ac88bafd55e89aa2947bc44e66b8ff4ac37f9cc8d3168d7c6cfb50b3b95ee7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a72998551fd170cb
chapter: CH-05
qa_id: QA-49a80a7fab8d37f0
reference: BLK-64caf7147f83da01
semantic_categories: [truth-values]
digest: 080c15bf1165d9f050915152accdc56bd39573473655a7eaedf46b2b470d3f41
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7719e277dd321af3
chapter: CH-05
qa_id: QA-65abb7d5ea02a9a9
reference: BLK-966c15b0885f6587
semantic_categories: [truth-values]
digest: b6a7021ba942e5f3a4a1e89353ad449a069608bddcde56f96f45ce37b1315b03
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5e2500b8787269a6
chapter: CH-05
qa_id: QA-127b5de080bf4c7b
reference: BLK-e6aca8c5011c2c92
semantic_categories: [truth-values]
digest: b9d3b4edd8221074eb522d60dd258a9492fc42dbe4e79a0eeec3724c624ae6ce
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d927eedcf7ad1870
chapter: CH-05
qa_id: QA-2ec68448a695a0f1
reference: BLK-f16c75347a49cfc8
semantic_categories: [truth-values]
digest: a04cc9e537a11eb94832e1cd99b0e6cb78eb7607bb0d4d4dd5fdce57d63e2935
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5ea767962cc383ff
chapter: CH-05
qa_id: QA-a7e529edd765eeeb
reference: BLK-bc0e62af97ec9ecb
semantic_categories: [truth-values]
digest: a38105ce874e7c30759cb0f18ae9fabf2c182f3c27b2ed0b0c6c68d199dee897
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8c97e2adc711577b
chapter: CH-05
qa_id: QA-b222ac34358d6c48
reference: BLK-8db7cb02fa0d8019
semantic_categories: [truth-values]
digest: bd68951a05b3a694d0c6102553ba5fc1c405c697fe20fc03cba69623c9799b4a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5aecae8d97e13853
chapter: CH-05
qa_id: QA-b29b5f2e46210dd3
reference: BLK-7ff764ddb3c09d45
semantic_categories: [truth-values]
digest: d16de5ade7ff661b7f09cd6b88d8f220b94f6578860402e48dd4c9518c86521e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a090d5322fde865e
chapter: CH-05
qa_id: QA-6378425a6037371e
reference: BLK-560f57c44741f42a
semantic_categories: [truth-values]
digest: f8262acc5e71da0b3fe39435f437ab3f115dae0ba4a2be4006a7271b6bea6a7d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1d8a197cd55c6568
chapter: CH-05
qa_id: QA-d67b755dc698f521
reference: BLK-5d036547953a8f35
semantic_categories: [truth-values]
digest: 8f9bf1ba4d3eca09791cdaca3b806e74b22e56d62973c05f095fe51253547262
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2b3244ac67df45d3
chapter: CH-05
qa_id: QA-60535c69698f3241
reference: BLK-aa4996164f00b4c3
semantic_categories: [truth-values]
digest: cc5b5ebd9d6b2273c61ad6e99bc401e6cfd4d972218d3774c1fe9bdc1e19dd72
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9277fddfebcd73da
chapter: CH-05
qa_id: QA-48b992e3bc82776f
reference: BLK-f8d1eedc439ab8ec
semantic_categories: [truth-values]
digest: 17455d891ee176901e9f46564251d120b93a33a4707e0c59a0d54aa237cf0787
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d9b3eb9cc738fa89
chapter: CH-05
qa_id: QA-d8be09957b0a0e3a
reference: BLK-f9b6faf28a2028a5
semantic_categories: [truth-values]
digest: 7eacd7b217910006fb960a0a7b108a5505edc93cd4f99e1574eb1fa719ac342d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c407a927f5c3e6b1
chapter: CH-05
qa_id: QA-1af12c7a6c71370a
reference: BLK-0bb7c9be9909cc35
semantic_categories: [truth-values]
digest: 6bc057b3b937b4ee2aae8af0660941cdb302d3dfd43261437f8b6f36cefb2d40
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b68e28315f519130
chapter: CH-05
qa_id: QA-e8ef28300ea3ae73
reference: BLK-a9fcb33c5ea171bc
semantic_categories: [truth-values]
digest: e31b4b1ca3c322fc55f4ecef8308738ebac46a586d1c9b4af5acb23628369ed5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-40a3384b17e92d86
chapter: CH-05
qa_id: QA-119cfb6bc1af3ac9
reference: BLK-5054224961c85436
semantic_categories: [truth-values]
digest: 62f81f623fd2783f900e11295a76653db6ea4117f104ef2d7a63c945d55a111f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8bfb2d9f14a1e382
chapter: CH-05
qa_id: QA-8e55ff9219f07414
reference: BLK-b6de378fb521f3e5
semantic_categories: [truth-values]
digest: cbbfd35356286b6db763ee27714d54b8ab5ab263dc4cbb58fb707fba1414b4e0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aab68f27c97053e1
chapter: CH-05
qa_id: QA-fd31d6d8e7f76dbf
reference: BLK-1827c164cec5cced
semantic_categories: [truth-values]
digest: 7706671244eec6663cc43953be18b6140993a410f43fe42d2111da3ecb52fcd6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a2b76283b1dc4b91
chapter: CH-05
qa_id: QA-7e523b3e81e3f693
reference: BLK-d1f0e80b99a8855a
semantic_categories: [truth-values]
digest: ae1f56647617b0409558c4ef6ca5a22477bcf5d62e26dc81afced502dadebd1e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-591dd02841cb2499
chapter: CH-05
qa_id: QA-851183981785d0db
reference: BLK-034df081487c6e14
semantic_categories: [truth-values]
digest: 57a730e95aade8fbc12d9406f461d05c026fc2b13b1ae7fc1b9bedd70732412b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2e00efd2b4acdeb6
chapter: CH-05
qa_id: QA-8fa2fcda839d0e2f
reference: BLK-3d6a7a0519d02f65
semantic_categories: [truth-values]
digest: 5a03bfe37d9c698e3a362fb447204edc8ded969055c858446b5db7218736f56d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8d7ffa570a805651
chapter: CH-05
qa_id: QA-18ff59fcb3db1246
reference: BLK-5f55f27905af292b
semantic_categories: [truth-values]
digest: cfbff54a29426916af0e09a7955bfe39423a711b06fdd740de9dd20b2ba9348e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-317143ea1b2171d1
chapter: CH-05
qa_id: QA-ec39246b6f3bb849
reference: BLK-99ce09c802bf60a2
semantic_categories: [truth-values]
digest: a01efd0e02e0c37120325f051318a781dd6f37e0fdcf2991079b8ca0ee2e4696
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-702b2f711fd79d30
chapter: CH-05
qa_id: QA-1182bb9ebf3ff2fc
reference: BLK-8d0cec0d56f71772
semantic_categories: [truth-values]
digest: e256ce7c1cb58883dacd94f774f2a1a0571e3f2c938c0436c5c3220a19a950f9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-88850511367fbca4
chapter: CH-05
qa_id: QA-ab4ce2bad9f1f3e3
reference: BLK-c2126d6032b00de1
semantic_categories: [truth-values]
digest: 6e5a19850a70675227178ed19a1ca7d2c88c46092d46d888cb65120240a21717
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4950bfd9e6d10f32
chapter: CH-05
qa_id: QA-29e872cd3e562bc0
reference: BLK-d0a0341eae3035cf
semantic_categories: [truth-values]
digest: 8fd819d474bf9655b3b0a54fdaf781814446ac48619c38bdcf93a529d2485e9e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2a507367b40dcc6a
chapter: CH-05
qa_id: QA-d778e6a911281a36
reference: BLK-19d08c340d427069
semantic_categories: [truth-values]
digest: d5c5c0993de4a627dfd1c93e2e341c65d548f5ac90a9e1aa546057e789658ca5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-517587f02eb8d1a8
chapter: CH-05
qa_id: QA-aae2f51c9db302f2
reference: BLK-c2a495572332a234
semantic_categories: [truth-values]
digest: d174cddf9b279d4eae3bf7e47a8be41a0c3ccd74151fb209a5ada66c2a57291b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e437648643bb29b7
chapter: CH-05
qa_id: QA-2cbc3191c4ca90f6
reference: BLK-cea8ae8e888936e9
semantic_categories: [truth-values]
digest: 2777499659424d30e58e3b097e55cb319d4adabcf9977f40ba952efe3b4a9ff6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4198b10d0c7665d0
chapter: CH-05
qa_id: QA-93e5b16275e406fe
reference: BLK-9c591fac4dfe8baf
semantic_categories: [truth-values]
digest: cf2e22468e333721e9184654d23415b4e19f0ef9386bb335ac813efa7e07a285
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-754763ab75dcb047
chapter: CH-05
qa_id: QA-2b5a783755d6a8fe
reference: BLK-154238569cc2d740
semantic_categories: [truth-values]
digest: be7c51a3d93a9279d90ede21408ab7a6737f2c6176904777cf06e74b272aba29
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5bf67154cd1f441c
chapter: CH-05
qa_id: QA-1a3a9e1d5cb031d3
reference: BLK-85c57404aa7470a5
semantic_categories: [truth-values]
digest: 3dfee4850d1dfca4cf2ed9276614256f986a7470e75c1539781393769dee2410
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-737c03c09d1c0e52
chapter: CH-05
qa_id: QA-030c453a260a7862
reference: BLK-5653ea053fcd305c
semantic_categories: [truth-values]
digest: ed61873874ac0b10dd747b4da0b365bef7921ab96f73baa97ff8fc3b8c7fc7d1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b9bfea3db776ec22
chapter: CH-05
qa_id: QA-83d210791307bb44
reference: BLK-a3e1adeda4bf400c
semantic_categories: [truth-values]
digest: b0dd9945427501b21150723ad4077ab014e018277ef12318231bf9847327c03c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d1b7a33de37bb33c
chapter: CH-05
qa_id: QA-fd5b5b8e2b1e419d
reference: BLK-5b85cd23416fe10a
semantic_categories: [truth-values]
digest: c670d7da1473dac1740db717f78f910a3991cf93f420e0dee06fd772cd067be0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d2055078271d94b9
chapter: CH-05
qa_id: QA-bb973857aa10cf92
reference: BLK-0aca188dad8fd4c4
semantic_categories: [truth-values]
digest: cdcf65eefd79e5e0d816710914da8233c2ff61139b0ec52ef2a74deb4ce64c66
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3d496c5160d3227b
chapter: CH-05
qa_id: QA-0026ea86964e8830
reference: BLK-27494b43ea9a88cc
semantic_categories: [truth-values]
digest: 1c5aba8232f0341860b86a479a50ea55e5ad39e46c079221149dac1f3a0d2206
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4c94b2bd1342993
chapter: CH-05
qa_id: QA-3c4638bdfe28f463
reference: BLK-bffd0561a132a3ee
semantic_categories: [truth-values]
digest: 1660d4838c1b500741b96d977544e44e44a3a61e1276aeccce7b2d8d87617325
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0446242195de6575
chapter: CH-05
qa_id: QA-8d88a77df9629e53
reference: BLK-cfbd6b5720d1c8c4
semantic_categories: [truth-values]
digest: 5c3f54e3083c9e1fc19ed600c62339f8fe3a2de9236c3f482003fb429f90c946
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fa3666c9e26d9b0a
chapter: CH-05
qa_id: QA-285ebbf657e67390
reference: BLK-dc5923a0cbbecea4
semantic_categories: [truth-values]
digest: 570faa17c3c129c94cb15083b9cff29a3ff42569a3252078763085b04fd0727b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6b0136156ec7726e
chapter: CH-05
qa_id: QA-d6f512a4bef3eabd
reference: BLK-389040bd2c4e208b
semantic_categories: [truth-values]
digest: 4aadc9f8908e27c63b69400c23c246c773df8a17b43d99e89c0d626b8450fdc5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c5a692ee37647ad5
chapter: CH-05
qa_id: QA-6f4ce95753e94ca4
reference: BLK-78c2cb371a96496e
semantic_categories: [truth-values]
digest: ceb2b0a721bf2e15b006fb3859e303296730528afc71743bedf4495dad6c5bb2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-88cce756ea770935
chapter: CH-05
qa_id: QA-805d8805727b7790
reference: BLK-7a4ef4151bc05f13
semantic_categories: [truth-values]
digest: de2ed9192e8ae580111943a584d2fd9c69ad1174d534ac1a122733adfc1bb067
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d3c1da9f47d2672d
chapter: CH-05
qa_id: QA-21037e7ca274c65d
reference: BLK-a307644bd6c65dd0
semantic_categories: [truth-values]
digest: 589a0814f5e7d3503f22ba232019bd6680e2a1dc56b77439a7448569141124dd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3aaf5e573f000f64
chapter: CH-05
qa_id: QA-d3c52bc1b3e8b5b4
reference: BLK-da60e2ba3a9d9f8b
semantic_categories: [truth-values]
digest: 14800a89a6b41544e68640b59bfff684ff1e556becb5cd7b1c027802ad1b1586
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8492301d6af1b6a3
chapter: CH-05
qa_id: QA-7cde3c68bfb993da
reference: BLK-92acd8f218475798
semantic_categories: [truth-values]
digest: 1c76843247791669bafe6f7e7346bbc377df9bdb2f83d5d64b8a938c14a29266
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d9de8fe2160c59e7
chapter: CH-05
qa_id: QA-a24a5ae5bd89c928
reference: BLK-7df6e314b23533aa
semantic_categories: [truth-values]
digest: 7ae340de310453b188d0e9230f02bcd582782bcf7474b628cbda8b330bd55189
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1e0f99960facad4d
chapter: CH-05
qa_id: QA-91ebf9de2b454126
reference: BLK-d5763b6b5eb0bf7a
semantic_categories: [truth-values]
digest: ed24b5f622fc4ee8000953272085aa53fc1091ef09b166065679058b34a5a2a5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-feac222c7fb18404
chapter: CH-05
qa_id: QA-ecc788f37b50ea2c
reference: BLK-c7d5202b059d4f66
semantic_categories: [truth-values]
digest: e1101f4ff9b8db2022209193936f511fb5c21f33741b92483b73c2db2074fcfc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-feec957f2f13865d
chapter: CH-05
qa_id: QA-f9400ec542121a70
reference: BLK-faa6749892163657
semantic_categories: [truth-values]
digest: 9219401a50e34ef5b586f7e4c08c2502a4471f0a23c42a153c434c86f6a94295
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3c3e7242abcd6eb5
chapter: CH-05
qa_id: QA-91cf5d90812b5554
reference: BLK-f103384b14a876e2
semantic_categories: [truth-values]
digest: eae1a18dffe183c5fc294e6cf74b87b82865b7d71eb5581514a4af13ac36e506
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1ab163e4ba8df63c
chapter: CH-05
qa_id: QA-80a9f5d256d21959
reference: BLK-fb68755b272d7cd1
semantic_categories: [truth-values]
digest: b0d1f180b2ddcf757cf64511c923f9ac818b8d07e3784c54c1b61cfec2fc66cd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ce9467fe04c3c8a6
chapter: CH-05
qa_id: QA-7f2a35d12a495a20
reference: BLK-c57d596903f7cb47
semantic_categories: [truth-values]
digest: e5278fa3f2006f89cf011000ec09e9934d522309df53845bd05076d44b931a0d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dce63e7c02a0b436
chapter: CH-05
qa_id: QA-59ca34c19d652935
reference: BLK-e5d2cae50c0adf8e
semantic_categories: [truth-values]
digest: 7557f3ff1b828c88b70b2e2da99da8ee13365d53c16b363ccb0604673e76b908
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bb2f081a6fb2dd67
chapter: CH-05
qa_id: QA-29d16b7f9ae9dd52
reference: BLK-773b97e3f4d9044f
semantic_categories: [truth-values]
digest: dc9fbf2562e16102c5749d4ef1a82c3da022fb1a3e7f0ecfefe7c89d07f45c33
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b9a921fc88a0ff52
chapter: CH-05
qa_id: QA-0a883d9b7a9d3485
reference: BLK-7f1aa0c4b22de975
semantic_categories: [truth-values]
digest: 38d48ad1fac9dcce7e30c3e8e6e00a3fbb860c9b0e9b2f67eac3628bbd165a5d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c3451c6982c893fc
chapter: CH-05
qa_id: QA-698c9469bf54a826
reference: BLK-f25b0aaead0e1ce8
semantic_categories: [truth-values]
digest: e87451120a16ab7260cd75ecf7a063b2373d8c159c4e97119e2dbda82143c823
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6c6cdc79fcc17936
chapter: CH-05
qa_id: QA-edf32a464c1be746
reference: BLK-3bd110a004054aa9
semantic_categories: [truth-values]
digest: 32608d7be2360d8edb5fe5f6c2e89a2179554cd7f14e2e00f25e09c68ca7635c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bdfcfa9c135759e5
chapter: CH-05
qa_id: QA-e762d50c957fe0dd
reference: BLK-365175335364136d
semantic_categories: [truth-values]
digest: f84513f1c54b6c127e5fab7628cf395d659b71ec0b79031b7a88a2b96f04f019
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2b2079b6ac791e2d
chapter: CH-05
qa_id: QA-b96bc83d400b73b5
reference: BLK-393080aa0cc18d4b
semantic_categories: [truth-values]
digest: 0419ad0733ada1d5a574266fa1dec38f3534e5f44c2a5416696f01e5cff71154
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fd724f03e3c6f88c
chapter: CH-05
qa_id: QA-78ecd86443a2d2ce
reference: BLK-f590cb8820f569fa
semantic_categories: [truth-values]
digest: 2f3b933b0aedeb6a0603e6598a2e0d8d57685555b00aa4d4bd4eb9696614e8d5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-49036e69022902d8
chapter: CH-05
qa_id: QA-f4d6f50121f626bc
reference: BLK-74c7bb9f41c91813
semantic_categories: [truth-values]
digest: a0d71d070939ccd86b01a726210b18142cc535dbf8be5fc173a9c8da7911050e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5539829f2ae6fd64
chapter: CH-05
qa_id: QA-3bbb772369b1b6ec
reference: BLK-26988fbc99af1428
semantic_categories: [truth-values]
digest: 4f014500ba9f4aa4cf184cd1ab001df2a44d8db3fc7cb62ac7bdeb4522f07217
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e9398702fd033ae0
chapter: CH-05
qa_id: QA-3fd21d4fd9621d9a
reference: BLK-3e50cfb0dfea9e5b
semantic_categories: [truth-values]
digest: 29a4b924fb87cc082ce799002469ae1445a92bfd8b52c373aaa6ed922450b545
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8631b0b48331ce74
chapter: CH-05
qa_id: QA-30e46d72ba8d9692
reference: BLK-fe1e428678f12304
semantic_categories: [truth-values]
digest: 6797af61eb938401532c16ba4a79d461e33a7ec0d03c8268d3718ba93f2cfbb4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-93b6c949c6eac92d
chapter: CH-05
qa_id: QA-d5a4a6eab3a51274
reference: BLK-539d7bec736ce9fa
semantic_categories: [truth-values]
digest: 63f694274c764af4858fea89b9edb8392be826bf138facd57e73d686e17d68c0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c537d64f02786899
chapter: CH-05
qa_id: QA-5bea6211b0274064
reference: BLK-f1a5006e2f61d559
semantic_categories: [truth-values]
digest: f2a1469d06785b0b4264612ccc8e757a17ecf6a89f495611249ff9c0f49a3d62
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7cf01ef969dfe560
chapter: CH-05
qa_id: QA-c83fb36e09fc37b6
reference: BLK-9931b529da7c6226
semantic_categories: [truth-values]
digest: 55035c581535c02f63710ece6ea38ea3db7381b938a0bfcf26c033d07111fd27
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7fff4af7b5caa350
chapter: CH-05
qa_id: QA-6a4cbcd4798b765c
reference: BLK-7ad70344cf0fd579
semantic_categories: [truth-values]
digest: b74f80999c28e6dd14e0094ca7f4376cf44f1a6ff749881ff82aafc00aa8d836
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-df48528aaa1f8c3a
chapter: CH-05
qa_id: QA-070a0d54308b3d5e
reference: BLK-e82692da642da4e6
semantic_categories: [truth-values]
digest: 92b8e4f161ffec5efa87271b1ef4b845c81aa4067685a6498283aa36291ce424
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cfaaf5c570e6010a
chapter: CH-05
qa_id: QA-e10259a427bdc845
reference: BLK-07cc51248e326726
semantic_categories: [truth-values]
digest: 430d77683d0b9a9864de4c149b7a1205ef800e5674be2a749f321f5fdb7341b0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aa98b265eb14c1b6
chapter: CH-05
qa_id: QA-8afd1d88c992b5fc
reference: BLK-0c4673919ffeab0f
semantic_categories: [truth-values]
digest: 5ae300bdb67daf8595e304254da07f0fc9f2f31a660e487ae4f6e1efc5efcb5a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-37459f9d4105c53f
chapter: CH-05
qa_id: QA-d0e542e9ddbbf865
reference: BLK-760d822b72ca8385
semantic_categories: [truth-values]
digest: 1f1adeafd79f6ce9b05d2e746fce2f8fd182a7f2cc924c20b04130b74c640ca4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-22823db3ff770177
chapter: CH-05
qa_id: QA-d148ee5198eea17a
reference: BLK-38e55e81ea44e29b
semantic_categories: [truth-values]
digest: e53c296c32a65f90cb11629292e2ec155c50ed70b8d64bcadc28df7e39b215e5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-22a9fe88c9eeb787
chapter: CH-05
qa_id: QA-59c97deaf3bcc165
reference: BLK-92df017ca6dd0a84
semantic_categories: [truth-values]
digest: ae7fe346aeb7267698b91318b618e2e6541b00975b36e0b551ae35ab114ce8e7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f12e9c4ed4da7812
chapter: CH-05
qa_id: QA-4a4244bba5d8fa18
reference: BLK-bca085b327a54593
semantic_categories: [truth-values]
digest: e9e9ddc35c923e1495a1b85ea38552d4eb1a8e01e37c7023e26fc19c435ae3c5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cd386ae244fcd79a
chapter: CH-05
qa_id: QA-e87d13b775b20f40
reference: BLK-c51a72be2c4f7943
semantic_categories: [truth-values]
digest: b79678759ab4744271fdbf03c03e68a5a0c9165b2c35db0a7d7f49e7bd6abde9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1e0010b71da00650
chapter: CH-05
qa_id: QA-4b77f3b6a3e733fd
reference: BLK-9c235109ac4fb55a
semantic_categories: [truth-values]
digest: 5b3dba8a1bc99d91dcda0a92391ff637d8111f3e174a1c8b140b6b5e1fa92067
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eaa0812d50abccfe
chapter: CH-05
qa_id: QA-37475d052deb8604
reference: BLK-79d62f89dc8c2bbe
semantic_categories: [truth-values]
digest: dd9d49805375329bab7e9d01e39538fa4f4131ff2c836d11aa4301af4738cd71
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5b30b986cf32f52a
chapter: CH-05
qa_id: QA-737bdab9db1fb017
reference: BLK-5c33fbfabf3e6fb4
semantic_categories: [truth-values]
digest: 044985e24a75733e1c7cf460ffd584844c899c96f62aa69ca27be99fe5d49df5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-860ddb741f427063
chapter: CH-05
qa_id: QA-2781f38803eddc60
reference: BLK-381855197c8a3986
semantic_categories: [truth-values]
digest: ca9708ce98e92d06b45a219726b31cc4a4f2db58dbe3c13dc64ac7a1dc5da948
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-65e7e59007860986
chapter: CH-05
qa_id: QA-d03eb1366f811484
reference: BLK-c09ef369e7bd778c
semantic_categories: [truth-values]
digest: d93fa6d7b1eded1781e8a51bd3cdfdc79121e08806dff2f60e738d0da86201be
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-978b319cd26f05c7
chapter: CH-05
qa_id: QA-9f3a878afc07535f
reference: BLK-cb82c0a969ee513d
semantic_categories: [truth-values]
digest: b2e79bc0e7368fbc60912135e82ccdf2d4a4f5e7b7313559e0e40156687297c9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-65772b12e697e2d3
chapter: CH-05
qa_id: QA-16f2e262883c81d8
reference: BLK-492775404d6858a1
semantic_categories: [truth-values]
digest: 955a4990d456b22123eaed14f31bea63faab14351066336cf8367130a422fe84
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c2932d9b2985b7dc
chapter: CH-05
qa_id: QA-c1b99f0c8fc071a2
reference: BLK-803815e4948a9134
semantic_categories: [truth-values]
digest: 04f404c39edfa65fe054e31abc5546a253d3b41106f18eb0efb9b4ff0bc9f67a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8a02ed4eb5029e37
chapter: CH-05
qa_id: QA-ca7d5ee1faf30986
reference: BLK-6d905df2ae0be4ca
semantic_categories: [truth-values]
digest: 529c56665e8ac0a642c2e804bdbe525ac0d241d0c208a931e9d7bfaacb2d13ef
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3a6e5dcee29fa429
chapter: CH-05
qa_id: QA-c0347347b583b099
reference: BLK-01f8eba873aaef46
semantic_categories: [truth-values]
digest: 2e1be7a8c2d44c98e4a5b08b45166d80f34154bc74d9f415bf11a63a2808586f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e9dea495fda7f80a
chapter: CH-05
qa_id: QA-199c65d056536938
reference: BLK-c93efe6db0a5e1b6
semantic_categories: [truth-values]
digest: 18d2331df9eaac2a6b7e76e0aeac7cf5b6cd94c0e2075991d0766f5455438f85
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0b9cbe4922a621e2
chapter: CH-05
qa_id: QA-6cabddaf977c824e
reference: BLK-95bea7dff21c1179
semantic_categories: [truth-values]
digest: 240e5a1919b7ef21f85cfb59601e915d470052eda173af6d11adb7db223d4e8c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cf41b6dc5e9b25c0
chapter: CH-05
qa_id: QA-1a94d44b3ea7da36
reference: BLK-01eb9f65fbee8e12
semantic_categories: [truth-values]
digest: 820aa7bbc7df2481740456e99e61418766ce061067fa40195484435f3a3506e3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fe8e76892e6294ef
chapter: CH-05
qa_id: QA-6e0698928cbe2332
reference: BLK-5970ca9ef37640be
semantic_categories: [truth-values]
digest: f035abc240efabdf56f467aabafa676d5dad40fcf933aec5f6bca8684483dd19
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8dc77334c57d626d
chapter: CH-05
qa_id: QA-efb3c991c7ae03e9
reference: BLK-03437db7242e9e11
semantic_categories: [truth-values]
digest: 618281db8f3220cca09f2ec8ab094fe8e5c859903e730a968587ca4c384b977b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-274e26dbb7f1a1cf
chapter: CH-05
qa_id: QA-b1d9854b9a77bc6d
reference: BLK-323678c5fae3b216
semantic_categories: [truth-values]
digest: 4bba4662b522e1a8084979a36e8842ab30726506bbc9f1f1b2fb1996760d6f42
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-844f0b917ab2269a
chapter: CH-05
qa_id: QA-c58ab67e7cf0e5d3
reference: BLK-36093a3541d6fac4
semantic_categories: [truth-values]
digest: a4043cc2aec1d56036b433aec1bb0f10d636332a2872be7308b3bb4d47987eb1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1af53ea075eafbfd
chapter: CH-05
qa_id: QA-ed8fe032e8731ada
reference: BLK-9f58a11b445194e4
semantic_categories: [truth-values]
digest: f31764dff232de5eee1f47882d1443ca6e01e5c2c95bc73f76944c54f0de071e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6ccb0abc049021eb
chapter: CH-05
qa_id: QA-0e4b35e31727dddc
reference: BLK-98d4acbef290299c
semantic_categories: [truth-values]
digest: 40044247bd829e0a0a23b80818a1e06bba9e52bc67eea06c1acbfda0edba5556
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ef67211c93c3faf2
chapter: CH-05
qa_id: QA-0022ddcf46b2e7c0
reference: BLK-4b147b9e016ab307
semantic_categories: [truth-values]
digest: 3e718395f56ea0d8d8371b7356d156f8899361af46bcef8a16cf4135fe68b4c0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-782545381d28d175
chapter: CH-05
qa_id: QA-71c5bfffb7f698a4
reference: BLK-5110d5b6e76c6c72
semantic_categories: [truth-values]
digest: 508a6dc54af4511486c9fa49df823aa973745f2d8729b48bd96ae4833e548b31
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dbf141d48b2cda3e
chapter: CH-05
qa_id: QA-c94d95491d090d2b
reference: BLK-4f8b95221334c8fd
semantic_categories: [truth-values]
digest: 682704c2faf3b436fe2a57159af4998e3eabd47d96ebe974fcef1842b85c8766
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7f8b61822aa5ef3a
chapter: CH-05
qa_id: QA-19f7f32da12b2aff
reference: BLK-b93a0cab2b781de4
semantic_categories: [truth-values]
digest: 1856eb7beb22ab9edba7901cee93414ae4d1d309e9f71f95e70079fd53d0919c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8ca333be2fb5df07
chapter: CH-05
qa_id: QA-8f6a96c77fcb2c5a
reference: BLK-f1886568bc74ebd4
semantic_categories: [truth-values]
digest: 154734b4026590481b163d304f4fbdc6224ffa07b18f33554b500918a6854f6a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5ae5165a89d86a9c
chapter: CH-05
qa_id: QA-6d024eeec7f5595f
reference: BLK-1f946628820928af
semantic_categories: [truth-values]
digest: b8ec1ebbea09234bb2a2c14798e8e2bc785241f5e950a13a5c4033821f12ef0c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-293cf2e2ae76c0d2
chapter: CH-05
qa_id: QA-51e540c00510b90e
reference: BLK-17b123b1fff6830e
semantic_categories: [truth-values]
digest: 7c1f86320f7e8303d8576c9d5505bcb6b929c56150858414d50e8e117c162559
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fe377f403a1ce895
chapter: CH-05
qa_id: QA-93744388b7a34b8a
reference: BLK-9f8bb9e36136d01a
semantic_categories: [truth-values]
digest: 8ea3d272c5eddd182a7eff7720b6cf822a6d6d3d51592ef184860fc10865b529
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-45774e8f7e45cc7e
chapter: CH-05
qa_id: QA-230c5b6e36990d45
reference: BLK-91a7da1dc4599199
semantic_categories: [truth-values]
digest: 84d95e4d3274741d64a416861fcbaa3859ed5f6509ca384ee4a8237eb2ff4456
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-04e011989e7fbaec
chapter: CH-05
qa_id: QA-83975613dc20ffb8
reference: BLK-aced02aaabc583d3
semantic_categories: [truth-values]
digest: f5cbc855c429fcfce5aceb0a587250ae80c92f08407f44a8a0f51841e503814c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-339081fa09698d5d
chapter: CH-05
qa_id: QA-07ac391ab4c017af
reference: BLK-7e8468a95010fff3
semantic_categories: [truth-values]
digest: 2be763a8994885f24e7ccdfa0b4b9b26cb5ba241720c043c08392ec39adb017f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3a54c3a28de2ecc5
chapter: CH-05
qa_id: QA-fe4cf1eb53910b75
reference: BLK-0c67765085ae094c
semantic_categories: [truth-values]
digest: 8ae1c5b06b9edfafc8e8c834d38ca8c752457a87b2b506db2e1a44b01a89e1e6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-41d766e6d3af989a
chapter: CH-05
qa_id: QA-88db14d6e7edcb58
reference: BLK-c7e05fd3fbe19ba7
semantic_categories: [truth-values]
digest: f9502553a1dad7ca1f5c9e2ac6180b3b59cc6d94202b834db0f9a6ece6bad36f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-68fb042f7b9b613e
chapter: CH-05
qa_id: QA-23dd86419156f9bd
reference: BLK-1d62064b846fefe8
semantic_categories: [truth-values]
digest: 38242ab7a04ba6e5f3d2488707a0d287f911161e02fbd99088874841a11a8192
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e754de0264f51168
chapter: CH-05
qa_id: QA-2474f711f79e4e3d
reference: BLK-1f0979248041848f
semantic_categories: [truth-values]
digest: 16d864847c04f876cce57c5a8d3e48d2f445d8b4dede0ce94c6e214693559908
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-027deca3e8f3d823
chapter: CH-05
qa_id: QA-158a183c54e375cd
reference: BLK-4f352c6a1c6b58e9
semantic_categories: [truth-values]
digest: 90f2c11fa7ad0d4b541374d07aa29cb01feaad6cb2124beaba8b0019d41b49eb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1090473f609d0940
chapter: CH-05
qa_id: QA-41e47f4d00915f5b
reference: BLK-f214eb556e8a953e
semantic_categories: [truth-values]
digest: 365697753b43e45daa3638fd9888cff090d9994574a68f6bf221823ec97789c6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1cf54c6542d0c7d2
chapter: CH-05
qa_id: QA-916225d51ea75cc7
reference: BLK-0275e80b2c04c6f4
semantic_categories: [truth-values]
digest: a85eae6f31d139984eb6bf913529180e518921c4f439cdb278bfcc7507239e81
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7b4ae0e55cfa3b40
chapter: CH-05
qa_id: QA-9ee575202b331c74
reference: BLK-52d1864741c9bdce
semantic_categories: [truth-values]
digest: d126b96c8ba4dc4d3769c13ad0ca8422fe54a540ea69a846edb516a168422e8b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-14053a20b263b4fe
chapter: CH-05
qa_id: QA-78354af1db10e924
reference: BLK-d809a65103391f7e
semantic_categories: [truth-values]
digest: 8dc5ac365be4f8694aed380dd1c0c947cbd58abfecbb1752d4d39a73c0eca325
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8d8b5e7b39591867
chapter: CH-05
qa_id: QA-067e3656e0919977
reference: BLK-44848643a647fa46
semantic_categories: [truth-values]
digest: 1fe068cab708fce374b744dd5de8bc9de18659e41b6faef19beec8208b74b3b3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ee2f6a2d33f3926d
chapter: CH-05
qa_id: QA-d41cb063c3787ca1
reference: BLK-da20c90c9d182979
semantic_categories: [truth-values]
digest: 3dbd00d9d0f3adf4244347d524142fe72b03b40fe0fda292dba06bc83fb4b183
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d40a91d44a4b6c50
chapter: CH-05
qa_id: QA-54cc57d430fefcbc
reference: BLK-fd859354759e8d82
semantic_categories: [truth-values]
digest: d2a49ec316556f92ef428ce0656585a02259bb015b415638a195e3d053ebf0d0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e7367d210cdbfdd3
chapter: CH-05
qa_id: QA-93ee953baa7b1e99
reference: BLK-eebd69b192e04b25
semantic_categories: [truth-values]
digest: 811b1e86ec3d37b344fc6a69b85ad704008a7b9371456f49be2feec01ed55f76
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2448e4e92ba05516
chapter: CH-05
qa_id: QA-d5b7edb3a6d5ca9e
reference: BLK-22cafa7883ad8583
semantic_categories: [truth-values]
digest: ed8020dc80af3df16751f852166a580d6ef98b15a2fd7ff53938c4c8b46e74b4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9f591cfe8a66339e
chapter: CH-05
qa_id: QA-b53a2736a52126da
reference: BLK-9e2b48aeaea0a3b0
semantic_categories: [truth-values]
digest: 16741b3042528b5b0ad02be9b340c8e7c3656c7c98d32f7971c05b9d6fa5d5e3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ec337ab8a43fc368
chapter: CH-05
qa_id: QA-7fc0f92a44aaee63
reference: BLK-088670189c3d74cf
semantic_categories: [truth-values]
digest: b855d77df7e098aa1364f92602376be535651b953ce93b5d86d64ef9f52ac947
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-37dc0c659eef2dd8
chapter: CH-05
qa_id: QA-43d50476e05144ce
reference: BLK-3bd9a709d1537f2e
semantic_categories: [truth-values]
digest: d4a00ea4a6d18eb14ff2e440d075e50b0e7a7db45dcba11fa6228d97b4c1911e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b231ddce4d115072
chapter: CH-05
qa_id: QA-1b4ac2f49d686140
reference: BLK-dabc7897b0693fc8
semantic_categories: [truth-values]
digest: ad1c696df06a0fc7cf7c06800a5fc522e13a3743d5e131d776b8a9161f6314fd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2d13d5c5f9d18f45
chapter: CH-05
qa_id: QA-ba30bb10bd95dbd5
reference: BLK-170f2a1e591e04fa
semantic_categories: [truth-values]
digest: cb6316156b4d12175c74a5aa6ab8dd3ab666e0f70b26b287e75b6cc30c0d0b7c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-888bf43eb9cb30a0
chapter: CH-05
qa_id: QA-9d347474a348f726
reference: BLK-a04d8dafcc0fa4ec
semantic_categories: [truth-values]
digest: a8cd7fd69101c22ae8c00f093c3a95f59877a7024d70aa20c8389349e89c30eb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e38db748880e8923
chapter: CH-05
qa_id: QA-d755b798b89263dd
reference: BLK-8c0b2ddbd669fce8
semantic_categories: [truth-values]
digest: 44a353091858ca5cb0a1d62c0fab595daaf6fdc0bb8e8d79d81281235e1cd1ab
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1252584d8f572ec9
chapter: CH-05
qa_id: QA-ea828ab3f58ae86d
reference: BLK-25b1b7cd937cb1b3
semantic_categories: [truth-values]
digest: 56e02cfced8f65455393c2d475266a4731190d9b9579772a5d9ed65db2e715ab
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a671a7e7b7470376
chapter: CH-05
qa_id: QA-8e500ccefa48d472
reference: BLK-5893372fbb305323
semantic_categories: [truth-values]
digest: 7588cdc2c2d574ab6ec1d0fd9a350073808eda12e5fffa2f4482f609fab80867
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-82eec58dd95a661b
chapter: CH-05
qa_id: QA-56b14a67236e742d
reference: BLK-40bcf556b793fb46
semantic_categories: [truth-values]
digest: 4713f80e176dc086838ea72d71f5fd1a9ab138a556451a3e166c755fc574ae33
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-18fc26c72c33d308
chapter: CH-05
qa_id: QA-7ec26db0a90e58b1
reference: BLK-a50a80fdc1c25566
semantic_categories: [truth-values]
digest: 3f5b84d783810db63ba883aa9cada517b515073e6d8f88060c5c39293a578593
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ba336895c17933cc
chapter: CH-05
qa_id: QA-6fb3dd48d7aa6fbb
reference: BLK-92e3fc7d804a2808
semantic_categories: [truth-values]
digest: 382c64362df1d3dbd87889f74346dc6092d44abd502a33c47ffcc1ed5f6e982d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-176df6e5e7b826fa
chapter: CH-05
qa_id: QA-08a943a671307262
reference: BLK-7bf0cd27ee7a741b
semantic_categories: [truth-values]
digest: 11ae03efee3ded586e3642bc2569cd5e0b019c0e5ddda1c3ef27bf2c1eb1fbb6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7a4832c023c23cbc
chapter: CH-05
qa_id: QA-aa958d1f4ad950ff
reference: BLK-bf0bc41d6b2d1316
semantic_categories: [truth-values]
digest: e152790f915db88fae7ecd706a264ade00cc6c4d92d5d65bbd1ec4ec234ef5f2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ebb8f7858ff58d8d
chapter: CH-05
qa_id: QA-310ab848a83e919c
reference: BLK-c8affe0478937bf0
semantic_categories: [truth-values]
digest: b6c14a7f44cfdb0a64be6281fbe6f9b6d765352321aeb7c7e258658a363f495b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a80d7f91cbaf035d
chapter: CH-05
qa_id: QA-946afbaec3ac789e
reference: BLK-b205c1c7c5b4d6cf
semantic_categories: [truth-values]
digest: a41098b491b3dfbd04a103c1f2b2486d7f80eb3636008db675fe146c1c73028d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e027e5135d442619
chapter: CH-05
qa_id: QA-8c901182c630c10d
reference: BLK-6ff4f186b7b2630a
semantic_categories: [truth-values]
digest: 2d7f6e1b10439efea9cd2d98aeaf6fdd69bc3819c3f7989ecd3bbbaaa4a00d0f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-311ff9aceac9e3a1
chapter: CH-05
qa_id: QA-4fddda21433e3be7
reference: BLK-af94401090888bac
semantic_categories: [truth-values]
digest: 1a565e9bde55ef3c600d998e5f4ebc08415e45e88e0a42a908b54caf3f00605a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-13a4ab2c25127825
chapter: CH-05
qa_id: QA-d0b72bd59e0f89fb
reference: BLK-3b7e4e77e5997407
semantic_categories: [truth-values]
digest: 7948d806a33fbdf4af3e9c34189c5c4ff00f24c6e0c0451e9a027d76b4179907
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a4f90eaff96b6abe
chapter: CH-05
qa_id: QA-8e0690562aa01940
reference: BLK-37ac9c46cd3b8691
semantic_categories: [truth-values]
digest: 56559a3af68afe4032a9b684ca5aad48297e699d5d3029913ad3c25ae9d1c6ea
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bf61b0d2e3241d89
chapter: CH-05
qa_id: QA-2ddad2af5c0c8aeb
reference: BLK-0df20cfb2ff67a77
semantic_categories: [truth-values]
digest: a5e7b3917949f1496857ddd4ec9e5b694d98e31702508e133d6cbbb1a68fb80a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8fa4edad12a79e57
chapter: CH-05
qa_id: QA-f331e67879837fdd
reference: BLK-22d542254fb4e430
semantic_categories: [truth-values]
digest: 4f44a2c75188a3376e8a11798ce5e1e0a4085316f659bc1eb992696fe0c911aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-31eaddef298d7bb5
chapter: CH-05
qa_id: QA-2923bd67da16f2ee
reference: BLK-75f34843f2caa056
semantic_categories: [truth-values]
digest: c34d8e029f180f0ac9a33894405d448bf0cd17d7c28c94f9561ad1f63d848a71
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c72f59c058fb4879
chapter: CH-05
qa_id: QA-13f6107062e3d0cb
reference: BLK-42bca06a919a5ae8
semantic_categories: [truth-values]
digest: db0c6370702cb06536a02a3eab5eba04e3003ed0037b8b0616db749cf5419080
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-074f33d2ea902914
chapter: CH-05
qa_id: QA-9ae9d0a155a32194
reference: BLK-2a123209b43ae5ad
semantic_categories: [truth-values]
digest: f23b29c76ff26f4865fc54c2b4aa13df8fcafe6e0aee02d9abca70ef56a26746
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-950e2b7a3e63688c
chapter: CH-05
qa_id: QA-f7d651eb7449a443
reference: BLK-89b0fd99072a7ad9
semantic_categories: [truth-values]
digest: 5cbac4a3b26d1bee062557a0e4ec828c85bf6fe80fa7b9f20729899e21a3e138
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ad571c628a6a88ce
chapter: CH-05
qa_id: QA-48dfe833809edf65
reference: BLK-d9889415e47b56cf
semantic_categories: [truth-values]
digest: b2ae97b850bf901dabca88753fab4a1a444d3b25713baad4efdd4a6e141ffaae
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-129cf5eeb3560c41
chapter: CH-05
qa_id: QA-55c729936adfbae5
reference: BLK-1095ee34dfae7aed
semantic_categories: [truth-values]
digest: 48d6c9f3f0e8c276f7b7d2221f6302e09b2d8f6baa240061824aabd68bd0735e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a33d834238b7fa4d
chapter: CH-05
qa_id: QA-055c3ba144d88ff2
reference: BLK-fb39667760c12b4c
semantic_categories: [truth-values]
digest: 4fc7b6ffc836d93c8410ba418c41cd191249e032bf509f10135e85bfe29a2d81
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cf502a12fd301b91
chapter: CH-05
qa_id: QA-7b367fe3adb925e7
reference: BLK-0d4a08a0bff4d6d5
semantic_categories: [truth-values]
digest: 2f2ca0dec2bd0e0bb91dd5a1b8ce90398d8b30d524889b912a90fd7a07bfb862
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cfc6904b962ccc93
chapter: CH-05
qa_id: QA-e7e4a1492e338518
reference: BLK-e1788d332fd4b6ad
semantic_categories: [truth-values]
digest: 5aff33cf3992aee0910c860cd55947f734b42c5bf8742750ab39d6f7302f6a3e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2df760e326456f7b
chapter: CH-05
qa_id: QA-5512c3dd4ce67432
reference: BLK-abf7fb28b77ba86b
semantic_categories: [truth-values]
digest: 1387ce08f119aae3cc7a368fc5a62c8c2b859a57b4a0e1975c52af006c53bcec
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c3c3066ab442816
chapter: CH-05
qa_id: QA-166efa817eec57b9
reference: BLK-e61c1e6a7ef98607
semantic_categories: [truth-values]
digest: e8997d967cfa459a2ee403ed7fcfd05bac97e86cba57b5ed1336c076fe8082ef
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a772c354f2826a7d
chapter: CH-05
qa_id: QA-90fbeab18caeccd0
reference: BLK-9de1de98fdc727e3
semantic_categories: [truth-values]
digest: 9e0377b53979bd572f7551d627f0b1161792cecc7ff85681e03c37b227382314
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f43f8069756e9e00
chapter: CH-05
qa_id: QA-96a97622afaf7c7c
reference: BLK-98bcb77cc1ac5811
semantic_categories: [truth-values]
digest: 6af7802b2ccaf57c4b4fc56507202d4bfc69709b3120a2370b673029c413d0b9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ff2855d6fedb3f60
chapter: CH-05
qa_id: QA-8da90b3ad2faba1f
reference: BLK-36aac4923d6e8a11
semantic_categories: [truth-values]
digest: f2ffb72e6de735ffd18857d63c630d5e5dcd611f8ad81da13964819b29ec4b09
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f993e4372f81e203
chapter: CH-05
qa_id: QA-ce9f6c3e02e767e5
reference: BLK-8cc9eedcab25fd2b
semantic_categories: [truth-values]
digest: 23664e35404458c632a9621e65d03ab714c092f4ae423c8d5248027e3a04a102
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-abb76db82c236269
chapter: CH-05
qa_id: QA-9213fcfc7b78fa1d
reference: BLK-7723dfb7493646b4
semantic_categories: [truth-values]
digest: d529be2c3b540d484d68807a9626d0e790c882163b427466d4fb45d95d02e9c0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a6e74bb5f471da1a
chapter: CH-05
qa_id: QA-12544b627abf7498
reference: BLK-629475ec5c0d3bfb
semantic_categories: [truth-values]
digest: ed29b06e10a379714f6fb19a7179c577939bb9b59d673d20da6a0be5811ea911
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-66670bb256fdbbfb
chapter: CH-05
qa_id: QA-37f1642e10b42144
reference: BLK-93ad46a2fdd8ff11
semantic_categories: [truth-values]
digest: e02b8f33a65012042d082c53261450324145657937c3c2462b7cefe185166fb8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f5ba5cce085f8a59
chapter: CH-05
qa_id: QA-453374693e02d4b9
reference: BLK-557953aa35227612
semantic_categories: [truth-values]
digest: 3a1f5f6d3474791ecfda9ad68be4759500f4ddd3b3d56c30142227e98e094701
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8197db3042206756
chapter: CH-05
qa_id: QA-31f8f023fd6cbf44
reference: BLK-22b57961d600fe2f
semantic_categories: [truth-values]
digest: f123200a01373a2175bca98910b05b40057b8a035d73d6c688a1757391d3e0c5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2c7659fb5a9fe7b4
chapter: CH-05
qa_id: QA-d931696d3a84f564
reference: BLK-f3b1c72ce3eb55c9
semantic_categories: [truth-values]
digest: dfdaa8726034671fd1da471dc6f575d94d23b15a1f7a30040343c4a463a3615c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a69f6a9da8d815a9
chapter: CH-05
qa_id: QA-b7ee5539b0ffefe9
reference: BLK-52537d28f7f19d80
semantic_categories: [truth-values]
digest: 1fa2ef96ecfb254c9e17f7301704697379e19f0721d37d6bfbb10fcc992899ac
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-703cce8d4f0dab00
chapter: CH-05
qa_id: QA-778bdc3950bf8adc
reference: BLK-2a74bde34951ff9b
semantic_categories: [truth-values]
digest: ed93947bd45e741647879507eed5bfbea0e554c0d02cac155991bc4a8d8bfd85
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-603b3e8e025cbed8
chapter: CH-05
qa_id: QA-f3bdffa65dd744b7
reference: BLK-85e73235529b5c88
semantic_categories: [truth-values]
digest: 33cdf89cb46639ab837e98d11bfbd38f59f06f651127aa04902e649b4fc46596
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cc2574ed3dad4434
chapter: CH-05
qa_id: QA-2a74715573c7cc8a
reference: BLK-c6e81d159f73459d
semantic_categories: [truth-values]
digest: 0cac784eac71a2ff56df6cfa43f59d91300bf3eadbde74cfa7c869fe45ee6976
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f8b259c90f9b292a
chapter: CH-05
qa_id: QA-eae047cf035f079d
reference: BLK-8237d2a05c87c232
semantic_categories: [truth-values]
digest: cc2856b632eeb4d08154c8ac040b0b786abe4a99d28e3b410a68e133305fe9f3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b2817e54d05fc19e
chapter: CH-05
qa_id: QA-4a08b656d33fe129
reference: BLK-c15df4c67851208d
semantic_categories: [truth-values]
digest: 8011e9a5a823c1f58761754cf53334dbce87240ce0bff67de098f2f96762bc01
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9a715a19ae63a55c
chapter: CH-05
qa_id: QA-fa3c0a1efcab4769
reference: BLK-62c2e97c399eb38b
semantic_categories: [truth-values]
digest: 061ebf2f66a7faee2b0fc4638a9f1738b70f2f79a79be1378a1ca6086c777363
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8e93be3af52f4dc1
chapter: CH-05
qa_id: QA-ddbb48b91a695fbe
reference: BLK-a6bde4c24ae6370c
semantic_categories: [truth-values]
digest: 17f36af68784ecec21f7fc8c2356472ba3ee2366e7e8d880be6e26fc278be63b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b9a27fbdc7f78912
chapter: CH-05
qa_id: QA-e383bc6221d4699c
reference: BLK-25cc50c2bf8d6039
semantic_categories: [truth-values]
digest: aa36558d8f67f46ccfe08394fc336929529d6a4ba392f7e4b43b6c6987362379
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5c87ef6f29c475be
chapter: CH-05
qa_id: QA-1845a6ee4af41f90
reference: BLK-721972a19dbe3e46
semantic_categories: [truth-values]
digest: 4dedf8e6d59b2017587a4518594fb69533e8237401d9dc8b774ae67afea99f5a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0976e893cff3c975
chapter: CH-05
qa_id: QA-5c821a2a9880b0c3
reference: BLK-2105253d138563cb
semantic_categories: [truth-values]
digest: b32db9d22c20e23f52a618003d88678d9dd4ed99031f7a390d44ef77e81bb3f3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a77459d8f677dfc7
chapter: CH-05
qa_id: QA-3b3ed9f767458ac2
reference: BLK-f78bd271000af25a
semantic_categories: [truth-values]
digest: 544b9a4aaf7ceaaa62062f7a5e389702508d257284b01800d2b72fa715f087cd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6a399fe71167096c
chapter: CH-05
qa_id: QA-ec67cae083515342
reference: BLK-6d542199f9475a27
semantic_categories: [truth-values]
digest: f71536bfaddf7b86825b5ee0ba0d05dc53496cb45ef203e7ac7f84ab67dc2523
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-40aa36eea6208007
chapter: CH-05
qa_id: QA-4f3943416ee9fb86
reference: BLK-5851e4a3db9f9ac3
semantic_categories: [truth-values]
digest: 00a9226e755938f12333473c7edd71341ead5579b5f3034aa7586824e780e939
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bd2acabdc44bc9dd
chapter: CH-05
qa_id: QA-7bc10090d2891abc
reference: BLK-2467bf0ffb43ccb1
semantic_categories: [truth-values]
digest: 36dcff34c5479fda386062123e66c9b62fe6503484371f15ba05142a96e437af
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fa1243e22171cffc
chapter: CH-05
qa_id: QA-77d89648fb405055
reference: BLK-e4f27c62a91903fd
semantic_categories: [truth-values]
digest: cf854cf7b07ac78b3117df9bf2dc71c8cb40326d6e5d05f4359b603f65d9b065
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fd55b072db204a0d
chapter: CH-05
qa_id: QA-f18e134d6c43fbb8
reference: BLK-4510e9e029402fb5
semantic_categories: [truth-values]
digest: 9e947594c7f04950df0654d887a89c55ec9f9e2c2cfd80e0287edf8a139a3a89
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e141b3e065934209
chapter: CH-05
qa_id: QA-164684966c3f77eb
reference: BLK-fe080225bb5195ba
semantic_categories: [truth-values]
digest: ebaa4f28e49050ccebf194079114a04ca08bab4cecdbca68833eef2749d83c9f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b1f95d6918f062a8
chapter: CH-05
qa_id: QA-40771e275944511f
reference: BLK-7b0b481d4c3ce520
semantic_categories: [truth-values]
digest: b3644ead2e5f4721d83b87ca4831ce57823a0dc53b46589e01da9f7f1250c487
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3150b9472d35b19e
chapter: CH-05
qa_id: QA-708db86afd27a59a
reference: BLK-da85b2ab78e71372
semantic_categories: [truth-values]
digest: d5c2d94ce19bfb42a6b16fb8954aa151bd786f6c7eb749bef9e27370182f9690
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6d750f783d5b297d
chapter: CH-05
qa_id: QA-554398d9655e4fa5
reference: BLK-980b341fb19bb54f
semantic_categories: [truth-values]
digest: 6e332c6a863fb737b3b287aac800df6d198518ba0b69dd246ed5b4da2c7dad3f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-93d0c1988c305626
chapter: CH-05
qa_id: QA-7e9be9e4acf051b2
reference: BLK-aee13c5bae097378
semantic_categories: [truth-values]
digest: d500c3300cfed56a0826cf3e46e933ed3be8fa23e25be1e47da085ec1eec05b2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-40b035295829c84f
chapter: CH-05
qa_id: QA-5059f2c560220895
reference: BLK-0b8df7beeb5c08e5
semantic_categories: [truth-values]
digest: 051f4b636878178efe760a5c2da9a72fbd4e62cb6c34f931e047c60f1affaec9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-89ef7c4ed5e0bff5
chapter: CH-05
qa_id: QA-5df7f0fa020a3829
reference: BLK-f1a56ec6ccdf9d8f
semantic_categories: [truth-values]
digest: 94d37f338e5f12d96e88fa7d662f6b46f21eddebbab5a460aea604a75450b3d2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ce4eaf8c35953a0a
chapter: CH-05
qa_id: QA-bb70e6c832065f7b
reference: BLK-537801bd1cd367b5
semantic_categories: [truth-values]
digest: 29978e864afbfdab1c362d4eac739ef9d2de54786238c1e7d749f5a0883e8ee4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5b49253bcfa2a0c6
chapter: CH-05
qa_id: QA-b401d77085f3dd31
reference: BLK-fa854a9140894ca2
semantic_categories: [truth-values]
digest: 16b8a28c288f7a7efbe929502a75c2680cdc29062f520835d00d9365ccf94b54
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-be98e0a32357f850
chapter: CH-05
qa_id: QA-2437a7e287c15f1e
reference: BLK-a57fac63b249febb
semantic_categories: [truth-values]
digest: f69b83c54aca2013531c7c338d5cd47ce2008ce73fe47ede121e113dfee585e8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5edd068fb7cbb93a
chapter: CH-05
qa_id: QA-36ba5d7ac8d87164
reference: BLK-b3c956e83dd2d9b9
semantic_categories: [truth-values]
digest: 6312a81493b360de9c5be9b385cf4a876610d1e99fd79730a262eca48fb1c7db
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7abb6e34269810cc
chapter: CH-05
qa_id: QA-5103fc8bce6dcbc5
reference: BLK-ed251b560e4430b0
semantic_categories: [truth-values]
digest: 6d7785cb1179aa9243a952ae49f0dd7e87264566d8db7ff06c5ebc6bc27355c9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b21c9b52897932e6
chapter: CH-05
qa_id: QA-35c7121e43ce570d
reference: BLK-f47d37f0ebabc839
semantic_categories: [truth-values]
digest: d184b3a427bd32c33481bb420d2917bb557241342fcfe8476307c697d0d4a29a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3346553405938411
chapter: CH-05
qa_id: QA-39ab7d91c61359da
reference: BLK-f2f11d384f628fdd
semantic_categories: [truth-values]
digest: bfba5b02959fb8f0196cce1f3e2e9b7fcdb12fd05edba4e40eac4eadd78bae29
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e1da9f26fa0aa587
chapter: CH-05
qa_id: QA-6fde3da2415c360b
reference: BLK-2fb586d6bc481c5d
semantic_categories: [truth-values]
digest: b5e9b8e0292aa9707c7f15d861b2bbb290f69730c57a63c96afb228e17a76fb1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9f11327863505162
chapter: CH-05
qa_id: QA-1a81b772abf82d43
reference: BLK-7834e0c249b42a27
semantic_categories: [truth-values]
digest: 8aae1d13355f3078d1b0fc787f2bf76e84cde2a877d7953e06573fcc128aa67b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a2995be136bb6cab
chapter: CH-05
qa_id: QA-69a8da5a3c771184
reference: BLK-a43afad2bf2ed56f
semantic_categories: [truth-values]
digest: 8a249c20d9cb7df52c7005011773cd37740e3153cee851f5e0c430953a67c0f2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-05d617332267c016
chapter: CH-05
qa_id: QA-db6e75ed8fbba5e8
reference: BLK-12a6c33c25aad45a
semantic_categories: [truth-values]
digest: 481b5edc80a364439acd592764a23eaec4cae873869f9fa46223c5d57e6a03ef
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4b4900b0d07a417e
chapter: CH-05
qa_id: QA-01c264082973ac82
reference: BLK-ee543555b43f4c19
semantic_categories: [truth-values]
digest: ae1e3c8c9299f94ca644edf12e99de5b9125ae8ee7db0c0a30caee053e3637d7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d547bbfebafce249
chapter: CH-05
qa_id: QA-3f96b592c409cc88
reference: BLK-216d33dfeabb69f0
semantic_categories: [truth-values]
digest: 158463f7f34e7a42be5c979a8cfda5d8d182f88ce7356112b459781207f76d93
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b0355c6a832ccdb3
chapter: CH-05
qa_id: QA-c0a6fe303f243f78
reference: BLK-72a460040bb5dc02
semantic_categories: [truth-values]
digest: 5b2cbd8307ff2abb6abacfc2b6f025893aa281576f83252f02b437e99b37853c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-96d3b07b9ce5fa4e
chapter: CH-05
qa_id: QA-fa6eb603dd701397
reference: BLK-3418174c65cc2e6b
semantic_categories: [truth-values]
digest: 4a4641bbd10aeff28b448f1b18396eac01e41e69e2e466aa086a79e61e317d9a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f0d3462916089fb9
chapter: CH-05
qa_id: QA-d1480a5987724f91
reference: BLK-b114e264b1a95140
semantic_categories: [truth-values]
digest: 6afbffca7a3eec3f60114ced056db882e9e504facc07a5cd0e469675097ad7c8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2ef876a728ed53d4
chapter: CH-05
qa_id: QA-b4901cefcbe24c7c
reference: BLK-f8692f6179728f8b
semantic_categories: [truth-values]
digest: eae08f40d4a911bcdebdde9b7ef29c840d9cc5e3d1014f7533f8e650c4a8cc6c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-596d24b493a272ba
chapter: CH-05
qa_id: QA-445a36b6e6adef8a
reference: BLK-ae51cdad26736c7b
semantic_categories: [truth-values]
digest: 111d27b4f0b4842a861bb0c8c201b5ebce76d429aeb964d6164e14a81cb5f4d5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cf2b2bad3ed3fd32
chapter: CH-05
qa_id: QA-2a558e23be8fee91
reference: BLK-00e38f5a2f7efa75
semantic_categories: [truth-values]
digest: 758e0b63c4ad102dcd2afc48af36d9efb54e70411ee2ca35ef2b5ff75261595a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-acf71f4e677b9901
chapter: CH-05
qa_id: QA-bbd2ef656f2bc24b
reference: BLK-a8d9de9cf30c1fc4
semantic_categories: [truth-values]
digest: bd29eb9e2260fea1e6214923a7b830e965bcd971365daf6820981a00f9f24644
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2936083da4d620ba
chapter: CH-05
qa_id: QA-88508d1807ae6b02
reference: BLK-b4984dc6c3976f8c
semantic_categories: [truth-values]
digest: e2092ba529cd5d9453b2ba7d06536908176b8abd55121f426d000010975237f1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f665acecdda05ad5
chapter: CH-05
qa_id: QA-c8c8f8ba5f8fd5ea
reference: BLK-2fefd1ebc0822d3c
semantic_categories: [truth-values]
digest: 106cd8e4aa2ee36802c6a2b63ae071b21bdf3ca00b8ab31919ae962b40051b42
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ec66df5dd7e3bbef
chapter: CH-05
qa_id: QA-bab4165ebc7dc5c6
reference: BLK-cb3db7a529ef9313
semantic_categories: [truth-values]
digest: 4b493aa21e72c94f71e04a658a3ae5dfb57a4942b1f1db49b94d4cf4d7c1a87c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-892d7cb326d64d8c
chapter: CH-05
qa_id: QA-cdb9d8b209d1bd04
reference: BLK-1b920d632bac61fa
semantic_categories: [truth-values]
digest: 1715047fbbb468f6aff68802808693dcda38c9bd84ecb64aab2a1902d8c70f43
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-50ca3431e28a764d
chapter: CH-05
qa_id: QA-dbd5fc01c7bf3f34
reference: BLK-8c6da53a0dea320a
semantic_categories: [truth-values]
digest: 5f865378c2b23fd81bfbcf099e35e0f632a5dadd07c7baae176968979d86d9f1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cc4f4a19f0c0f918
chapter: CH-05
qa_id: QA-1202f8c725e05d97
reference: BLK-1a8bc26591bda96c
semantic_categories: [truth-values]
digest: 7bfacaca47ebd3f6ab0577808d4ad61d2689cdbe4f3fa764ffa1191e49402708
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8507653ab2c9b357
chapter: CH-05
qa_id: QA-c812281398113b5a
reference: BLK-bc9f823fd5cedebf
semantic_categories: [truth-values]
digest: e83f5625d2743ed1ba5fafc9f46aee0447d25477a89caaf4b5082b0bf80f95e6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ef0be15228862c03
chapter: CH-05
qa_id: QA-4c303cc57dd371a9
reference: BLK-e8ea5973a9c2c4fa
semantic_categories: [truth-values]
digest: fca8091b2ff92d51b5d630739f114b3e074e560106e7f79c2f2832783748a160
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9a0186fb7811150f
chapter: CH-05
qa_id: QA-4ef9b468885df972
reference: BLK-d8d63540cecf04c9
semantic_categories: [truth-values]
digest: ac4eb6c5868128ebea87e5573c561fea01c0514bd7f62200941c11ff80c7bb0f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6657967e88f5d4da
chapter: CH-05
qa_id: QA-c8037841ad5b387d
reference: BLK-a733b1236eb837cb
semantic_categories: [truth-values]
digest: f0674e712f3b209b229a243874f1565207355254195e0b0eafaea282f6ca5528
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bfbb1e5080bb4918
chapter: CH-05
qa_id: QA-cbc5d13ddf8ad0f6
reference: BLK-3ab344a17a6684a1
semantic_categories: [truth-values]
digest: c98605b1eab022c230c5b8aaa6b5843105a6446ea9973dbd8a9015670adf7c85
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d2a64b337d0f3f89
chapter: CH-05
qa_id: QA-959b13783d974315
reference: BLK-82a0ab5d24aee213
semantic_categories: [truth-values]
digest: 75e8b7e17363efe809f10845638215d9cb4869a85ab0e7badd6a4bd0fa04ccc5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-181326e37a7ee47e
chapter: CH-05
qa_id: QA-c967827e07e94bab
reference: BLK-b18ce5c52c9d7ec8
semantic_categories: [truth-values]
digest: 5978220cd1c0f2778bf5d10a1e1e4274eb415a84c5d3f539504cfd94b70f9bc4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-88392adb0f7b05b2
chapter: CH-05
qa_id: QA-560eeee3d284f98b
reference: BLK-ded8c7f03a6d2763
semantic_categories: [truth-values]
digest: 40be08f5e000fdeedae80e7b38f00ddb75dbc802a56192d7597d6d01dd4e8586
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-91dbf67fd86a023e
chapter: CH-05
qa_id: QA-74ff7731ac646a64
reference: BLK-e47c0f553000bb39
semantic_categories: [truth-values]
digest: 6c3847382980b9d7f4bd2de5d583bc0ed0a1270fd70cb9a26a3fb851977b06ce
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-97e61127295d7011
chapter: CH-05
qa_id: QA-d792811507566bf7
reference: BLK-7c6331f584245e6f
semantic_categories: [truth-values]
digest: 2fa64545464e1060c850ceff748e2a08a0bff8f9a9fff1ce7f650cfa644a5a68
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f85067da795a5d68
chapter: CH-05
qa_id: QA-7e68a27a68c09d32
reference: BLK-6f609bd8fd8f15c6
semantic_categories: [truth-values]
digest: 4fd04c53e2178a5e39509f80333297e4416cbdb5e476d6790c22d18404b885d3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b6eb8a4eab2c6d3f
chapter: CH-05
qa_id: QA-58102361b684397c
reference: BLK-86120ccbf9fd371f
semantic_categories: [truth-values]
digest: c7d3bc4eb38085006d47c1e0c31571fc8bd3d1125d8e85ef1060e4bb02317224
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-07853d202889f103
chapter: CH-05
qa_id: QA-3d97495cc969fa0d
reference: BLK-df4e849b650f07a7
semantic_categories: [truth-values]
digest: ee7b6b33bb442e0df5bc0e3df26b2a6f6817591320ccb0b7c4005a8e595b7c98
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-517677cd4cc0e822
chapter: CH-05
qa_id: QA-354fe350bcbba71d
reference: BLK-0acff6661b16050d
semantic_categories: [truth-values]
digest: 93094caa2fbd25bc18339cddc140cb7bf85f9d075c7a0e40666bc684ba154b59
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2e3caad5fcbadb16
chapter: CH-05
qa_id: QA-ae1793bca65e5ce0
reference: BLK-7cbd323bc9f94955
semantic_categories: [truth-values]
digest: 78a1509f237bd575c543af79dfcbef2bda2f06a87ce946723de2783d8e0f9a78
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-34c9b8785d29bf48
chapter: CH-05
qa_id: QA-84fac227471a48b1
reference: BLK-cf01220d4f2b5562
semantic_categories: [truth-values]
digest: 3f54ac6e989208ca11572d71ee1685b109acc8baed2105d44aebfddaef3eb461
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-89ad4d6d343bb481
chapter: CH-05
qa_id: QA-33748ee3d8d25fa0
reference: BLK-9bf695cdc0aa522c
semantic_categories: [truth-values]
digest: eace354ef01c07c179a5534974cdd1841c8c79eb7301094b4a2dbe83d1b09099
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fc6dea745b1fae7b
chapter: CH-05
qa_id: QA-7ec35a4780e41115
reference: BLK-8329ea621be0fbe8
semantic_categories: [truth-values]
digest: 77c0be1a42aebb2ec78e3ff1c5b99937d25b9472264289cd1911dd989f8489f0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ec822971b8400551
chapter: CH-05
qa_id: QA-836fd9e2415adb3f
reference: BLK-eab8babc80ad3a19
semantic_categories: [truth-values]
digest: 6d4263ce8d04673618f479a8a835bb0fee9b3e51ca90ca2c7469efc214e1ef0c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-735730a02ec5dbd7
chapter: CH-05
qa_id: QA-8724e0789f93bd89
reference: BLK-eb983ec34e7f2afd
semantic_categories: [truth-values]
digest: d2c18c5348456337391db4d97bd80af45b9b812d95a7d5207ee9294dfc9708bb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-02032f58f49375e4
chapter: CH-05
qa_id: QA-b32593bef099acb3
reference: BLK-87dcc1797078ce96
semantic_categories: [truth-values]
digest: 3a5116735652d1988bc799c59d60c3383c809eb5fd476ee79a19ae08f1e10ce5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-490b2b44babb83c8
chapter: CH-05
qa_id: QA-c7b00f1bb969d845
reference: BLK-38a3d8f94378e0d5
semantic_categories: [truth-values]
digest: 6207266a4bf03b846c0210b77c83f54f75231f638b91ffa3610706e457c27981
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ab2d41e9162dfb2b
chapter: CH-05
qa_id: QA-28a2de082c888619
reference: BLK-33daea6eded19bdb
semantic_categories: [truth-values]
digest: d41b77a8c1307331b2405b5282e07799490d484655f6a676ddf7973a60819348
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-447cea49a3ec425f
chapter: CH-05
qa_id: QA-c55497c15d95e42b
reference: BLK-716c7db7881919b2
semantic_categories: [truth-values]
digest: 979feea8c368c7cdf397028e666afbaaf53df53316927ff21e233b64f69283ab
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-094c8a8bdbf5218d
chapter: CH-05
qa_id: QA-3a87d7d23bf50a70
reference: BLK-3cce476e79eee5ee
semantic_categories: [truth-values]
digest: f740c0b11c9c06d4385f2c834703153cfc7bfb045f04ee3aacf71a150cf489b4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f9888deec98c15c9
chapter: CH-05
qa_id: QA-c3cb0387f29604f9
reference: BLK-be379cbe8b085069
semantic_categories: [truth-values]
digest: 6b05131861f9cc50ba2bfd14b69a7495ae9ae69fcb904e0c3b2be9649052a4a0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-36b1dcf0967eaaad
chapter: CH-05
qa_id: QA-e8b6bed4d5fc36ce
reference: BLK-8e340303a8cff7d0
semantic_categories: [truth-values]
digest: bd1a54c3f3720fb3838d701475ca2bfbf83e0f0abcb20efbd9a7914aa2b7be7f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b7aeb99e310fcfdf
chapter: CH-05
qa_id: QA-5b931ad1a2403573
reference: BLK-76ca8f44b0c02913
semantic_categories: [truth-values]
digest: 7e54ae00e9c48667643a39879a5f8959e89e921d31ec655eddf0c9d665bf87ad
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6e5c22788c84be8a
chapter: CH-05
qa_id: QA-912981117f710622
reference: BLK-67d5c6760b15e129
semantic_categories: [truth-values]
digest: 823052040ce5fcf667ab90f994a968b57612a0000e10827b5c81a30b1a84c349
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0df9b8b7ac3a2d88
chapter: CH-05
qa_id: QA-8fc48a2aa92b868b
reference: BLK-4976548b8700b298
semantic_categories: [truth-values]
digest: b844dae533b1f291913b8d802cf9565f11c63e3ed83b9b795fddf286d9bf9089
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f726e9d065578992
chapter: CH-05
qa_id: QA-408511080031f42f
reference: BLK-815e807463d05340
semantic_categories: [truth-values]
digest: 5dd2a3bacc9c7e4577931cb953ef72f540cb92f6ea1afa8d6be32c13da5b468c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f0e03f97d0a738bc
chapter: CH-05
qa_id: QA-db8e3ecd308e8dbd
reference: BLK-e18f935c97d3ec3d
semantic_categories: [truth-values]
digest: 4e0d9c71f5f42b7e63b1efb80f0697ac3a4ae16aadded16e5ecbf7ed933e57ce
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f25e697a6179e0d2
chapter: CH-05
qa_id: QA-2bc553d2bac93fb5
reference: BLK-2d0d11c237ce14cb
semantic_categories: [truth-values]
digest: 5831055e35f08b4ac44831ba4a303721eb2a6eee77dc093c71e09f07f95b14c2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6dcbb45030719ae6
chapter: CH-05
qa_id: QA-abf515b8767b21fc
reference: BLK-2a66a03314f167f4
semantic_categories: [truth-values]
digest: c1014ce06eef20574c638246488acc2cb30203b8ea3efe0f3820197c9afd4baa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-57611721c920c463
chapter: CH-05
qa_id: QA-08cff67c1e046e95
reference: BLK-94d881df8f040676
semantic_categories: [truth-values]
digest: f8a8bc523a0ed56450ca776c5220ffe447874bda696f8281c696bde25512d772
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4b0f8574fb53e2b7
chapter: CH-05
qa_id: QA-a8f9d52630ceb217
reference: BLK-226d4d54f908a22c
semantic_categories: [truth-values]
digest: dc1e9d7cbd979451115c637633761507888597bd9a39d4d1f5f615d1039e2d93
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-44ced37e9e2b92a3
chapter: CH-05
qa_id: QA-70bb1f77016f0de7
reference: BLK-ff682021c825f473
semantic_categories: [truth-values]
digest: 14fac32b298e6e68784cf008fb8b6cc885729a403ed9e57fdfb11e2fda18fc65
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a00a9b26da120890
chapter: CH-05
qa_id: QA-e3e9d94945d06dda
reference: BLK-262b6cf7fecd7591
semantic_categories: [truth-values]
digest: 2de95b5b7413c2e5728b949d5bf27e2d0e1b897a2cee7d472b1d8d6e9bc3e0b8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f037bc6e6a49d64e
chapter: CH-05
qa_id: QA-8e63febeb9572bc3
reference: BLK-fc4d408a0b120c15
semantic_categories: [truth-values]
digest: 86359ad5406967c2c1cf75f0e222eb44e99630cf1c88527e638cee602ec6247d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-239117c359167b76
chapter: CH-05
qa_id: QA-87b6d4ee26a7f2fd
reference: BLK-e5ca9a3a2bcfb757
semantic_categories: [truth-values]
digest: d996af8150e89190f961ebe04bf1215838a3d74b7e8af16b89a4880aa4ba7773
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d3dce5dad2408e3e
chapter: CH-05
qa_id: QA-23af767abd96eff8
reference: BLK-452d175adcd847c7
semantic_categories: [truth-values]
digest: 88eecd0b13f8798c81c61984b0aac90b99755830ce8c5e4de942790798e6e53f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-686b929c4c5db83c
chapter: CH-05
qa_id: QA-ad52ae42981d7a51
reference: BLK-c25057b8a38b65d8
semantic_categories: [truth-values]
digest: d20b5e7e2b224b53bd3a69d36acca84bfa2acb6e9bc27eb86940b16ffab83abb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d85281c9cb3bba23
chapter: CH-05
qa_id: QA-63c573c31281ad5f
reference: BLK-24debc49b4b7f143
semantic_categories: [truth-values]
digest: c290789b080f538f8fee280a60c0ae899450c9e4005403075232ca7ad2251e93
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-54db8b03cab6b4db
chapter: CH-05
qa_id: QA-072ce3a48e3fb048
reference: BLK-fb09f96c638665e9
semantic_categories: [truth-values]
digest: 3b92ed46e6f905eebd0cffad38cf01838f0853dc79595c2307cc42b010bb1140
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5a5222ab83beb3fa
chapter: CH-05
qa_id: QA-0c5c6013769d55e5
reference: BLK-cc6f290305561e56
semantic_categories: [truth-values]
digest: 4311fb053804559736541c80b192b16a9820f38645de82edcb0d7791468df88a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-19c0efa947fb1975
chapter: CH-05
qa_id: QA-5b542ce3ecb1baa8
reference: BLK-d5f021f01e8b32e6
semantic_categories: [truth-values]
digest: 8d0fc77311dea76ba9843eeacd18e65e7fd9388c0b31d1aa59db6704ee9eff86
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5a249f3e65d8ba13
chapter: CH-05
qa_id: QA-ae410ee5388ea368
reference: BLK-545646192799e4a9
semantic_categories: [truth-values]
digest: e78cb0b3751afb2d532448302a1df6fdcd18ad8577cb54659fab9ff27ff1e7a2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6652e5e06b2b4fb7
chapter: CH-05
qa_id: QA-4954e2b2aa7f5a76
reference: BLK-2af9eec9bfb6a27e
semantic_categories: [truth-values]
digest: 246c5ff83a323c11efaa7bc60acbae6381ebdbb46b392f04865d617f9cf195dd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d0498a3899931ab1
chapter: CH-05
qa_id: QA-678f13133f32eaae
reference: BLK-a55ef7691563b3b5
semantic_categories: [truth-values]
digest: eda953d045d312ab5b5d48a474a865a0a14c49a450a16124fc3ecb92af697e99
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bdf1273edcccd9f4
chapter: CH-05
qa_id: QA-484a55ded6fb285a
reference: BLK-4ae88044f166e17a
semantic_categories: [truth-values]
digest: 08801066f6ff91514418307d7c6bbac0a76234682ce5a3869ea318a6fb1c571e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e6b05cc3ef1e86b5
chapter: CH-05
qa_id: QA-7d4606e3f58ce046
reference: BLK-99f7241a145fddb0
semantic_categories: [truth-values]
digest: c1a112d9b6473790cb6c198c47bbde7363465faea00407ece9c8aa47191ca48d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-70f876ed8e62c249
chapter: CH-05
qa_id: QA-3a7f950ae0d8579a
reference: BLK-8ce4a80f2b54bd39
semantic_categories: [truth-values]
digest: 0fc8ce7eedefb1b04dee535885e2da23d24d965d1f6d4d4557d7c1364f877241
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1164cd240ec37b6d
chapter: CH-05
qa_id: QA-7ba8edff153b1153
reference: BLK-79fbf7e37836b953
semantic_categories: [truth-values]
digest: f5182d39c62b15fc0e90c2cb7db62c4627646c5fd30910fb2ab91f1a5204f0dc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f1ed62950239ff2e
chapter: CH-05
qa_id: QA-b275e321717c42f8
reference: BLK-c4708b67898ef8d9
semantic_categories: [truth-values]
digest: b59fc1fbf5695d22baebd7ccb35e849187b343114c2efb8936a52504d68b7c18
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b853021e7d2ea19d
chapter: CH-05
qa_id: QA-f850fd496144e40c
reference: BLK-30f8a1f3bad5f945
semantic_categories: [truth-values]
digest: 56ad5cf45e1cebb8d251eea5c9006d0d1f8040000db63ba6ea4b11474e402c17
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dd8420452bff08f1
chapter: CH-05
qa_id: QA-66a6c495339b7b7e
reference: BLK-bebdc8068b9afba0
semantic_categories: [truth-values]
digest: 49aaffaad32f94ed3c6b889742f40e720c412dd715b77928fa92ff98b20b3d8a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4b3707b6196baadd
chapter: CH-05
qa_id: QA-a5bbe3d890bd9385
reference: BLK-94d092d110d895e4
semantic_categories: [truth-values]
digest: 88e41e70ffb59f207833da2a1f0f99e753e1e13b3aa21f2264bb0582e0ad6631
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-57ef5ca64ab2fad7
chapter: CH-05
qa_id: QA-eb86c1d8e6a98d80
reference: BLK-c1e7ab5edbc34051
semantic_categories: [truth-values]
digest: da22bf3fc61fe1b81b4ba75bad34b715785e7bf4ec819675ad6b797c798a7385
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5cf7de070fad3edc
chapter: CH-05
qa_id: QA-ea5af28e846b6356
reference: BLK-da13a43f73416bc2
semantic_categories: [truth-values]
digest: 77317d815a12bef9d48c4066afb58d7d101da0a195ac12dd6b4566eebfc5b258
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5abb4d80d809b6bd
chapter: CH-05
qa_id: QA-df98c10572037d86
reference: BLK-23529cac1f63a029
semantic_categories: [truth-values]
digest: c01748d18e2274afa5841857488ce16289f244f9184d284643acd3304b052a42
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e7c081f29b5db93e
chapter: CH-05
qa_id: QA-575635d6427cb01c
reference: BLK-ad917938449c7e7e
semantic_categories: [truth-values]
digest: aed281992c8207b99073b5dcabe4d03c5c8e3096c3e36f2792a4da7ab9b38c33
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a7b3e7d5d3684fe3
chapter: CH-05
qa_id: QA-cc97c99c4ea05a2a
reference: BLK-ba6adeec0ea6c0dd
semantic_categories: [truth-values]
digest: 95c8660eaed65bbbb13608ef524a67ba3e867f530cb7975acdaad654f57ac310
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f43a7da213858674
chapter: CH-05
qa_id: QA-ba5fc117d74105fc
reference: BLK-524a614cce84f31a
semantic_categories: [truth-values]
digest: 418a332b926180f1e0dbad3dd6ecd122eb14f3a4d2a0a78fb8edb0e64e80bebb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c1d67cdeb491360
chapter: CH-05
qa_id: QA-c4f4a4d9c293f88b
reference: BLK-fd34e8211928ad97
semantic_categories: [truth-values]
digest: e44c02edbeec18268ea8396e34940039bc63a3412bcc1f77609dc177bc596ddc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c13e15f3ef8cbcbf
chapter: CH-05
qa_id: QA-e1084c254f9c7d0a
reference: BLK-504b0b84d9f07aaf
semantic_categories: [truth-values]
digest: 2c82062bb1b32f8efdb273b97c36864db2f9d59459e67a41d6fe34761f3be1fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0216acb40c070e1e
chapter: CH-05
qa_id: QA-dc29eff31ee01187
reference: BLK-79a5d70928584f27
semantic_categories: [truth-values]
digest: 06f1eeb34bda715c1264e25bf345c2ad6bf3dfeff1c45f50aec1fafdfbb14e7d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2d66eb602e5a1973
chapter: CH-05
qa_id: QA-6b651fa52f5b86a3
reference: BLK-923558ff279a8861
semantic_categories: [truth-values]
digest: 8d1a3969165eb7d52ce29240403e2195a50daf8b0375f991f736f0e15726c76e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5fac684f268b0181
chapter: CH-05
qa_id: QA-b919e033a9831130
reference: BLK-139c3fe74060a52b
semantic_categories: [truth-values]
digest: ddf249558167e707f023e2bef062bae9026ade59fca52f1ac0291eb30abcc1bd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-42641c86c88ae579
chapter: CH-05
qa_id: QA-2a04512722f0f8d3
reference: BLK-cbf7f28fee540782
semantic_categories: [truth-values]
digest: 04d465145834920d231bb50ca9b7be113847d5ba0d54a13d58cb62f8d1c27b61
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-896cd7ca2fed70f3
chapter: CH-05
qa_id: QA-2996fa2fba50f488
reference: BLK-0d6e5a6876e52458
semantic_categories: [truth-values]
digest: f5bd3907dd700f85abac66df8cc705c734302653712f99f22324b590545d2c07
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-68bc2a936ece1990
chapter: CH-05
qa_id: QA-30065734e9b92124
reference: BLK-2f48550b2fa1529c
semantic_categories: [truth-values]
digest: 1620363ed7d95a0dd2e0e778ad765b53a7b3bc10d7356f50b3e4d95a17377e5b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-df0e4af5cd6d2991
chapter: CH-05
qa_id: QA-a4b634dd6bd01d82
reference: BLK-5769859e9bd59db9
semantic_categories: [truth-values]
digest: 4a58326f7fe8523b8b5edfc2266413c4b0a3638a6b873ce1d8fc52d25af50815
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-95e1cc94c46ca27d
chapter: CH-05
qa_id: QA-a9604be13c7c1064
reference: BLK-061653364bae9a32
semantic_categories: [truth-values]
digest: 33864545bc131a73dd3f640cafdd5d2b394646df0476f6e3bea21e8ad64aff28
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-790e572e5b6fb250
chapter: CH-05
qa_id: QA-c11052f1186e6e9b
reference: BLK-2f18848e7865b628
semantic_categories: [truth-values]
digest: 15b37b56c570ff1e610a64cfd7d240dcdc1bae0806c26df861df6dcc4401f4fd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9e55174b315e9b6f
chapter: CH-05
qa_id: QA-0dbfb51d79fa1b8f
reference: BLK-e3939d7108ad8277
semantic_categories: [truth-values]
digest: d3fd21dcc91581b71283625361168daf8062dd12c1f81fdf56d38a5d6a1c960a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e3457c471d0a66c6
chapter: CH-05
qa_id: QA-ddb07d404697142d
reference: BLK-137908516f846d9b
semantic_categories: [truth-values]
digest: 09af96c13ccd0f58f014a7e11f8ea7925a2df9d24bae3996418574823667f147
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-81a5aa6c9be86d70
chapter: CH-05
qa_id: QA-186a9be56ef551d7
reference: BLK-f0e250b1b329925b
semantic_categories: [truth-values]
digest: d471651f8f1f2a3bd5668e04131d4bc3e53941352696a9b44f8d266135e8ff96
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f68623e7604c90a6
chapter: CH-05
qa_id: QA-56375277f068ef49
reference: BLK-cc03bee3c83123fb
semantic_categories: [truth-values]
digest: 9a4732d79e6f8400a586ba4eda604783d9887a96be2de7835ea01569eb0c67f4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-caaa5301bfdb1c6a
chapter: CH-05
qa_id: QA-f39cfc2f0902101c
reference: BLK-c1c5efdfcf097b54
semantic_categories: [truth-values]
digest: 6590fdc32d57618d042f3aeae2bf844a19df1748eaa73d52807508866253e73d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dfed759d69239087
chapter: CH-05
qa_id: QA-f242bfe8a0d415c2
reference: BLK-21f4fa8659b7887a
semantic_categories: [truth-values]
digest: cd95177577c2c5124e5b9ecf57f1901b7b4e1f03f5c068ceb536ddea8656c5a8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c24c36b69d24c3b
chapter: CH-05
qa_id: QA-ac7f57de6c84e554
reference: BLK-1a2433cf2e7dd787
semantic_categories: [truth-values]
digest: 7904e22616fc9de2ca57648c94739c575922c980381ea4782f33ba9ccd2a624b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b9d5b1d6efdd6d93
chapter: CH-05
qa_id: QA-0d0d8cc7a5a64230
reference: BLK-ffa5f256037b8448
semantic_categories: [truth-values]
digest: 2ad094dc92f3b39effe16693cb1c62f64fb75d668e3d5471b116b07b4d34987d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-be8d2b5925045863
chapter: CH-05
qa_id: QA-e4a60e733e3b0354
reference: BLK-af753aeced1226aa
semantic_categories: [truth-values]
digest: 49b24fb4f90ce698cff6861c1d4893e4d77b8562b51f508d42bafaab6943e5af
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e746bf45f9f408c7
chapter: CH-05
qa_id: QA-979bf31676349ede
reference: BLK-9917457deaa0fcf0
semantic_categories: [truth-values]
digest: e27a49d51eb2ff47af960d4807337fe050c2c30cda5f3462d958b4efe1d66904
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-15b9be713665f71b
chapter: CH-05
qa_id: QA-e5935045148c7443
reference: BLK-91f4730964a13670
semantic_categories: [truth-values]
digest: 879c4abf848dfc4c02c7770f74c3813494b9fed16ea6bf1dfcd442785d2f5e2b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9141a26336f83c05
chapter: CH-05
qa_id: QA-b90c5af9ddf8ae7b
reference: BLK-4984619c0e0050a5
semantic_categories: [truth-values]
digest: 4eec9b588f32451500c78808340537253098aae9328945ea5bc1abc820f975fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7ce34cd615da3a47
chapter: CH-05
qa_id: QA-18946c1e719a792d
reference: BLK-f7e87b62755ad0fa
semantic_categories: [truth-values]
digest: 285f820e003f67ee55c7828d04b720e1041602b97eeb58cecf4abdc7f24a0017
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fe2cde12fc4e91d0
chapter: CH-05
qa_id: QA-c98dc8875105277a
reference: BLK-69c05c427b8cd3f3
semantic_categories: [truth-values]
digest: 4aa2f5486e1da26db1dc2abbd339df7e0dc4884dd6bd4fcd2265dede3d2251f5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ac8110211a623d65
chapter: CH-05
qa_id: QA-75eedbe248822c86
reference: BLK-10a064964dd99bf1
semantic_categories: [truth-values]
digest: f9f1479ab1b7307c5b68a41bfb5f9d46e18767be90208b3fab5e0f5257008f9f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b614d3b302aa092e
chapter: CH-05
qa_id: QA-5acfb87dd3f58d4f
reference: BLK-eccf109bc4dfb522
semantic_categories: [truth-values]
digest: 131a0243812dba7e5766536a4e3d26f8e3de6ea9710bb8d2d9ee17153ae5805c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-68b83b3db9aeea90
chapter: CH-05
qa_id: QA-59efe2f2581bd89e
reference: BLK-c10db066c498a48d
semantic_categories: [truth-values]
digest: e79fc696bf2bbe97ba91ed8e6e933f3392089668c8c80c9780cff942b6e9ced7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c25b114c7684630
chapter: CH-05
qa_id: QA-2df927565217b63e
reference: BLK-57b5b916a2a46835
semantic_categories: [truth-values]
digest: 9e9bffc0a44a893a6051616583a7c4ef8d50883adbdd6dd2ab2f4b6f07025b17
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7f74c108803f1c0f
chapter: CH-05
qa_id: QA-4cdf79293b19212c
reference: BLK-af46131c6bb3a8ce
semantic_categories: [truth-values]
digest: 9ee54135f9c5047f010dc11e7a4c9bab6a627469ae25d506815702b4a36ab8a1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a3ad39dea1887dbd
chapter: CH-05
qa_id: QA-c764d1f8949edff9
reference: BLK-3fe483d8d3a22e99
semantic_categories: [truth-values]
digest: 9e38c8660d4387d9d60b980547b02d5550bbc1a272be73128469ccd45abb19b9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b284bcb4f9e6ca43
chapter: CH-05
qa_id: QA-bdaf3e10a817ce12
reference: BLK-0e7a6c61b883e7e6
semantic_categories: [truth-values]
digest: ebabc33dbc2c95dd5d15ae3a49f90a01d24356a124884d175492e43dba8465f1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-74e8bf021ea0c6c0
chapter: CH-05
qa_id: QA-b053389e22c41269
reference: BLK-06a52347059013ef
semantic_categories: [truth-values]
digest: b4c52f1958c23fb6398104a92b9bb5c50168c934d4a65b825199ef6d37b20a71
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2e0c3c1c9066f14d
chapter: CH-05
qa_id: QA-353684ae33917110
reference: BLK-8c1040019d74489c
semantic_categories: [truth-values]
digest: 876bac9a1de777adf8745cb0acdc305491ee2d35f3bbf786bac380247c79e8bf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-32545aaf06935805
chapter: CH-05
qa_id: QA-fe23909eaa96ad73
reference: BLK-b530a84aa5f3112f
semantic_categories: [truth-values]
digest: 56174208d3401c900190a4be82511e46394354c38effdc1da22de34c07fd9679
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a8ae1552976b05a6
chapter: CH-05
qa_id: QA-ee6dd0aaf3eaed3e
reference: BLK-1a8da57b7485efda
semantic_categories: [truth-values]
digest: 62668df22fecf0a8e8c73f6c71292436023e25ef554af82a10d5e4c65a2afd27
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fd0e9d3c209c7c51
chapter: CH-05
qa_id: QA-c832080f1044e6f4
reference: BLK-b64bd35f4b861874
semantic_categories: [truth-values]
digest: 13e6ecef53ae4b7219486959bfc18314e96537908480597a27e752958a797009
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-41c06df5493f3fa3
chapter: CH-05
qa_id: QA-7396a05c4199fe84
reference: BLK-52900d5604afced9
semantic_categories: [truth-values]
digest: b323d84f348cac2f1d4863fb78df9fffb63d4c16d5d8e4df5f69f1b14dffd9bc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f784b02cbe88b642
chapter: CH-05
qa_id: QA-7c0a79ff095f47b6
reference: BLK-4eae47b5b88ac30b
semantic_categories: [truth-values]
digest: e27f7930bfe3f8d5a7441f3b4c42851cab6478ea50cadad8867dde174c594c20
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-516aa6284bc94d40
chapter: CH-05
qa_id: QA-848846e3f2787351
reference: BLK-28e58a316e04a314
semantic_categories: [truth-values]
digest: 9076e164b32b71673a066d898bd4a9001aa14b488818b4991575bb8ab623c262
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0d37f3d56d229801
chapter: CH-05
qa_id: QA-d276d4b407a7f4d5
reference: BLK-20e31440afe0e8ca
semantic_categories: [truth-values]
digest: a223b98d48da840ddaa6e07736e9e8d218e7b2288df6be9630cbeb4d40b7dbfe
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e444bb1b32a54cd8
chapter: CH-05
qa_id: QA-c6684df86b3412ec
reference: BLK-5d68765eb3fb6b23
semantic_categories: [truth-values]
digest: 0910cb8bb514d2515e081749ab0dd14a2e9cfcfd734540cc70e87637f8f6fda8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-03e1fa21bbe40e41
chapter: CH-05
qa_id: QA-ca8334885d7c637a
reference: BLK-602cdb4b50a087c9
semantic_categories: [truth-values]
digest: 3e3a6619c101a7c7d4e76973ad05ae9d781aaee16d94c7cfd1df37c60a2aa3c2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dbe73899b2ff9366
chapter: CH-05
qa_id: QA-d1272d58ea07fdd7
reference: BLK-d3b7e29e9b95c9dc
semantic_categories: [truth-values]
digest: 290340ce89b5cdd0ceaa209921718638dce46c0f86dfc8ecaabb37f4ec39ab65
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a2c943ec7c3057d2
chapter: CH-05
qa_id: QA-308c687156b7b5e7
reference: BLK-7c4c29ca27d52d01
semantic_categories: [truth-values]
digest: 46efe0d5dfd847744974db861599c467d383fc5b1c2168f2e4f0015208dd4c79
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5e21585c30dccd1c
chapter: CH-05
qa_id: QA-c92ee3830540959f
reference: BLK-881ee9741315002c
semantic_categories: [truth-values]
digest: 80f1df9ea0df8852997ba84f56bbfea8551fc15eb8af4c37cd7ee42c26acab2e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2d81955b2ae095b0
chapter: CH-05
qa_id: QA-018052b77ac707ee
reference: BLK-0016265f5a3c2c5b
semantic_categories: [truth-values]
digest: 0883e603225c3714c8ed61341a1a0bef29c7ddd2c8093def46d09976a9f05c9f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-546001025f750ffd
chapter: CH-05
qa_id: QA-c2f6157f7467db36
reference: BLK-044c7de784844b9b
semantic_categories: [truth-values]
digest: 4a101f51b490a9963151c0108ce5011c4e54f0df78256c434453ceebc5bf7a26
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e9599f72925c25ab
chapter: CH-05
qa_id: QA-dc163354f44c10a4
reference: BLK-8a79fd9ce8c38157
semantic_categories: [truth-values]
digest: 09a43fd285685b6c7294180531ff0bfb2fe9b9bcc106265222bd9d411f0c110b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-416441d2cbefb52f
chapter: CH-05
qa_id: QA-e179b62b769641fe
reference: BLK-7fb970abfedb4ed3
semantic_categories: [truth-values]
digest: 1d42b873808c37a1627da99416984148f44c15e15804c79da03ade5f18186049
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4242ecab0470afb
chapter: CH-05
qa_id: QA-5bdb84fcf5f1f173
reference: BLK-301f517072826bc8
semantic_categories: [truth-values]
digest: 73d7ac22f1b61ce044c6fb35dca1c4cf242e6d8a3910ecaa1cc07377109c4450
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b4ad8356ca0d804b
chapter: CH-05
qa_id: QA-ecc99fc6c78df8a7
reference: BLK-fa54db274a3f8d73
semantic_categories: [truth-values]
digest: ed6d56848fb79ffe96d943308ccfb01197898b4833d0f76b384725090a0180b9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e53db2335d0f25f9
chapter: CH-05
qa_id: QA-1fadc331caf952a9
reference: BLK-c0d4ff0c2c28803e
semantic_categories: [truth-values]
digest: db4408cb430d217a81126ab1fa87202f859ede0fecfe6005d374ce616e6adfa2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-20318f5dfb05b56a
chapter: CH-05
qa_id: QA-65813a3a4a5d7d63
reference: BLK-bbdc4627b644d8c5
semantic_categories: [truth-values]
digest: acdc0bab78eea8c8a6d8305fde2dda38e0271452b3a6ba4bb85a8a86efe97168
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d735b432aab4e29b
chapter: CH-05
qa_id: QA-117f4505ddae3a96
reference: BLK-7b4eb1a9e305379f
semantic_categories: [truth-values]
digest: a79f834755d1bdbb209ac32d58c9a972178a3f80fd428508dcfcff95ba04b3b2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-56619454bf048ffd
chapter: CH-05
qa_id: QA-33ac9bc2adb30c55
reference: BLK-9b773aae56da6674
semantic_categories: [truth-values]
digest: e3ea569f808b744f2e489eaa9cf09321ede2c2e81286f506eda9a61da953500a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-be1ed1610c416d55
chapter: CH-05
qa_id: QA-d0656e20a2b6c9e6
reference: BLK-53fedeb32bc6499b
semantic_categories: [truth-values]
digest: dcd033552f74839071abc394a6d72f1c03678d0fa79e48b31c385accb7dcf340
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-65af2498589f2909
chapter: CH-05
qa_id: QA-30cb89828d642907
reference: BLK-a9c9f10372751d58
semantic_categories: [truth-values]
digest: 03293dbc49c213db557c789ae4014b5b27f928bb71e63f0cc2e5ab5484aae83f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5f8b8c9fbff2f0e9
chapter: CH-05
qa_id: QA-2a64aa45d3476315
reference: BLK-79a22ef860c5e85f
semantic_categories: [truth-values]
digest: 13a197af3ba28c2ad7b68481dc95b3794ed3aab327e3bc966d6bf0280f8ee239
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6539ab7a6296ebdd
chapter: CH-05
qa_id: QA-effa6251ffd5f15c
reference: BLK-1cb53c48958ecdaa
semantic_categories: [truth-values]
digest: 73d42eb1f105bef097c1ef4e115f252add0ff5061ebf56f5f6b639289ecd2d92
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c63773af5829b749
chapter: CH-05
qa_id: QA-bf35fb2871153f0f
reference: BLK-97da80a1bfbb763f
semantic_categories: [truth-values]
digest: c42c3713fdc55be67bc4f7328beb6e9db3ac96a1da2d8434de7cbd6100b1a4c3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-23e5b307cb782d23
chapter: CH-05
qa_id: QA-73835b786ac46d22
reference: BLK-0765a0f81e468faa
semantic_categories: [truth-values]
digest: 522dc65d33928f27576b5b3e20b8d0821590e6bfd9979211a649e850a72bccc0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8b2d15f84555950a
chapter: CH-05
qa_id: QA-9f7b0003ddd76385
reference: BLK-e89c971ac66c2591
semantic_categories: [truth-values]
digest: 88b43d75151cf16ec949c853a3937dcb1eb5cadf69065aafe83dd0a94f4edc73
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-beec2f4f727682a7
chapter: CH-05
qa_id: QA-02a8c22a2719d2d1
reference: BLK-3641c3e33c8e8566
semantic_categories: [truth-values]
digest: c214d17ba75b9992622ba13be59f5e59b36e5cf753fca630fc1fd6b2150148f5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b23d8766b8b469e9
chapter: CH-05
qa_id: QA-3c6dad6c5b107758
reference: BLK-ddb2b91d0cd87295
semantic_categories: [truth-values]
digest: 7a0e74f8aab35be7db9ca52c35f742eebfbd30859198fa24d16f4842f157479a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-21a4ff285194e4ee
chapter: CH-05
qa_id: QA-8fd83da8a5534554
reference: BLK-22ea3c1f6e7bd5de
semantic_categories: [truth-values]
digest: a75c4e625a8fdc6d88373412d2f69bb3a3358c748093747fae860f2060aee6ba
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-64b8432add3944ce
chapter: CH-05
qa_id: QA-3ced635218d54c8c
reference: BLK-eae51f08b14c25ab
semantic_categories: [truth-values]
digest: 30a6a10695e554ce8e3841e2fc048dc1fc7f1a5320c06bdc4decdb3556872006
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a5ed544af070c51c
chapter: CH-05
qa_id: QA-eab1d95e91087694
reference: BLK-96cfa439c2ca2a38
semantic_categories: [truth-values]
digest: 16f3cdfa64d8fc2ec2dc19b5ad72d22b65bdcf598a3e205a57439215c35ac156
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cd8e1ab35a3af98f
chapter: CH-05
qa_id: QA-8337410c8b93b26a
reference: BLK-8bb9ccc71d144b2c
semantic_categories: [truth-values]
digest: 8ac4e85626dab25c6d372af227688cf2b607f51f4a6a8a77ba7b0efa846dee61
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4f5a46fb9fc20ccf
chapter: CH-05
qa_id: QA-24e3b566daac3265
reference: BLK-476ba186ec97144b
semantic_categories: [truth-values]
digest: 203cf0138e36b0ce7bd3fd0c71d173f43fb8c75da71e8901d48504909b558d1d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c95599d9b1fe3744
chapter: CH-05
qa_id: QA-4d81f456e32254d9
reference: BLK-708c71e7c73e35f2
semantic_categories: [truth-values]
digest: 25df6cfa1887308e7f67516b9e0152ee835466497a8bc73e16cd79ab7b916359
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d01a47b7c78be609
chapter: CH-05
qa_id: QA-bb83f0a9b579f7c2
reference: BLK-b8ae9bf60f3a1989
semantic_categories: [truth-values]
digest: ecf4693210892e9da60f77ba5cf3a378387f0515eb6f20bb48e3ff99e664d153
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a19d0603f8c59cf1
chapter: CH-05
qa_id: QA-d25e790c89eb60ed
reference: BLK-492bd318f6c337d0
semantic_categories: [truth-values]
digest: f35a2692c55d6fcd818142f8e10cf644c66d5b76c6aa89bed5905127bb12cafc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1a484ff0cfdfd447
chapter: CH-05
qa_id: QA-56061476ecfaf57e
reference: BLK-adc62466f65013a1
semantic_categories: [truth-values]
digest: 7121c9e9ca213714c8fff9ab956a8c1f10f2dabf5dfe7f87d65d73059e6e0c0a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bc74392eb2f11711
chapter: CH-05
qa_id: QA-9aa1d14dec585afe
reference: BLK-6fd70c9d544e887a
semantic_categories: [truth-values]
digest: ea1d339d6f937566c0e094ee57172832c74d23953c74953ea09ec15e9c72ae80
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8461188701c35172
chapter: CH-05
qa_id: QA-f6d69904dc9a19a4
reference: BLK-137c2fd546a4d073
semantic_categories: [truth-values]
digest: 856b01195fc96d25ec3bcfa39a82185a2ce392c57a0a1841314883fca5facc35
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cf44d79b3ffc6df0
chapter: CH-05
qa_id: QA-fccf2a1c264119bf
reference: BLK-2c687b2f253cfbe4
semantic_categories: [truth-values]
digest: a452841770b3961a429d6d90e2bed1a18892d802ac24acddea1ab0c9247d92a8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-58cca5f29539c14a
chapter: CH-05
qa_id: QA-62a16e79d7cfda16
reference: BLK-239395e2f35c1d1c
semantic_categories: [truth-values]
digest: 20e4bdb4ca271d79e6ec55f63d7a72c62db1f33dcb9aaba37d357e8607b54fa8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9a3b3623bdda5d61
chapter: CH-05
qa_id: QA-35b951bc87d12608
reference: BLK-d016298bd014580e
semantic_categories: [truth-values]
digest: 46f27f99f7d1af53e26cd6458d222ce626f2c40cb5ce0514c66c1660ab32264d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e0d853abeb95c371
chapter: CH-05
qa_id: QA-e2788fde832194b0
reference: BLK-780f6a8ebb08e0bf
semantic_categories: [truth-values]
digest: 2a9cce1b8c93e0bf5672ec52ed0a50c1186f5bdd11b6feaa85f57afbc7c4a541
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3f6c9e5eb079aca6
chapter: CH-05
qa_id: QA-28b0e1df2e828000
reference: BLK-e32fefe6aa6f262a
semantic_categories: [truth-values]
digest: 95fef1833218d84e0823a3f4f414f7b5b5503295c91d2cc87e4ae2c8dd778dcd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-38877549a7be6bda
chapter: CH-05
qa_id: QA-2bdb297e2b37f2d6
reference: BLK-e73b9199be66d077
semantic_categories: [truth-values]
digest: 19b02de81cc700ed5fa928cb701d5d4b04f22e3ba7df5e237c0eca2dbfc6f02f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-029ce2330b72b65f
chapter: CH-05
qa_id: QA-80454161b202d450
reference: BLK-29afb65bc79a3e3b
semantic_categories: [truth-values]
digest: 9888e23fd1fc08173a4cb0707b4f4b79b3172b5051131b2e78504b59f9e387e2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ec7521b338ffee1f
chapter: CH-05
qa_id: QA-e3bf44a5783b98ba
reference: BLK-da9d1cf4f0f47cfe
semantic_categories: [truth-values]
digest: 3f5f1b92f5dd95506d51a38cf06b242bd2b7c07557b4e6467a644256ffb5940e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ca85c560c272f02d
chapter: CH-05
qa_id: QA-f3b6aba4d221315b
reference: BLK-6d1f67793e063be6
semantic_categories: [truth-values]
digest: e9bafac943e4a41a854cc6804133a9a3642c0488db87a20ce6810a31a75b0e54
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-355303d655707ffa
chapter: CH-05
qa_id: QA-72c4588ef9b6055e
reference: BLK-2e2e66e96d2b3f2e
semantic_categories: [truth-values]
digest: 678748b8f196ea92f2750214e5fa819170e5e73065590f15f885c279431fa4e5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-188f861767d27b5b
chapter: CH-05
qa_id: QA-5b99ff51d7a232b1
reference: BLK-96475ac62d55d092
semantic_categories: [truth-values]
digest: e3b2593fec5eaf8d76d209e89192fc6a27c53c964d0ae0f6abd3dd4820e7c31e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d48293806eb5a66d
chapter: CH-05
qa_id: QA-914b2675c2f581db
reference: BLK-1d1bce0ed2b5d5f2
semantic_categories: [truth-values]
digest: 2663b3e6f20cd1a100a238accf2a6247fbac1556c2678dccc0cc77af0545639e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-15e84c7b46b17c42
chapter: CH-05
qa_id: QA-d6210c9ce59feef4
reference: BLK-177acd5879ae1eb5
semantic_categories: [truth-values]
digest: 48778e21e162cdb406c33374d4e4d3fdafd37f52248f696eb343553712543698
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-99e82588e6c6de39
chapter: CH-05
qa_id: QA-2be00bd5695f368f
reference: BLK-07f8a2771f295779
semantic_categories: [truth-values]
digest: 03b020f9a983b7344de3db4dc05df3057384ac5d501aeceaf02f1c17a890d25d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eb193483ac52afa4
chapter: CH-05
qa_id: QA-bfc9fcfc78e06228
reference: BLK-073cbe3299458fca
semantic_categories: [truth-values]
digest: 709831194754f399102a04e851da3ed55026eb62a7f48e99d4a6c93915d769c5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5966f079f2a21b0d
chapter: CH-05
qa_id: QA-e75aa2d44a7971f1
reference: BLK-3f86fc771487f729
semantic_categories: [truth-values]
digest: f0670ae032700bc512719978d9d2cf022ed84775eea3a0ceb021c807f90c178a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-860cebf21cf190e3
chapter: CH-05
qa_id: QA-03a15b4a7a96ea1e
reference: BLK-1606d5d3769853a7
semantic_categories: [truth-values]
digest: c362776aa36c2d7e2ae6078c17c2d223f5f58e036cc540591253d00d1422a088
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8b765c8f4d51bbf4
chapter: CH-05
qa_id: QA-64b95c995325d52f
reference: BLK-daffda34523491fc
semantic_categories: [truth-values]
digest: bcc33181d725257750f82388391e1ee732b77a3f497d2499b193344b69dc6660
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a4e3d7550a57b3f7
chapter: CH-05
qa_id: QA-0d622e6e5cb3f977
reference: BLK-d766db30ebdfc849
semantic_categories: [truth-values]
digest: e139c52e10f7cabe38e45cbcd7f8124d01a888a38d5616d958a66591882885b0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-106ed6039872c948
chapter: CH-05
qa_id: QA-7639ed237bd745eb
reference: BLK-6b73a05c5f7af41e
semantic_categories: [truth-values]
digest: c1735a8b1f1be4ebf495760f96dcebfa82d142cf75f6d1ba5a30131ba9f7b3cc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8b6002d50cd603d2
chapter: CH-05
qa_id: QA-0b98c54eadc9ac34
reference: BLK-95369408c55face3
semantic_categories: [truth-values]
digest: 726856d1597a4b15d355360b6ef94ee0bb0d9a65f6c09f1db7f0b8a6095c8051
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-643768d9d8e15b4e
chapter: CH-05
qa_id: QA-332f0e772a5128e8
reference: BLK-e23b8f98ae17ad67
semantic_categories: [truth-values]
digest: bc0424cccf2baa4152b20af83433160313db4210c1d4eb5561fe1ce3ca6d8677
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4304bd957c9acbf9
chapter: CH-05
qa_id: QA-c47687c1c7c6b483
reference: BLK-95a4d919e71a1c12
semantic_categories: [truth-values]
digest: d56d7dcb6d14785fa1813d2adc058f9eb90390ebdf09e8b7c1df780dbe5a7d98
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d186438275e8f0fe
chapter: CH-05
qa_id: QA-611bff1c445fd1d7
reference: BLK-b9edbad05e484b05
semantic_categories: [truth-values]
digest: ec561f4306583bb4ad913d9e289a5d8b2b85954beac533bb753ab22ee15da6e8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-eec97f3259f152ce
chapter: CH-05
qa_id: QA-9bbef1be805e2642
reference: BLK-f3552229f486fc05
semantic_categories: [truth-values]
digest: fb5733bacb24931b59fa3ad848b218250224c0457280d1d64cb7cb7b9d074f85
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9484cc5b9d7ff5ac
chapter: CH-05
qa_id: QA-7a839643eb0dd015
reference: BLK-393f7de2a0c944c2
semantic_categories: [truth-values]
digest: 36de21b4aa7d47f1c271d4a155424e96c9c12e0bc0f9c08ba8d52074ae1c3a0d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-976b74116bf9c5a6
chapter: CH-05
qa_id: QA-f98248802c0556ce
reference: BLK-fbf68ce59d9c01f8
semantic_categories: [truth-values]
digest: 528668f2b377f43251fff0664afe5a5836cb9eafb6f53384d373c77a9c7c39a9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-65cfc29782d69116
chapter: CH-05
qa_id: QA-5823ac404d5b2ddd
reference: BLK-2ee574aac09ad686
semantic_categories: [truth-values]
digest: 1456f6f1de31eb9d017b6d06bbfe409c991d445d8c3c311c33c1abe3496d30db
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-724a9d46d223aa88
chapter: CH-05
qa_id: QA-38d7ac0e2f05e9dd
reference: BLK-c191fd1bb522212a
semantic_categories: [truth-values]
digest: d300334b54251b3da15c6649c20f9abefe08928054f1e3445dbf20a2cd648945
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7a8656d7f8f83f12
chapter: CH-05
qa_id: QA-ac57a452d831772f
reference: BLK-85a476063d06921f
semantic_categories: [truth-values]
digest: c217bffc26f6af28fb619c3b9dac3508786ccd919765ba7af2e23aaf308a687f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a80a6077a285e38f
chapter: CH-05
qa_id: QA-ea1be1deaca49c83
reference: BLK-2c5e711e15ee03f4
semantic_categories: [truth-values]
digest: b0effb9a05a69425097068f4ed963e2f7a09cd20acd86f6e861a17d7603b2746
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6acf388eee52ff99
chapter: CH-05
qa_id: QA-8b93df9670f5f4a4
reference: BLK-b1c0d736416df0fe
semantic_categories: [truth-values]
digest: 8e2972243d149887224ad090da354c03e721f0eb90f7d5266d2f73548ea46697
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2284ae2a01207d3e
chapter: CH-05
qa_id: QA-df48992913679b2f
reference: BLK-e0278fba1f055245
semantic_categories: [truth-values]
digest: 464fbaf0ba497b1555cf21b73530851d3f236e78fb33b6200c5c12725068ffad
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fb1b902e833db02d
chapter: CH-05
qa_id: QA-29e5cb2ad9018be6
reference: BLK-a6843e981cac13eb
semantic_categories: [truth-values]
digest: 336a56420c586b78dea19b874a08e360e6ca9eee70acba99b43fe30c7e837df9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ed979dfca24f3285
chapter: CH-05
qa_id: QA-06922b4eabd7bde3
reference: BLK-a81ca863b9a3b7d5
semantic_categories: [truth-values]
digest: 621e3af3ad23bea07b312fcbe8341dada4021eee2570ceaa9d45507a0379b026
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e5844dd6bdb73970
chapter: CH-05
qa_id: QA-1d5cf60e1c98f6ef
reference: BLK-7572efde313bc676
semantic_categories: [truth-values]
digest: ce7a69d1013cb0dd56ad38ed5ed216c208b0d27a414657eef5ab10092e82f8b6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c8c43ff69b5a0cb3
chapter: CH-05
qa_id: QA-b38d0f65d02e5a41
reference: BLK-f623d12ad47f73ed
semantic_categories: [truth-values]
digest: 82f0a7175042146be5f293efe8e6fb9a3c3ee1efad40448a3f096baa45b22f9e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aa52ffde0d6b14bc
chapter: CH-05
qa_id: QA-e21549c7e221cc49
reference: BLK-b0acb177781b0063
semantic_categories: [truth-values]
digest: d4029929d7d23625dd6ff02e3dbfd4c1afa5e692bec481ae5c65289ec591bb15
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6362e228f32f8f76
chapter: CH-05
qa_id: QA-526e49e5aab4dec4
reference: BLK-74371f1f90bb0e83
semantic_categories: [truth-values]
digest: 0347fec9df0bf0b4c2f30274a4be8596a9a666a7052885201d92502a5218cb00
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-128c38480bae2ec8
chapter: CH-05
qa_id: QA-73036b94680bb450
reference: BLK-75ee5ef88004b802
semantic_categories: [truth-values]
digest: cf3e2fde7248cccab0647df6b4e13d4664183799cd6784bb058795c0141217a7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-71b3601a66224350
chapter: CH-05
qa_id: QA-9eefa5618de717fa
reference: BLK-3a12d7c2cc6d03a1
semantic_categories: [truth-values]
digest: 8b2006828261af355ca870fc9eac31e915669674e14ef2e06b98f73dd1ea0cb3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5006e60304fc64a3
chapter: CH-05
qa_id: QA-dac675732b140165
reference: BLK-bfc749d64868bc9b
semantic_categories: [truth-values]
digest: 23db4191222e2e6bdf278a465b4257b3b9db738567952aa2305729f287d50b9d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c6150a29b246e16b
chapter: CH-05
qa_id: QA-219395b4f8db81d7
reference: BLK-d20e8dfa86879fc7
semantic_categories: [truth-values]
digest: fa7e852a144b655db0953558bafb5cd7223c773436a489f7f1edf144c5c2c46c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5714040d53632202
chapter: CH-05
qa_id: QA-7326ba36cdade284
reference: BLK-30ddfd3dd392bd32
semantic_categories: [truth-values]
digest: d17d27d8fc650720c388eb31d28f3bb10ca980e208ab1cb68adf24e1c6020552
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0b0499b8a83f1e38
chapter: CH-05
qa_id: QA-45b7c7643ee3b294
reference: BLK-2e5f3039527c7503
semantic_categories: [truth-values]
digest: b427fbd8ab9c8da34337dcf1622ffd09833228aa2f468d02574e2d5f21c02eaf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5ca00e52e52c966d
chapter: CH-05
qa_id: QA-040cb8bbbcc81493
reference: BLK-d495a3815b3b05b9
semantic_categories: [truth-values]
digest: 2efcd5d1441cf6548741b7415fee114dc7b7d13182a2b24a26b89520d51ca2b5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-addd79762b1e40b8
chapter: CH-05
qa_id: QA-5bd1cd5d7edce79a
reference: BLK-35f656550b066ee3
semantic_categories: [truth-values]
digest: 06969315051605ec0977f4b95d5bebc144c83ad62a850b1b217514b8a41778d3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c2cc8d710245b526
chapter: CH-05
qa_id: QA-deaca142dae1b832
reference: BLK-e06cf468a4849f5c
semantic_categories: [truth-values]
digest: 933dd90c1bca40a55a99109875fa7e9da8791f8043962deb79c6c5600021fbe2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e89eb10da7e354ab
chapter: CH-05
qa_id: QA-0b407f9c90441d1d
reference: BLK-f223eb01cf8eba29
semantic_categories: [truth-values]
digest: 1e3de015887eddea2c5dd03cbe68c628088e680298561a87745207d1783d01d8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dba71d3c2d6e596d
chapter: CH-05
qa_id: QA-77c4b72a0596369e
reference: BLK-312401e4a78cb757
semantic_categories: [truth-values]
digest: 799ee26dae2ac3d50d053bcbad56b1679561b558a6f46a581ab9c24d2b612003
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-94a98444c53a3ba0
chapter: CH-05
qa_id: QA-28bcf03127a1a945
reference: BLK-b172f82260025d9b
semantic_categories: [truth-values]
digest: 23e34fbf09ce1a02d2e38b71437258662ff5b3c97f6a964b57009c0ef21d0302
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a2da7c7106cec4c6
chapter: CH-05
qa_id: QA-43d4dcd37056ab6f
reference: BLK-6a5cb055b34e7cb6
semantic_categories: [truth-values]
digest: 5655ddd5b24ef3727fb9dc7646931dbdd82cdc9449a3af9418b68c85f96b42e4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5727672a67822fd9
chapter: CH-05
qa_id: QA-d4a5fef655e5fe85
reference: BLK-5be303f8619ebc37
semantic_categories: [truth-values]
digest: 023215fa1b52d02059a4c6319e7c49fe6bab801e20faa421a179f2236d558e76
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-23138fedc6b4841f
chapter: CH-05
qa_id: QA-67241ef276dff81c
reference: BLK-f3d455506a6b7cc8
semantic_categories: [truth-values]
digest: 5dbbd5c52710490d2d7fff8542c70b7793e5653e2bf7293985ea2a12c5533e0d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-367bf69522d50b08
chapter: CH-05
qa_id: QA-b4e978e783d5a795
reference: BLK-a164ce803bbdb95f
semantic_categories: [truth-values]
digest: 14ebbe2f0517ae3f58d8ff07ab850fc27846be5d53216ea85d55c7153eb68f8d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f6001dc3e250ed88
chapter: CH-05
qa_id: QA-c9800352bde344c1
reference: BLK-0917a2a8dc7a41ce
semantic_categories: [truth-values]
digest: d8b99ce955c3634b7c49a7886c50c6505aa94a172c3dcdde0b25420152a2c73e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-21b7e25a381e5e24
chapter: CH-05
qa_id: QA-bf8042326595a851
reference: BLK-b08121aaef4efdfc
semantic_categories: [truth-values]
digest: f594a202cf7b0e706a1ef225c9742d17cf3358e604e63b820e43ec6867111ab5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dac57a2cf983ef5d
chapter: CH-05
qa_id: QA-de7880139516292d
reference: BLK-f133e19232661cc2
semantic_categories: [truth-values]
digest: 3ba42df4f29f3487776af16262a751748b00ff7ae8286d51a6645b5f6db0b362
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aa79b8a2eb58031e
chapter: CH-05
qa_id: QA-4927e12986401b08
reference: BLK-b19700b3080dc69c
semantic_categories: [truth-values]
digest: 1088f442ed2129b37d7c06bc27fd3069874bdf28f9ab01ed24e99f6e61469ef4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6adeefd3514ad94e
chapter: CH-05
qa_id: QA-aa0013b15def7239
reference: BLK-37b6ab540b493df4
semantic_categories: [truth-values]
digest: 06d3e7b516ec5a0e1e69ffaf24de07630c54faab923125e907e365362ac000a8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5e1efc21309e07fc
chapter: CH-05
qa_id: QA-2bc3cd0bf1b6ea0d
reference: BLK-bf480b6db9e70e26
semantic_categories: [truth-values]
digest: cf757444ea141a87976ac8aa02f3eaaf97d92fc0e614ecb51ef754caab65f932
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-966ea9ebfc648e1d
chapter: CH-05
qa_id: QA-ab7cf79f54d9167a
reference: BLK-e3c06649001ac7cb
semantic_categories: [truth-values]
digest: 1b8e512c3cbd728285638616bcd25aac3e20a6287d5c101444a511e3e0691aa2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-68976788c3690364
chapter: CH-05
qa_id: QA-fd0d6f5492b4420b
reference: BLK-2c956a537c865bff
semantic_categories: [truth-values]
digest: 0f9b9b637c3f1e7e3ab173c024af6b2b633d46aaf793ec1c760e9adf0ec3629c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-715ab7fedb072040
chapter: CH-05
qa_id: QA-5de9a774ea4b05f7
reference: BLK-d17bf7dff7e2687d
semantic_categories: [truth-values]
digest: 4c83a15dd8783e51daaa007a5864b1b2e122e772e3fab843284346013787973b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b83513eb9a1c7944
chapter: CH-05
qa_id: QA-eaa40d8f1e5e5915
reference: BLK-00aae760c3f524cb
semantic_categories: [truth-values]
digest: ee33850834cc07f225a4a7353e5a3bd4d3096e61e9fbeb42fdf9327b4a3bccdd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-da8a5ce7a2b6dc87
chapter: CH-05
qa_id: QA-3ae345e6f1ee50e7
reference: BLK-7984539227277d1e
semantic_categories: [truth-values]
digest: 00c90c0fb1254ae656113302b8477ab3a9bb7311c5e0b459e8dd752c33604fc9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-70cf597476c05c77
chapter: CH-05
qa_id: QA-6505db860235d38e
reference: BLK-88897c889d38315b
semantic_categories: [truth-values]
digest: 9a7c630d0db30b4c2a980b18484a6424374e48ff43e751368ff7ac0e5ef9a6ec
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0bbb6fc14556832d
chapter: CH-05
qa_id: QA-ae50b7196579a594
reference: BLK-c6a16c819faf270c
semantic_categories: [truth-values]
digest: 157b1303566decac3c1ad860e3a914467d3c6e8948fbba7674078ac180d1c00f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2b8ac1f1536f8a90
chapter: CH-05
qa_id: QA-db616b6a349f9973
reference: BLK-5051a10ae5706b97
semantic_categories: [truth-values]
digest: f137285a679e0090d1db5d9e188b8700fe8ad8bda8bba7d2899264c9508ca697
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2f48637a5f8123ea
chapter: CH-05
qa_id: QA-ed13e91d7e76e513
reference: BLK-ac0efa57c504e47d
semantic_categories: [truth-values]
digest: 92e353ea877b36ba18b13fb0ff2ed88561a5a76aea9e6330bbc652b52c20b6e3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a8754ef2f7789e0e
chapter: CH-05
qa_id: QA-ad04f173175d9dd3
reference: BLK-9b47d89fb37632a4
semantic_categories: [truth-values]
digest: b2091b728d8f2ca72a6a355092d31dfcb4615b16feb7ebf2b37c39a25f890097
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fe5ed1149a916165
chapter: CH-05
qa_id: QA-d99c6821a97b08e2
reference: BLK-be239d14ac089893
semantic_categories: [truth-values]
digest: f2a47204eb90e295d5aef49d64f115147bf0ee58e01b60e211f0f3ec5972e4b3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-17d78c05e7d9cf8c
chapter: CH-05
qa_id: QA-c876443da323b17a
reference: BLK-fb9f85c09a41dacf
semantic_categories: [truth-values]
digest: dcc9fee61aa135fedac55566116d46bd9b1f9da27205ceb2365aaa4e913b216f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2d9c9e5586bcdd77
chapter: CH-05
qa_id: QA-41d7ee4f48f77e6f
reference: BLK-29dadeb3f0a54d1b
semantic_categories: [truth-values]
digest: d6bc8e8663b6b6a72d3aceaadd21b7038504458e700bd03107fd9f967252568c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-26892e2eb75c00c3
chapter: CH-05
qa_id: QA-c2838838731185f3
reference: BLK-a6ad7c1547585e40
semantic_categories: [truth-values]
digest: 8be50e5bfd5432d586b4f7d1b0fe22f87afa143db3a69eef7d2c244f7edb1c79
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-70573e6928c834e3
chapter: CH-05
qa_id: QA-60452740cf233f4c
reference: BLK-24e160a1846f69ab
semantic_categories: [truth-values]
digest: 97371e01a675f4b0562aa880e070c467501ad13e32ff697bcd88ce638c5a7d81
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-15f5084c305445d7
chapter: CH-05
qa_id: QA-9f657777d51caa4f
reference: BLK-05d76e22769680a5
semantic_categories: [truth-values]
digest: c21e2d9babae82b8af740aeef7bdce6c841976628593843d9b6970c335e217f9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d71c2513e9ffcfc2
chapter: CH-05
qa_id: QA-8432b87bd232de86
reference: BLK-c37d51b33f8c33c7
semantic_categories: [truth-values]
digest: 8e373ba755c114add536f505b23adcff667cf09e92ac235d0e4a4013cc3cd5bf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3c094f71e6770e9d
chapter: CH-05
qa_id: QA-6784c60396255d7b
reference: BLK-3797e2670efc01ec
semantic_categories: [truth-values]
digest: dc3868474287e046c620905f1a776118944e94d45656f4bff9bd996f14ec6034
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a6d6820a011d8a2e
chapter: CH-05
qa_id: QA-062314ad37a7cb3a
reference: BLK-26016fa8bb549e8a
semantic_categories: [truth-values]
digest: 3da2ad4787d3e1bd4e7ffeac74dae09e5aaf80eb1dfb14f70e7a9dc24b7eaaf5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4fe7320b536969ec
chapter: CH-05
qa_id: QA-b431a0ddf40b8d30
reference: BLK-5ff9a90c174543e6
semantic_categories: [truth-values]
digest: e1e3288d6fe2fb9731a3c2e8b05b7438a6d5edfa1c64bbb988bf5c9c57e95114
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-52a4b1805dbace2e
chapter: CH-05
qa_id: QA-ba29acaddf39e035
reference: BLK-c90e38cedbdc43d1
semantic_categories: [truth-values]
digest: 2b449bd32f03901d2e9af82f0c419bda1388c136fdc216f4d4a7c070504464f2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7cdd53b833888cd2
chapter: CH-05
qa_id: QA-6fc4cf4a7b5bdb93
reference: BLK-a1aba1f7c35dda91
semantic_categories: [truth-values]
digest: 660549e33997682959d172ffefeb8756f3ad631e1c8d2eacad8c3ee1c84282fc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a36c9135939004d6
chapter: CH-05
qa_id: QA-609ec1648e2f1fa3
reference: BLK-f13d3c0879266a61
semantic_categories: [truth-values]
digest: c49de82707237bc794854757df9bd8841a502a67c19450118314f2babd085051
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6b71401c14c35dca
chapter: CH-05
qa_id: QA-f7cd121f67d4d2af
reference: BLK-5d6ddaa19e8cfcaf
semantic_categories: [truth-values]
digest: f4b67672d3df3ec153026a086d1fd9e688dbaaaaa1e2728a284202b29826910c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8c01f4fa2b08d706
chapter: CH-05
qa_id: QA-a446ab270b69a0e1
reference: BLK-42e8f5f868517157
semantic_categories: [truth-values]
digest: 13038d9027c205b61de126fe5f7273b87dad5a65b886b33d1c8e33ff2935478f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1a298b99d11b6d23
chapter: CH-05
qa_id: QA-f111649600818372
reference: BLK-0e27cac7a34ed96c
semantic_categories: [truth-values]
digest: f5ab4c1c4f8934d12f0dafaccbb29beccafdf869aa718b19a8323f5a2525548e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-13d214d1cf635803
chapter: CH-05
qa_id: QA-985039a2d5c50540
reference: BLK-04f8b905633b2c5f
semantic_categories: [truth-values]
digest: 2a71fb408a553a8a637e9a4f1ae440325cb8b702b42803973eaa53e667edca50
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d1ae9495c2b2bfe4
chapter: CH-05
qa_id: QA-d4e10a9cdd98a2c7
reference: BLK-9d3aeb0abc8fd54e
semantic_categories: [truth-values]
digest: c3d115826f527f5a5ebf0484452a47c81efec89edded2ffd603581ea2d6d248e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e9f44d16a73fcc17
chapter: CH-05
qa_id: QA-46d414ab4649fd6a
reference: BLK-56a7595a69adae94
semantic_categories: [truth-values]
digest: 85f2969e0ade5a4d1ffb269ef5f786a943839106a30607c242a6326b9d723175
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e78d8f1c619dd3ab
chapter: CH-05
qa_id: QA-fad80d18db9c8278
reference: BLK-5e0ef2d16b64008e
semantic_categories: [truth-values]
digest: 362fbe1d43ee9d2e4cdf89ca0a73ad767f8d8fe9b84cb8ae0bcd969aff335d3c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9d59264972fa024c
chapter: CH-05
qa_id: QA-a41bd2de2c4a1dca
reference: BLK-81be0a89ed2bbdeb
semantic_categories: [truth-values]
digest: 4ccc1aea8d1034468c1d4732375e039cb7b82bc579fe144f304ea2681f257abe
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c4026c3a1964123
chapter: CH-05
qa_id: QA-71c135e782c16caf
reference: BLK-976f4a3022f5c700
semantic_categories: [truth-values]
digest: ecc61ed3a594147351ccf2cb92e2cd07c4eaec767c59813e60a07463ac5356ac
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bd8a3d8b6b02b219
chapter: CH-05
qa_id: QA-9b3d5eec04291255
reference: BLK-2b29aec02bdf3804
semantic_categories: [truth-values]
digest: 4502ae8c445f304096419500e6a0b3fdcc163c4992b8a5d6bd9dad20a4f2ffd4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b0d5f4e0c24b417d
chapter: CH-05
qa_id: QA-f965cd08e4f86b24
reference: BLK-9ee40e622c0b8c69
semantic_categories: [truth-values]
digest: 6dcdd45b51c45432b4805108271b262e5cfe481987c24648263284ca8267efaa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-05a689e9fda3e3a9
chapter: CH-05
qa_id: QA-4668a502d0e494b1
reference: BLK-62df538504d93142
semantic_categories: [truth-values]
digest: 8740b5ae2f5950c0b4918b06720d7d0e62f4760a660c85e0e85b4d21018748d8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-87b37c5433a09242
chapter: CH-05
qa_id: QA-1949f3076ab9d65a
reference: BLK-8564f950737ad167
semantic_categories: [truth-values]
digest: 947c62940abf96d4b73d378781242c0b424239ab9c4511f8fda3ac55e19e97aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8d4727c72b16128c
chapter: CH-05
qa_id: QA-7eef6884a52a2611
reference: BLK-81063a0c4670fed4
semantic_categories: [truth-values]
digest: 9263683799ee66f9a0d3fb705e862205d385921d873ad3d69b9c41212033e76e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5bbbeae1bdd8bedc
chapter: CH-05
qa_id: QA-7edc5251b1f26ac2
reference: BLK-710e9c5927914bb2
semantic_categories: [truth-values]
digest: eb89867546ac4154825aa9c5959fd7fbd8cb92cdf78a513aec01734f29c76f57
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e4d727dee05e8bab
chapter: CH-05
qa_id: QA-617cabc3272bdfd0
reference: BLK-a2f928d215b1d576
semantic_categories: [truth-values]
digest: 751a12d2ef4e05e9284b56e9f854f59e986088f5d366f755eece1ca6d0b33d50
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2c248512c8c6f797
chapter: CH-05
qa_id: QA-7096662eabafd598
reference: BLK-35b8084f79c559ed
semantic_categories: [truth-values]
digest: c5e6bf5b4a800c122042d88f608bd4519c37f3f38063a23c2a86a0b595f4f564
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9ee4aee2f0b0b7d4
chapter: CH-05
qa_id: QA-17999214a99704d2
reference: BLK-f51067adb203c9c1
semantic_categories: [truth-values]
digest: 573a67b689020d0e4747defc90be0345041b3195fcdc84dd75191055650b99a6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aec4804651a458ce
chapter: CH-05
qa_id: QA-4aa07e9741eafdeb
reference: BLK-c947320997cd09cc
semantic_categories: [truth-values]
digest: 9c14ae5dcc9d630f66457248fd5ad9fa349c9d03ed84f33f9bb8fd0a28a50c7b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d30c23ecdf590fef
chapter: CH-05
qa_id: QA-c71d343bcebe7240
reference: BLK-bb993ad92ca88b76
semantic_categories: [truth-values]
digest: b22b98bb642348bc6132f4cca6d97fd89c747699b3b07360ea917b43bf223e8d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-681ab398e019b3c9
chapter: CH-05
qa_id: QA-b4aff1a92edaa91e
reference: BLK-813a09749e866fe6
semantic_categories: [truth-values]
digest: 4e521fa313ba9b83f1c67edef4b6157cdbcce10da9f31c716fd5e8e7ecb5d3e3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5cfe28f6e810ee61
chapter: CH-05
qa_id: QA-6a2d96a223b735aa
reference: BLK-2ceb4799a2c96bb9
semantic_categories: [truth-values]
digest: 2ea85239a9f01ebcfb1e64d51302e71fa0a9bf4907e20a31fccc863a11f1491f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aeab2f3385709ab1
chapter: CH-05
qa_id: QA-94070f0f43b966c0
reference: BLK-fac5338924d4d432
semantic_categories: [truth-values]
digest: 64093f1c9ef6cb72f14e5d0adb7f92e6c2055474b850a4302d0d0176fcfdafbc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-550aefedd60d29bc
chapter: CH-05
qa_id: QA-fc9a4e316c86ce58
reference: BLK-f5eae2ff1df643e4
semantic_categories: [truth-values]
digest: f42797f9f893a20b97ee455a354e7e2e895f68e75d1e0eb780d0080ed453f26c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-513232ebf162f46b
chapter: CH-05
qa_id: QA-4241d6aef4cd06eb
reference: BLK-9dd87631232b80f5
semantic_categories: [truth-values]
digest: 92140f9c9a6e72c09ce08f7d5631f7f8c8b42231f2100a1c0dec9b913fa88bac
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9157d83131fe7302
chapter: CH-05
qa_id: QA-741b38c931dde500
reference: BLK-b7a8495733a99b9e
semantic_categories: [truth-values]
digest: da056a18b7b6dee76a0d58c3aec088316ed02df7b4176d0ccbd6bb82a8599807
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-10ca6136be33c678
chapter: CH-05
qa_id: QA-466c3df94bca0b9f
reference: BLK-6e4d17c6138f8e98
semantic_categories: [truth-values]
digest: 37124384814383b2f23ced1e0e90b30f31f19aefa60b9eb210e02bc1478ca502
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-72a8e6a9a1ec7d43
chapter: CH-05
qa_id: QA-1a77ddd6f5f57a3d
reference: BLK-8ad24621e33d0824
semantic_categories: [truth-values]
digest: 34a8ec40f0a392eaa018b928f7c45d06191dc2da45504ee951231ccadcc67143
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ea811d117867b2d2
chapter: CH-05
qa_id: QA-eccce0b83db3f797
reference: BLK-5a57193e78bc4589
semantic_categories: [truth-values]
digest: 6110bd9083a315c054b874ba2abb8f5d47d38c5216520e644e914460bffa20fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9e7f48295e131182
chapter: CH-05
qa_id: QA-87758232f98bb3ce
reference: BLK-d4ff7978dd13cf56
semantic_categories: [truth-values]
digest: 115387e197e9f2ac4a5e9c1986214236daa0033b1c91aec39aafb1a5aeab92a8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7ecee9740e5832f8
chapter: CH-05
qa_id: QA-80782c50f32e86a9
reference: BLK-c163d16de7a9a92c
semantic_categories: [truth-values]
digest: ba7ace4d74bda4ae555abb1eae6b9e6553fa66af7fff7f2c1a92514ab5820c33
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-96ae7ae21daef993
chapter: CH-05
qa_id: QA-19b308b7474c89a3
reference: BLK-477027788171287a
semantic_categories: [truth-values]
digest: f55d13105a7d4383a824b1ea3312714527b3de64c2e19f3a6baa79b06cdb02ba
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ed83fadf0ea3c84b
chapter: CH-05
qa_id: QA-17309b67ff67992f
reference: BLK-1003fa1dd551feed
semantic_categories: [truth-values]
digest: dcf76ab7cb7ccfeddccb60416bcdacfa5ac0746791666890ac54798bb20f1ff0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4313f66320bf2474
chapter: CH-05
qa_id: QA-7edf27887c80685b
reference: BLK-a99828297e3dc974
semantic_categories: [truth-values]
digest: 5540467eecdf082a2e65b959e41f3be3e5de28dd46e906d026f1b015c2ea083a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5432f4c654ae5825
chapter: CH-05
qa_id: QA-9a6519fd0bbe6290
reference: BLK-ed618edd2a05c651
semantic_categories: [truth-values]
digest: b9811061463f8d40a0b334d48123ece65f22721f4fec23aade36f81c2e039bad
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d5ef0ba4947280dc
chapter: CH-05
qa_id: QA-909e99edae4cfe4e
reference: BLK-80e59217aeec7749
semantic_categories: [truth-values]
digest: 1839fdfd834a8329bb408c92577d59c3c0d8db5f76254460aefa7c6053d6d56b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ba6e568509544de5
chapter: CH-05
qa_id: QA-70ab1741cb6a57c3
reference: BLK-2326d2661bb082c0
semantic_categories: [truth-values]
digest: b914a5e54b8fa6c7ef589b757239f935016609ba2db413ad2a5971297e4d98a7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fcc73a97a486a755
chapter: CH-05
qa_id: QA-760239fbd7de1699
reference: BLK-b4e88b76bdf8c0c0
semantic_categories: [truth-values]
digest: 47fc1dbe5ba0a53f164059b8139334be42c1f7b532f4991d3293c5101574b60d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d714ffd2b0628b67
chapter: CH-05
qa_id: QA-1aa8fd5befe00f6b
reference: BLK-b75673f31a5a408f
semantic_categories: [truth-values]
digest: ba8d8cfce8392945744a46134b114af938959ebf9203ee54f1029d06c42c2b72
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b2fdcee4c05cb165
chapter: CH-05
qa_id: QA-02932a4e42a04c09
reference: BLK-05ff27cf94f0f286
semantic_categories: [truth-values]
digest: a1d07434c59618d82299c68de3ccfdc78a780b0f7b94f42ecc7a46e62349a930
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-63de36c7a349a297
chapter: CH-05
qa_id: QA-6df8bab96c859ec2
reference: BLK-441c9184c5a43cc2
semantic_categories: [truth-values]
digest: d4d73a88183427b985c612e0633612757958d4d065c5253315ae964dde5e5951
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0cb6fb41b8a96001
chapter: CH-05
qa_id: QA-c13e69984f0dafa9
reference: BLK-bda11239f7ba578b
semantic_categories: [truth-values]
digest: 799d634ada2095a701d646f8aa6f27f30b42ee84b2bc16ae989a65ef5c88e02c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a1a70e11e30ad46d
chapter: CH-05
qa_id: QA-55a596072f58e6c5
reference: BLK-d34d0d419aa0c7e2
semantic_categories: [truth-values]
digest: 43414d9607442a8729b19fa3457a639767b96622183b975150b236443dc885f5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-20cab21e5b58004b
chapter: CH-05
qa_id: QA-71518a1c7b268ea9
reference: BLK-5bbfded757016e50
semantic_categories: [truth-values]
digest: 33315d66309308d6c33fadd0a9c4d6b3f8b1da4c8d1fb5988e669127f136155b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-91e9ef96ac119187
chapter: CH-05
qa_id: QA-1ba84079afda3478
reference: BLK-69b6a886fdd31d76
semantic_categories: [truth-values]
digest: bccde90591c42e1c206c5d25bb778ff598511e70d54c2d2693b7baa5d1d595c7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fe578a4221a32a35
chapter: CH-05
qa_id: QA-3af28de9a02c6437
reference: BLK-faf25efc6ab6024c
semantic_categories: [truth-values]
digest: 139bd2a68289249a30b53f893e654225ffbeeef91a6c50cbcaf5b7d72e211312
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b18cf5365abc5378
chapter: CH-05
qa_id: QA-5ad778a307823620
reference: BLK-cc9220c066084a66
semantic_categories: [truth-values]
digest: 35fb6893d44530590b672e68e7aa5f49dc2ebd0e9c98746039e7e39d766f2afa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4ebc7fe8338fab9c
chapter: CH-05
qa_id: QA-57e8cf0c31015e2e
reference: BLK-ae2f270b91be8579
semantic_categories: [truth-values]
digest: c87aee3dfa89a2475356172e4692ea78dd0a75fe3d6266efa6e6fc70272437fa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ab2896087245eb64
chapter: CH-05
qa_id: QA-a09aeed9b738677a
reference: BLK-0ac25a2b767e2140
semantic_categories: [truth-values]
digest: 6d7fa55e7a54c2fe1df283bb2c0201e654fe69a351792456144f586714289449
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-36f44382db6510a7
chapter: CH-05
qa_id: QA-25ba3a55ddbe8767
reference: BLK-c70f9f364e197266
semantic_categories: [truth-values]
digest: 1ed17689d520d221de97562350de653ab6cd74eae1f24a5671a56650d03372ad
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-62283fd4a416af83
chapter: CH-05
qa_id: QA-bffac705dea3344a
reference: BLK-f5381b4672ab8919
semantic_categories: [truth-values]
digest: d3fc5914910893d7b5e0596a5044c8ae6fb56b54f90efd545a97828541ac225b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5c490993f0072e2c
chapter: CH-05
qa_id: QA-c837a29060b2dd97
reference: BLK-f65b10d7491c5a74
semantic_categories: [truth-values]
digest: 3701b2e3540db5d347c1e63fbaacfc4c558fbe141a9bd306e3ffe527db2e2fe9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a0c8bdbcebe5f717
chapter: CH-05
qa_id: QA-76f7564b3c39e759
reference: BLK-0e8c5e2011dd4b9b
semantic_categories: [truth-values]
digest: 18c23e6793617b52efe515bd3114821da3ad8f126d00708d03907b79081eb6dd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-30041f79ea92274d
chapter: CH-05
qa_id: QA-0c86de215745d87f
reference: BLK-c8f0e1b1efee8906
semantic_categories: [truth-values]
digest: 97c24a5a9cf9560756ca9a7cd01091f66ff6a9fa0feb8b85d1d4bb0d67260aca
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ace966609238c81f
chapter: CH-05
qa_id: QA-9748bad2dbb59198
reference: BLK-c1dbf3b38ab667e9
semantic_categories: [truth-values]
digest: 8f9983b466bd0bdc1a0a4cebd086fdb51fde491220457d61ff28b217bc6b3c15
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-67237473559389bf
chapter: CH-05
qa_id: QA-a4adf58a76ae5903
reference: BLK-778e8e4ce5250571
semantic_categories: [truth-values]
digest: 476a892f4757e4141205bbc000c9f3d72b4d8e90f4fdc2acf1e489c7b4718573
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-06b306c03babc714
chapter: CH-05
qa_id: QA-6e3161182cbf510f
reference: BLK-35e5e00ecdd4703e
semantic_categories: [truth-values]
digest: bc08366d38d09f988cc7c24254204294fb5f331947a55eee35412e1bbba2ef8a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3725a78fcd190f2b
chapter: CH-05
qa_id: QA-8c9701cfbb4df492
reference: BLK-edc2afac6508d102
semantic_categories: [truth-values]
digest: 8c8624ab2e01b11143ad048cd5674feeb3ead7575006a830281f1025020ebcca
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fdaf2b9dbfc99608
chapter: CH-05
qa_id: QA-345014ab4ad118fd
reference: BLK-561e364c0bc56c05
semantic_categories: [truth-values]
digest: 52f05e10b51386faedc62047f8ad57c3915326c78200e2c69b7344d133329dc0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f5238415fb31dd0f
chapter: CH-05
qa_id: QA-97f7bc04ef5e1300
reference: BLK-217a40a7d3f6722c
semantic_categories: [truth-values]
digest: 3d8bb16cae27110a623ddfc18c5f49563c8fc894fe0d69f3565d90c1afddc5aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f38750e0de42c83f
chapter: CH-05
qa_id: QA-e247375c69f2dbc9
reference: BLK-5feaf7cf3b0268ba
semantic_categories: [truth-values]
digest: c93ed79579490f5e88a2426827d9b864903a7ec5d0a9c5d51d4c1bef2becb612
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e18a0f3113cf8589
chapter: CH-05
qa_id: QA-b2cf3eed5c82ca52
reference: BLK-3632bbb69a6a4073
semantic_categories: [truth-values]
digest: 1a3fe2424fdd8a4cf130e2eec8988507b3e1707c9d5ba99edc2dff32fbd90af5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-542a7ffa403096cf
chapter: CH-05
qa_id: QA-fc0932de2fead7f6
reference: BLK-ecab223a7c0486a1
semantic_categories: [truth-values]
digest: c599f8d60324b4d4998f430524f54b772825e7b8ebccba8c2b121d93ccfe58e6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a710c89e3fbb51b8
chapter: CH-05
qa_id: QA-6be7597133479d48
reference: BLK-09019c1063d48428
semantic_categories: [truth-values]
digest: b6ed927fd815bc4a18fe9415ee28e99b7598a36934d25368d1142d8e778a2aeb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-696c6fc65059dfcc
chapter: CH-05
qa_id: QA-d369fb813620da62
reference: BLK-5e538168da6683e7
semantic_categories: [truth-values]
digest: 4dc5a3ac6d1271df3b7426af07b8ca5f7a44d42f170f37976635deabe7d295fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9a05b2a266b5bc35
chapter: CH-05
qa_id: QA-599f70b60319238b
reference: BLK-75950f14edf8397e
semantic_categories: [truth-values]
digest: c622471cd87150f99dd474d39e693f4cfe2a58239a389e7b5c464be11ad154af
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3defc3121dbeef57
chapter: CH-05
qa_id: QA-278133a869055c85
reference: BLK-aa71c08475407014
semantic_categories: [truth-values]
digest: cb0c47f4c7dabb6c6c582054c7c0bc05609cf8cf6edc6000020a240a9f638e11
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-793768bee2ac645a
chapter: CH-05
qa_id: QA-e8188c23330655e6
reference: BLK-1708ce308bfcfad0
semantic_categories: [truth-values]
digest: 7b093d4a67f6d7987e45c2c45ca0f129dea6ff3e057f21321700716c7c422a4c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-165d4533a9c79cd8
chapter: CH-05
qa_id: QA-097a7ac981b34f09
reference: BLK-bb3abd47870bb2d7
semantic_categories: [truth-values]
digest: 7ee319de85b6b8c3e69d586328b1ff65c03dcf7303b7548a34fe89a1f8254780
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-13dabb889643c6d3
chapter: CH-05
qa_id: QA-87c62eab173a70ef
reference: BLK-2f580e08bcbba95e
semantic_categories: [truth-values]
digest: d829189bac812d989cbd4f7483b2d9e4f05f74c6e81b0230f2b8689a6725184e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f02af6bfba21f2b7
chapter: CH-05
qa_id: QA-d585f6c03c797730
reference: BLK-2a2bc1ccf807b459
semantic_categories: [truth-values]
digest: 06778562a76339c6319d29f78de69809848f3414e9a105e28dcba1d143f97156
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5fbfb534ccf68d54
chapter: CH-05
qa_id: QA-96ed04521209aff2
reference: BLK-3dc6f99a487983ea
semantic_categories: [truth-values]
digest: 94d28a5337a2e335c30548044891a5bca9e02ba89e300b3d7f6a46a3d064a9c9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c66b3a63cc843e71
chapter: CH-05
qa_id: QA-f4f6b1bf048e0a65
reference: BLK-489f1a3e7b195d7f
semantic_categories: [truth-values]
digest: ce7b200fc532103c1728cc9864c5dc44546be2dbf6881e6e59781c5657ec8f35
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7549582a822d5af2
chapter: CH-05
qa_id: QA-327310094e4f494f
reference: BLK-23d21738b0f1b56f
semantic_categories: [truth-values]
digest: 23e536ac5cccb372e1cd394c7e2e4344572cfcc02e2ffe9c4ba8492eb6398667
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3d793bf7564937b8
chapter: CH-05
qa_id: QA-fdda7c2cbfb2278f
reference: BLK-d94d9a8b50f394c0
semantic_categories: [truth-values]
digest: 3cb3cb485b34ea812ff79ffd21725e8e1311b76e40312e8e68e9f8d5f154293f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-af306b74b2889866
chapter: CH-05
qa_id: QA-abd1a2af8757a0a5
reference: BLK-84861e440fcba053
semantic_categories: [truth-values]
digest: b4dccabb3394e6b50512e16441714e5233f0b7519388747c057724415a41c856
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3d92cf79f6b8fb47
chapter: CH-05
qa_id: QA-a69be5b6c756ef06
reference: BLK-42ff1a2ed90a4135
semantic_categories: [truth-values]
digest: 61797fa831bfaf466e83fd7649d2957411ef072d32f2040b1200880bcd833904
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c0c6538c0c77b44c
chapter: CH-05
qa_id: QA-c010ecdcce11f033
reference: BLK-b5bff85150d3377c
semantic_categories: [truth-values]
digest: cc56653aad54077d6236af48cf9bf4882c219550d8c30bc54bb6f930fba2525b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aa9dfc33e5b59e2d
chapter: CH-05
qa_id: QA-47779488effc8ad0
reference: BLK-baba7ac4a7b4d63d
semantic_categories: [truth-values]
digest: dada7a977ef528c4fa58381d30b7af67e6411f0c293403a4e9de4d9b84168d44
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-76254ab55da40481
chapter: CH-05
qa_id: QA-8ea2d48524a70fe1
reference: BLK-e0c6ec40c537eb08
semantic_categories: [truth-values]
digest: d5023402dde9fd0235f18030bb535a775d54af69911a822e27956a2aa029857a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ffda9cc8d91a7d0e
chapter: CH-05
qa_id: QA-27bd0a36f1ebd345
reference: BLK-1804a20482d1b343
semantic_categories: [truth-values]
digest: beb3297dc3dcfe9ff8ae4867f99fc280419d687961330383e99d0ab6728ccc12
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-71ad59420ada74e5
chapter: CH-05
qa_id: QA-881b84c3e6e6b8ee
reference: BLK-39ed6f20348b8623
semantic_categories: [truth-values]
digest: 4aec6fb819b0f8d345f564aaa1705c8d42249d3f40ba2bb2f701777c16031772
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4a8f9681ccb0a577
chapter: CH-05
qa_id: QA-e9cc6cdb37854503
reference: BLK-2290e821ea646404
semantic_categories: [truth-values]
digest: f8ed82beb43af441de0f7650b6feb285839e3a6cdf5b25ab208141b8c7735616
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0f64b201a077d073
chapter: CH-05
qa_id: QA-cb61b1307cbc4a4e
reference: BLK-0f57f72096c4c8a0
semantic_categories: [truth-values]
digest: c8084e0c87c97be7c976e0ed528f76510bc9ed8aafd1dba3fb99612226e8c7fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-496466a2a511e833
chapter: CH-05
qa_id: QA-9aad57c2e204786e
reference: BLK-4ce77748e8276750
semantic_categories: [truth-values]
digest: 8287bcb07b2ad94e280e4855f789bd65fb5563deb05da70882ff41e5d6aae99f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-73af8ba34d1e9792
chapter: CH-05
qa_id: QA-32b90444eb477b64
reference: BLK-d936cb7e30a4ea67
semantic_categories: [truth-values]
digest: 7a1ac806eb5287143d2e95a976973d0bed1f68d87eb9d5a766094f94f14f3c11
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e8a0f788b27b7415
chapter: CH-05
qa_id: QA-129f525eae1f3661
reference: BLK-36ea9500bf4999b0
semantic_categories: [truth-values]
digest: f5d9c4c146a04471f532944edd9dead87699be27b591907fc9ee58c3c96d8ce2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a81feacb3b9bf805
chapter: CH-05
qa_id: QA-bdb5b6e977f7c208
reference: BLK-d8cbad3b94589fdb
semantic_categories: [truth-values]
digest: d06b6b036581529d564ccfc54969101e342f92d9dd979c919157a2ab6d527070
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f7a2f7db5620a021
chapter: CH-05
qa_id: QA-d2b611f38599568f
reference: BLK-f234f625c8beddfc
semantic_categories: [truth-values]
digest: 9cf48003545fbbe8d9a8efa9736637c3d6bc7c1d6718109df59e9447e81448b1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-74710dd46fa913c9
chapter: CH-05
qa_id: QA-3fbfb249d182f2ff
reference: BLK-3ed64c8d88ca8eca
semantic_categories: [truth-values]
digest: be709ccbd2e5ec14a8b8b1b864704c3fafc24109a4f7a204b3d6b7bed0d13770
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4e58b1e6c4565ce8
chapter: CH-05
qa_id: QA-f0b51f7c7778337d
reference: BLK-21b409432e66beb2
semantic_categories: [truth-values]
digest: 86801159aae6ff18fbbabc3ce236ca6c89db5e4e2665a43e336ca41456142352
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b45da0cc859c0ee3
chapter: CH-05
qa_id: QA-31a493e3473888df
reference: BLK-97ebf04ed742eadc
semantic_categories: [truth-values]
digest: 575f9132da47ef5994a8559a0decea799c44884c4ac56be86f1bbe7b477018a8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b83927dee6ac6fd7
chapter: CH-05
qa_id: QA-6041c22e5d198f6e
reference: BLK-56ab8a64b9bbcf14
semantic_categories: [truth-values]
digest: e8b84c45e0ca02a720331dc6246b28062bd10a3882f72b146f8b6cffaab90ef6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-94c39c54504fee48
chapter: CH-05
qa_id: QA-c2aa49f74e0175da
reference: BLK-980f1c312cf40eb8
semantic_categories: [truth-values]
digest: 9a547fb5caa2ed744433f0d5d0a7061e1580cd4aeb999e1d87b8ef5f6773d8bc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-242f5cb1b2224aee
chapter: CH-05
qa_id: QA-895330a0c5461a25
reference: BLK-d10604b78eaedde3
semantic_categories: [truth-values]
digest: e0016c06329aa3e4ccdbdd647c504d8cdd8e584b1584e297011710de7c91f3df
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8e67c5a523b5e9b3
chapter: CH-05
qa_id: QA-e019a5835c804237
reference: BLK-3cec2ea33dbc48c5
semantic_categories: [truth-values]
digest: ccf5ca841a69c506aa1d8a9df24a4675232043783243cc5bf8d526e486112fd9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-431c64a9ebfbe4bd
chapter: CH-05
qa_id: QA-2739fd4904507e41
reference: BLK-b808b17ee8a689c6
semantic_categories: [truth-values]
digest: 842daa918bcd02e6079f512fcd7fca07827c0681277c88047767673c059e8c34
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-434ea040b3a916e6
chapter: CH-05
qa_id: QA-8d9a2f41ec9e23b2
reference: BLK-33fa20a5d4c88b66
semantic_categories: [truth-values]
digest: 4449030cb30b0564b4ecdb50dd98f6129b7c00c1f958c6fe67bac64dd562d957
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b7b660b427dc78a7
chapter: CH-05
qa_id: QA-7ceb46cdb7ea7697
reference: BLK-70478133c7e3b2e9
semantic_categories: [truth-values]
digest: 0e65d67557366fd948ea4316e136c46626fc313cd99690dfd921d3771bab3e89
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0ebf5f03117a36a8
chapter: CH-05
qa_id: QA-f95006543bf79921
reference: BLK-03fccd8e6d2155ad
semantic_categories: [truth-values]
digest: 27c50f8db1a9b428005cf2e091f8df7d4e976eb18a8568dde116418e68b1f2b3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fff5c835eb2e8335
chapter: CH-05
qa_id: QA-f5b8842d8f397471
reference: BLK-270b38e64b2b00e3
semantic_categories: [truth-values]
digest: 72fabb87454ef7f116e01d484ee2cae74e009428626094f9fe20be905979fdf1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b25e8f7bb1a26816
chapter: CH-05
qa_id: QA-0c92096ab3271795
reference: BLK-70a8f91f82a18e3d
semantic_categories: [truth-values]
digest: f4c77f85aab58e558fe6751d7efba7fda5aa35fc36dc6933f26f3807fa8b9a4e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2a6bd571eaf91355
chapter: CH-05
qa_id: QA-c60a9db4529168a9
reference: BLK-fbbe119189f2ab36
semantic_categories: [truth-values]
digest: 088f3ed909ee672188370fd60c06b51c1b54b9fd2b60a1147a37818772c9ae27
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8e9f06dc5fd3b969
chapter: CH-05
qa_id: QA-721618cc8d81c944
reference: BLK-54d277aeaababbe9
semantic_categories: [truth-values]
digest: adac9698fe2ce229175f99f2ab610aaef676481200c4328d68ac7b32144649ee
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-76aa018a819bc8e7
chapter: CH-05
qa_id: QA-ccdfd4880bc2d838
reference: BLK-405a975fd98ce06b
semantic_categories: [truth-values]
digest: 5502e9bbc14eeb9be522e94e0a2b1c75c51c5f6f0d7efbe11e6e77df9c2de52a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1a1ea6e601abc2df
chapter: CH-05
qa_id: QA-1544151535ec80b1
reference: BLK-7f7b19bbfe9ca742
semantic_categories: [truth-values]
digest: bb697b8ce68a65f5fd48b041ada95caf9cf49c85c801be8c5196b4cf63df4350
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2d2dfc3c0d20ec06
chapter: CH-05
qa_id: QA-3973669dd3a66389
reference: BLK-09066e199d225e96
semantic_categories: [truth-values]
digest: 49137f529a2d7fcffa8b3e72eccc82e124798f32a9f3e89962480db2e75396aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e0442229f268c214
chapter: CH-05
qa_id: QA-e8582c6d8f257732
reference: BLK-2ef9e325c3ede69b
semantic_categories: [truth-values]
digest: 9ad86bdfdc801847bb1a86a540ef99ec17320d372f5daee562053897b5b86484
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-06cd76ff4478b250
chapter: CH-05
qa_id: QA-8a868281ae3ca4be
reference: BLK-6c4f81cc9fa85914
semantic_categories: [truth-values]
digest: 69f1cc5836b903448ebd4e6676f93bd05f8d13ecb537f2e05e8ac65dc1c20ba8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c7091c1de67052a1
chapter: CH-05
qa_id: QA-73af52fe3c037db5
reference: BLK-0e04cfd232a00a3d
semantic_categories: [truth-values]
digest: 67f1a42d72fa00197fcd8d22483472ba1c8e3528cf2effc8cefb34deffc9bb9d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0536f97f6d945d09
chapter: CH-05
qa_id: QA-d38127c277f76755
reference: BLK-0b9f5a2396b4bc82
semantic_categories: [truth-values]
digest: 53fc67d4e38d9b3402c4f71a64c4585d8cc92ccc84bb181204fb476d1f1425de
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-518c089ca2c6a3e3
chapter: CH-05
qa_id: QA-df7525617db01e55
reference: BLK-b23aa9257026f9c0
semantic_categories: [truth-values]
digest: 7b423796249a4f58acb7285c9420e981eae9315e647d88193245191aeb701fca
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-179abe4510b0d63a
chapter: CH-05
qa_id: QA-119793bf7dd444b0
reference: BLK-8b09faf1219c8625
semantic_categories: [truth-values]
digest: 4fab18cf00daab5f93b2c9e6d1b5a209a93443ce599247dc591f737b180ba300
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6d590d8ab6e5bbe2
chapter: CH-05
qa_id: QA-280963056a985106
reference: BLK-a39d79842263ba83
semantic_categories: [truth-values]
digest: dc1205eb4eae4dace4bb4d341b0b303a07497131bdb540652f0f26436a09cc8b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1a6007f3361058cd
chapter: CH-05
qa_id: QA-cac44acfcab95a01
reference: BLK-8c30db71e7f93b4d
semantic_categories: [truth-values]
digest: 35e299cdf902e3c6a54ba22edf74e03a67643940eb757e21091a9e74227aa4e7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b6804aa6a6bb4fb5
chapter: CH-05
qa_id: QA-48b518ceb142a751
reference: BLK-2757c170b17bf0a0
semantic_categories: [truth-values]
digest: 72b0e51fe77e4ed422a97f1ae2e2beafdbb15d794aea310ce34c15b90e909e6e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8b01a11268add613
chapter: CH-05
qa_id: QA-057a1d17227620ea
reference: BLK-94f8c149d00a676c
semantic_categories: [truth-values]
digest: 75ce7af2a4a41f912f09395fc43db225fa8273ca0762b41dbfe8bc70cde39490
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5763050f60f30ed6
chapter: CH-05
qa_id: QA-8b1d6e96f98638f2
reference: BLK-c1e1ad2a784b9961
semantic_categories: [truth-values]
digest: 43709da8a52ebe0e2d6183bfa22b842fabeb22e0c8967630d3f9dee12ef1eb99
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7cc46c32d66c2db7
chapter: CH-05
qa_id: QA-8a811213a24b2399
reference: BLK-e9a2a703bbdc8110
semantic_categories: [truth-values]
digest: e734149e496eda45cdd91298a139e0d36c8a7da12ff6273d9607ceb4750521b0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-197abd3804e0b411
chapter: CH-05
qa_id: QA-a82bb1afc7e4d9ba
reference: BLK-5fe91289cef7406b
semantic_categories: [truth-values]
digest: e25388eadb28d192d3b169a38974fcefb563989310a486183edb5fbf13bcc1aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b747dc74b4cf5407
chapter: CH-05
qa_id: QA-9652e829c267adae
reference: BLK-3062214c3efb9bc9
semantic_categories: [truth-values]
digest: 599a3627339a492b52025795d97a5e45594ae1fe94603c17868e39f33e08f2d2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-57a83c14f27af7cf
chapter: CH-05
qa_id: QA-66e37d0f4def50ad
reference: BLK-01dc213f722cd9db
semantic_categories: [truth-values]
digest: e6a084712d9cc39f3fd61fb0c81952a065d7e6fb71923ea030b1f5ad0301fff4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1c02c1df480c5694
chapter: CH-05
qa_id: QA-f0d154284cb02412
reference: BLK-7e368e0110cc4ce5
semantic_categories: [truth-values]
digest: 320230eb99e545762633d3ec9aee84470e57622083519c4aecc2e11668b60ba3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-74daca5254a05367
chapter: CH-05
qa_id: QA-74ee93244fcbf731
reference: BLK-bd9cc15be97aaac3
semantic_categories: [truth-values]
digest: b7a09b432e2f649e50503a7c3a3f865e71b6b80836946f307bee9079875c9dd7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0c4afee93a0f0604
chapter: CH-05
qa_id: QA-881c6d3ad202dbe5
reference: BLK-66161b54f3ab4c92
semantic_categories: [truth-values]
digest: 361f1f99065da7227393450b7a2cf11b2fe192780417149dc19cd95d7a790dc0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-16e6cf03706e0006
chapter: CH-05
qa_id: QA-63e9059ca78cdfad
reference: BLK-d72d3ae58221ff67
semantic_categories: [truth-values]
digest: ae5b464e070714c3b5a3c16fd18cdf83af686a1151f138c62829e3421b1573b3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b70ed888b8c1b42c
chapter: CH-05
qa_id: QA-5b5d7e045c08e5bb
reference: BLK-47e95b45cc5edf3c
semantic_categories: [truth-values]
digest: 5fe59d16a81d8150f5eb396ecdb7bb6a5f75501ffc203e65d844de6adf1349cf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ae21e207ee413cb0
chapter: CH-05
qa_id: QA-320e7b55750c2f5e
reference: BLK-633a4a5154649ed1
semantic_categories: [truth-values]
digest: 29616477576d1f1588a8830610488ee1f2c3ef25545f448607554cba3a7fadeb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2f5977a1fbc28867
chapter: CH-05
qa_id: QA-47781507956ddcef
reference: BLK-4504655151caa66a
semantic_categories: [truth-values]
digest: b201245af208a856c9539e383feb9b4ad273b70e7ac92a9f4613a04cd59df124
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-45eb6ee84d694baf
chapter: CH-05
qa_id: QA-31dcac2da1fde021
reference: BLK-b7db79b559c9a8be
semantic_categories: [truth-values]
digest: 3b5f4c8638b1d6a6c1260721cf49d81627530d27c981594b9851480f89c70eb7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e7bd8a73131e0706
chapter: CH-05
qa_id: QA-afbe4f7265f5e147
reference: BLK-36c3bcd5e1134f4f
semantic_categories: [truth-values]
digest: ddc21c7cb69e0f4c4cd85222da35e34a1b9e30ba91f98612dc297238e5f958f0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-844ed049ceb6ceb7
chapter: CH-05
qa_id: QA-978b23bab8e0417f
reference: BLK-b7d90967e18de369
semantic_categories: [truth-values]
digest: 64723c2bd830b633610655ecee3f850a43a5136155d09402cbfa25cc12cbe712
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-94008ac062f2cabf
chapter: CH-05
qa_id: QA-6e6e7301604da4f2
reference: BLK-e35261e5caf2b447
semantic_categories: [truth-values]
digest: 42129569430652a6ba66f8e62cb805151d82b7942989d534a2b416237a48d531
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2a4bf6b5cefb948d
chapter: CH-05
qa_id: QA-3fe41b9ed262b05e
reference: BLK-dc69febaea17b4d4
semantic_categories: [truth-values]
digest: b7c867f5e26d7ee2a477b4d8bc2a04844feb8017b73184f0486b8e72706697d4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-333a275b94859fca
chapter: CH-05
qa_id: QA-d4b7028d6183510a
reference: BLK-e47efc5955420f53
semantic_categories: [truth-values]
digest: ad0e95e73bec41486bc93bef5d97db5f1678cba5931fe36031f931b96a2d7719
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-13f33be438ce8bc1
chapter: CH-05
qa_id: QA-0118e7a2f2310050
reference: BLK-7c1a3d4a579c38de
semantic_categories: [truth-values]
digest: 93bb4a3e1d9670678d4fd563e8cc603e1c97bf8017e0c3c6f24fabc8c281c2b9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e4ba866a28e292d8
chapter: CH-05
qa_id: QA-4da0a36adffa1c5c
reference: BLK-e4237f7442d9769a
semantic_categories: [truth-values]
digest: 29fed421ee8c3beb9d4b1b73d98e37d759e0a9a6fb923c933bfc323c72586606
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-22dfdd56b8fd9af8
chapter: CH-05
qa_id: QA-70747cb862c64449
reference: BLK-365c96c74e794ad8
semantic_categories: [truth-values]
digest: 99781189fdd5c64435d4651fab0d7aa1bc1635523db373945620917d05bcd263
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2968cbfb347e7d07
chapter: CH-05
qa_id: QA-9384e3d64e5a5c0f
reference: BLK-624f75dd97acc370
semantic_categories: [truth-values]
digest: 69fea3c33fb219719265c509dae3db08ad60b694adbd34d2de956eb670cf06f9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-810d9c033bbcb597
chapter: CH-05
qa_id: QA-0a119fe4b2dcf0e2
reference: BLK-7b110b84bf4a7140
semantic_categories: [truth-values]
digest: cb36ba4025209ba560ee54ff72d73beaa9cb8ec4d78f6827843aa42a944852d1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ca370dd38a1daf36
chapter: CH-05
qa_id: QA-12cd0958b2d800ad
reference: BLK-d4b34685c6fe166d
semantic_categories: [truth-values]
digest: 276654a8cba3ec5cacb015b559628348f4e2508b25ba20a9d1f6b56ced5d5a5c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-99a7386aa43d2fb9
chapter: CH-05
qa_id: QA-f9179006b9000796
reference: BLK-21057b3108817270
semantic_categories: [truth-values]
digest: 501c8987ff25e8b2543b3a248e9fc3ee5520e4db142f75c70b38eb40f71604e5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f3786b96347586e2
chapter: CH-05
qa_id: QA-377bf6cdf5b71c82
reference: BLK-9c0b54c322f0cfd2
semantic_categories: [truth-values]
digest: 039b8d439683870596c46a81a01bab4dbbb9c880005eb0b9d3cacd0c76ebf5f6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-08bdd1c1faa35a00
chapter: CH-05
qa_id: QA-3f119339c0fd890a
reference: BLK-831a0270acb78581
semantic_categories: [truth-values]
digest: 049b811462aea38cf44e962a62b61e1edbccebc258c8491906ab778f06327040
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-63a54cabfc1caca8
chapter: CH-05
qa_id: QA-8bf6e6b24143a5ae
reference: BLK-825177e2f70d19a9
semantic_categories: [truth-values]
digest: 9984cb07a15df4431e07908df406e0400e1d2a2a2fb58d4af4cc742d3c70e481
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bc7f98a14bc812c6
chapter: CH-05
qa_id: QA-10ab36e82365fc36
reference: BLK-67a3905c24c8c0ec
semantic_categories: [truth-values]
digest: f617d1f6d8ad834a9df97a3d89cb345ef473911ef97311682ede0a34f2a963a5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-32e84ff43f5ae450
chapter: CH-05
qa_id: QA-de0243f144783531
reference: BLK-55ada30082a8703f
semantic_categories: [truth-values]
digest: 7841979a92f00b16ab4ceffc1827d75d23fb9f6830374579affa04a4bacf71c2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ef7b9803094c37c9
chapter: CH-05
qa_id: QA-777e83443d0df451
reference: BLK-b5937dcce3d0252f
semantic_categories: [truth-values]
digest: 82bb33c609b49805902619437bb5fc33f81a1290714a35e2ee98e301a9cde659
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-09dee236347147e5
chapter: CH-05
qa_id: QA-2d7897d59e15c908
reference: BLK-79448506eb420437
semantic_categories: [truth-values]
digest: 8321ebbee0b13effa7be0dba1336ef9fe5b4a71be9340b97f7056db229773ad8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-babcd348f19176b2
chapter: CH-05
qa_id: QA-19479e7fc2ac5297
reference: BLK-b7157bcb8e94b0ed
semantic_categories: [truth-values]
digest: 7dd774b7f60bf231ebc941ccf74527d70923cff9f87a2fee1352cd26aba23e75
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-29b75dca9a4a8d2a
chapter: CH-05
qa_id: QA-02cd2c3f8ead0fb9
reference: BLK-2e17d5deecfb16e9
semantic_categories: [truth-values]
digest: 5d6c322905524ade78716b6d7fa7a28d44dca03bbb4463f8b7108c7e25ea8335
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1eac9e32f4336abf
chapter: CH-05
qa_id: QA-32241de7079a4b7d
reference: BLK-d2517da8161f68a7
semantic_categories: [truth-values]
digest: b4154cd1c3db3dbcf83df2467cc646ac4a24db1e3e3dcd4ed966b4cfc48b2b5a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e23cac8b65799701
chapter: CH-05
qa_id: QA-5cd38447b501c995
reference: BLK-c6c12d42e06d1082
semantic_categories: [truth-values]
digest: cf88c4d53f9d15daa3f79cb0be89dbe7ce752d09ff56cec6534c332909e81b4a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ea2fea50ca835420
chapter: CH-05
qa_id: QA-f33bab17bbe2d955
reference: BLK-352021e25dd18271
semantic_categories: [truth-values]
digest: bd1edb5efd7db109db11740ff3e258da7ff4260275b2ebae71341a1b0929838a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-54fd282734a3c596
chapter: CH-05
qa_id: QA-bcd88ad1d99d82c1
reference: BLK-05f8217e07cce144
semantic_categories: [truth-values]
digest: b97ef22bdb22d72ffa860899d63daa96c082433c0107b73372dfaffb9dcae72b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b8e32fae0a6babfd
chapter: CH-05
qa_id: QA-4e07a9d1832023ce
reference: BLK-5178d3c470aafde0
semantic_categories: [truth-values]
digest: 346f28b464c2a55da1e9b3a45a3664e5febafe49989861dee126763e0db080b9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-359f8f4f078b2e2c
chapter: CH-05
qa_id: QA-8ab798dcca99d22d
reference: BLK-99693fd9c0631dc9
semantic_categories: [truth-values]
digest: 6e51e4117466938c119947d327131db93fd601129f96fda32c4401a72e0b3c0d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8473efa141e06193
chapter: CH-05
qa_id: QA-403d827d24eb232f
reference: BLK-89b4222f574f5bd8
semantic_categories: [truth-values]
digest: 7a10213876db95d672299f2e75623d6e9955f0647346100ceb2fa374b8cfd1e3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cab058d635403536
chapter: CH-05
qa_id: QA-c263b8d2dcf4873c
reference: BLK-2b4b1821e0d0db43
semantic_categories: [truth-values]
digest: f7c5e7fb02f769193fe1c5f1ff55ac61a264b23f2991f8b40277d5c5d0bdb7c3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-afad3d08c0fb6b17
chapter: CH-05
qa_id: QA-9d4de9e84e885670
reference: BLK-b992c588b72a15d0
semantic_categories: [truth-values]
digest: d6660aadd8648ed0ccf1421c1b0c03aba81ffab6ee7ee152c95f8cce2aa565b3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7917f9aae205f0ed
chapter: CH-05
qa_id: QA-17554570acb51d70
reference: BLK-a62e5ffefca78bb2
semantic_categories: [truth-values]
digest: 74e99d30c08ddd2599ca5f4118a22442bbc7cf1b0dcd3aa9519bb6e05f4ebd2c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4c184bbf9962b845
chapter: CH-05
qa_id: QA-902dd19b73a15b1d
reference: BLK-a0d6a6b70fe5fdb9
semantic_categories: [truth-values]
digest: f54b9a2ffc39a886f66567cf26ad21a9213a5b2980ef398b6cf09fb035c7cb13
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a2547184ecc79e64
chapter: CH-05
qa_id: QA-be872eb91947e4b4
reference: BLK-d2bdd9db4aebc3a8
semantic_categories: [truth-values]
digest: a6897dd8e85fe7b0b3a624449b79257bc034dda87244c7fb892f6ffdc784d9fc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-58862b5e993d4bf3
chapter: CH-05
qa_id: QA-9659d93cc4d311ad
reference: BLK-637e77339c5814ec
semantic_categories: [truth-values]
digest: 54efe4769cb36cd5b148bdb977e6e5ccb45085973690282fe8cbc1eac2fac3ec
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-85db4886676c066e
chapter: CH-05
qa_id: QA-e00a3f798e03f934
reference: BLK-8824da1c32a641ad
semantic_categories: [truth-values]
digest: 6d0b92fb10b92a81e58618b6da83691b93c1d2ee773c283956bd947d232ee182
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5de96945e4ed1d3b
chapter: CH-05
qa_id: QA-86557e0b1152bb20
reference: BLK-13991d114e5dea7e
semantic_categories: [truth-values]
digest: 484240735bc7f87a1ae092f355c6855fd0bcc85eb36727a737ea44a59936d073
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fac1bb16b39fb9db
chapter: CH-05
qa_id: QA-1e516df87bf145e4
reference: BLK-52bb492156ce1912
semantic_categories: [truth-values]
digest: aa1903039fd354f50bdf13b70f75cd892dc0785a383122fae55e50a0e2e564f8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b3a13daf3029f934
chapter: CH-05
qa_id: QA-b6bc85559eb4fa29
reference: BLK-322b0467c2590b89
semantic_categories: [truth-values]
digest: 4db6121db964b57daea4723574a023eb8202e4c526c21d76de7f436dbd389845
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-383fa449f539b312
chapter: CH-05
qa_id: QA-aaa090646b0a0652
reference: BLK-0ce0885ddcf9ff4e
semantic_categories: [truth-values]
digest: 6ef5770bd980fafa307d18bfaed96b746bf46ce93202327bb3e1b7294ca59245
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9c9cd538e4984f14
chapter: CH-05
qa_id: QA-60085d8d09ca3cd2
reference: BLK-1b7adba70540b67a
semantic_categories: [truth-values]
digest: 2f3a600b6cd13da3c993df00312d66eb7269ae2b08b14ef1e87b306f08e55952
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ad9cd89eeba944d8
chapter: CH-05
qa_id: QA-73c7bb71b2433961
reference: BLK-a7dbd4176f57e16c
semantic_categories: [truth-values]
digest: 08e26e8b695719b7a4355232a7f8542debaaaa6da7a30214fcb412198eeb8af1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a92ee01e5778c83e
chapter: CH-05
qa_id: QA-9293836814ffcc87
reference: BLK-223e103f0ca5d229
semantic_categories: [truth-values]
digest: 2511fccbcf5fc1701fdb56f6985a20a557e5bf3f59d2e93a208516fb29ffbc67
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c59691bb14ad5f9b
chapter: CH-05
qa_id: QA-2666f7eb4e712034
reference: BLK-f467d2011eab9dfc
semantic_categories: [truth-values]
digest: ba1e291151105852f944f866365f535154cfaafd083df4a77e35c50e6960512e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a927eaec2e6ebc78
chapter: CH-05
qa_id: QA-131b86384ddffab5
reference: BLK-dc6be62dc0d450eb
semantic_categories: [truth-values]
digest: 3177561779bae694f8e7a9a7bec1dede0c79fe267a15306874b994b007dc1763
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-650a605fb812e2d8
chapter: CH-05
qa_id: QA-ac57a016ee0add40
reference: BLK-84a9bbab21a7036f
semantic_categories: [truth-values]
digest: 5ccfad8ac67754a694f0f3994318e1fe3baa4f4570d8b4aac6406215439dcb0a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d2db4832bc6f762d
chapter: CH-05
qa_id: QA-9dff274cfc5dfe45
reference: BLK-de4bad29442a85ab
semantic_categories: [truth-values]
digest: d1cf0e08ba3f2b64bd8c6d4e6fe604f5ccd241094e286fce6744241118bfd446
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fd55e8d4d586f17d
chapter: CH-05
qa_id: QA-217888097154e30e
reference: BLK-981ffefdcd4afb94
semantic_categories: [truth-values]
digest: d14bbcda2a8ddd6df51e3555764478bf52355736aa728724fe0d05d20bf348f2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6472203dc33db319
chapter: CH-05
qa_id: QA-6272ccb95212f2be
reference: BLK-9124fbb631e1cbb3
semantic_categories: [truth-values]
digest: 64aa0188b928b42ae6431ac7b56a966253f806c7ecbee133da6f3e97b4549a32
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0e180801774ec11d
chapter: CH-05
qa_id: QA-b6ef7049e070a656
reference: BLK-d0f4b36469b3fdf9
semantic_categories: [truth-values]
digest: bc5468946b0e92eab72291de5824def846b6dc30c5ca564c6c9dc7d1be0511dd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8a319b4874388532
chapter: CH-05
qa_id: QA-fd047a325d98ade6
reference: BLK-a51da1defba3faaf
semantic_categories: [truth-values]
digest: 7e9dfd504b3dea5fd4ccfa63041cda48d4a7d717060c05c3bfd8722c9d0b1551
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c82b038a12d99ea6
chapter: CH-05
qa_id: QA-c1af655b78b8bd48
reference: BLK-5a847029cb16e01b
semantic_categories: [truth-values]
digest: 60d00ea30a57bb2fa18d753ebf409f510e08319e1813e073034bf978f650bd4e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-160f70576e30291f
chapter: CH-05
qa_id: QA-032a987af20db8bf
reference: BLK-bc5639f652d5d406
semantic_categories: [truth-values]
digest: aa2f48770b878f31072da589d5251ef015043bbdffd7b272bda468b90f41d00b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dac34a2ad1337c0c
chapter: CH-05
qa_id: QA-3a8fbc98d96b7b73
reference: BLK-05e28689781336be
semantic_categories: [truth-values]
digest: 0a894b8c6c98774229ffb1da278cfd082f38c3108f9a488a59d877226f49afde
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9f5c0061a10ce737
chapter: CH-05
qa_id: QA-bfccb0874e13be7e
reference: BLK-b9153a25532c29d8
semantic_categories: [truth-values]
digest: 9f3c92fc11e65a224709eb97774a4574227ee8b218bcff94f20df3c95c501fc3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a5791dac60575bc0
chapter: CH-05
qa_id: QA-56d92f97b5352756
reference: BLK-eca62ba9be73fa32
semantic_categories: [truth-values]
digest: 9dff47bc77804e29b2d428da602c4d7ca9c56498c27ba47bb4d9eb08e00ec303
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-83c33cb6d6470790
chapter: CH-05
qa_id: QA-1032c8abfdb94da7
reference: BLK-677d05531da1a273
semantic_categories: [truth-values]
digest: 330f24bddbff7be8e17fbc2085e49b6e8424584eaf0834a84289869344794590
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-face9cce41707686
chapter: CH-05
qa_id: QA-092c64fa829bc925
reference: BLK-93ffa0f5a38427e7
semantic_categories: [truth-values]
digest: 08fe99f4d29b4bd48429f855b6408aecdb6a74bc2290cdebf9d12e9981386663
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6ee5914e5bd851be
chapter: CH-05
qa_id: QA-ea747405a9b96b53
reference: BLK-1a7182fdc95d78a0
semantic_categories: [truth-values]
digest: d86abebe97c3c4f69df282bde13526263fa9e8f075f5621bbe9471f5bb67ac51
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ce9220e41e63e05e
chapter: CH-05
qa_id: QA-0a489aa533a125a2
reference: BLK-15363c301ec7d7cb
semantic_categories: [truth-values]
digest: c5a34b856602bfa289fde512455935cfb98fd82e71bcc0e179d1563966646d9f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9d8bb562922cd3b7
chapter: CH-05
qa_id: QA-4350108cd86dd8f6
reference: BLK-c888ec6fcbcc9a8d
semantic_categories: [truth-values]
digest: d5f4cfb1fc190914e41c55ed133b536ceb93d3276aee3c1866c7dd723cf1fef3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bb9e6ef8fae287e2
chapter: CH-05
qa_id: QA-6e3240605767eee5
reference: BLK-1e5b7b422e5753f5
semantic_categories: [truth-values]
digest: 195f7630c8d2596d493823b75872cefcbc456ee07b567c7720aa33f2a64b21a2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e664c494dbd4951e
chapter: CH-05
qa_id: QA-5ff22a782671f9cf
reference: BLK-a18f52daf68b5951
semantic_categories: [truth-values]
digest: 729160e24cb0e2cbd31d90384d72b605432b796d2165f1465205a03faa1aa420
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ec3a5c1790334889
chapter: CH-05
qa_id: QA-83ab71d076787242
reference: BLK-96e5ec08b719db94
semantic_categories: [truth-values]
digest: 74fb844d5f39fdd0c0c8a4bad5714b375f86eb1901e20857f040d4a362021684
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b91df6e71d780e80
chapter: CH-05
qa_id: QA-9d711dfe86fb7d0b
reference: BLK-d1deb4055bd6abbf
semantic_categories: [truth-values]
digest: c808231ec7d8c12268c4a4d3b96c68797e85ed8dbbeac5835a8ada367f8d4797
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-67e7614ea1537a4d
chapter: CH-05
qa_id: QA-d455496785227540
reference: BLK-ea1b59903a6ee23e
semantic_categories: [truth-values]
digest: 27a73b97b6f1faf6df7c6fe2a2682fc005ed267ec9f738cc0cbd805d5dfe8d30
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-601d7be59eb66553
chapter: CH-05
qa_id: QA-06254f294d3fdbab
reference: BLK-8aab5191c0a4c854
semantic_categories: [truth-values]
digest: 7846201ab5c97e5496078876db0ab531f56e302e140ce87f23afd2e0fd603032
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4ba68eb9b915c8e
chapter: CH-05
qa_id: QA-c839689483003d2e
reference: BLK-e671dc0247adca2d
semantic_categories: [truth-values]
digest: 437ef1ab42ef11d687e76b5bfa50daac557d40320a0ebd4b780abf59f5310c0a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2fc3a309e3e74d9f
chapter: CH-05
qa_id: QA-cccbfa377921e91a
reference: BLK-ff117af14d974338
semantic_categories: [truth-values]
digest: ea2ebd017d120bc86ef5b88d3bc26893fcedfc15c9d8567bc5e0084b2f256590
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cc7ab074f5ab7f4d
chapter: CH-05
qa_id: QA-6505b3677987c979
reference: BLK-88cc3f7309a3f03e
semantic_categories: [truth-values]
digest: bceb5bf391bc620ebd1b41122c1ca396d75a4b593ddbeedda858eef1d85b8945
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bed7c946aff7cd24
chapter: CH-05
qa_id: QA-9dfc5187c3858edb
reference: BLK-288854f032dcf91b
semantic_categories: [truth-values]
digest: a237ddcb7c8309bb90954756b9a4cc59ec3ccb816ae4bf8b8fa08e687a3f82c9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0fe937d1a8c5fde3
chapter: CH-05
qa_id: QA-9a4a82c74e10aaf5
reference: BLK-3ded27af0667e46d
semantic_categories: [truth-values]
digest: 0d1ae94883426d975a374bbf942ab57774b3fca82bef50a77120370d2c7db495
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-85b164f3a0b7205e
chapter: CH-05
qa_id: QA-67095c92f7dfdd8c
reference: BLK-1a1e1d4534d9231d
semantic_categories: [truth-values]
digest: 77b834ad55a20b3046bfbd2371f28df38cd2e58e3d49b09a29b7377878a082ea
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b04fbbf9cc1833f8
chapter: CH-05
qa_id: QA-a2ca5d89379342ca
reference: BLK-0700523bfa0d00a5
semantic_categories: [truth-values]
digest: d946751e5c0a578000a914a79ec62b5828c26e5ff61e34b951b7b2db50a09982
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-af983816b0c98070
chapter: CH-05
qa_id: QA-ba3a5855c59ca0f7
reference: BLK-01855145c4052297
semantic_categories: [truth-values]
digest: 121a402b639b98333c72ce0ac2e09ff70777149010e4afe36a8cafab24a7c369
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b1e59b40b57342c9
chapter: CH-05
qa_id: QA-963430a8a2ca6f60
reference: BLK-e91de7f88c47fe02
semantic_categories: [truth-values]
digest: 2a85478283b8163151b4af18c80b0ce75b8dc210cab4625dfd616f88c595bf13
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1ffed99eb9917c8a
chapter: CH-05
qa_id: QA-97ffb4cef576d111
reference: BLK-05bf15ca8721ad44
semantic_categories: [truth-values]
digest: c3ff21b3e7866e509006f7c24e2c7ba80ee696438ff2b04d72b0e508fe33f1bd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f70a11db6c762fd1
chapter: CH-05
qa_id: QA-641f2f67b3db9d2b
reference: BLK-27062c2f2ad4bea0
semantic_categories: [truth-values]
digest: 40932994837043e7f596e5bf925d6bcb60d53e31b57d0ceecf74645da2ee1126
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-90e0a388d1951d31
chapter: CH-05
qa_id: QA-926195cb016caeca
reference: BLK-bf8a85428b528a50
semantic_categories: [truth-values]
digest: 6c57acbcfa1786bf26cee9cd1681752c4ef667345522947b974a1dbdc46a37aa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a86ccb647506093a
chapter: CH-05
qa_id: QA-e59e4b7d2ffca166
reference: BLK-9a8c8c3ad33b8ee2
semantic_categories: [truth-values]
digest: 12f481c4bb10e610a8e8cc2ced9011aa03342b5aa27002bcbf89a563eb0f7952
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1fb5bf3730ae6e38
chapter: CH-05
qa_id: QA-edb26c9f5ff0d4f1
reference: BLK-0fc3cbba44a5ab8b
semantic_categories: [truth-values]
digest: 78ff5d62144dad5750fc12af6399924c8e402f147eaecb82d4ba426cb2819f9b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-81efca40bddafe64
chapter: CH-05
qa_id: QA-7aaa986cf7275bcb
reference: BLK-1d0b9f66d47eaeaf
semantic_categories: [truth-values]
digest: fb39561146cb9b2111482c9994ff055f001d848d3a3598ad597f3969604c1761
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f66dfa305e879d1b
chapter: CH-05
qa_id: QA-810ed027ed50e37d
reference: BLK-a55c36241eba7524
semantic_categories: [truth-values]
digest: 40f63873be68e4900031c23160c044a39d7f6b9b4eda19ff1c74529b187eae87
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-10ece70e7829bae1
chapter: CH-05
qa_id: QA-e380f2c2c08da70a
reference: BLK-ad7f2ed6a6987d63
semantic_categories: [truth-values]
digest: 0b39ca85c96582dab5134016cffe60d34070a4d398d32c8f3a495432f5835609
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e8b0f4b3c27e41d3
chapter: CH-05
qa_id: QA-1522cc281655af46
reference: BLK-442aa4acd401c5ce
semantic_categories: [truth-values]
digest: fc87d0b16b6ba0c48a5582855a12fa73d25ff8cf8e671f757463561db0f02105
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f035286e3c2ea23d
chapter: CH-05
qa_id: QA-19623044594ffed0
reference: BLK-befcf2864cbe4ba2
semantic_categories: [truth-values]
digest: 761bd2ecd408997014d60e4058341d122c2e9d662741f8e83fd5a1faa13b4fb1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5717d483cfe643c5
chapter: CH-05
qa_id: QA-b406a0c574f20b95
reference: BLK-b24e880e43548028
semantic_categories: [truth-values]
digest: 06938fba407b0edbe586859a63b0330826331a2eb3b5973cbb4e635c98bce552
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d0b7be6c6c088ec4
chapter: CH-05
qa_id: QA-c7cd97115006e29c
reference: BLK-4e06b56bed56546c
semantic_categories: [truth-values]
digest: 1d32c3e879305ae24147074c201781a6f95fcd728d07751b5af932ce2557004e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fb72d25737185830
chapter: CH-05
qa_id: QA-d5745a8433d06828
reference: BLK-3364104f50f32b25
semantic_categories: [truth-values]
digest: 9002733879296dcff15b2acdd354679139544786a436034be3ab97443428ba33
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6d2f58cfffb53f06
chapter: CH-05
qa_id: QA-7006ded3d5cbfb59
reference: BLK-bd36eb180f9a0870
semantic_categories: [truth-values]
digest: 0e6e0ee8b6cf189e708e0acf97efed7ef27aa990c2ee227f6a25c1f310cd6b1b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0096aaff622cf72a
chapter: CH-05
qa_id: QA-9aca6fbc8971c107
reference: BLK-0f79a0a4b3796507
semantic_categories: [truth-values]
digest: fb279f703c8f2df8a0a7ecc82d1bf74e7d6b6190cb12b86e7b398f30e7a1b3a0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c11d15041573fee7
chapter: CH-05
qa_id: QA-c173fd7f9553897c
reference: BLK-916a2b733c75da32
semantic_categories: [truth-values]
digest: 87d12181a5a6817a1d9f975d148e07241e049c45fa23724e3dbb4efee01c9605
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7514869097cd4eeb
chapter: CH-05
qa_id: QA-2547a4802a5f5455
reference: BLK-6f78ccb1a2aa0db5
semantic_categories: [truth-values]
digest: 48012626ad3f0146a7a0f93413fff1900e7ada1401a5bfd51b7e9aa4d0288285
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e1d1121d270bb86b
chapter: CH-05
qa_id: QA-3535c9bce449fa75
reference: BLK-055762078b24cd0d
semantic_categories: [truth-values]
digest: 32b246b9b478b497ff5212704ac49a88251c077d67c905826b81898b64166a71
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0d0649de0598540a
chapter: CH-05
qa_id: QA-ec2e82288aa3a9d7
reference: BLK-1e753a25a214b3ee
semantic_categories: [truth-values]
digest: 6aaa472ac32168f7a590db81ffddb0d4b555aeabeb72f94efde5a7503715c7c9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-03c4ff3e430de641
chapter: CH-05
qa_id: QA-93658e2e4e3b694a
reference: BLK-91376980b3497347
semantic_categories: [truth-values]
digest: 39734ef30f31a33fc163b7cb350687897564355137d5572babfe1a8f814eecd2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7a4682cca0380ed5
chapter: CH-05
qa_id: QA-0505646ec288f639
reference: BLK-fe348bf4a59d3eca
semantic_categories: [truth-values]
digest: 8db7180342021599ca8bab53b47790bf5c0fd3e229f9eb21ffac905200799a92
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3f1f9b568d40d01c
chapter: CH-05
qa_id: QA-49d8e0a607d089ef
reference: BLK-de0aa65f66c9c2e5
semantic_categories: [truth-values]
digest: dcc88bf290d5f690b16288a749ef2ce2ccfebd5dec76e32b989f213aaf978941
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-53b84933c6035bea
chapter: CH-05
qa_id: QA-f4f51c7aa3508c7d
reference: BLK-8bcbd5638e8f2f52
semantic_categories: [truth-values]
digest: 3148ddf746127c06c21308624dd11ed2cec298296fcaf03cd54538def514c5a9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d231ba907b6fe656
chapter: CH-05
qa_id: QA-d33f12eeb819f8fe
reference: BLK-811010e43f08ad56
semantic_categories: [truth-values]
digest: dac5e9c39ce3a9e4b88131d4fab7e0a99dd800de3692677c8b1d1591e720c327
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3e5ecd3db4857dbd
chapter: CH-05
qa_id: QA-4ea6e1befd5d3ef0
reference: BLK-402d3ae84b7a6ec5
semantic_categories: [truth-values]
digest: d35033bec97123006bcc1977aa09c2160bf9ba3b2dfac45892e813efb0f839b4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-733c647ca82308a5
chapter: CH-05
qa_id: QA-bb2bf8db89803ee5
reference: BLK-8912a891da49a895
semantic_categories: [truth-values]
digest: add1924c6eca4dd3b07c91eb32063f33dc43d8a8932a816ed3e18b2a4fd73af1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-671c58200f530805
chapter: CH-05
qa_id: QA-f7db536897806d0b
reference: BLK-4bbc8cdf4775092d
semantic_categories: [truth-values]
digest: d1702c1f5db61d36969ad503fc60fa80d429089e8d11cf6bf33b45743a3d54b5
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-29bd40b738692e6a
chapter: CH-05
qa_id: QA-0c1a4010dbc80b03
reference: BLK-a0487d3cbb802b3d
semantic_categories: [truth-values]
digest: 653afaaac55d00efe720d414d84b284de37ea498f893d92539217c38ad2c661e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-36a3287b80cb34b9
chapter: CH-05
qa_id: QA-a122f68c9ef0084d
reference: BLK-904181a17b9dcc04
semantic_categories: [truth-values]
digest: 007be023590239aaae9bc60ca3b4c5137c1712a8aca4fdfc3eeea1bd0451e349
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2d46cda7a89fda4b
chapter: CH-05
qa_id: QA-a0f72352fef26d8c
reference: BLK-8e593dfe4228799c
semantic_categories: [truth-values]
digest: c05894f099a0fd394965eed319a3a70911ae834d5689b6d004233e26422350e6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d0a158953a0dd49b
chapter: CH-05
qa_id: QA-1b5f04e60701a423
reference: BLK-cf1cf42e9d5ccf61
semantic_categories: [truth-values]
digest: f3ca48b41afac5c7bcebb317efc311185a556528898b446ea1f24feb34a5ca2a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-96162c5e17e3745a
chapter: CH-05
qa_id: QA-f0dbbefc7fa09b5a
reference: BLK-46c7fbb1283483ac
semantic_categories: [truth-values]
digest: 6f243e3232c8843617af62be798271fa64e569f39b59e4ca0348c23ff8337063
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dd4363a22e7a3554
chapter: CH-05
qa_id: QA-d4b69c1dc36b6965
reference: BLK-a3d9d649abe9ea27
semantic_categories: [truth-values]
digest: bf5de8c26898daed5e8cef1d7f49bd04c065a10e6571d936d3f3d5f8f42b7d9e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-562b6c74e102c30a
chapter: CH-05
qa_id: QA-49906e3b12fe553f
reference: BLK-f4849492414ac27e
semantic_categories: [truth-values]
digest: 84891ffdc547678949562aa9e2479c51eda030e6e869b7824db4235fcb194964
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5fdff173278fe838
chapter: CH-05
qa_id: QA-f67180fef23f8072
reference: BLK-e496ef913bfa6596
semantic_categories: [truth-values]
digest: b5faa1dd7e9533f858409639d2ad72b5c08f7b0008504610d06a29d29125bd52
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4dc79dca7e90896
chapter: CH-05
qa_id: QA-e9e960e52953b1e6
reference: BLK-b34b8dd3cc79096e
semantic_categories: [truth-values]
digest: dcab0864ee892b693d3f270e17e1b894382113c0a9c58ef5c30c3399e8d64aa2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5fae82d2e864497a
chapter: CH-05
qa_id: QA-2e8b862c6df13b63
reference: BLK-c83570b0bab95162
semantic_categories: [truth-values]
digest: 5e97e5fb94eb5eee72ee883eee2739cf6202b091213538e19d6e5438668a4a43
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-98059466a49e2218
chapter: CH-05
qa_id: QA-8113a4fa5ede414d
reference: BLK-cdba5783ce8acf92
semantic_categories: [truth-values]
digest: 2e6ef2395a36cbacc08a5fe89eec63586d291c7d94d293f5537d71180608df53
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e687482301e02aa2
chapter: CH-05
qa_id: QA-72bf975c4cad7ebf
reference: BLK-66c781d55a92faaf
semantic_categories: [truth-values]
digest: 8fd7e31f99c6540166fee641302f383f47d217b1060a6c3bdd9366bef076b46c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a4331f776a9384db
chapter: CH-05
qa_id: QA-8981d03c1c94e974
reference: BLK-522dcd428818f34e
semantic_categories: [truth-values]
digest: 4e55478f1f5a6abd0b1c19aee00527a1a9e8aa17dbbb174bdc374fae2145424a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9821bab554916e0a
chapter: CH-05
qa_id: QA-1e74e8a490a8466c
reference: BLK-95ca2e72cd741b4e
semantic_categories: [truth-values]
digest: 7cd26d3846e4f618c068cdfdd1844f8bd693443dee1c62a1598ae6f4f12f41d1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-7d69ca3be4ba38a2
chapter: CH-05
qa_id: QA-7913bf178bcdd672
reference: BLK-87787a835dbfdc8d
semantic_categories: [truth-values]
digest: 60fde83b5449fdd0afad77e546dc302c0138cdb91156283414b31953586ad268
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-51c6d2fd4b9d861b
chapter: CH-05
qa_id: QA-12b6c691c593917d
reference: BLK-03e7fcc4768817d5
semantic_categories: [truth-values]
digest: 13005812fc66e80df5ed509a725e5183ef6ff97c5b04cb7e3c7e717e6c779d54
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-04fd7c7bf0c83ad1
chapter: CH-05
qa_id: QA-e50e25d86247f862
reference: BLK-8751d75b24bfe192
semantic_categories: [truth-values]
digest: 74ad5f6e2122697951418b5d4ce515151f48c0a51fe8cc96fdc1d94d03176fbe
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5125a6379002b4ac
chapter: CH-05
qa_id: QA-c427e584d1573644
reference: BLK-b78146783f0378c4
semantic_categories: [truth-values]
digest: 2bc6805cc6475c5a0405f215b0cbea4e7301a2999048edd8126ae3e05dfa9983
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f2fa17823b15f17f
chapter: CH-05
qa_id: QA-3fc844a103592337
reference: BLK-0677b2d89a2bb634
semantic_categories: [truth-values]
digest: 1d3ecef92d3d0e733a84b7655b3447ba8533fca4b62cb90770e36c2eee8ab7e1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-98e3aa648c3c9325
chapter: CH-05
qa_id: QA-c79337c73470fe7f
reference: BLK-0f7eb6e9110cfd7d
semantic_categories: [truth-values]
digest: eabcc2fed604acf24a3ff22b28203d54db4ff4e53b7b7a867112abc3974bc083
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b62625c2cfacc573
chapter: CH-05
qa_id: QA-7afd319eba08e9f3
reference: BLK-dc195421896fae6e
semantic_categories: [truth-values]
digest: 786376e91a81a7628a81cc445c9f94d6f8abda54a85613ab9faddbf91220fd0d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e67c48a3990b0f68
chapter: CH-05
qa_id: QA-14a094962c22fad3
reference: BLK-c769e5e37ddda8d1
semantic_categories: [truth-values]
digest: dd3b4750c08e473f2d2bab9953747a9c0129c58cd853f6cb34e3ce2717ead6fb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-779184fede599dd1
chapter: CH-05
qa_id: QA-dbc61a9063a7b446
reference: BLK-c93c5530af136464
semantic_categories: [truth-values]
digest: 849617d6183052aea0006f6eb6b653a6eb0ae02bfa90e92fddca9a4cf3e42936
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2404f07964296efd
chapter: CH-05
qa_id: QA-2187acdcf802b655
reference: BLK-d0196af4f922ba99
semantic_categories: [truth-values]
digest: d84375ebb0b8585660e5cd325b7efc5ae6bb61d8724483c1499668972392dc55
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1d5f21bb9d4f12ce
chapter: CH-05
qa_id: QA-6c3e3ab2d00fa424
reference: BLK-471eebb35854e544
semantic_categories: [truth-values]
digest: c4c9c1d629d2142f60f28dd9ebead06b37129b5d340b341e8febfb8afe826dc3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c556e4b774f53db0
chapter: CH-05
qa_id: QA-3013d2c385be70bb
reference: BLK-f2d6de3be5108863
semantic_categories: [truth-values]
digest: 7a40932d9a910184fe29f1a85b1122c9092f353cf52bb17768f1acc4707c4ad6
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1584ecd85f63c0d9
chapter: CH-05
qa_id: QA-a457dc09265d7023
reference: BLK-033ecc50bad86de4
semantic_categories: [truth-values]
digest: 42695605dcfb41ec1d449b2acd41bfff7136dd3a8921cc4a10a9dd29e8d16cec
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d52d79cb47ec7b52
chapter: CH-05
qa_id: QA-297721473a8368e4
reference: BLK-56fc64cdaff7a3ab
semantic_categories: [truth-values]
digest: 0e1e1ce113e20efbe8421ca46bdc068ccd6bd6e31e9afbcdb7053ebd085100a8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fdc556f6d5b0748b
chapter: CH-05
qa_id: QA-98681f8f51877553
reference: BLK-2c1d51f4e5a960ff
semantic_categories: [truth-values]
digest: 181513ba1ac7b901825def3e2f3e68aab5f2ce9854d4103ef94172d796fd5c0b
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-426e8d6b6d8620b6
chapter: CH-05
qa_id: QA-1c29fe3f41c5c30b
reference: BLK-2602fdd8c51b5938
semantic_categories: [truth-values]
digest: 8c3fe65778d6ba3a4319bfb3126f0e3d1845292f6434bcac2c92e122fd29cee1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ffd3610a718bbe10
chapter: CH-05
qa_id: QA-bad50a33d6d38166
reference: BLK-440f2e7d6df53450
semantic_categories: [truth-values]
digest: 5a669afea7838f9198644964c2b213e557d29c6f5ec160630f7cb090159d5035
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e4fbe68dc272e398
chapter: CH-05
qa_id: QA-648428f41b3b70d8
reference: BLK-c332a68f35c8a3ec
semantic_categories: [truth-values]
digest: 371f80a206149de108130f60bc2f9a636dd643ac141df9e454b3ec604f5ffff1
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ca8a72253fc464a8
chapter: CH-05
qa_id: QA-64f70c530ec17beb
reference: BLK-146721aedc728fd8
semantic_categories: [truth-values]
digest: 9f627abcc4b387e08e91de58e08c2e7052a7adc5bd8c84dc2a87131d765b6490
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-045ed50daf2ad701
chapter: CH-05
qa_id: QA-87a62421643e691c
reference: BLK-1601cc39b76cae1a
semantic_categories: [truth-values]
digest: 9b3a8151d97c338a96f556594ea297a752b538af2fbcf5d8714d629541bce866
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5a7fe546f8835815
chapter: CH-05
qa_id: QA-02027d7c024e0cf6
reference: BLK-2c388bc6691a4f51
semantic_categories: [truth-values]
digest: 728d9ba6f11ad9f5abb79f2856e9a3e51c4150f3ca95449397c5f12a5dcc25f9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-9f8bd23afd1bb989
chapter: CH-05
qa_id: QA-ece015c5b24a9b28
reference: BLK-dead8fc635007af0
semantic_categories: [truth-values]
digest: 8b945462fad34a13b63c0ffbdd0adf60d160ccf4831077205230a25852560529
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-33b8012fde357a5d
chapter: CH-05
qa_id: QA-3034321aa9220605
reference: BLK-1896739847a942b1
semantic_categories: [truth-values]
digest: 176e23a82a2b9ecc7b1f6775fb40f230c9ff24bc0e384eb242f4561e28b6b0d0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4981b54d1b426ac8
chapter: CH-05
qa_id: QA-f3b082b86264b66a
reference: BLK-b0975f5a5f83bad3
semantic_categories: [truth-values]
digest: ed18ec29e87c9045c51f378aaacbab74cd8c15ba4fc5aacaba67a71a55faf667
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-acedc854d5ba7dad
chapter: CH-05
qa_id: QA-433c8659558f6b17
reference: BLK-98a5e27b479b7275
semantic_categories: [truth-values]
digest: 472c7f96903fd707f33f3e9fa15b104f1c89c921e66db7c68961630da1bd47d8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4f4e95527500db52
chapter: CH-05
qa_id: QA-c9b23e1fbe49e9a4
reference: BLK-4cf1d9d3379ed5ab
semantic_categories: [truth-values]
digest: f454508fac19b4ac5e6c22208d802b70ff92fab8c1fb6a7e2e6c73d73ffdacdc
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6abd2bf6d27c42ab
chapter: CH-05
qa_id: QA-542ad3f60a2463df
reference: BLK-c16b774f244e504a
semantic_categories: [truth-values]
digest: a4bcac3bb05e39bf3b9c1a8fe27d7d6a8a77e54c3e635b2a5ab0e3c742198810
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4b2108df4385cc43
chapter: CH-05
qa_id: QA-cbdb45467e8df9e8
reference: BLK-cf07614973daa160
semantic_categories: [truth-values]
digest: 47c9b74f016ff2df6e12729bde8b380a9f9e052cc6bd0e6154f31f68351c6608
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-01d24ca06cbcea63
chapter: CH-05
qa_id: QA-b1471caea6c97e1e
reference: BLK-ee4b87e1821ec277
semantic_categories: [truth-values]
digest: 521bc7175af657fd52c6b57a4e543aca2c375787f3765845a2e5cce6e820322c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d5eb7e10101341e8
chapter: CH-05
qa_id: QA-4fb85531a5c24d8c
reference: BLK-f3ae62e558c8b1ba
semantic_categories: [truth-values]
digest: 97984a85d7c177cd319130fe90533a5ded29a9270faabe77519daba1f0d56b25
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3c0bef55de575c83
chapter: CH-05
qa_id: QA-8fd416bf81e20683
reference: BLK-d0319c48162006d3
semantic_categories: [truth-values]
digest: cac026ccb9cb9835602a242c44e351abdd2c6e57b30ea0cbdcad7b0383d92dfd
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d31d45a9f2a802a2
chapter: CH-05
qa_id: QA-fc79fe5d234235a7
reference: BLK-ab7e5a89ec7dec84
semantic_categories: [truth-values]
digest: 4e57e0208cab7889d00f38300b5ef2c64d903ef531e0917f4cd61e8ea1d5dc5f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-dcdb7ec708bf226c
chapter: CH-05
qa_id: QA-9ffb23caeff6b8bf
reference: BLK-40bec3306bf43c74
semantic_categories: [truth-values]
digest: 88c5b692c9a67865edf734efbbc4bee4c3c2668637f3aa299273325284af023c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f2433d6fe64208ac
chapter: CH-05
qa_id: QA-a0f5b0be8ce3be31
reference: BLK-ddd5bab848658cd1
semantic_categories: [truth-values]
digest: 66e47769174438b9e7ff21089cadd21b34958b536571b0094d965b88d6a76cf4
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-12a2ea524445afbf
chapter: CH-05
qa_id: QA-5464f32fffb83ee3
reference: BLK-1e9f46006e81b12b
semantic_categories: [truth-values]
digest: adbf8e5c6a26378f52e9686be672a77b64dc1056ca1bce31911e0b573184a6de
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2e0e817f80963436
chapter: CH-05
qa_id: QA-cb98d63feb21da33
reference: BLK-4a3213cba6c14203
semantic_categories: [truth-values]
digest: 043ea0baaf9290cb3550885d9be867660fe4a94db8dd0116cce23236fc775a2a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f1f67efbce599dc6
chapter: CH-05
qa_id: QA-3db21658bc5a650f
reference: BLK-6f8c40f9057e8541
semantic_categories: [truth-values]
digest: 5a669fe32275a4d592ff48b2838ee84dcd39a4b1382626ac38f1b87f3eaf124a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d3cb5f9f82fa51e5
chapter: CH-05
qa_id: QA-97092ca37fc933c6
reference: BLK-5fe7ad67431a1a6b
semantic_categories: [truth-values]
digest: a94fd97f2ecf6c36e81f0bd04790a94dc1da1a682b674b7ef1dc3989373dd2fa
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-58d41c1ceed46d59
chapter: CH-05
qa_id: QA-c078ffd564a2c0b8
reference: BLK-5a5fb3b6a6feb291
semantic_categories: [truth-values]
digest: 707ce3a29563852fa23511ab73bcf7d98eb26cb965b5a88a1ee7a1a4a60787a3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b67536eab4670f5b
chapter: CH-05
qa_id: QA-54e2443eb5091fbd
reference: BLK-065b5e4f94f9236b
semantic_categories: [truth-values]
digest: e11dd6827a8548ad85528acd70c2deb23c325f18b7f8d91b0be9d9b9d62b7d2f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-d66aa21989401aa8
chapter: CH-05
qa_id: QA-0b9360e4dd6375f2
reference: BLK-7eb95260235a09c0
semantic_categories: [truth-values]
digest: 3c26924c674663362552783ba52c99bb9ecbb379f10c77c1dd21ca0182cbfdad
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ea968404556bb345
chapter: CH-05
qa_id: QA-45dd681ad68ae2a4
reference: BLK-970b9d75dc34a42c
semantic_categories: [truth-values]
digest: 03652dc89b08c5110c93ae89ffdafd11cc12f8190543256b300e0acdb7b37dec
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-55e70fda5de1e332
chapter: CH-05
qa_id: QA-d39101d0148ce0a0
reference: BLK-94b0c6d4242ec932
semantic_categories: [truth-values]
digest: 9f4a470ffbba285553335af2c6c77676205f08519617bb599e1d31ee71f382e3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-45eb039f263c3385
chapter: CH-05
qa_id: QA-1933251c3b047900
reference: BLK-2692a565a55bc811
semantic_categories: [truth-values]
digest: f14c137e20a3a65eae9f18edb26d8994c483e532337f128391adc61bce965399
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bbdb19b111bd1529
chapter: CH-05
qa_id: QA-d2607a47fd3bf815
reference: BLK-4b75100e9c1723da
semantic_categories: [truth-values]
digest: 344e0f1d0e42ce7cd9806fee4f9342fb3734cedecde2f9749e8b6666d1dd7b25
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6f762ef6c0925647
chapter: CH-05
qa_id: QA-03dc0bf843ece140
reference: BLK-18bcb7950f8dcf72
semantic_categories: [truth-values]
digest: 0c672285953e2a7ee3511fbb48f1ad9a078779dcf6c2dc1d70e3fba19a30f856
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-fb7870ae134b491b
chapter: CH-05
qa_id: QA-c687bffc81d465e0
reference: BLK-a75307e7442dd9e9
semantic_categories: [truth-values]
digest: ab9d1343162b64babe98f61e0ef7646f2670b7cacd1e54219be367f47cc60ef7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-20d451bf66c04c71
chapter: CH-05
qa_id: QA-6611dc222d020c2b
reference: BLK-c91a17469e570904
semantic_categories: [truth-values]
digest: f3cedb983d94f77b9f6b713ed04e4820f85cd3c6a442af1c0161d3f2a809efc9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4ce617d640d671ba
chapter: CH-05
qa_id: QA-ca607479269ea9d0
reference: BLK-2a6fca36dc1d9152
semantic_categories: [truth-values]
digest: 61561d3ab5120bf60226df4e2f7da95f7c402aab871f3e9585aadf7250ba6a46
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-28167f92dd94b76d
chapter: CH-05
qa_id: QA-fc0be20bf4b0b04d
reference: BLK-db4ad97b2c59bf89
semantic_categories: [truth-values]
digest: 230fd4c343ef6532f9d8a08822cc05d1a58618003ef5d89f54f6f96c0da2b8f3
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c77dc6bc909c31f2
chapter: CH-05
qa_id: QA-b5293177e4a24b16
reference: BLK-533b2ce56a96a5b1
semantic_categories: [truth-values]
digest: 47fb58b265a160b30c732767e1e11890a7193c119340a55e44c90184b5e30175
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1d62cf4462725ae3
chapter: CH-05
qa_id: QA-5df89b9fa75533d3
reference: BLK-5034a2914309672a
semantic_categories: [truth-values]
digest: a8d9b2a2d36e582101c0fc6ebe75c1f35a1e77689cccc9f7bb0529d5456db2df
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5ac868e6acfd2e77
chapter: CH-05
qa_id: QA-2b47d3d6183af7b2
reference: BLK-6b3973c5adc77112
semantic_categories: [truth-values]
digest: 19fbe22eee84c14f5305ec66bf1187025c7e475cc518441203b6105ea0860cdf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-0f48088dbb2e063e
chapter: CH-05
qa_id: QA-29520422812902ee
reference: BLK-d61d9d1a25742a7b
semantic_categories: [truth-values]
digest: a146d008fe60fe88473a3a2e8e84eda732b00f2e4bc1d443e6dffae38cd43fd9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-c4aa886731aaf98e
chapter: CH-05
qa_id: QA-041dbcc9fcfd2e9a
reference: BLK-bf4723cba99361ab
semantic_categories: [truth-values]
digest: 5b6ee0209003a3223d023a2a7e96b912b601c0df01b8056df3ae94f4717feb8a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f6f9aaabc2d6a4fd
chapter: CH-05
qa_id: QA-53f8c7eb8c77ee03
reference: BLK-83a2499bac0ee44d
semantic_categories: [truth-values]
digest: 87ec408436a91c351f0e8aa400e758675507993f1d14a5cb2f0940a2f338d84e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2ff937291f78efb4
chapter: CH-05
qa_id: QA-2d58173f39099d81
reference: BLK-6143e7b8d21b076b
semantic_categories: [truth-values]
digest: 64b4db44a2482c164dec389c86d7b431e32ff4ebf39a8dd58eb7015c7d2223b8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-2a4d53475d210f93
chapter: CH-05
qa_id: QA-681dfd8eb67d8aea
reference: BLK-8124b98cebb7344a
semantic_categories: [truth-values]
digest: 0e6e989cd982d3506e77c9fc8979cfe1f9c83847ccdd23b85970f772749468c8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f4bb561483107a86
chapter: CH-05
qa_id: QA-c53e057db86bc7ae
reference: BLK-1c354b57ee22967c
semantic_categories: [truth-values]
digest: 6c789800c7987782f98ae117ef541412499312a9e8f9ff0a75f5ee679a867dc2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-675a5aa4e4dff0b8
chapter: CH-05
qa_id: QA-725823324a9f0728
reference: BLK-365b36bfe5904699
semantic_categories: [truth-values]
digest: 0bd1252090d7e0531a8da119adbcbc2f60976bee7eca4b40d8ac1ae2e67478f0
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f9c246071b108490
chapter: CH-05
qa_id: QA-34070ab6abb23009
reference: BLK-9cb0813090319e09
semantic_categories: [truth-values]
digest: ea119fc685f45899ad313064f1dbdc991c40d9e6b162e7566281b0d834bda85f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a4f83b9a861bda92
chapter: CH-05
qa_id: QA-2836d86ec2f75a9a
reference: BLK-ae9cdf2a87e2849e
semantic_categories: [truth-values]
digest: 05451fd26290f15306abb554193f4acee04bb008d6d3c1518c0f4508f1aa38f9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-e8e400c41541f915
chapter: CH-05
qa_id: QA-c1016749c5a89609
reference: BLK-63c154a8c410ed16
semantic_categories: [truth-values]
digest: 418dae9452954981e1e504181ea6f2e8339b9283f192df952a509665c6eb8481
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cee5823040343109
chapter: CH-05
qa_id: QA-22d2d1da595afa81
reference: BLK-930cbcf639591aef
semantic_categories: [truth-values]
digest: 8d74ec2055878b50448fb322c7e11067e6f73d4f397569758ee30d801a00ee45
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-8eb510d71a30f722
chapter: CH-05
qa_id: QA-c6906c986bfc2951
reference: BLK-b5f2b2e0022c070b
semantic_categories: [truth-values]
digest: 45ddbb62457005bc11b139b7f29d002cc5d5c38ec3c314c644fa003cbc56734c
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-51c3d651d357958c
chapter: CH-05
qa_id: QA-4eec40b7c219e88e
reference: BLK-a994f5dd4573c580
semantic_categories: [truth-values]
digest: 303a0a5d86def8265ca50b0cf058f5714b1de52fdbd557c29be36b14853dbe50
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-96e02dbe5afe8602
chapter: CH-05
qa_id: QA-f512eeedc0196cee
reference: BLK-b2462fef40f9e1a3
semantic_categories: [truth-values]
digest: 18cb00f1b039e05cc8638243d17766970c934b42f6245c52747e4a47d6be2d68
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-5eeac21decda20e2
chapter: CH-05
qa_id: QA-8549bc60b22ca166
reference: BLK-8c1f028fe1d5059b
semantic_categories: [truth-values]
digest: 26da1e10b566ef47355a36f00503a467176b529c6d7015ef30c6a3907feea647
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-374f70e7f59d934f
chapter: CH-05
qa_id: QA-8469a249e4ce4f3e
reference: BLK-7224d1b50de33c99
semantic_categories: [truth-values]
digest: ec1b31e8e0547fc0098a1e089340258bd74b34e36d2f9b34e051d61aa13812ca
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cde5fe6f7b578ed1
chapter: CH-05
qa_id: QA-4de5f361b53a5b20
reference: BLK-de1b194932f56032
semantic_categories: [truth-values]
digest: 0a73ee088bb5058e96cfc6a3072f33db114c40c9eb989ab9b21fdbd3b05ef6bf
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-baecfdf7db54ab35
chapter: CH-05
qa_id: QA-f8740a8accf43e93
reference: BLK-9ab409739c58aced
semantic_categories: [truth-values]
digest: ff11b08c2dbe2de48ea364089db912e6fe011484172554712938a734ead4de3d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-201ba4eb06f77517
chapter: CH-05
qa_id: QA-b9a19c8ff0d49fa2
reference: BLK-b8e54938be458fcb
semantic_categories: [truth-values]
digest: c0ee52b6711f743d4b55a87dee39539d9d8d1be982b55dba461f719579c18f73
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-4ff08634edfe253a
chapter: CH-05
qa_id: QA-e6b81a0c8ee06356
reference: BLK-475ae3ca4b662fcb
semantic_categories: [truth-values]
digest: cabe6acd6eec1713feab6d7037e52671d9f32e26fbc062092d4b6a72fdc1c9f8
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b4c52b2e83127498
chapter: CH-05
qa_id: QA-5b7cbcd55500576e
reference: BLK-ec33c76e3eda42a5
semantic_categories: [truth-values]
digest: 77f4d6f71061d32cbcf5becae04929f2978d29a3a019b8516fefb34efa8a1e71
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ec6a0a861281385b
chapter: CH-05
qa_id: QA-8155fb873ece2706
reference: BLK-fe580d36f95ecec0
semantic_categories: [truth-values]
digest: a29444f20d8d7a666712c2f392e42b33cd0ee6e523f62118cfff5f5b141161eb
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f2722edf91c6b435
chapter: CH-05
qa_id: QA-ce323a11568b9049
reference: BLK-914d3ab30c1cbcd0
semantic_categories: [truth-values]
digest: ddc0b8e2965d0fbc3e7e2fc1b5fc924bfda22f3357e2c248d52042100ca7ce48
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-cf03747a2ab5c93a
chapter: CH-05
qa_id: QA-4b7382d9f77a42c9
reference: BLK-91b98d897aa10bbe
semantic_categories: [truth-values]
digest: 377d379dbf33d8dd206d97a9813aac2c0397b4084fdffffda0ec61458cb7ec20
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-730ecfa47d1c4db3
chapter: CH-05
qa_id: QA-b9f0e01b341452cc
reference: BLK-f190297a6c64fecc
semantic_categories: [truth-values]
digest: 6dcddb51861f61e55c667fa946a8868e1106f0f0631dc845c00b6ede6f9a9f01
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-f414316127b1c5c0
chapter: CH-05
qa_id: QA-fff55b20317aa3e1
reference: BLK-661d723e70c87b2f
semantic_categories: [truth-values]
digest: a2482d7cfc7524bf8371948dd492161f00ab05425202d3a911d0a7adb75760f7
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-bfe2148a11115212
chapter: CH-05
qa_id: QA-36cbdcc5c0e8b254
reference: BLK-a9c05c7f62d3cb54
semantic_categories: [truth-values]
digest: 3a840858334ff7f3849f4105983b6da8d2e3404b3ca67d2d8232e2c95d93c18f
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-671efef2eba6d37d
chapter: CH-05
qa_id: QA-a4a7c3e9967894d8
reference: BLK-3018dbc1695a1713
semantic_categories: [truth-values]
digest: 92920dc2ba10d0af2db262ab03c90aa7a9fa1e8db3282eb27cb050abe6b68c3a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a2cfa64bfcd3938f
chapter: CH-05
qa_id: QA-879adf21c36c1a4e
reference: BLK-99ded45841e99ee9
semantic_categories: [truth-values]
digest: d3f0552a56cb7ed300c14edfacb4b98737c58538bc05611d17f3363af1055b98
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-61f5289f53819572
chapter: CH-05
qa_id: QA-61d9d2b1ab48b095
reference: BLK-54e698b7ae1d69f6
semantic_categories: [truth-values]
digest: 3d45b62b63ec6226645bac22f54c29a33adf14c7d73e76bf23ae08bfbf6a03be
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-3ccd81e391f0d220
chapter: CH-05
qa_id: QA-992ccef8d16eb357
reference: BLK-62b84bd110ac2fbb
semantic_categories: [truth-values]
digest: 436fd2cdf90135dfa477dbe9d575e938bbe9917ea58189bd85ebc3b6e1b1f98a
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-6a39c4cde22490c9
chapter: CH-05
qa_id: QA-1705b1c6c5da5883
reference: BLK-0906546a75dd84e2
semantic_categories: [truth-values]
digest: c2fabb88a74061c82ed780aa0406ad9aeca951b12409a2d9d79c265c28772100
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-54ea52c38d675824
chapter: CH-05
qa_id: QA-ba23668728feba09
reference: BLK-694a2f9470d0042f
semantic_categories: [truth-values]
digest: ba15282e407c935c726162de68de4fc097e2df6c01dc37454fd3025a9fe7c73d
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-a6d92b63ddae59b2
chapter: CH-05
qa_id: QA-909970edf072981a
reference: BLK-22ef61310b55ff98
semantic_categories: [truth-values]
digest: f9ba4d8a7da5338fd0c79a6a90e38a124bec60fd50d8785f2a83c6c56cb61196
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-b7143187e1c5081d
chapter: CH-05
qa_id: QA-a04f5a0dff627e69
reference: BLK-42ef9188bb22552f
semantic_categories: [truth-values]
digest: 20261818fe62ddb6b03fc336118137cd3e5cff48e31ba8491553ea14cc72e49e
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-1777ea35b902d43f
chapter: CH-05
qa_id: QA-00c5ccedecd85c90
reference: BLK-bf3d83b7e8b7048b
semantic_categories: [truth-values]
digest: 65fccec95c91572a2432e65e06663c75a61ae5a0401dce820ff6cb4fef6182a2
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-aebd88f8176c96f7
chapter: CH-05
qa_id: QA-b21b9b07229bc8bc
reference: BLK-23099cfd845b535f
semantic_categories: [truth-values]
digest: 7d7197f0c91392091a60111c822e42aab3fec7f1e09d638bee201ad53459c3f9
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ba467aaf78a4cb82
chapter: CH-05
qa_id: QA-b442aef3e458eb9f
reference: BLK-44a8a9caa5e043ee
semantic_categories: [truth-values]
digest: 61b06115fd90637951dcb39aed0d5cb4cdfc625d99ed495de83ebda108eb1416
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ae16a45d7fbcbd0d
chapter: CH-05
qa_id: QA-679cf41d8d525abf
reference: BLK-c511802d86d94661
semantic_categories: [truth-values]
digest: 32a7a7bb3a852268660f29eed6bda0fc7f5033a17fc8fa8af46b92012cc77b28
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: reasoning-chain
id: CHAIN-ff6a6aceb092138a
chapter: CH-05
qa_id: QA-b9082b0a411df4d0
reference: BLK-f707e7c8060ca885
semantic_categories: [truth-values]
digest: d41b1a1c8525934ae279ad30db1070ede92fb1714be176c2cdccacc447e41c40
symbol_refs: []
semantic_role: content
:::
- Read the question carefully.
- Recall the relevant definition or rule.
- Match the question scenario to the rule.
- Consider edge cases (e.g., undefined vs false).
- Summarize the conclusion clearly.
:::

::: role-note
id: ROLE-c7a31b3503b589a9
chapter: CH-05
role: Policy Author
guidance: Focus on correctness & clarity of rules in this chapter.
digest: e5f5610a7e5cbc9fb4afd8ad097c29cc8c855836199ff142159f8edb5a9a5b36
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-8a33603d0ac928a5
chapter: CH-05
role: Security Reviewer
guidance: Look for unsafe patterns, missing deny cases, misuse of negation.
semantic_categories: [negation]
digest: 52104962933dc626e1938b91eedd5900d3f9c145d1b0735e8a870bc9301936e1
symbol_refs: []
semantic_role: content
:::
:::

::: role-note
id: ROLE-da4496977870427c
chapter: CH-05
role: Performance Engineer
guidance: Identify heavy comprehensions and opportunities for partial evaluation.
semantic_categories: [performance]
digest: aa3e5c601ee4f93f22239efa5641f1fa1b52c4c364f3333e4581acc70bdecbf3
symbol_refs: []
semantic_role: content
:::
:::

::: diagram
id: DIAG-a658e81e493859cb
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: a33b5fac8a1f26c217ed50c22692724b27fbb65699a95f76357837ee0eded1cf
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Raw string for multi-line test data
test_diff_parsing if {
    diff_content := `+ // TODO: Fix issue
+ function implementation() {`
    # Contains actual newline between lines
    
    mock_input := {"diff": diff_content}
    # Policy regex patterns can now match newlines correctly
}

# ‚ùå PROBLEMATIC: Double-quoted string with \n literal
test_diff_parsing if {
    diff_content := "+ // TODO: Fix issue\n+ function implementation() {"
    # \n is literal backslash + 'n', NOT a newline
    # Regex patterns expecting newlines will fail
}
:::

::: diagram
id: DIAG-5b5a5ff15f029eaf
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 6f36f21d43d5aca5dd681bd835d5b2760abf076aa574032ef0bad0fa4d6ce962
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
{
  "diff": "+ // TODO:\n+ function getUsers() {"
}
:::

::: diagram
id: DIAG-3ee6e81678baa6a8
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 62546e2bbc6bfa0924828399730f6dcd6e598d8e4bcddaaad5c526558cfd30fb
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
test_example if {
    mock_input := {"diff": "+ // TODO:\n+ function getUsers() {"}
    # \n here is literal: backslash + 'n', NOT a newline
}
:::

::: diagram
id: DIAG-58fbbb6531000c82
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: b91fd16cc8b66447f4f357b282d651eb415386d4bd054f9918f6ad845ceff440
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy expects actual newline
regex.match("TODO:\\s*\\n", file.diff)  # Fails in tests with \n literal

# Test input with \n literal
"diff": "+ // TODO:\n+ function()"  # Contains literal "\n", not newline
:::

::: diagram
id: DIAG-3b2b07639a5f7865
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: b6c94b8bbecb42280cf5306cbe940d708919ab69be7e1b563afc6db1f4694384
symbol_refs: []
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# ‚úÖ CORRECT: Raw string preserves actual newlines
test_todo_with_newline if {
    diff_content := `+ // TODO:
+ function getUsers() {`
    
    mock_input := {"changed_files": [{
        "path": "file.ts",
        "diff": diff_content
    }]}
    
    # Policy regex now matches correctly
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
}
:::

::: diagram
id: DIAG-dfbdeb8fe429a0c2
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 8fc9749a5432dbf278450b5021134493b71a522ba58d2e1ae78f866c02488af2
symbol_refs: []
semantic_role: reference
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy has two rules that can both match:
# R15-W02: Meaningful TODO not logged (general check)
# R15-W03: TODO added without reference (specific check for +.*TODO:)

# Both rules check:
# - has_meaningful_todo_keywords(file)
# - not has_tech_debt_reference(file)
# R15-W03 also checks: regex.match("\\+.*TODO:", file.diff)
:::

::: diagram
id: DIAG-203f84dfe465d870
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: bb445a3ebd297b2e2c8cab31730bc046e26ffcf6dc68ed8f908eb01e7faf45d2
symbol_refs: []
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [testing]
:::
# ‚úÖ CORRECT: Test for either rule, or check for common message pattern
test_meaningful_todo_not_logged if {
    mock_input := {"changed_files": [{
        "diff": "+ // TODO: Fix issue (workaround)"
    }]}
    
    warnings := policy.warn with input as mock_input
    count(warnings) >= 1
    
    # Check for message pattern common to both rules
    some warning in warnings
    contains(warning, "meaningful TODO/FIXME")
    contains(warning, "tech-debt.md")
}

# ‚ùå FRAGILE: Testing for specific rule ID
test_specific_rule if {
    # This may fail if rule precedence changes
    # or if a more specific rule triggers first
}
:::

::: diagram
id: DIAG-2a39a10520ec912e
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 1ef3fd1a0826a14094e3dacee3db840eb886ac67f74e19bb09e166e0c60b2339
symbol_refs: []
semantic_role: warning
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Policy checks for lowercase "temporary"
has_meaningful_todo_keywords(file) if {
    contains(file.diff, "FIXME:")
    contains(file.diff, "temporary")  # Lowercase required
}

# ‚ùå TEST FAILS: Test uses "Temporary" (capital T)
test_example if {
    mock_input := {"diff": "+ // FIXME: Temporary hack"}
    # Policy doesn't match "Temporary" (capital T)
    # Test expects warning but gets none
}

# ‚úÖ TEST PASSES: Test uses "temporary" (lowercase)
test_example if {
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # Policy matches "temporary" correctly
}
:::

::: diagram
id: DIAG-d27a8f07fb101aa7
chapter: CH-05
language: ascii
diagram_type: diagram
summary: diagram diagram
nodes: []
edges: []
normalized_content: 
digest: 5efb444059955d2c4b2f406f4207a475441934e987d1ae78190b3f9a4c1b4800
symbol_refs: []
semantic_role: visualization
embedding_hint_importance: medium
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
# Normalize keywords in test inputs to match policy expectations
test_example if {
    # Use lowercase to match policy checks
    mock_input := {"diff": "+ // FIXME: temporary hack"}
    # ...
}
:::

::: test-hint
id: TEST-1e8f37bdbcac526b
chapter: CH-05
source_id: CODE-a23e9086072f5ce3
digest: af87b30ab7a30af25a44b9b5ba4b3656b71d38b9197f2bec57858a161a0b96f3
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b34387d207a8f847
chapter: CH-05
source_id: CODE-ab9dfd453065e279
digest: 2fc67aaca2dee78678c247ca8fed5b232f4ca319e7da3d69f98987d9f70e06c6
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-ef5d5d7c36fb5edd
chapter: CH-05
source_id: CODE-d4b2dcce40fd1ab3
digest: 576f01d57db4e40a75a6005b2a8b2570d7ec2132e12719e75ad852131eec9abc
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-9f84054f06c570da
chapter: CH-05
source_id: CODE-66aab2e8459d4f6c
digest: bcb032b9b71da926cfe55a805b8dc5123e09acee18206593d369f2be42c977d7
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-61440791badbf906
chapter: CH-05
source_id: CODE-fafaf716cd6b4cab
digest: ec5f3bca80f5dc430e037251092c51efcbd210fa7a4e0f476060086ec03b49ec
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-dff4c7c3b8a16839
chapter: CH-05
source_id: CODE-0d18d72d3e70f617
digest: d18123fa129931483f90a191a3774eefd183c0e01dc22aa9c651ee93b51e3db7
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-aa0f238d00f0ec1e
chapter: CH-05
source_id: CODE-3152b6a89a146d23
digest: 5e0d61595f9b38e93252a13d177de4ebcebd029e15f141e92badc8e1e52111fe
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-5d2af033642cc5cb
chapter: CH-05
source_id: CODE-ff0c5e5c7e41a636
digest: d03689d6b91b7363029d7e00c6725a89073980bc00db0c03be49d32d7a2931b6
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-56377792726ebde2
chapter: CH-05
source_id: CODE-189eb42d4e1567c5
digest: f5abb68e84819805964dc0f852158aba3f8b3e8173c4ddef967fe7c64c66a7ff
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-71f0d729b4272342
chapter: CH-05
source_id: CODE-b916c9b490f90d5d
digest: f23669329cb0809a30bc2eef30ec5dc18fe293453b0f05946ab0d21810d57628
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-710c3007ddb2a02e
chapter: CH-05
source_id: CODE-4a2be09c33beac7b
digest: 94d0156c8c632f7d24f10211e21175bdaabe1fa457ce34d551008707a5cd067d
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-d78bfa9c4f547af2
chapter: CH-05
source_id: CODE-62ae1147b658428b
digest: ffe9684c904cab95e4ae80bf770acf4f6a6429c366527d5b06a645319942478f
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-19c8ba7ba42e2b08
chapter: CH-05
source_id: CODE-ee17c3fb697fd027
digest: fa17dacb9324128a0bf9cebefa6ba98c9ea61b61cf5ff0a28f6bd346e481c2e6
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-479aa0f5801e1928
chapter: CH-05
source_id: CODE-0dde4ffacad2f8a3
digest: dc44344f94093fdccbf219daaeef35335eff99438bf67cb633784f3020fcd5e0
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-9b4971b9e0ef16ea
chapter: CH-05
source_id: CODE-a0d0469e0feedab3
digest: 26d2055e52983e67f02c16d4753ec8dd405f0ac8742bc452485a63f9d8513ee2
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b897cf8d778005b1
chapter: CH-05
source_id: CODE-6f138445d33c3682
digest: 7eb222e8665dcf1b9f037ced192020bc202b4417ab4979d3f3b2dd8329b5d33d
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-9a9144fd3c04f6ce
chapter: CH-05
source_id: CODEPAT-30265d67b6856971
digest: 484e2053b4c2841e743e17f4a7a7e4d3c73008a5a12613304724e7abf89dfc12
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-618ecfcf7a3a6865
chapter: CH-05
source_id: CODEPAT-305b334dae7a01bb
digest: 1b738b1832e74f3b49424142ef032af0843f299a55eeff5687495415b6e283fa
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-b16a4ae9c51e90b8
chapter: CH-05
source_id: CODEPAT-f5d7f842be805668
digest: 8b6fa0f09d4c71ab764fdcec59b9ca1006d44a78c7b193a2563a245214c3417a
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-70be90c2c75f88a9
chapter: CH-05
source_id: CODEPAT-dd2907d7692be834
digest: 39908838f090a9d69e243c787725402fcb4ff2b8f6422c899b4935f4ebed7047
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: test-hint
id: TEST-d0bf4cb5820c61ba
chapter: CH-05
source_id: CODEPAT-fbd2aab3751da520
digest: 8ff918fe3e251fa3e6c318d21d3e2d148dacb1132ddbb4500be6acce3ffc259b
symbol_refs: []
semantic_role: content
:::
Convert this snippet into a unit test by constructing input and asserting allow/deny.
:::

::: uncertainty
id: UNCERT-d28f2f165c62dac0
chapter: CH-05
source_id: TERM-61b8c1a83d1cdbdd
digest: 66725fd14c5476d928a9551433545c96f7df74009cc367a6c62e1511aa4d9814
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-48f0986b25bd52b3
chapter: CH-05
source_id: CODE-4522197481045bd4
digest: 9274a473e94f28e5887089bea04d305e672cffd848a968f94a0452bc28a7d784
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-a226629d67efc275
chapter: CH-05
source_id: CODE-031e381b7120fc25
digest: f6df5736badc8c57a01b2dff5904ba82f814f378dcb4b63b606c43bce93d356a
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-3df5f8614ddf93e2
chapter: CH-05
source_id: CODEPAT-ce3111aa333c1369
digest: 11f02b1b12409807e03fb92b5ce6a3bcab79683de5fb2c04d4f07f362039b731
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-095d64f1e1b5277a
chapter: CH-05
source_id: PATTERN-7bab973cb8c529c8
digest: d06e6c0c5822eedc6134450b2b4d20e5aa341b74df221cb06f0391f5c44985cd
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-d86ddd8dfdd577b5
chapter: CH-05
source_id: BLK-452d175adcd847c7
digest: eed6786eb685a5f5740fd7a0308db78ce92acebed60f07a425b260ec2caf5046
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-ba76a2525da5cc61
chapter: CH-05
source_id: BLK-c191fd1bb522212a
digest: 367adcf4ce91d7ab2d8a63988e53272d3ac736009d67258315903a0f7417e3e6
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-1ba694dd6a2a5ee2
chapter: CH-05
source_id: BLK-402d3ae84b7a6ec5
digest: 9933274d05d228d99debda70b11f67c03184daac209f787edfb60a098e355cd1
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-7f4671bdb1572b8b
chapter: CH-05
source_id: BLK-b78146783f0378c4
digest: 977abb12413a089c524557cf1a7378dc91ae5f436ae96b61edcff57a5ffe70c8
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-fd728353020f749f
chapter: CH-05
source_id: BLK-1896739847a942b1
digest: c75e2a1abd10a4355f2d5afd399f153585230aff1b3bb669930775fd7c8ad617
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-a3b96c4e2cb9cf21
chapter: CH-05
source_id: BLK-4cf1d9d3379ed5ab
digest: 9f198ffd1693ddcaa66ddef6fb782ea0aaade21898615ae3c1ba32e6751b109b
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-967d5bbadc820b53
chapter: CH-05
source_id: TABLE-f3829f7c85d60ef1
digest: adafd4957994e460910369c82edcc5fb7dd4ad6359515bc74d0eed1acd2d56a7
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-2362046bf74687b3
chapter: CH-05
source_id: QA-23af767abd96eff8
digest: 2baa76c6049247fcb8683cabe7c3f5da76404c981246753a35b299b0bb797552
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-28699f8fe034ee6d
chapter: CH-05
source_id: QA-38d7ac0e2f05e9dd
digest: 638699d15cab48592b81614513333976c2487a3d1bcf402f02d66470b717a407
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-43ef752668a7e00c
chapter: CH-05
source_id: QA-4ea6e1befd5d3ef0
digest: 06f814d4773a8805d920f5cbad0c080516d44d5e1faa249a11e4fb793ccd0e33
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-c1efdd9adc88a77e
chapter: CH-05
source_id: QA-c427e584d1573644
digest: 50c7d8178846457321b913ffd7abfa21d57245a04a874ecd9aab699d0437a766
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-5b7b4a4985253093
chapter: CH-05
source_id: QA-3034321aa9220605
digest: bf4a1b5b73828d08e4414c4f1ad72d8a9d5b09c8e247af069a353fb7ccbe8a21
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: uncertainty
id: UNCERT-46925cc403f612c7
chapter: CH-05
source_id: QA-c9b23e1fbe49e9a4
digest: 3368622f788538ceb6b60a2335baa231b86abe9f0f25f3f9848c58854a993dbd
symbol_refs: []
semantic_role: content
:::
This content may have ambiguous or context-dependent interpretation.
:::

::: section-meta
id: SECMETA-df291acabf6ba89a
title: 5.1 Logical Conjunction (AND)
level: 3
chapter: CH-05
parent_section: None
line_no: 1021
digest: a9f4024be8baab3bcd8ef927df2cd6a48600bf3d69e1ca8f46e436d5c07a43da
symbol_refs: []
semantic_role: structure
token_range: (1021, 1021)
char_offset: (81600, 81629)
source_ref: {'line': 1021, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-06c8cd5a78aaa65c
title: 5.2 Logical Disjunction (OR)
level: 3
chapter: CH-05
parent_section: None
line_no: 1034
digest: 58ad5fa201eb0a087dadb2c655d43f58f20895a7204a4f231ad2d41448dd2fad
symbol_refs: []
semantic_role: structure
token_range: (1034, 1034)
char_offset: (82640, 82668)
source_ref: {'line': 1034, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-92d8c5f697632ced
title: 5.3 Comprehensions
level: 3
chapter: CH-05
parent_section: None
line_no: 1050
digest: 8be5c2aff7ad192e2d71e279eac6acf5ed73f66b08d166608a5a65c1bd19bc79
symbol_refs: []
semantic_role: structure
token_range: (1050, 1050)
char_offset: (83920, 83938)
source_ref: {'line': 1050, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-6b1ccb0236c0fa9a
title: 5.4 Universal Quantification (FOR ALL)
level: 3
chapter: CH-05
parent_section: None
line_no: 1116
digest: fab6f827911221d6ebc90992e9a49bd7d84d56b649adb875eb698c2f67380a70
symbol_refs: []
semantic_role: structure
token_range: (1116, 1116)
char_offset: (89200, 89238)
source_ref: {'line': 1116, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-d521acca4baba9b7
title: 1. Using `every` (Modern, Recommended)
level: 4
chapter: CH-05
parent_section: SECMETA-6b1ccb0236c0fa9a
line_no: 1120
digest: d1770a9d6776bb8ef87c1b610c7372852a1192878b6e5816688053d80ccb6f03
symbol_refs: []
semantic_role: structure
token_range: (1120, 1120)
char_offset: (89520, 89558)
source_ref: {'line': 1120, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-2642991d2c3739c8
title: 2. Using Negation (Helper Pattern)
level: 4
chapter: CH-05
parent_section: SECMETA-6b1ccb0236c0fa9a
line_no: 1148
digest: 483e0e5528e9bcc2d2fd1f64b0fc0148617073ab8acc0add751bb64d2d87f3e9
symbol_refs: []
semantic_role: structure
token_range: (1148, 1148)
char_offset: (91760, 91794)
source_ref: {'line': 1148, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation]
:::
:::

::: section-meta
id: SECMETA-0efd16c587f68a0d
title: 3. Using Comprehensions
level: 4
chapter: CH-05
parent_section: SECMETA-6b1ccb0236c0fa9a
line_no: 1159
digest: 16a31d365517ac5bc9d5352f35fc92db3ac44480850e3495f1655750b71a40d3
symbol_refs: []
semantic_role: structure
token_range: (1159, 1159)
char_offset: (92640, 92663)
source_ref: {'line': 1159, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
:::

::: section-meta
id: SECMETA-a6e5299e595d03b4
title: 5.5 Negation
level: 3
chapter: CH-05
parent_section: None
line_no: 1174
digest: 3b9650ca4bf24f0a4336e0afcfc1d37ba8b61a2bc5d153d522cb3d5dd6aa8cdc
symbol_refs: []
semantic_role: structure
token_range: (1174, 1174)
char_offset: (93840, 93852)
source_ref: {'line': 1174, 'column': 0}
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [negation]
:::
:::

::: pattern
id: PATTERN-acaafdb314522854
name: use count for guardrails:
description: Pattern: Use count for guardrails:
category: generic
chapter: CH-05
pattern_type: conceptual
digest: 3f7cbba943fdc3bd9c0bcddab777c1d516470ce8f74348f32db030d094b77490
symbol_refs: [use count for guardrails:]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
Pattern: Use count for guardrails:
:::

::: pattern
id: PATTERN-b81bfed5cf7205a0
name: prefer sets for membership:
description: Performance pattern: Prefer sets for membership:
category: generic
chapter: CH-05
pattern_type: conceptual
digest: 809312db0fffc20064cfea87963de65b15c389c92e4e6c16eb8cc6719fceff65
symbol_refs: [prefer sets for membership:]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
Performance pattern: Prefer sets for membership:
:::

::: pattern
id: PATTERN-91cc7814e0bc3fbf
name: defensive guards before deeper logic:
description: Pattern: Defensive guards before deeper logic:
category: generic
chapter: CH-05
pattern_type: conceptual
digest: 9dd25029b528124f50ad175724d52f55ace15a482ad6e100c63c18076f42f92e
symbol_refs: [defensive guards before deeper logic:]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
Pattern: Defensive guards before deeper logic:
:::

::: pattern
id: PATTERN-f556c9b66fafbb39
name: combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
description: Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
category: generic
chapter: CH-05
pattern_type: conceptual
digest: bcca16561bdd12ba72aadb8c8083211c8bea539c5f1b831c8518c6dc3dc5d0db
symbol_refs: [combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
Pattern: Combine strict mode in tests with non-strict mode in production, or vice versa, depending on risk posture.
:::

::: pattern
id: PATTERN-92bc59ecda5c846e
name: Multiple Assertions
description: **Pattern for Multiple Assertions:**
category: generic
chapter: CH-05
pattern_type: conceptual
digest: bdd9b06a0d4ee762ce624b4d8298dfa3e27bc6b76808117cdab51c16a29246b2
symbol_refs: [Multiple Assertions]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
**Pattern for Multiple Assertions:**
:::

::: pattern
id: PATTERN-00f465586b86e538
name: ‚Ä¢	global policies: package global.*
description: Chapter 13 ‚Äì Multi-Layer Policy Architecture
Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owners, bundles, and tenants without descending into chaos.
At scale, you need:
‚Ä¢	Layers: global ‚Üí domain ‚Üí team ‚Üí tenant.
‚Ä¢	Ownership metadata: who owns what, and how severe is it.
‚Ä¢	Override semantics: how do layers combine, and who wins on conflict.
________________________________________
13.1 Layer Model: Global ‚Üí Domain ‚Üí Team ‚Üí Tenant
Think of policies as a stack of overlays:
1.	Global Baseline (Organization Level)
o	Owned by: security/compliance.
o	Guarantees non-negotiable invariants:
ÔÇß	‚ÄúNo public S3 buckets‚Äù
ÔÇß	‚ÄúAll admin actions must be audited‚Äù
o	Usually has the highest precedence for denies (security wins).
2.	Domain Policies (Product / Platform Level)
o	Example domains:
ÔÇß	crm.*, billing.*, identity.*.
o	Define domain-specific invariants:
ÔÇß	‚ÄúAn Opportunity must have an associated Account‚Äù
ÔÇß	‚ÄúA Subscription must have a plan and billing cycle‚Äù
3.	Team / Service Policies
o	Local teams add guardrails and UX-level rules:
ÔÇß	‚ÄúThis API must include X-Request-Id‚Äù
ÔÇß	‚ÄúThis microservice cannot call that microservice directly‚Äù
4.	Tenant Overlays (Customer-Specific)
o	Per-tenant exceptions and configuration:
ÔÇß	‚ÄúTenant A enforces stricter password rules‚Äù
ÔÇß	‚ÄúTenant B has a special approval workflow‚Äù
OPA sees all of these as data + Rego modules merged into a single virtual data tree.
________________________________________
13.2 Encoding Layers in Data and Packages
One robust pattern:
‚Ä¢	Global policies: package global.*
‚Ä¢	Domains: package domain.<name>.*
‚Ä¢	Teams/services: package svc.<service_name>.*
‚Ä¢	Tenant overlays: data.tenants[tenant_id].*
Example structure:
policies/
  global/
    baseline.rego          # package global.baseline
  crm/
    authz.rego             # package domain.crm.authz
    schema.rego            # package domain.crm.schema
  svc/
    accounts.rego          # package svc.accounts.rules
  tenants/
    123/
      overrides.json       # data.tenants["123"]
    456/
      overrides.json
________________________________________
13.3 Policy Ownership Metadata
Every rule that matters should be self-describing.
You can store metadata as:
‚Ä¢	A dedicated rule (__meta__)
‚Ä¢	Rego annotations (via rego.metadata.rule())
‚Ä¢	Comments (less machine-friendly)
Example:
package crm.policies.account_lifecycle
category: architecture
chapter: CH-05
pattern_type: conceptual
digest: 41a3e402102e7c311cee6ca7ebab691161e6a76271b64bd9c0eb47ad7d12a70a
symbol_refs: [‚Ä¢	global policies: package global.*]
semantic_role: architecture
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution]
:::
Chapter 13 ‚Äì Multi-Layer Policy Architecture
Multi-layer policy architecture is how you scale from one clever Rego file to hundreds of policy owners, bundles, and tenants without descending into chaos.
At scale, you need:
‚Ä¢	Layers: global ‚Üí domain ‚Üí team ‚Üí tenant.
‚Ä¢	Ownership metadata: who owns what, and how severe is it.
‚Ä¢	Override semantics: how do layers combine, and who wins on conflict.
________________________________________
13.1 Layer Model: Global ‚Üí Domain ‚Üí Team ‚Üí Tenant
Think of policies as a stack of overlays:
1.	Global Baseline (Organization Level)
o	Owned by: security/compliance.
o	Guarantees non-negotiable invariants:
ÔÇß	‚ÄúNo public S3 buckets‚Äù
ÔÇß	‚ÄúAll admin actions must be audited‚Äù
o	Usually has the highest precedence for denies (security wins).
2.	Domain Policies (Product / Platform Level)
o	Example domains:
ÔÇß	crm.*, billing.*, identity.*.
o	Define domain-specific invariants:
ÔÇß	‚ÄúAn Opportunity must have an associated Account‚Äù
ÔÇß	‚ÄúA Subscription must have a plan and billing cycle‚Äù
3.	Team / Service Policies
o	Local teams add guardrails and UX-level rules:
ÔÇß	‚ÄúThis API must include X-Request-Id‚Äù
ÔÇß	‚ÄúThis microservice cannot call that microservice directly‚Äù
4.	Tenant Overlays (Customer-Specific)
o	Per-tenant exceptions and configuration:
ÔÇß	‚ÄúTenant A enforces stricter password rules‚Äù
ÔÇß	‚ÄúTenant B has a special approval workflow‚Äù
OPA sees all of these as data + Rego modules merged into a single virtual data tree.
________________________________________
13.2 Encoding Layers in Data and Packages
One robust pattern:
‚Ä¢	Global policies: package global.*
‚Ä¢	Domains: package domain.<name>.*
‚Ä¢	Teams/services: package svc.<service_name>.*
‚Ä¢	Tenant overlays: data.tenants[tenant_id].*
Example structure:
policies/
  global/
    baseline.rego          # package global.baseline
  crm/
    authz.rego             # package domain.crm.authz
    schema.rego            # package domain.crm.schema
  svc/
    accounts.rego          # package svc.accounts.rules
  tenants/
    123/
      overrides.json       # data.tenants["123"]
    456/
      overrides.json
________________________________________
13.3 Policy Ownership Metadata
Every rule that matters should be self-describing.
You can store metadata as:
‚Ä¢	A dedicated rule (__meta__)
‚Ä¢	Rego annotations (via rego.metadata.rule())
‚Ä¢	Comments (less machine-friendly)
Example:
package crm.policies.account_lifecycle
:::

::: pattern
id: PATTERN-eeb5c30a9b540572
name: package authz
description: allow_flag := some e in all_effects { e.effect == "allow" }
}
You can refine this by:
‚Ä¢	Picking highest-ranked deny by layer rank.
‚Ä¢	Allowing tenant to tighten, but never to weaken global invariants.
________________________________________
13.5 Tenant Overlays and Safe Customization
Tenant-specific rules should be additive and tightening, not weakening:
‚Ä¢	Allowed:
o	Tenant can restrict their own behavior further.
‚Ä¢	Forbidden:
o	Tenant cannot bypass global security invariants.
Pattern:
package authz
category: generic
chapter: CH-05
pattern_type: conceptual
digest: 2a87e13595467973f95fc1543dcb695fe117e3b8cb74d2411e44e7fc7e2fcab2
symbol_refs: [package authz]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
allow_flag := some e in all_effects { e.effect == "allow" }
}
You can refine this by:
‚Ä¢	Picking highest-ranked deny by layer rank.
‚Ä¢	Allowing tenant to tighten, but never to weaken global invariants.
________________________________________
13.5 Tenant Overlays and Safe Customization
Tenant-specific rules should be additive and tightening, not weakening:
‚Ä¢	Allowed:
o	Tenant can restrict their own behavior further.
‚Ä¢	Forbidden:
o	Tenant cannot bypass global security invariants.
Pattern:
package authz
:::

::: pattern
id: PATTERN-27d0f036b9933e43
name: package authz
description: allow if {
  base_allow
  not tenant_extra_deny[_]
}
This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù
________________________________________
Chapter 14 ‚Äì Observability & Audit
OPA is not only a decision engine; it‚Äôs an evidence generator. Observability and audit are how you prove that decisions are:
‚Ä¢	Correct
‚Ä¢	Consistent
‚Ä¢	Explainable
‚Ä¢	Compliant with regulation
________________________________________
14.1 Decision Logs
Every OPA decision should be treatable as a replayable event:
Minimum recommended fields:
‚Ä¢	decision_id (UUID)
‚Ä¢	timestamp
‚Ä¢	path (e.g., data.authz.allow)
‚Ä¢	input_hash or input (with PII scrubbing)
‚Ä¢	result (decision doc: allow/deny/effects)
‚Ä¢	bundle_revision
‚Ä¢	metrics (evaluation time, rule count)
‚Ä¢	correlation_id (to tie into tracing)
Conceptual log:
{
  "decision_id": "3f7b9b1a-0ee2-4e52-9f39-4edb8b6a3a01",
  "timestamp": "2025-11-25T10:02:45Z",
  "path": "data.authz.allow",
  "input_hash": "sha256:abcd...",
  "result": {
    "allow": false,
    "effects": [
      {
        "effect": "deny",
        "rule_id": "ACCT_001",
        "layer": "domain",
        "msg": "Closed accounts cannot be reopened"
      }
    ]
  },
  "bundle_revision": "git:1234abcd",
  "metrics": {
    "eval_time_ns": 45321,
    "num_rules_evaluated": 37
  },
  "correlation_id": "trace-xyz-123"
}
OPA supports decision logs via configuration; your host system should stream them to:
‚Ä¢	Kafka / Kinesis
‚Ä¢	ELK / Loki
‚Ä¢	Datadog / Prometheus / Grafana
________________________________________
14.2 Metrics and SLOs
To treat OPA like a production service, track at least:
‚Ä¢	Latency:
o	p50 / p95 / p99 evaluation time.
‚Ä¢	Throughput:
o	decisions per second.
‚Ä¢	Decision deltas:
o	How often outcomes change after a new bundle.
‚Ä¢	Error rate:
o	Number of evaluation failures (e.g., built-in errors in strict mode).
Define SLOs like:
‚Ä¢	99.9% of policy decisions complete in < 10 ms.
‚Ä¢	< 0.1% of decisions result in evaluation error.
‚Ä¢	Decision delta after bundle rollout < 1% for stable inputs (in shadow mode).
________________________________________
14.3 Correlation IDs and Tracing
Policy evaluations rarely stand alone; they‚Äôre part of a larger request trace:
‚Ä¢	HTTP header:
o	X-Request-Id
o	traceparent (W3C Trace Context)
‚Ä¢	PEP should pass correlation ID in:
o	input.trace_id
o	or embed as part of input.request.headers.
Then decision logs include correlation_id, which lets you:
‚Ä¢	Trace a single user‚Äôs journey across services.
‚Ä¢	Root-cause analyze unauthorized/denied requests quickly.
Example pattern:
package authz
category: generic
chapter: CH-05
pattern_type: conceptual
digest: 6113fbce8b5923b403d45a356fce68c82f23576dc7dc86cd4ca6960aa045e5d9
symbol_refs: [package authz]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution, observability]
:::
allow if {
  base_allow
  not tenant_extra_deny[_]
}
This gives global ‚Üí domain final say on allow, and tenant extra ways to say ‚Äúno.‚Äù
________________________________________
Chapter 14 ‚Äì Observability & Audit
OPA is not only a decision engine; it‚Äôs an evidence generator. Observability and audit are how you prove that decisions are:
‚Ä¢	Correct
‚Ä¢	Consistent
‚Ä¢	Explainable
‚Ä¢	Compliant with regulation
________________________________________
14.1 Decision Logs
Every OPA decision should be treatable as a replayable event:
Minimum recommended fields:
‚Ä¢	decision_id (UUID)
‚Ä¢	timestamp
‚Ä¢	path (e.g., data.authz.allow)
‚Ä¢	input_hash or input (with PII scrubbing)
‚Ä¢	result (decision doc: allow/deny/effects)
‚Ä¢	bundle_revision
‚Ä¢	metrics (evaluation time, rule count)
‚Ä¢	correlation_id (to tie into tracing)
Conceptual log:
{
  "decision_id": "3f7b9b1a-0ee2-4e52-9f39-4edb8b6a3a01",
  "timestamp": "2025-11-25T10:02:45Z",
  "path": "data.authz.allow",
  "input_hash": "sha256:abcd...",
  "result": {
    "allow": false,
    "effects": [
      {
        "effect": "deny",
        "rule_id": "ACCT_001",
        "layer": "domain",
        "msg": "Closed accounts cannot be reopened"
      }
    ]
  },
  "bundle_revision": "git:1234abcd",
  "metrics": {
    "eval_time_ns": 45321,
    "num_rules_evaluated": 37
  },
  "correlation_id": "trace-xyz-123"
}
OPA supports decision logs via configuration; your host system should stream them to:
‚Ä¢	Kafka / Kinesis
‚Ä¢	ELK / Loki
‚Ä¢	Datadog / Prometheus / Grafana
________________________________________
14.2 Metrics and SLOs
To treat OPA like a production service, track at least:
‚Ä¢	Latency:
o	p50 / p95 / p99 evaluation time.
‚Ä¢	Throughput:
o	decisions per second.
‚Ä¢	Decision deltas:
o	How often outcomes change after a new bundle.
‚Ä¢	Error rate:
o	Number of evaluation failures (e.g., built-in errors in strict mode).
Define SLOs like:
‚Ä¢	99.9% of policy decisions complete in < 10 ms.
‚Ä¢	< 0.1% of decisions result in evaluation error.
‚Ä¢	Decision delta after bundle rollout < 1% for stable inputs (in shadow mode).
________________________________________
14.3 Correlation IDs and Tracing
Policy evaluations rarely stand alone; they‚Äôre part of a larger request trace:
‚Ä¢	HTTP header:
o	X-Request-Id
o	traceparent (W3C Trace Context)
‚Ä¢	PEP should pass correlation ID in:
o	input.trace_id
o	or embed as part of input.request.headers.
Then decision logs include correlation_id, which lets you:
‚Ä¢	Trace a single user‚Äôs journey across services.
‚Ä¢	Root-cause analyze unauthorized/denied requests quickly.
Example pattern:
package authz
:::

::: pattern
id: PATTERN-e80876fd79a2e88f
name: safe_input := {
description: # decision doc
decision := {
  "allow": allow,
  "trace_id": trace_id,
}
________________________________________
14.4 PII and Redaction in Logs
Golden rule: logs must not become a data breach.
‚Ä¢	Do not log entire input if it contains PII.
‚Ä¢	Instead:
o	Log hashed fields (hash(email))
o	Log ids / foreign keys
o	Redact sensitive values (e.g., use "redacted")
Pattern:
safe_input := {
  "user_id": input.user.id,
  "tenant_id": input.tenant_id,
  "resource_id": input.resource.id,
  "action": input.action,
}
Your decision logger uses safe_input rather than raw input.
________________________________________
14.5 Reproducibility & Auditability
A compliant audit story usually needs:
‚Ä¢	Given:
o	bundle_revision
o	policy_version
o	input (or hash + associated fixture)
‚Ä¢	You can re-evaluate the decision and get the same result.
To achieve this:
‚Ä¢	Store:
o	Bundle artifacts (bundle.tar.gz)
o	Manifest metadata (revision, version)
o	Decision logs + input fixtures (or deterministic reconstruction)
‚Ä¢	Avoid:
o	Non-deterministic calls in Rego (e.g., random, uncontrolled http.send)
When you must use time.now_ns or external data:
‚Ä¢	Either:
o	Snapshot it in the input used to evaluate.
o	Or store enough context to reconstruct.
________________________________________
Chapter 15 ‚Äì Stateful & Temporal Extensions
OPA itself is stateless: each query sees input and data as immutable snapshots. Yet many policies are stateful or temporal:
‚Ä¢	Rate limits (N requests per unit time)
‚Ä¢	‚ÄúNo more than 5 failed logins in 10 minutes‚Äù
‚Ä¢	‚ÄúThis migration must be rolled out only after all canaries pass‚Äù
The trick: Move state and time into data + input, not inside Rego.
________________________________________
Stateful & Temporal Extensions
category: generic
chapter: CH-05
pattern_type: conceptual
digest: c2048461755f174464ae35968b52994e9a4674f24d0bb17e81247681cddbb84e
symbol_refs: [safe_input := {]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution, observability]
:::
# decision doc
decision := {
  "allow": allow,
  "trace_id": trace_id,
}
________________________________________
14.4 PII and Redaction in Logs
Golden rule: logs must not become a data breach.
‚Ä¢	Do not log entire input if it contains PII.
‚Ä¢	Instead:
o	Log hashed fields (hash(email))
o	Log ids / foreign keys
o	Redact sensitive values (e.g., use "redacted")
Pattern:
safe_input := {
  "user_id": input.user.id,
  "tenant_id": input.tenant_id,
  "resource_id": input.resource.id,
  "action": input.action,
}
Your decision logger uses safe_input rather than raw input.
________________________________________
14.5 Reproducibility & Auditability
A compliant audit story usually needs:
‚Ä¢	Given:
o	bundle_revision
o	policy_version
o	input (or hash + associated fixture)
‚Ä¢	You can re-evaluate the decision and get the same result.
To achieve this:
‚Ä¢	Store:
o	Bundle artifacts (bundle.tar.gz)
o	Manifest metadata (revision, version)
o	Decision logs + input fixtures (or deterministic reconstruction)
‚Ä¢	Avoid:
o	Non-deterministic calls in Rego (e.g., random, uncontrolled http.send)
When you must use time.now_ns or external data:
‚Ä¢	Either:
o	Snapshot it in the input used to evaluate.
o	Or store enough context to reconstruct.
________________________________________
Chapter 15 ‚Äì Stateful & Temporal Extensions
OPA itself is stateless: each query sees input and data as immutable snapshots. Yet many policies are stateful or temporal:
‚Ä¢	Rate limits (N requests per unit time)
‚Ä¢	‚ÄúNo more than 5 failed logins in 10 minutes‚Äù
‚Ä¢	‚ÄúThis migration must be rolled out only after all canaries pass‚Äù
The trick: Move state and time into data + input, not inside Rego.
________________________________________
Stateful & Temporal Extensions
:::

::: pattern
id: PATTERN-16422769bea3fb75
name: 1.	events flow into kafka / kinesis.
description: count(recent_failures) > 5
  msg := "Too many recent login failures"
}
OPA sees only a subset; the window is curated by your stateful event pipeline.
________________________________________
15.3 Event-Driven Architectures with OPA
Typical pattern:
1.	Events flow into Kafka / Kinesis.
2.	A stream processor:
o	Maintains aggregates:
ÔÇß	counts, sums, last-seen times, sliding windows.
o	Writes materialized state to:
ÔÇß	Redis, DB, or data-bundles for OPA.
3.	OPA uses that state to decide:
o	Allow or deny new events.
o	Trigger downstream actions/alerts.
OPA remains pure ‚Äî no long-lived state, no hidden mutable variables.
________________________________________
15.4 Time-Scoped Exceptions
Sometimes you want:
‚Ä¢	‚ÄúAllow this temporary override until 2025-12-31.‚Äù
Pattern:
package overrides
category: architecture
chapter: CH-05
pattern_type: conceptual
digest: 607d54af899fa3d43126bf1b8ec65ff9e1634b05ef13730381463b0fe6194803
symbol_refs: [1.	events flow into kafka / kinesis.]
semantic_role: architecture
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution]
:::
count(recent_failures) > 5
  msg := "Too many recent login failures"
}
OPA sees only a subset; the window is curated by your stateful event pipeline.
________________________________________
15.3 Event-Driven Architectures with OPA
Typical pattern:
1.	Events flow into Kafka / Kinesis.
2.	A stream processor:
o	Maintains aggregates:
ÔÇß	counts, sums, last-seen times, sliding windows.
o	Writes materialized state to:
ÔÇß	Redis, DB, or data-bundles for OPA.
3.	OPA uses that state to decide:
o	Allow or deny new events.
o	Trigger downstream actions/alerts.
OPA remains pure ‚Äî no long-lived state, no hidden mutable variables.
________________________________________
15.4 Time-Scoped Exceptions
Sometimes you want:
‚Ä¢	‚ÄúAllow this temporary override until 2025-12-31.‚Äù
Pattern:
package overrides
:::

::: pattern
id: PATTERN-7bab973cb8c529c8
name: ‚Ä¢	keeps data access rules central.
description: statuses_for(user) := {"active"} if {
  not "admin" in user.roles
}
This pattern:
‚Ä¢	Keeps data access rules central.
‚Ä¢	Allows multiple services to enforce the same logic.
________________________________________
Chapter 17 ‚Äì LLM & Agentic Integration with OPA
LLMs are good at generating Rego, OPA is good at executing and verifying Rego. Together they form:
‚ÄúAI drafts policy, OPA and tests keep it safe.‚Äù
________________________________________
17.1 The Agentic Workflow
Canonical pipeline:
1.	Requirements in natural language:
o	‚ÄúAPI keys must not be visible in logs‚Äù
o	‚ÄúAdmin role modifications require approval‚Äù
2.	LLM drafts:
o	Rego module.
o	Test suite (_test.rego).
o	Metadata (owner, rule_id).
3.	Static checks:
o	opa fmt
o	Regal lint
o	opa check --strict
4.	Dynamic checks:
o	opa test (unit + integration tests).
o	Fuzz/Golden tests for critical policies.
5.	Human review:
o	Security / Policy engineers review diff, semantics.
6.	Bundle build & rollout:
o	Standard policy SDLC.
OPA becomes the execution and verification back-end for LLM-authored policy.
________________________________________
17.2 Guardrails for LLM-Generated Rego
When you let an LLM write Rego, you must:
‚Ä¢	Enforce style & safety:
o	Modern syntax only (import rego.v1 or future.keywords).
o	No http.send in production rules (unless explicitly allowed).
o	No secrets in code.
o	Type guards for all input.* references.
‚Ä¢	Require tests:
o	At least one positive and one negative case.
o	Use with overrides instead of real network/time.
You can encode this as Rego that reviews Rego:
‚Ä¢	Use rego.metadata.chain() and AST analysis to enforce rules.
‚Ä¢	Or use external tools (Regal) plus your own AST/grep rules.
________________________________________
17.3 ‚ÄúPolicy Copilot‚Äù Pattern
A typical agentic stack:
1.	Authoring agent:
o	Generates initial Rego module + tests from description and examples.
2.	Critic agent:
o	Reads module, runs static analysis (Regal messages, opa check).
o	Suggests improvements and simplifications.
3.	Tester agent:
o	Proposes additional tests (edge cases, negative paths).
o	Extends _test.rego.
4.	Reviewer agent:
o	Summarizes behavior in human language.
o	Flags risky constructs, ambiguous cases.
5.	Bundle builder:
o	Once human approves, compiles into bundle artifact.
OPA is the deterministic core all these agents orbit around.
________________________________________
17.4 LLM Self-Checking with Rego
LLMs can call OPA during prompt execution:
‚Ä¢	Use examples like:
o	‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù
‚Ä¢	LLM loops:
1.	Generate candidate Rego.
2.	Invoke opa test programmatically.
3.	If tests fail, update policy and try again (up to N iterations).
4.	Present final Rego + test report.
This turns Rego into a ground truth oracle inside an agentic system.
________________________________________
Chapter 18 ‚Äì Rego Cheat Sheet (Condensed)
This chapter is intentionally tight ‚Äì it‚Äôs the 2-page desk reference.
________________________________________
18.1 Core Rule Types
Type	Syntax	Example
Boolean	name if { ... }	allow if { is_admin }
Complete	name := value if { ... }	max_conns := 10 if is_admin
Partial Set	name contains x if { ... }	deny contains msg if { ... }
Partial Obj	name[key] := value if { ... }	roles[user] := role if { ... }
Function	f(x) := y if { ... }	double(x) := x * 2
Default	default name = value	default allow = false
________________________________________
18.2 Assignments & Comparisons
‚Ä¢	:= ‚Äì assignment (one-way)
‚Ä¢	== ‚Äì equality (no binding)
‚Ä¢	= ‚Äì unification (binds if unbound, else compares)
Examples:
x := 10               # assignment
ok if x == 10         # comparison
category: generic
chapter: CH-05
pattern_type: conceptual
digest: ac3291460e0398eff785298520d978d7849655dbc7adadd9d7220eac70c0b3b9
symbol_refs: [‚Ä¢	keeps data access rules central.]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
semantic_categories: [distribution, unification]
:::
statuses_for(user) := {"active"} if {
  not "admin" in user.roles
}
This pattern:
‚Ä¢	Keeps data access rules central.
‚Ä¢	Allows multiple services to enforce the same logic.
________________________________________
Chapter 17 ‚Äì LLM & Agentic Integration with OPA
LLMs are good at generating Rego, OPA is good at executing and verifying Rego. Together they form:
‚ÄúAI drafts policy, OPA and tests keep it safe.‚Äù
________________________________________
17.1 The Agentic Workflow
Canonical pipeline:
1.	Requirements in natural language:
o	‚ÄúAPI keys must not be visible in logs‚Äù
o	‚ÄúAdmin role modifications require approval‚Äù
2.	LLM drafts:
o	Rego module.
o	Test suite (_test.rego).
o	Metadata (owner, rule_id).
3.	Static checks:
o	opa fmt
o	Regal lint
o	opa check --strict
4.	Dynamic checks:
o	opa test (unit + integration tests).
o	Fuzz/Golden tests for critical policies.
5.	Human review:
o	Security / Policy engineers review diff, semantics.
6.	Bundle build & rollout:
o	Standard policy SDLC.
OPA becomes the execution and verification back-end for LLM-authored policy.
________________________________________
17.2 Guardrails for LLM-Generated Rego
When you let an LLM write Rego, you must:
‚Ä¢	Enforce style & safety:
o	Modern syntax only (import rego.v1 or future.keywords).
o	No http.send in production rules (unless explicitly allowed).
o	No secrets in code.
o	Type guards for all input.* references.
‚Ä¢	Require tests:
o	At least one positive and one negative case.
o	Use with overrides instead of real network/time.
You can encode this as Rego that reviews Rego:
‚Ä¢	Use rego.metadata.chain() and AST analysis to enforce rules.
‚Ä¢	Or use external tools (Regal) plus your own AST/grep rules.
________________________________________
17.3 ‚ÄúPolicy Copilot‚Äù Pattern
A typical agentic stack:
1.	Authoring agent:
o	Generates initial Rego module + tests from description and examples.
2.	Critic agent:
o	Reads module, runs static analysis (Regal messages, opa check).
o	Suggests improvements and simplifications.
3.	Tester agent:
o	Proposes additional tests (edge cases, negative paths).
o	Extends _test.rego.
4.	Reviewer agent:
o	Summarizes behavior in human language.
o	Flags risky constructs, ambiguous cases.
5.	Bundle builder:
o	Once human approves, compiles into bundle artifact.
OPA is the deterministic core all these agents orbit around.
________________________________________
17.4 LLM Self-Checking with Rego
LLMs can call OPA during prompt execution:
‚Ä¢	Use examples like:
o	‚ÄúWrite a policy such that opa eval returns allow=true for these inputs and false for others.‚Äù
‚Ä¢	LLM loops:
1.	Generate candidate Rego.
2.	Invoke opa test programmatically.
3.	If tests fail, update policy and try again (up to N iterations).
4.	Present final Rego + test report.
This turns Rego into a ground truth oracle inside an agentic system.
________________________________________
Chapter 18 ‚Äì Rego Cheat Sheet (Condensed)
This chapter is intentionally tight ‚Äì it‚Äôs the 2-page desk reference.
________________________________________
18.1 Core Rule Types
Type	Syntax	Example
Boolean	name if { ... }	allow if { is_admin }
Complete	name := value if { ... }	max_conns := 10 if is_admin
Partial Set	name contains x if { ... }	deny contains msg if { ... }
Partial Obj	name[key] := value if { ... }	roles[user] := role if { ... }
Function	f(x) := y if { ... }	double(x) := x * 2
Default	default name = value	default allow = false
________________________________________
18.2 Assignments & Comparisons
‚Ä¢	:= ‚Äì assignment (one-way)
‚Ä¢	== ‚Äì equality (no binding)
‚Ä¢	= ‚Äì unification (binds if unbound, else compares)
Examples:
x := 10               # assignment
ok if x == 10         # comparison
:::

::: pattern
id: PATTERN-ff12b39da5d9a966
name: all enterprise-grade policy suites
description: This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct pattern for all enterprise-grade policy suites.
category: generic
chapter: CH-05
pattern_type: conceptual
digest: 8046ce664afe536bf0720c34d4eda25677f1f417fe3c086350d4af52496f4da3
symbol_refs: [all enterprise-grade policy suites]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
This matches the pattern in your other test file (tech_debt_r15_test.rego) and is the correct pattern for all enterprise-grade policy suites.
:::

::: pattern
id: PATTERN-47647a18e70d4d1a
name: **
description: **Anti-Pattern:**
category: generic
chapter: CH-05
pattern_type: conceptual
digest: c43b71782a54d837e64dab737d1baa099ee3edb272d5e91138b0522f62840408
symbol_refs: [**]
semantic_role: pattern
embedding_hint_importance: low
embedding_hint_scope: local
embedding_hint_chunk: auto
:::
**Anti-Pattern:**
:::
