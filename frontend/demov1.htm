<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VeroSuite - System Architecture Demo</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      color: #ffffff;
    }
    .container { max-width: 1200px; margin: 0 auto; padding: 20px; }
    .header { text-align: center; margin-bottom: 40px; }
    .header h1 {
      font-size: 3rem; font-weight: 700; margin-bottom: 10px;
      background: linear-gradient(45deg, #ffffff, #f0f8ff);
      -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;
    }
    .tabs { display: flex; background: rgba(255,255,255,0.1); border-radius: 12px; padding: 4px; margin-bottom: 30px; backdrop-filter: blur(10px); }
    .tab { flex: 1; padding: 12px 20px; background: transparent; border: none; color: rgba(255,255,255,0.7); border-radius: 8px; cursor: pointer; transition: all .3s ease; font-size: 14px; font-weight: 500; }
    .tab.active { background: rgba(255,255,255,0.2); color: #fff; transform: translateY(-1px); box-shadow: 0 4px 12px rgba(0,0,0,0.2); }
    .tab-content { display: none; animation: fadeIn .5s ease-in; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(20px);} to { opacity: 1; transform: translateY(0);} }

    .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap: 20px; margin-bottom: 30px; }
    .stat-card { background: rgba(255,255,255,0.1); border-radius: 12px; padding: 20px; text-align: center; backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.2); }
    .stat-number { font-size: 2.5rem; font-weight: 700; color: #fff; margin-bottom: 5px; }
    .stat-label { font-size: .9rem; color: rgba(255,255,255,0.7); }

    .architecture-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px,1fr)); gap: 20px; margin-bottom: 30px; }
    .layer-card { background: rgba(255,255,255,0.1); border-radius: 16px; padding: 24px; backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.2); transition: transform .3s ease, box-shadow .3s ease; }
    .layer-card:hover { transform: translateY(-5px); box-shadow: 0 20px 40px rgba(0,0,0,.3); }
    .layer-title { font-size: 1.4rem; font-weight: 600; margin-bottom: 15px; color: #fff; }
    .service-list { list-style: none; }
    .service-item { display: flex; align-items: center; margin-bottom: 8px; padding: 8px 12px; background: rgba(255,255,255,0.05); border-radius: 8px; font-size: 14px; }
    .service-icon { width: 8px; height: 8px; border-radius: 50%; margin-right: 10px; }
    .frontend { background: #61dafb; }
    .backend { background: #e10098; }
    .database { background: #336791; }
    .integration { background: #ff6b35; }

    .branding-demo { background: rgba(255,255,255,0.1); border-radius: 16px; padding: 30px; backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.2); }
    .brand-selector { display: flex; gap: 15px; margin-bottom: 30px; flex-wrap: wrap; }
    .brand-option { padding: 10px 20px; border-radius: 25px; background: rgba(255,255,255,0.1); border: 2px solid transparent; color: #fff; cursor: pointer; transition: all .3s ease; font-weight: 500; }
    .brand-option.active { background: rgba(255,255,255,0.2); border-color: rgba(255,255,255,0.4); transform: scale(1.05); }
    .brand-preview { background: #fff; border-radius: 12px; padding: 30px; color: #333; min-height: 300px; transition: all .5s ease; }

    .api-docs, .db-schema { background: rgba(255,255,255,0.1); border-radius: 16px; padding: 30px; backdrop-filter: blur(15px); border: 1px solid rgba(255,255,255,0.2); }
    .endpoint-group { margin-bottom: 25px; }
    .endpoint-group h3 { font-size: 1.2rem; margin-bottom: 15px; color: #fff; padding-bottom: 8px; border-bottom: 1px solid rgba(255,255,255,0.2); }
    .endpoint { display: flex; align-items: center; margin-bottom: 10px; padding: 12px; background: rgba(255,255,255,0.05); border-radius: 8px; font-family: 'Monaco','Menlo',monospace; font-size: 13px; }
    .method { padding: 4px 8px; border-radius: 4px; font-weight: 600; font-size: 11px; width: 60px; text-align: center; margin-right: 15px; }
    .get { background: #61affe; color: #fff; } .post { background: #49cc90; color: #fff; } .put { background: #fca130; color: #fff; } .delete { background: #f93e3e; color: #fff; }

    .schema-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px,1fr)); gap: 20px; }
    .table-card { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px; border-left: 4px solid #61dafb; }
    .table-name { font-weight: 600; font-size: 1.1rem; margin-bottom: 12px; color: #61dafb; }
    .field-list { list-style: none; font-family: 'Monaco','Menlo',monospace; font-size: 12px; }
    .field-item { padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.1); }
    .field-name { color: #fff; font-weight: 500; }
    .field-type { color: rgba(255,255,255,0.6); margin-left: 10px; }

    .rls-demo { background: rgba(255,255,255,0.05); border-radius: 12px; padding: 20px; margin-top: 20px; font-family: 'Monaco','Menlo',monospace; font-size: 13px; border-left: 4px solid #f93e3e; }
    .code-block { background: rgba(0,0,0,0.3); border-radius: 8px; padding: 15px; margin: 15px 0; font-family: 'Monaco','Menlo',monospace; font-size: 13px; overflow-x: auto; }
    .keyword { color: #ff79c6; } .string { color: #f1fa8c; } .comment { color: #6272a4; font-style: italic; } .function { color: #8be9fd; }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>VeroSuite</h1>
      <p style="font-size: 1.2rem; opacity: .9;">System Architecture & Technical Demo</p>
    </div>

    <div class="tabs">
      <button class="tab active" onclick="showTab('architecture', this)">System Architecture</button>
      <button class="tab" onclick="showTab('branding', this)">Branding Engine</button>
      <button class="tab" onclick="showTab('api', this)">API Documentation</button>
      <button class="tab" onclick="showTab('database', this)">Database Schema</button>
    </div>

    <!-- Architecture Tab -->
    <div id="architecture" class="tab-content active">
      <div class="stats-grid">
        <div class="stat-card"><div class="stat-number">45+</div><div class="stat-label">API Endpoints</div></div>
        <div class="stat-card"><div class="stat-number">12</div><div class="stat-label">Core Modules</div></div>
        <div class="stat-card"><div class="stat-number">25+</div><div class="stat-label">Database Tables</div></div>
        <div class="stat-card"><div class="stat-number">99.9%</div><div class="stat-label">Target Uptime</div></div>
      </div>

      <div class="architecture-grid">
        <div class="layer-card">
          <h3 class="layer-title">Frontend Layer</h3>
          <ul class="service-list">
            <li class="service-item"><div class="service-icon frontend"></div>Next.js Web Application</li>
            <li class="service-item"><div class="service-icon frontend"></div>React Native Mobile App</li>
            <li class="service-item"><div class="service-icon frontend"></div>Offline-First Architecture</li>
            <li class="service-item"><div class="service-icon frontend"></div>Real-time Updates</li>
          </ul>
        </div>
        <div class="layer-card">
          <h3 class="layer-title">Backend Services</h3>
          <ul class="service-list">
            <li class="service-item"><div class="service-icon backend"></div>NestJS API Gateway</li>
            <li class="service-item"><div class="service-icon backend"></div>Event-Driven Architecture</li>
            <li class="service-item"><div class="service-icon backend"></div>Background Job Processing</li>
            <li class="service-item"><div class="service-icon backend"></div>Multi-Tenant Security</li>
          </ul>
        </div>
        <div class="layer-card">
          <h3 class="layer-title">Data Layer</h3>
          <ul class="service-list">
            <li class="service-item"><div class="service-icon database"></div>PostgreSQL with RLS</li>
            <li class="service-item"><div class="service-icon database"></div>Redis Caching</li>
            <li class="service-item"><div class="service-icon database"></div>S3 File Storage</li>
            <li class="service-item"><div class="service-icon database"></div>Analytics Warehouse</li>
          </ul>
        </div>
        <div class="layer-card">
          <h3 class="layer-title">Integrations</h3>
          <ul class="service-list">
            <li class="service-item"><div class="service-icon integration"></div>Stripe Payments</li>
            <li class="service-item"><div class="service-icon integration"></div>Twilio Communications</li>
            <li class="service-item"><div class="service-icon integration"></div>QuickBooks Sync</li>
            <li class="service-item"><div class="service-icon integration"></div>Mapbox Routing</li>
          </ul>
        </div>
      </div>

      <div class="rls-demo">
        <h3 style="margin-bottom: 15px; color: #f93e3e;">Row Level Security (RLS) Implementation</h3>
        <div class="code-block">
<span class="comment">-- Every table enforces tenant isolation</span>
<span class="keyword">CREATE POLICY</span> tenant_isolation <span class="keyword">ON</span> jobs
<span class="keyword">USING</span> (tenant_id = <span class="function">current_setting</span>(<span class="string">'app.tenant_id'</span>)::<span class="keyword">uuid</span>);

<span class="comment">-- Middleware sets tenant context per request</span>
<span class="keyword">SET LOCAL</span> app.tenant_id = <span class="string">'${tenantId}'</span>;
        </div>
        <p style="margin-top: 10px; color: rgba(255,255,255,0.8);">üîí Database-level tenant isolation ensures no cross-tenant data access is possible</p>
      </div>
    </div>

    <!-- Branding Tab -->
    <div id="branding" class="tab-content">
      <div class="branding-demo">
        <h2 style="margin-bottom: 20px;">Multi-Tenant Branding Engine</h2>
        <div class="brand-selector">
          <div class="brand-option active" data-brand="ace-pest" onclick="applyBrand('ace-pest', this)">Ace Pest Control</div>
          <div class="brand-option" data-brand="guardian" onclick="applyBrand('guardian', this)">Guardian Exterminators</div>
          <div class="brand-option" data-brand="green-shield" onclick="applyBrand('green-shield', this)">Green Shield Pest</div>
          <div class="brand-option" data-brand="urban-pest" onclick="applyBrand('urban-pest', this)">Urban Pest Solutions</div>
        </div>

        <div class="brand-preview" id="brand-preview">
          <div style="display:flex; align-items:center; margin-bottom:20px;">
            <div id="brand-logo" style="width:50px; height:50px; border-radius:8px; margin-right:15px; background:#e74c3c;"></div>
            <div>
              <h2 id="brand-name" style="margin:0; color:#2c3e50;">Ace Pest Control</h2>
              <p id="brand-tagline" style="margin: 5px 0 0 0; color:#7f8c8d;">Professional Pest Solutions Since 1985</p>
            </div>
          </div>
          <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; margin-bottom:20px;">
            <button id="primary-btn" style="padding:12px 24px; border:none; border-radius:6px; background:#e74c3c; color:#fff; font-weight:600;">Schedule Service</button>
            <button id="secondary-btn" style="padding:12px 24px; border:2px solid #e74c3c; border-radius:6px; background:transparent; color:#e74c3c; font-weight:600;">Get Quote</button>
          </div>
          <div id="card-sample" style="background:#f8f9fa; padding:15px; border-radius:8px; border-left:4px solid #e74c3c;">
            <h4 style="margin:0 0 10px 0; color:#2c3e50;">Recent Service Report</h4>
            <p style="margin:0; color:#6c757d; font-size:14px;">Interior and exterior treatment completed. Next service scheduled for next month.</p>
          </div>
        </div>

        <div class="code-block" style="margin-top: 20px;">
<span class="comment">// Dynamic theme loading per tenant</span>
<span class="keyword">const</span> theme = <span class="keyword">await</span> <span class="function">fetchBrandTheme</span>(tenantId);
<span class="keyword">document</span>.<span class="function">documentElement</span>.<span class="function">style</span>.<span class="function">setProperty</span>(<span class="string">'--primary-color'</span>, theme.primaryColor);
<span class="keyword">document</span>.<span class="function">documentElement</span>.<span class="function">style</span>.<span class="function">setProperty</span>(<span class="string">'--secondary-color'</span>, theme.secondaryColor);
        </div>
      </div>
    </div>

    <!-- API Tab -->
    <div id="api" class="tab-content">
      <div class="api-docs">
        <h2 style="margin-bottom: 25px;">REST API Documentation</h2>
        <div class="endpoint-group">
          <h3>üè¢ CRM Module</h3>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/crm/accounts</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/crm/accounts</span></div>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/crm/accounts/{id}/locations</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/crm/locations</span></div>
        </div>
        <div class="endpoint-group">
          <h3>üìÖ Scheduling & Dispatch</h3>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/scheduling/calendar</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/scheduling/work-orders</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/scheduling/jobs/assign</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/scheduling/optimize-routes</span></div>
        </div>
        <div class="endpoint-group">
          <h3>üîß Field Service</h3>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/field/jobs/today</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/field/jobs/{id}/start</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/field/jobs/{id}/complete</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/field/jobs/{id}/photos</span></div>
        </div>
        <div class="endpoint-group">
          <h3>üí≥ Billing & Payments</h3>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/billing/invoices</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/billing/invoices</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/billing/invoices/{id}/pay</span></div>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/billing/payment-methods</span></div>
        </div>
        <div class="endpoint-group">
          <h3>üé® Branding Engine</h3>
          <div class="endpoint"><span class="method get">GET</span><span>/v1/branding/current</span></div>
          <div class="endpoint"><span class="method put">PUT</span><span>/v1/branding/draft</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/branding/publish</span></div>
          <div class="endpoint"><span class="method post">POST</span><span>/v1/branding/assets/upload-url</span></div>
        </div>
        <div class="code-block">
<span class="comment">// Example API Response</span>
{
  <span class="string">"data"</span>: {
    <span class="string">"id"</span>: <span class="string">"job-123"</span>,
    <span class="string">"tenant_id"</span>: <span class="string">"ace-pest-control"</span>,
    <span class="string">"status"</span>: <span class="string">"completed"</span>,
    <span class="string">"scheduled_at"</span>: <span class="string">"2025-08-18T10:00:00Z"</span>,
    <span class="string">"completed_at"</span>: <span class="string">"2025-08-18T11:30:00Z"</span>,
    <span class="string">"technician"</span>: {
      <span class="string">"id"</span>: <span class="string">"tech-456"</span>,
      <span class="string">"name"</span>: <span class="string">"Mike Johnson"</span>
    }
  },
  <span class="string">"meta"</span>: {
    <span class="string">"request_id"</span>: <span class="string">"req-789"</span>,
    <span class="string">"timestamp"</span>: <span class="string">"2025-08-18T12:00:00Z"</span>
  }
}
        </div>
      </div>
    </div>

    <!-- Database Tab -->
    <div id="database" class="tab-content">
      <div class="db-schema">
        <h2 style="margin-bottom: 25px;">Database Schema Overview</h2>
        <div class="schema-grid">
          <div class="table-card">
            <div class="table-name">tenants</div>
            <ul class="field-list">
              <li class="field-item"><span class="field-name">id</span><span class="field-type">UUID PRIMARY KEY</span></li>
              <li class="field-item"><span class="field-name">name</span><span class="field-type">VARCHAR(255)</span></li>
              <li class="field-item"><span class="field-name">domain</span><span class="field-type">VARCHAR(255) UNIQUE</span></li>
              <li class="field-item"><span class="field-name">status</span><span class="field-type">ENUM('active','suspended')</span></li>
              <li class="field-item"><span class="field-name">created_at</span><span class="field-type">TIMESTAMPTZ</span></li>
            </ul>
          </div>

          <div class="table-card">
            <div class="table-name">accounts</div>
            <ul class="field-list">
              <li class="field-item"><span class="field-name">id</span><span class="field-type">UUID PRIMARY KEY</span></li>
              <li class="field-item"><span class="field-name">tenant_id</span><span class="field-type">UUID NOT NULL</span></li>
              <li class="field-item"><span class="field-name">name</span><span class="field-type">VARCHAR(255)</span></li>
              <li class="field-item"><span class="field-name">type</span><span class="field-type">ENUM('commercial','residential')</span></li>
              <li class="field-item"><span class="field-name">ar_balance</span><span class="field-type">DECIMAL(10,2)</span></li>
            </ul>
          </div>

          <div class="table-card">
            <div class="table-name">locations</div>
            <ul class="field-list">
              <li class="field-item"><span class="field-name">id</span><span class="field-type">UUID PRIMARY KEY</span></li>
              <li class="field-item"><span class="field-name">tenant_id</span><span class="field-type">UUID NOT NULL</span></li>
              <li class="field-item"><span class="field-name">account_id</span><span class="field-type">UUID REFERENCES accounts(id)</span></li>
              <li class="field-item"><span class="field-name">name</span><span class="field-type">VARCHAR(255)</span></li>
              <li class="field-item"><span class="field-name">address</span><span class="field-type">TEXT</span></li>
              <li class="field-item"><span class="field-name">lat</span><span class="field-type">DECIMAL(10,8)</span></li>
              <li class="field-item"><span class="field-name">lng</span><span class="field-type">DECIMAL(11,8)</span></li>
            </ul>
          </div>

          <div class="table-card">
            <div class="table-name">jobs</div>
            <ul class="field-list">
              <li class="field-item"><span class="field-name">id</span><span class="field-type">UUID PRIMARY KEY</span></li>
              <li class="field-item"><span class="field-name">tenant_id</span><span class="field-type">UUID NOT NULL</span></li>
              <li class="field-item"><span class="field-name">location_id</span><span class="field-type">UUID REFERENCES locations(id)</span></li>
              <li class="field-item"><span class="field-name">technician_id</span><span class="field-type">UUID NULL</span></li>
              <li class="field-item"><span class="field-name">status</span><span class="field-type">ENUM('unassigned','scheduled','in_progress','completed','cancelled')</span></li>
              <li class="field-item"><span class="field-name">priority</span><span class="field-type">ENUM('low','medium','high','urgent')</span></li>
              <li class="field-item"><span class="field-name">scheduled_date</span><span class="field-type">DATE</span></li>
              <li class="field-item"><span class="field-name">scheduled_start_time</span><span class="field-type">TIME</span></li>
              <li class="field-item"><span class="field-name">scheduled_end_time</span><span class="field-type">TIME</span></li>
              <li class="field-item"><span class="field-name">created_at</span><span class="field-type">TIMESTAMPTZ</span></li>
            </ul>
          </div>
        </div>

        <div class="rls-demo">
          <h3 style="margin-bottom: 15px; color:#f93e3e;">RLS Policy (SQL)</h3>
          <div class="code-block">
<span class="comment">-- Enable Row Level Security and enforce tenant isolation</span>
<span class="keyword">ALTER TABLE</span> jobs <span class="keyword">ENABLE ROW LEVEL SECURITY</span>;
<span class="keyword">CREATE POLICY</span> tenant_isolation_jobs <span class="keyword">ON</span> jobs
  <span class="keyword">USING</span> (tenant_id = current_setting(<span class="string">'app.tenant_id'</span>)::<span class="keyword">uuid</span>);
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    const brands = {
      'ace-pest': {
        name: 'Ace Pest Control',
        tagline: 'Professional Pest Solutions Since 1985',
        primary: '#e74c3c',
        secondary: '#c0392b',
        accent: '#f39c12'
      },
      'guardian': {
        name: 'Guardian Exterminators',
        tagline: 'Protecting What Matters Most',
        primary: '#2ecc71',
        secondary: '#27ae60',
        accent: '#16a085'
      },
      'green-shield': {
        name: 'Green Shield Pest',
        tagline: 'Eco-Friendly Pest Protection',
        primary: '#059669',
        secondary: '#047857',
        accent: '#10b981'
      },
      'urban-pest': {
        name: 'Urban Pest Solutions',
        tagline: 'City-Proof Pest Management',
        primary: '#3498db',
        secondary: '#2980b9',
        accent: '#8e44ad'
      }
    };

    function showTab(tabId, el) {
      document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
      document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
      const tab = document.getElementById(tabId);
      if (tab) tab.classList.add('active');
      if (el) el.classList.add('active');
    }

    function applyBrand(key, el) {
      const b = brands[key];
      if (!b) return;
      // Update active pill
      document.querySelectorAll('.brand-option').forEach(o => o.classList.remove('active'));
      if (el) el.classList.add('active');

      // Update preview values
      document.getElementById('brand-logo').style.background = b.primary;
      document.getElementById('brand-name').textContent = b.name;
      document.getElementById('brand-tagline').textContent = b.tagline;

      const primaryBtn = document.getElementById('primary-btn');
      const secondaryBtn = document.getElementById('secondary-btn');
      const cardSample = document.getElementById('card-sample');

      primaryBtn.style.background = b.primary;
      primaryBtn.style.borderColor = b.primary;
      secondaryBtn.style.borderColor = b.primary;
      secondaryBtn.style.color = b.primary;
      cardSample.style.borderLeftColor = b.primary;

      // Subtle background tint on preview
      const preview = document.getElementById('brand-preview');
      preview.style.boxShadow = `0 10px 30px ${b.secondary}22`;
    }

    // Initialize defaults
    window.addEventListener('DOMContentLoaded', () => {
      applyBrand('ace-pest', document.querySelector('.brand-option[data-brand="ace-pest"]'));
    });
  </script>
</body>
</html>